(this.webpackJsonpsoundbubble=this.webpackJsonpsoundbubble||[]).push([[0],{266:function(e,t,n){},267:function(e,t,n){},268:function(e,t,n){},269:function(e,t,n){},270:function(e,t,n){},271:function(e,t,n){},272:function(e,t,n){},273:function(e,t,n){},274:function(e,t,n){},275:function(e,t,n){},276:function(e,t,n){"use strict";n.r(t);var s=n(2),c=n.n(s),a=n(122),r=n.n(a),i=(n(91),n(12)),o=n(14),u=n(17),l=n(3),d=n(6),j=n.n(d),b=n(8),h=n(87);n(133),n(134),n(135),n(136);var f=h.a.initializeApp({apiKey:"AIzaSyBuDoETyUrO2RCDAlFMsW2uV-QmtCT8t6Y",authDomain:"soundbubble-27737.firebaseapp.com",projectId:"soundbubble-27737",storageBucket:"soundbubble-27737.appspot.com",messagingSenderId:"527274299416",appId:"1:527274299416:web:64b1ac2d05f4262df0736d",measurementId:"G-9TP9PEEV11"});h.a.analytics();var O=f.auth(),p=f.storage(),m=f.firestore(),g=n(127),x=n.p+"static/media/Logo3.fc53f4ac.svg",v=n(1),y=function(){return Object(v.jsx)("div",{className:"LoadingData",children:Object(v.jsx)("img",{loading:"lazy",src:x,alt:""})})};function S(e){return e.replace(/\s/g,"").replace(/[,'._/]/g,"").replace(/-/g,"").toLowerCase()}var w=function(e){for(var t=[],n=S(e),s=1;s<n.length+1;s++)t.push(n.substr(0,s));return t},N=c.a.createContext(),C=function(){return Object(s.useContext)(N)},k=function(e){var t=e.children,n=Object(s.useState)({}),c=Object(l.a)(n,2),a=c[0],r=c[1],i=Object(s.useState)(null),o=Object(l.a)(i,2),u=o[0],d=o[1],h=Object(s.useState)(!0),f=Object(l.a)(h,2),p=f[0],x=f[1],y=Object(s.useState)(""),S=Object(l.a)(y,2),C=S[0],k=S[1];Object(s.useEffect)((function(){if(null!==u)return m.collection("users").doc(u).onSnapshot((function(e){e.data()&&void 0===a.uid&&r(e.data())}))}),[m,u]),Object(s.useEffect)((function(){return O.onAuthStateChanged(function(){var e=Object(b.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t?d(t.uid):(d(null),r({}),x(!1));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]);var I={currentUser:a,setCurrentUser:r,login:function(e,t,n,s){return s(!0),O.signInWithEmailAndPassword(e,t).then().catch((function(e){n(e.message),s(!1)}))},signup:function(e,t,n,s,c,a,r,i){return i(!0),O.createUserWithEmailAndPassword(e,n).then((function(e){m.collection("users").doc(e.user.uid).set({uid:e.user.uid,displayName:t,photoURL:c||"https://images.fineartamerica.com/images/artworkimages/mediumlarge/1/music-icon-mohammed-jabir-ap.jpg",isAuthor:1===parseInt(s),isVerified:1===parseInt(s),numberOfListenersPerMonth:0,ownSongs:[],ownPlaylists:[],addedSongs:[],addedPlaylists:[],addedAuthors:[],lastSongPlayed:"",chats:[],friends:[],subscribers:0,regDate:g.a.firestore.FieldValue.serverTimestamp(),imageColors:a}),m.collection("search").doc(e.user.uid).set({place:"users",uid:e.user.uid,rank:0,variantsOfName:w(t)}),m.collection("history").doc(e.user.uid).set({history:[]}),i(!1)})).catch((function(e){r(e.message)}))},logout:function(){return O.signOut()},loading:p,setLoading:x,searchValue:C,setSearchValue:k};return Object(v.jsx)(N.Provider,{value:I,children:t})},I=c.a.createContext(),A=function(){return Object(s.useContext)(I)},P=function(e){var t=e.children,n=Object(s.useState)(window.innerWidth),c=Object(l.a)(n,2),a=c[0],r=c[1],i=Object(s.useState)(window.innerHeight),o=Object(l.a)(i,2),u=o[0],d=o[1],j=Object(s.useState)(window.innerWidth<1e3),b=Object(l.a)(j,2),h=b[0],f=b[1];function O(){r(window.innerWidth),d(window.innerHeight),f(window.innerWidth<1e3)}Object(s.useEffect)((function(){return window.addEventListener("resize",O),function(){window.removeEventListener("resize",O)}}),[]);var p={screenWidth:a,screenHeight:u,isMobile:h};return Object(v.jsx)(I.Provider,{value:p,children:t})},L=n(32),M=n(19),T=n(10),E=n(41),R=function(e){var t=e.listOfChosenItems,n=e.setListOfChosenItems,s=e.itemId;return void 0!==t?Object(v.jsx)("div",{onClick:function(e){return e.preventDefault()},style:{width:"35px"},children:t.includes(s)?Object(v.jsx)("button",{type:"button",onClick:function(e){var c=t.filter((function(e){return e!==s}));n(c)},className:"addToListBtn",children:Object(v.jsx)(E.a,{style:{color:"var(--lightBlue)"}})}):Object(v.jsx)("button",{type:"button",onClick:function(){return n((function(e){return[].concat(Object(T.a)(e),[s])}))},className:"addToListBtn",children:Object(v.jsx)(E.b,{})})}):null};function B(e){return e%10===e?"0"+e:e}function D(e){var t=new Date(1970,0,1);return t.setSeconds(e),t}function U(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=["January","February","March","April","May","June","July","August","September","October","November","December"],s=isNaN(e)?new Date(e):e.seconds?D(e.seconds+10800):D(e/1e3+10800);return 0===t?n[s.getMonth()]+" "+s.getDate()+", "+s.getFullYear():1===t?n[s.getMonth()]+" "+s.getDate():2===t?B(s.getHours())+":"+B(s.getMinutes()):3===t?n[s.getMonth()]+" "+s.getDate()+", "+s.getFullYear()+" at "+B(s.getHours())+":"+B(s.getMinutes()):void 0}var F,W=function(e){var t=e.userUID,n=(Object(L.a)(e,["userUID"]),Object(s.useState)("")),c=Object(l.a)(n,2),a=c[0],r=c[1],i=Object(s.useState)(!1),o=Object(l.a)(i,2),u=o[0],d=o[1];return Object(s.useEffect)((function(){var e=m.collection("users").doc(t).onSnapshot((function(e){if(void 0!==t){var n=(new Date).getTime()-3e5,s=e.data().online>n;d(s),void 0===e.data().online?r("offline"):s||r("last seen "+U(e.data().online,3))}}));return function(){e()}}),[m,t]),u?Object(v.jsx)("span",{className:"is-online",children:"Online"}):Object(v.jsx)("span",{className:"is-not-online",children:a})},H=n(20),z=H.a.div(F||(F=Object(M.a)(["\n  position: absolute;\n  top: 50%;\n  right: 8px;\n  transform: translateY(-50%);\n"]))),V=function(e){var t=e.data,n=e.chosenArray,s=e.setChosenArray,c=e.lastSeen,a=void 0!==c&&c,r=e.rightButton,i=Object(L.a)(e,["data","chosenArray","setChosenArray","lastSeen","rightButton"]);return Object(v.jsxs)("div",Object(u.a)(Object(u.a)({className:"person"},i),{},{children:[Object(v.jsx)(R,{listOfChosenItems:n,setListOfChosenItems:s,itemId:t.uid}),Object(v.jsx)("div",{className:"pesronImg",children:Object(v.jsx)("img",{loading:"lazy",src:t.photoURL,alt:""})}),Object(v.jsx)("div",{className:"personName",children:t.displayName}),a&&Object(v.jsx)(W,{userUID:t.uid,className:"is-online"}),Object(v.jsx)(z,{children:r})]}))},Y=function(e,t){m.collection("history").doc(t.uid).get().then((function(n){var s=n.data().history;s[0]!==e&&s.unshift(e),s.length>30&&(s.length=30),m.collection("history").doc(t.uid).update({history:s})}))};function q(e){for(var t=[],n=new Array(e.length),s=0;s<e.length;){var c=Math.floor(Math.random()*e.length);t.includes(c)||(t.push(c),n[c]=e[s],s++)}return n}var G=function(e,t,n,c){Object(s.useEffect)((function(){e.uid&&n&&t()}),[JSON.stringify(c)])};function Q(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e>t?n:e<n?t:e}var K=function(e,t,n){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(e){return e},c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){return null},a=arguments.length>5?arguments[5]:void 0,r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;if(null===e||void 0===e?void 0:e.length){var i=e.map(function(){var e=Object(b.a)(j.a.mark((function e(n,s){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection(t).doc(n).get();case 2:return e.abrupt("return",e.sent.data());case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());Promise.all(i).then((function(e){var t=s(e);(null===t||void 0===t?void 0:t.length)>a&&(t.length=a),n(0===r?t:function(e){var n=[];return t.forEach((function(t){t&&(e.find((function(e){return e.id===t.id}))||n.push(t))})),[].concat(Object(T.a)(e),n)}),c()}))}},X=c.a.createContext(),J=function(){return Object(s.useContext)(X)},_=function(e){var t=e.children,n=Object(s.useState)(!1),c=Object(l.a)(n,2),a=c[0],r=c[1],i=Object(s.useState)(Object(v.jsx)("h1",{children:"Test"})),o=Object(l.a)(i,2),u=o[0],d=o[1],j=Object(s.useState)({isOpenned:!1,type:"success",message:"Action is successfully done!"}),b=Object(l.a)(j,2),h=b[0],f=b[1],O=Object(s.useState)(!1),p=Object(l.a)(O,2),m=p[0],g=p[1],x=Object(s.useState)({confirmText:"Confirm Action",rejectText:"Cancel",onConfirmL:function(){return null},onReject:function(){return null}}),y=Object(l.a)(x,2),S=y[0],w=y[1];function N(){g(!1)}var C={openModal:a,setOpenModal:r,toggleModal:function(){r(!a)},setContent:d,content:u,isOpenConfirm:m,setIsOpenConfirm:g,openConfirm:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Cancel",s=arguments.length>3?arguments[3]:void 0,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:N;g(!0),w({question:e,confirmText:t,rejectText:n,onConfirm:s,onReject:c})},closeConfirm:N,confirmContent:S,bottomMessage:h,openBottomMessage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Success",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e3;f({isOpenned:!0,type:t,message:e}),setTimeout((function(){f({isOpenned:!1,type:t,message:e})}),n)}};return Object(v.jsx)(X.Provider,{value:C,children:t})},Z=Object(s.createContext)(null),$=function(){return Object(s.useContext)(Z)},ee=function(e){var t=e.children,n=C(),c=n.currentUser,a=n.loading,r=n.setLoading,o=J().setOpenModal,u=Object(s.useState)([]),d=Object(l.a)(u,2),h=d[0],f=d[1],O=Object(s.useState)([]),p=Object(l.a)(O,2),g=p[0],x=p[1],S=Object(s.useState)([]),w=Object(l.a)(S,2),N=w[0],k=w[1],I=Object(s.useState)([]),A=Object(l.a)(I,2),P=A[0],L=A[1],M=Object(s.useState)([]),T=Object(l.a)(M,2),E=T[0],R=T[1],B=Object(s.useState)(-1),D=Object(l.a)(B,2),U=D[0],F=D[1],W=Object(s.useState)(0),H=Object(l.a)(W,2),z=H[0],X=H[1],_=Object(s.useState)({}),$=Object(l.a)(_,2),ee=$[0],te=$[1],ne=Object(s.useState)(0),se=Object(l.a)(ne,2),ce=se[0],ae=se[1],re=Object(s.useState)({id:-1}),ie=Object(l.a)(re,2),oe=ie[0],ue=ie[1],le=Object(s.useState)([]),de=Object(l.a)(le,2),je=de[0],be=de[1],he=Object(s.useState)(!1),fe=Object(l.a)(he,2),Oe=fe[0],pe=fe[1],me=Object(s.useState)(0),ge=Object(l.a)(me,2),xe=ge[0],ve=ge[1],ye=Object(s.useState)(0),Se=Object(l.a)(ye,2),we=Se[0],Ne=Se[1],Ce=Object(s.useState)(1),ke=Object(l.a)(Ce,2),Ie=ke[0],Ae=ke[1],Pe=Object(s.useState)(0),Le=Object(l.a)(Pe,2),Me=Le[0],Te=Le[1],Ee=Object(s.useState)(0),Re=Object(l.a)(Ee,2),Be=Re[0],De=Re[1],Ue=Object(s.useState)(!1),Fe=Object(l.a)(Ue,2),We=Fe[0],He=Fe[1],ze=Object(s.useState)(!1),Ve=Object(l.a)(ze,2),Ye=Ve[0],qe=Ve[1],Ge=Object(s.useRef)(null),Qe=Object(s.useRef)(null),Ke=Object(s.useRef)(null),Xe=Object(s.useRef)(null),Je=Object(s.useState)(0),_e=Object(l.a)(Je,2),Ze=_e[0],$e=_e[1],et=Object(s.useState)(!1),tt=Object(l.a)(et,2),nt=tt[0],st=tt[1];function ct(){var e;K(null===c||void 0===c||null===(e=c.lastQueue)||void 0===e?void 0:e.songsList,"songs",R,(function(e){return e}),(function(){return X(c.lastQueue.songsList.findIndex((function(e){return e===c.lastSongPlayed})))}))}function at(){K(c.addedSongs.slice(0).reverse(),"songs",f,(function(e){return e}),ct)}function rt(){return it.apply(this,arguments)}function it(){return(it=Object(b.a)(j.a.mark((function e(){var t,n,s,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0!==c.uid&&(t={id:-1,name:"",songSrc:"",authors:[],cover:"",listens:0,releaseDate:"",lyrics:[],imageColors:[]},n=c.lastSongPlayed||c.addedSongs[0]||t.id,s=c.lastQueue||{source:"/library",name:"Your Library",image:c.photoURL,songsList:h}||[],F(n),te(s),-1!==n?(a=m.collection("songs").doc(n),a.get().then((function(e){if(e.exists){var t=e.data();ue(t),be(t.imageColors||[]),r(!1)}})).catch((function(e){console.log("Error getting document:",e),r(!1)}))):(ue(t),be([]),r(!1)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ot(){return(ot=Object(b.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:-1!==U?m.collection("songs").doc(U).get().then((function(e){if(e.exists){var t=e.data();be(t.imageColors||[]),ue(t)}})):rt();case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ut(){for(var e=0,t=oe.lyrics.length-1,n=parseFloat(parseFloat(Ge.current.currentTime).toFixed(1));e<=t;){var s=Math.floor((e+t)/2),c=parseFloat(parseFloat(oe.lyrics[s].startTime).toFixed(1)),a=s!==oe.lyrics.length-1?parseFloat(parseFloat(oe.lyrics[s+1].startTime).toFixed(1)):t;if("undefined"===oe.lyrics[s].startTime)return;if(n>=c&&n<=a){De(s);break}c<n?e=s+1:t=s-1}}function lt(){return(lt=Object(b.a)(j.a.mark((function e(){var t,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Q(z+1,E.length-1),e.next=3,m.collection("songs").doc(E[t].id).get();case 3:return e.next=5,e.sent.data().id;case 5:n=e.sent,Y(n,c),De(0),F(n),X(Q(t,E.length-1)),m.collection("users").doc(c.uid).update({lastSongPlayed:n});case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function dt(){return(dt=Object(b.a)(j.a.mark((function e(){var t,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(xe>5)){e.next=5;break}return Ge.current.currentTime=0,ve(0),De(0),e.abrupt("return");case 5:return t=Q(z-1,E.length-1),e.next=8,m.collection("songs").doc(E[t].id).get();case 8:return e.next=10,e.sent.data().id;case 10:n=e.sent,Y(n,c),De(0),F(n),X(Q(t,E.length-1)),m.collection("users").doc(c.uid).update({lastSongPlayed:n});case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return G(c,at,c.addedSongs&&c.addedSongs.length!==h.length,[c.addedSongs]),G(c,(function(){var e=[];c.ownPlaylists&&c.ownPlaylists.map((function(t,n){m.collection("playlists").doc(t).get().then((function(t){t.exists?(e.push(t.data()),n===c.ownPlaylists.length-1&&x(e)):console.log("No such document!")})).catch((function(e){console.log("Error getting document:",e)}))})),c.addedPlaylists&&c.addedPlaylists.map((function(t,n){m.collection("playlists").doc(t).get().then((function(t){t.exists?(e.push(t.data()),n===c.addedPlaylists.length-1&&x(e)):console.log("No such document!")})).catch((function(e){console.log("Error getting document:",e)}))}))}),c.ownPlaylists&&String(c.ownPlaylists.concat(c.addedPlaylists))!==String(g),[c.ownPlaylists]),G(c,(function(){K(c.friends.filter((function(e){return"added"===e.status})).map((function(e){return e.uid})),"users",L)}),c.friends&&String(c.friends.filter((function(e){return"added"===e.status})))!==String(P),[c.friends]),G(c,(function(){K(c.addedAuthors,"users",k)}),c.addedAuthors&&c.addedAuthors.length!==N.length,[c.addedAuthors]),G(c,(function(){return ot.apply(this,arguments)}),c&&(-1===oe.id||U||c.lastSongPlayed),[U,c.lastSongPlayed]),Object(s.useEffect)((function(){void 0===c.uid&&(ue({id:-1}),F(-1),R([]),k([]),f([]),L([]),x([]))}),[c.uid]),Object(s.useEffect)((function(){var e;He((void 0===(e=oe.lyrics)||0!==e.length)&&(void 0===e||"undefined"!==e[0].startTime))}),[oe.lyrics]),Object(s.useEffect)((function(){if(!a)if(Me){var e=q(E);R(e),X(e.findIndex((function(e){return e.id===U})))}else R(ee.songsList),X(ee.songsList.findIndex((function(e){return e.id===U})))}),[Me]),Object(s.useEffect)((function(){De(0)}),[oe.id]),Object(s.useEffect)((function(){2===Ze&&ut()}),[Ze]),Object(s.useEffect)((function(){document.title=oe.name||"Soundbubble"}),[oe.name]),Object(v.jsx)(Z.Provider,{value:{yourSongs:h,setYourSongs:f,yourPlaylists:g,yourFriends:P,currentSongQueue:E,currentSongPlaylistSource:ee,setCurrentSongPlaylistSource:te,setCurrentSongQueue:R,setCurrentSongInQueue:X,play:Oe,setPlay:pe,songSrc:oe.songSrc,currentTime:xe,setCurrentTime:ve,songDuration:we,songRef:Ge,name:oe.name,authors:oe.authors,lyrics:oe.lyrics,cover:oe.cover,imgColors:je,setImgColors:be,currentSong:U,setCurrentSong:F,repeatMode:Ie,setRepeatMode:Ae,shuffleMode:Me,setShuffleMode:Te,inputRef:Ke,leftSideBarInputRef:Xe,isThereKaraoke:We,rightSideCurrentPage:Ze,currentParagraph:Be,currentParagraphRef:Qe,nextSong:function(){return lt.apply(this,arguments)},prevSong:function(){return dt.apply(this,arguments)},playSong:function(){Oe?Ge.current.pause():Ge.current.play(),pe(!Oe)},playing:function(e){ve(e.target.currentTime),We&&2===Ze&&Ye&&nt&&function(){if(Be!==oe.lyrics.length-1&&parseFloat(oe.lyrics[Be+1].startTime)<=Ge.current.currentTime)De(Be+1)}(),ae(e.target.currentTime/we*100)},defineCurrentParagraph:ut,setRightSideCurrentPage:$e,changeCurrentTime:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if("div"===e.target.localName||"p"===e.target.localName){if(void 0!==t)return ve(t),Ge.current.currentTime=t,ae(t/we*100),We&&2===Ze&&Ye&&De(parseInt(e.target.id)),Ge.current.play(),void pe(!0)}else ve(e.target.value),Ge.current.currentTime=e.target.value,ae(e.target.value/we*100),We&&2===Ze&&Ye&&ut()},displayAuthors:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oe.authors,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" & ";return e.map((function(n,s){return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(i.b,{to:"/authors/".concat(n.uid),onClick:function(e){e.stopPropagation(),qe(!1)},children:n.displayName},n.uid),s===e.length-1?"":t]})}))},displayAuthorsFull:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oe.authors;return e.map((function(e,t){return Object(v.jsx)(v.Fragment,{children:Object(v.jsx)(i.b,{to:"/authors/".concat(e.uid),onClick:function(e){e.stopPropagation(),qe(!1),o(!1)},children:Object(v.jsx)(V,{data:e})},e.uid)})}))},openFullScreenPlayer:Ye,setOpenFullScreenPlayer:qe,loadSongData:function(e){ve(e.target.currentTime),Ne(e.target.duration),Ke.current.max=e.target.duration,window.innerWidth>1e3&&(Xe.current.max=e.target.duration),ae(0),Oe?e.target.play():e.target.pause()},fetchYourSongs:at,setOpenMenu:st,openMenu:nt,currentSongData:oe,setCurrentSongData:ue,setIsThereKaraoke:He,setYourPlaylists:x,yourAuthors:N,setYourAuthors:k,inputRange:ce},children:a?Object(v.jsx)(y,{}):t})},te=n(11),ne=n(7),se=function(){return Object(v.jsx)("div",{className:"NotificationCircle"})},ce=n(24),ae=n(50);function re(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;return e.substr(0,t)+(e.length>t?"...":"")}var ie=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" & ",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,s=null===e||void 0===e?void 0:e.map((function(e){return e.displayName})).join(t);return s?re(s,n):""};function oe(e){var t="";return e.forEach((function(e){t+=e.displayName})),t.length}function ue(e){return e%10===e?"0"+e:e}function le(e){return ue(Math.floor(e/60))+":"+ue(Math.floor(e%60))}var de=function(e){var t=e.play;return Object(v.jsxs)("div",{className:"ColorCircles",style:t?{}:{opacity:0,transform:"scale(.95)"},children:[Object(v.jsx)("span",{className:"colorCircle"}),Object(v.jsx)("span",{className:"colorCircle"}),Object(v.jsx)("span",{className:"colorCircle"})]})},je=function(e){var t=e.inputRef,n=e.textLimit,s=void 0===n?18:n,c=e.linkToAuthors,a=void 0===c||c,r=$(),i=r.currentSongData,o=r.currentTime,u=r.changeCurrentTime,l=r.songDuration,d=r.setRepeatMode,j=r.repeatMode,b=r.play,h=r.prevSong,f=r.playSong,O=r.nextSong,p=r.setShuffleMode,m=r.shuffleMode,g=r.displayAuthors,x=r.name,y=r.authors,S=r.cover,w=r.inputRange;return-1!==i.id?Object(v.jsxs)("div",{className:"player",children:[Object(v.jsxs)("div",{className:"playerUpperSide",children:[Object(v.jsx)("div",{className:"songCover",children:Object(v.jsx)("img",{loading:"lazy",src:S,alt:""})}),Object(v.jsxs)("div",{className:"nameAndAuthors",children:[Object(v.jsx)("h2",{title:x.length>s?x:null,style:{overflow:"hidden"},children:Object(v.jsx)("div",{style:x.length>s?{animation:"outSideText 17s infinite",whiteSpace:"nowrap"}:{},children:x})}),Object(v.jsx)("h3",{style:{overflow:"hidden"},title:y.map((function(e){return" "+e.displayName})),children:a?Object(v.jsx)("div",{style:oe(i.authors)>s?{animation:"outSideText 17s infinite",whiteSpace:"nowrap"}:{},children:g()}):Object(v.jsx)("div",{children:ie(y," & ",33)})})]})]}),Object(v.jsxs)("div",{className:"controlPanel",children:[Object(v.jsx)("input",{type:"range",min:"0",ref:t,step:"1",value:o,onChange:function(e){u(e)},style:{background:"linear-gradient(to right, var(--themeColor2) ".concat(w,"%, #fff ").concat(w,"%)")}}),Object(v.jsxs)("div",{className:"startAndEndTime",children:[Object(v.jsx)("span",{children:le(o)}),Object(v.jsx)("span",{children:le(l)})]}),Object(v.jsxs)("div",{className:"btns",children:[Object(v.jsx)("button",{className:"shuffleBtn",onClick:function(){return p(Q(m+1,1))},style:m?{background:"var(--reallyTransparentWhite)"}:{},children:Object(v.jsx)(ae.b,{style:m?{color:"var(--themeColor)"}:{}})}),Object(v.jsx)("button",{onClick:function(e){e.stopPropagation(),h()},children:Object(v.jsx)(ce.a,{})}),Object(v.jsx)("button",{onClick:function(e){e.stopPropagation(),f()},children:b?Object(v.jsx)(ce.e,{}):Object(v.jsx)(ce.f,{})}),Object(v.jsx)("button",{onClick:function(e){e.stopPropagation(),O()},children:Object(v.jsx)(ce.c,{})}),Object(v.jsxs)("button",{className:"repeatBtn",onClick:function(){return d(Q(j+1,2))},style:j?{background:"var(--reallyTransparentWhite)"}:{},children:[Object(v.jsx)(ae.a,{style:j?{color:"var(--themeColor)"}:{}}),Object(v.jsx)("span",{style:2===j?{opacity:1}:{}})]}),Object(v.jsx)(de,{play:b})]})]})]}):null},be=n(28),he=n(34),fe=function(e){var t=e.text,n=e.direction,s=void 0===n?"top":n,c=Object(L.a)(e,["text","direction"]);return A().isMobile?null:Object(v.jsx)("div",Object(u.a)(Object(u.a)({className:"Hint "+s},c),{},{children:Object(v.jsx)("h5",{children:t})}))},Oe=n(25),pe=function(e,t,n,s){e.stopPropagation();var c=t.authors.map((function(e){return e.uid})),a=[];c.forEach((function(e){n.addedAuthors.includes(e)||a.push(e)}));var r=n.addedSongs;r.push(t.id),m.collection("users").doc(n.uid).update({addedSongs:r,addedAuthors:[].concat(a,Object(T.a)(n.addedAuthors))}),a.forEach(function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(t).get();case 2:n=e.sent.data().subscribers,n++,m.collection("users").doc(t).update({subscribers:n});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())};function me(e,t){return e.filter((function(e){return this.indexOf(e)<0}),t)}var ge=function(e,t,n,s){e.stopPropagation();var c=t.authors.map((function(e){return e.uid})),a=[],r=n.addedSongs.filter((function(e){return e!==t.id}));c.forEach((function(e){s.forEach((function(t){r.includes(t.id)&&t.authors.find((function(t){return t.uid===e}))&&a.push(e)}))}));var i=me(c,a),o=me(n.addedAuthors,i);m.collection("users").doc(n.uid).update({addedSongs:r,addedAuthors:o}),i.forEach(function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(t).get();case 2:n=e.sent.data().subscribers,n--,m.collection("users").doc(t).update({subscribers:n});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())};function xe(e){var t=e.song,n=C().currentUser,s=$().yourSongs,c=J(),a=c.openConfirm,r=c.setOpenModal;return n.addedSongs.includes(t.id)?Object(v.jsxs)("span",{onClick:function(e){e.stopPropagation(),r(!1),a("You sure you want to delete this song from library?","Yes, delete it","No, just kidding",(function(e){return ge(e,t,n,s)}))},children:[Object(v.jsx)(ne.F,{}),"Delete"]}):Object(v.jsxs)("span",{onClick:function(e){return pe(e,t,n)},children:[Object(v.jsx)(ne.w,{}),"Add"]})}var ve=function(e,t){var n=Object(s.useState)([]),c=Object(l.a)(n,2),a=c[0],r=c[1],i=Object(s.useState)(!1),o=Object(l.a)(i,2),u=o[0],d=o[1],j=C().currentUser,b=$().currentSong,h=t||b;return Object(s.useEffect)((function(){var t=m.collection("playlists").doc(e).onSnapshot((function(e){e.exists&&r(e.data().songs)}));return function(){return t()}}),[m]),Object(s.useEffect)((function(){d(a.includes(h))}),[a,h]),[function(){if(a.length>0&&void 0!==e){if(a.includes(h)){var t=a.filter((function(e){return e!==h}));return void m.collection("playlists").doc(e).update({songs:t})}var n=a;n.unshift(h),m.collection("playlists").doc(e).update({songs:n});var s=[e].concat(Object(T.a)(j.ownPlaylists.filter((function(t){return t!==e}))));m.collection("users").doc(j.uid).update({ownPlaylists:s})}},u]},ye=function(e){var t=e.playlist,n=e.song,s=ve(t.id,n.id),c=Object(l.a)(s,2),a=c[0],r=c[1];return Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:a,children:[r?Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(fe,{text:"Remove ".concat(n.name," from playlist")}),Object(v.jsx)(ne.c,{})]}):Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(fe,{text:'Add "'.concat(n.name,'" to playlist')}),Object(v.jsx)(ne.w,{})]}),t.name]})},Se=function(e){var t=e.song,n=$(),c=n.yourPlaylists,a=n.currentSongData,r=C().currentUser,i=Object(s.useState)(t||a),o=Object(l.a)(i,2),u=o[0],d=o[1];return Object(s.useEffect)((function(){(null===t||void 0===t?void 0:t.id)&&d(t)}),[null===t||void 0===t?void 0:t.id]),Object(v.jsx)("div",{className:"AddToPlaylists",children:Object(v.jsx)("div",{style:{display:"flex",flexDirection:"column"},children:c.length?c.map((function(e,t){if(r.ownPlaylists.includes(e.id))return Object(v.jsx)(ye,{playlist:e,song:u})})):Object(v.jsx)("div",{className:"songItemMenuWindowItem",children:"No playlists created"})})})};function we(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}var Ne=function(){var e=Object(b.a)(j.a.mark((function e(t){var n,s,c,a,r,i=arguments;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=i.length>1&&void 0!==i[1]?i[1]:we(),s=i.length>2&&void 0!==i[2]?i[2]:"",c=i.length>3&&void 0!==i[3]?i[3]:"",a=i.length>4&&void 0!==i[4]?i[4]:[],r=i.length>5&&void 0!==i[5]?i[5]:[],m.collection("chats").doc(n).set({chatImage:c,chatName:s,id:n,messages:[],participants:t,wallpaper:"undefined",admins:t.length>2?a:[],typing:[],imageColors:r}),t.map(function(){var e=Object(b.a)(j.a.mark((function e(t){var s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(t).get();case 2:(s=e.sent.data().chats).push(n),m.collection("users").doc(t).update({chats:s});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ce=function(){var e=Object(b.a)(j.a.mark((function e(t,n,s,c){var a,r,i;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=!1,r=0,!n.chats){e.next=9;break}return e.next=5,m.collection("chats").where("participants","array-contains",n.uid).get();case 5:return e.sent.docs.forEach((function(e){var n=0;return t.every((function(t){return!!e.data().participants.includes(t)&&(n++,!0)})),n+1!==e.data().participants.length||n!==t.length||(a=!0,s(!1),c(e.data().id),r=e.data().id,!1)})),a||(i=we(),a=!0,s(!0),c(i),r=i),e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})));return function(t,n,s,c){return e.apply(this,arguments)}}(),ke=function(e,t,n,s){var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[],i=arguments.length>7?arguments[7]:void 0;if(0!==s.trim().length||0!==c.length||0!==a.length||0!==r.length){var o=(null===t||void 0===t?void 0:t.messages)||[];o.push({id:o.length,sender:n,message:s,sentTime:(new Date).toString(),inResponseToMessage:i||null,attachedSongs:c,attachedAlbums:a,attachedAuthors:r,seenBy:[n]}),m.collection("chats").doc(e).update({messages:o})}};function Ie(e){var t=e.shareList,n=e.currentUser,s=e.itemId,c=e.whatToShare,a=e.messageText,r=void 0===a?"":a,i=e.setShouldCreate,o=void 0===i?function(){return null}:i,u=e.setFriendChatId,l=void 0===u?function(){return null}:u,d=e.setLoading,h=void 0===d?function(){return null}:d,f=e.setCompleted,O=void 0===f?function(){return null}:f;h(!0),O(!1),t.map(function(){var e=Object(b.a)(j.a.mark((function e(t){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=[{uid:t,status:"added"}].concat(Object(T.a)(n.friends.filter((function(e){return e.uid!==t})))),m.collection("users").doc(n.uid).update({friends:a}),Promise.resolve(Ce([t],n,(function(){return null}),l)).then(function(){var e=Object(b.a)(j.a.mark((function e(a){var i;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("chats").doc(a).get();case 2:if(void 0===(i=e.sent.data())){e.next=17;break}e.t0=c,e.next="song"===e.t0?7:"playlist"===e.t0?9:"author"===e.t0?11:13;break;case 7:return ke(a,i,n.uid,r,[s]),e.abrupt("break",15);case 9:return ke(a,i,n.uid,r,[],[s]),e.abrupt("break",15);case 11:return ke(a,i,n.uid,r,[],[],[s]),e.abrupt("break",15);case 13:return ke(a,i,n.uid,r,[s]),e.abrupt("break",15);case 15:e.next=18;break;case 17:Ne([n.uid,t],a).then(Object(b.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("chats").doc(a).get();case 2:i=e.sent.data(),o(!1),e.t0=c,e.next="song"===e.t0?7:"playlist"===e.t0?9:"author"===e.t0?11:13;break;case 7:return ke(a,i,n.uid,r,[s]),e.abrupt("break",15);case 9:return ke(a,i,n.uid,r,[],[s]),e.abrupt("break",15);case 11:return ke(a,i,n.uid,r,[],[],[s]),e.abrupt("break",15);case 13:return ke(a,i,n.uid,r,[s]),e.abrupt("break",15);case 15:case"end":return e.stop()}}),e)}))));case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(){h(!1),O(!0)}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}var Ae,Pe,Le,Me,Te=function(e){var t=e.top,n=void 0===t?"20%":t;return Object(v.jsx)("div",{className:"LoadingCircle",style:{top:n},children:Object(v.jsx)("img",{loading:"lazy",src:"https://icon-library.com/images/spinner-icon-gif/spinner-icon-gif-28.jpg",alt:""})})},Ee=function(e,t,n,c,a,r,i,o,u){var d=Object(s.useState)(""),h=Object(l.a)(d,2),f=h[0],O=h[1],p=Object(s.useState)(!1),g=Object(l.a)(p,2),x=g[0],v=g[1],y=Object(s.useState)(!1),w=Object(l.a)(y,2),N=w[0],C=w[1],k=Object(s.useState)(e),I=Object(l.a)(k,2),A=I[0],P=I[1];function L(e){return M.apply(this,arguments)}function M(){return(M=Object(b.a)(j.a.mark((function s(i){var o,u,l,d,h=arguments;return j.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return o=h.length>1&&void 0!==h[1]?h[1]:[],u=h.length>2?h[2]:void 0,l=[],d=S(e),s.next=6,m.collection("search").where("variantsOfName","array-contains",d).get();case 6:s.sent.docs.forEach(function(){var e=Object(b.a)(j.a.mark((function e(s){var d,b,h,f,p,g,x,y,S;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((d=s.data()).place!==i){e.next=20;break}return e.next=4,m.collection(d.place).doc(d.uid).get();case 4:if(b=e.sent.data(),void 0!==o&&o.length?o.map((function(e){return e.id||e.uid})).includes(d.uid)&&l.push(b):b.isPrivate||l.push(b),void 0!==a||0!==r||0===l.length){e.next=19;break}u(l),e.t0=d.place,e.next="songs"===e.t0?11:"users"===e.t0?13:"playlists"===e.t0?15:17;break;case 11:for(h=0;h<l.length;h++)f=b.authors,K(f.map((function(e){return e.uid})),"users",n,(function(e){return e.sort((function(e,t){return t.subscribers-e.subscribers}))}),void 0,void 0,1);return e.abrupt("break",19);case 13:for(p=0;p<l.length;p++)g=b.ownSongs,x=b.ownPlaylists,K(g,"songs",t,(function(e){return e.sort((function(e,t){return t.listens-e.listens}))}),(function(){return null}),3,1),K(x,"playlists",c,(function(e){return e.sort((function(e,t){return t.listens-e.listens}))}),(function(){return null}),3,1);return e.abrupt("break",19);case 15:for(y=0;y<l.length;y++)S=b.authors,K(S.map((function(e){return e.uid})),"users",n,(function(e){return e.sort((function(e,t){return t.subscribers-e.subscribers}))}),void 0,void 0,1);return e.abrupt("break",19);case 17:return O("Wrong search mode"),e.abrupt("break",19);case 19:0!==l.length&&(v(!1),C(!0),u(l));case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),v(!1),0===l.length&&(u([]),C(!1));case 10:case"end":return s.stop()}}),s)})))).apply(this,arguments)}function T(){if(0!==e.length)if(P(e),v(!0),C(!1),void 0===a)0!==r&&1!==r||(L("songs",i,t),n([]),c([])),0!==r&&2!==r||(L("users",o,n),t([]),c([])),0!==r&&3!==r||(L("playlists",u,c),n([]),t([]));else switch(a){case"songs":L("songs",i,t);break;case"playlists":L("playlists",u,c);break;case"authors":L("users",o,n);break;default:L("songs",i,t)}}return Object(s.useEffect)((function(){0===e.length&&(void 0!==i&&t(i),void 0!==o&&n(o),void 0!==u&&c(u),v(!1))}),[e]),Object(s.useEffect)((function(){T()}),[r]),{findSomething:T,message:f,loading:x,foundAnything:N,inputValue:A,setInputValue:P}},Re=function(e,t){e&&m.collection("search").doc(t).get().then((function(e){var n=e.data().rank?e.data().rank+1:1;m.collection("search").doc(t).update({rank:n})}))},Be=function(e){var t=e.length,n=e.setInputValue,s=e.setValue;return Object(v.jsxs)("div",{className:"searchBarElement",children:[Object(v.jsx)(ne.x,{}),Object(v.jsx)("span",{onClick:function(){s(""),n("")},style:t?{}:{opacity:0,visibility:"hidden",cursor:"default"},children:Object(v.jsx)(ne.G,{})})]})},De=function(e){var t=e.text,n=e.searchMode,s=e.setSearchMode,c=e.index;return Object(v.jsx)("button",{onClick:function(){return s(c)},style:n===c?{background:"var(--lightBlue)"}:{},children:t})},Ue=function(e){var t=e.defaultSearchMode,n=e.searchMode,s=e.setSearchMode;return Object(v.jsx)("div",{className:"searchFilters",style:void 0!==t?{display:"none"}:{},children:["All","Songs","Authors","Playlists"].map((function(e,t){return Object(v.jsx)(De,{text:e,searchMode:n,setSearchMode:s,index:t})}))})},Fe=function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.length>0)){e.next=7;break}return e.next=3,m.collection("search").where("variantsOfName","array-contains",t).get();case 3:return n=e.sent.docs.map(function(){var e=Object(b.a)(j.a.mark((function e(t){var n,s,c,a,r,i,o,u,l;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.data(),s=n.place,c=n.uid,a=n.rank,e.next=3,m.collection(s).doc(c).get();case 3:return r=e.sent.data(),i=r.name,o=r.authors,u=r.displayName,l=r.isVerified,e.abrupt("return",{type:s,name:i||u,author:o?o[0].displayName:null,uid:c,rank:a||0,isVerified:null!==l&&void 0!==l&&l});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.abrupt("return",n);case 7:return e.abrupt("return",[]);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),We=function(e){var t={"\u0430":"f","\u0431":",","\u0432":"d","\u0433":"u","\u0434":"l","\u0435":"t","\u0451":"`","\u0436":";","\u0437":"p","\u0438":"b","\u0439":"q","\u043a":"r","\u043b":"k","\u043c":"v","\u043d":"y","\u043e":"j","\u043f":"g","\u0440":"h","\u0441":"c","\u0442":"n","\u0443":"e","\u0444":"a","\u0445":"[","\u0446":"w","\u0447":"x","\u0448":"i","\u0449":"o","\u044a":"]","\u044b":"s","\u044c":"m","\u044d":"'","\u044e":".","\u044f":"z"},n={f:"\u0430",",":"\u0431",d:"\u0432",u:"\u0433",l:"\u0434",t:"\u0435","`":"\u0451",";":"\u0436",p:"\u0437",b:"\u0438",q:"\u0439",r:"\u043a",k:"\u043b",v:"\u043c",y:"\u043d",j:"\u043e",g:"\u043f",h:"\u0440",c:"\u0441",n:"\u0442",e:"\u0443",a:"\u0444","[":"\u0445",w:"\u0446",x:"\u0447",i:"\u0448",o:"\u0449","]":"\u044a",s:"\u044b",m:"\u044c","'":"\u044d",".":"\u044e",z:"\u044f"};return t[e[0]]?e.split("").reduce((function(e,n){return e+t[n]}),""):e.split("").reduce((function(e,t){return e+n[t]}),"")},He=function(e){var t=e.setCurrentHint,n=e.searchValue,c=e.inputFocused,a=e.setSearchHints;Object(s.useEffect)((function(){t(-1),0!==n.length&&c?Promise.resolve(Fe(S(n))).then((function(e){Promise.all(e).then((function(e){var t=e.sort((function(e,t){return t.rank-e.rank}));t.length?a(t.slice(0,10)):Promise.resolve(Fe(S(We(n)))).then((function(e){Promise.all(e).then((function(e){var t=e.sort((function(e,t){return t.rank-e.rank}));a(t.slice(0,10))}))}))}))})):a([])}),[n,c])},ze=n(22),Ve=function(e){switch(e){case"songs":return Object(v.jsx)(ne.t,{style:{color:"var(--reallyLightBlue)"}});case"playlists":return Object(v.jsx)(te.a,{style:{color:"var(--lightPurple)"}});case"users":return Object(v.jsx)(ne.B,{style:{color:"var(--pink)"}});case"search":return Object(v.jsx)(ne.x,{});default:return Object(v.jsx)(ne.t,{})}},Ye=function(e){var t=e.name,n=e.author,s=e.isVerified,c=e.type,a=e.index,r=e.currentHint,i=e.setCurrentHint;return Object(v.jsxs)("div",{className:"search-hint-item"+(r===a?" current":""),onClick:function(){i(a)},children:[Ve(c),Object(v.jsx)("span",{children:t}),n&&Object(v.jsx)("span",{className:"search-hint-item-author",children:n}),s?Object(v.jsx)(ze.b,{style:{width:"12px",height:"12px",opacity:.5,marginLeft:"10px"}}):null]})},qe=function(e){var t=e.searchValue,n=e.searchHints,c=e.setSearchHints,a=e.currentHint,r=e.setCurrentHint,i=e.inputFocused,o=e.defaultSearchMode;return He({setCurrentHint:r,searchValue:t,inputFocused:i,setSearchHints:c}),Object(v.jsxs)("div",{className:"search-hints",style:n.length?o?{transform:"translateY(0px)"}:{transform:"translateY(-35px)"}:{display:"none"},children:[Object(v.jsx)(Ye,{name:t,type:"search",index:-1,currentHint:a,setCurrentHint:r},-1),n.map((function(e,t){return Object(s.createElement)(Ye,Object(u.a)(Object(u.a)({},e),{},{currentHint:a,setCurrentHint:r,index:t,key:e.uid}))}))]})},Ge=function(e){var t,n,c=e.value,a=e.setValue,r=e.setAllFoundSongs,i=e.setResultPlaylists,o=e.setResultAuthorList,u=e.focus,d=void 0!==u&&u,j=e.defaultSearchMode,b=void 0===j?void 0:j,h=e.inputText,f=void 0===h?"Search for songs or for people":h,O=e.defaultSongsListValue,p=e.defaultAuthorsListValue,m=e.defaultPlaylistsListValue,g=e.background,x=Object(s.useState)(0),y=Object(l.a)(x,2),S=y[0],w=y[1],N=Object(s.useState)(-1),C=Object(l.a)(N,2),k=C[0],I=C[1],A=Object(s.useState)([]),P=Object(l.a)(A,2),L=P[0],M=P[1],T=Object(s.useState)(d),E=Object(l.a)(T,2),R=E[0],B=E[1],D=Object(s.useRef)(null),U=Ee(null!==(t=null===(n=L[k])||void 0===n?void 0:n.name)&&void 0!==t?t:c,r,o,i,b,S,O,p,m),F=U.findSomething,W=U.loading,H=U.foundAnything,z=U.inputValue,V=U.setInputValue;Object(s.useEffect)((function(){d&&D.current.focus()}),[]);return Object(v.jsxs)("div",{style:{marginTop:"10px",width:"100%"},className:"searchBarWrapper",children:[Object(v.jsxs)("div",{className:"searchBar",children:[Object(v.jsx)(Be,{setInputValue:V,length:c.length,setValue:a}),Object(v.jsx)("input",{type:"text",onFocus:function(){return B(!0)},onBlur:function(){return B(!1)},style:L.length?{borderRadius:"var(--standartBorderRadius) var(--standartBorderRadius) 0 0",background:!!g&&g}:{background:!!g&&g},placeholder:f,value:z,onChange:function(e){V(e.target.value),a(e.target.value)},onKeyDown:function(e){var t,n;(function(e){var t,n,s,a;if(R)switch(e.key){case"ArrowDown":I(Q(k+1,L.length-1,-1)),V(null!==(t=null===(n=L[Q(k+1,L.length-1,-1)])||void 0===n?void 0:n.name)&&void 0!==t?t:c);break;case"ArrowUp":I(Q(k-1,L.length-1,-1)),V(null!==(s=null===(a=L[Q(k-1,L.length-1,-1)])||void 0===a?void 0:a.name)&&void 0!==s?s:c)}}(e),"Enter"===e.key)&&(F(),Re(null===(t=L[k])||void 0===t?void 0:t.name,null===(n=L[k])||void 0===n?void 0:n.uid),M([]))},ref:D}),Object(v.jsx)(Ue,{defaultSearchMode:b,searchMode:S,setSearchMode:w}),Object(v.jsx)(qe,{searchValue:c,currentHint:k,searchHints:L,setSearchHints:M,setCurrentHint:I,inputFocused:R,defaultSearchMode:b})]}),Object(v.jsx)("div",{className:"authorsResult",children:W?Object(v.jsx)("div",{style:{position:"relative",width:"100%",height:"50px",marginTop:"40px"},children:Object(v.jsx)(Te,{})}):H||0===c.length?null:Object(v.jsx)("h2",{children:"Not found"})})]})},Qe=H.a.button(Ae||(Ae=Object(M.a)(["\n  border: none;\n  color: var(--lightBlue);\n  background: var(--lightGrey);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 5px 10px;\n  border-radius: var(--standartBorderRadius3);\n  font-weight: 600;\n\n  svg {\n    margin-right: ",";\n    width: 16px;\n    height: 16px;\n  }\n"])),(function(e){return 0===e.textLen?"0":"5px"})),Ke=function(e){var t=e.text,n=void 0===t?"":t,s=e.icon,c=e.onClick,a=e.visible;return(void 0===a||a)&&Object(v.jsxs)(Qe,{onClick:c,textLen:n.length,children:[s,Object(v.jsx)("span",{children:n})]})},Xe=H.a.div(Pe||(Pe=Object(M.a)(["\n  width: 100%;\n  position: relative;\n\n  button {\n    position: absolute;\n    right: 8px;\n    top: 50%;\n    transform: translateY(-50%);\n  }\n"]))),Je=H.a.input(Le||(Le=Object(M.a)(["\n  width: 100%;\n  box-sizing: border-box;\n  padding: 12px;\n  border-radius: var(--standartBorderRadius);\n  border: none;\n  background: var(--leftSideBarColor);\n  outline: none;\n  color: #fff;\n  font-weight: 600;\n"]))),_e=function(e){var t=e.title,n=e.type,s=void 0===n?"text":n,c=e.value,a=e.setValue,r=e.placeholder,i=void 0===r?"":r,o=e.required,u=void 0!==o&&o;return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)("h3",{children:t}),Object(v.jsxs)(Xe,{children:[Object(v.jsx)(Je,{value:c,onChange:function(e){return a(e.target.value)},placeholder:i,type:s,required:u}),Object(v.jsx)(Ke,{icon:Object(v.jsx)(ne.G,{}),onClick:function(){return a("")},visible:!!c.length})]})]})},Ze=H.a.button(Me||(Me=Object(M.a)(["\n  width: 100%;\n  padding: 10px;\n  box-sizing: border-box;\n  opacity: ",';\n  background: var(--purpleAndBlueGrad);\n  color: #fff;\n  font-weight: bold;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  height: 40px;\n  border-radius: var(--standartBorderRadius3);\n  position: relative;\n  overflow: hidden;\n\n  @keyframes button-animation-in {\n    0% {\n      opacity: 0;\n      transform: scale(0.95);\n    }\n    50% {\n      opacity: 1;\n      transform: scale(1);\n    }\n    100% {\n      opacity: 0;\n      transform: scale(0.95);\n    }\n  }\n\n  @keyframes button-animation-out {\n    0% {\n      opacity: 0;\n      transform: scale(0.95);\n    }\n    100% {\n      opacity: 1;\n      transform: scale(1);\n    }\n  }\n\n  .inner-button {\n    z-index: 1;\n\n    .inner-button-success {\n      animation: button-animation-in 2s forwards;\n    }\n\n    .inner-button-text {\n      animation: button-animation-out 0.5s forwards;\n    }\n  }\n\n  &::before {\n    content: "";\n    position: absolute;\n    display: block;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    background: var(--green);\n    width: ',";\n    height: ",";\n    border-radius: 100%;\n    transition: 0.6s;\n    z-index: 0;\n  }\n\n  .LoadingCircle {\n    position: relative;\n    transform: none;\n    left: auto;\n    top: auto;\n    width: 30px;\n    height: 30px;\n\n    img {\n      width: 30px;\n      height: 30px;\n    }\n  }\n"])),(function(e){return e.isLoading||!e.isActive?.5:1}),(function(e){return e.completed?"2000px":"0"}),(function(e){return e.completed?"2000px":"0"})),$e=function(e){var t=e.text,n=e.action,c=e.isLoading,a=e.completed,r=void 0!==a&&a,i=e.setCompleted,o=e.bottomMessage,u=e.isActive,l=void 0===u||u,d=J().openBottomMessage;return Object(s.useEffect)((function(){r&&(d(null!==o&&void 0!==o?o:void 0),setTimeout((function(){i(!1)}),2e3))}),[r]),Object(v.jsx)(Ze,{isLoading:c,className:"submit-button",completed:r,isActive:l,onClick:l?n:function(){return d("Nope","failure")},children:Object(v.jsx)("div",{className:"inner-button",children:r?Object(v.jsxs)("div",{className:"inner-button-success",children:[Object(v.jsx)(ze.b,{})," Done"]}):c?Object(v.jsx)(Te,{top:0}):Object(v.jsx)("div",{className:"inner-button-text",children:t})})})},et=function(e){var t=e.listOfPeople,n=e.title,s=e.chosenArray,c=e.setChosenArray,a=void 0===c?function(){return null}:c,r=e.lastSeen,i=void 0!==r&&r;return Object(v.jsxs)("div",{children:[n?Object(v.jsx)("h2",{style:{marginTop:"0",marginBottom:"7px"},children:n}):null,t.map((function(e){return Object(v.jsx)(V,{data:e,chosenArray:s,setChosenArray:a,lastSeen:i})}))]})},tt=function(e){var t=e.item,n=e.whatToShare,c=void 0===n?"song":n,a=$().yourFriends,r=Object(s.useState)([]),i=Object(l.a)(r,2),o=i[0],u=i[1],d=C().currentUser,j=Object(s.useState)(""),b=Object(l.a)(j,2),h=b[0],f=b[1],O=Object(s.useState)(!1),p=Object(l.a)(O,2),m=p[0],g=p[1],x=Object(s.useState)(!1),y=Object(l.a)(x,2),S=(y[0],y[1]),w=J(),N=w.toggleModal,k=(w.openBottomMessage,Object(s.useState)("")),I=Object(l.a)(k,2),A=I[0],P=I[1],L=Object(s.useState)([]),M=Object(l.a)(L,2),T=M[0],E=M[1];return a.length?Object(v.jsxs)("div",{className:"FriendsListToShareWith",children:[Object(v.jsxs)("div",{style:{maxHeight:"300px",overflowY:"hidden",display:"flex",flexDirection:"column"},children:[Object(v.jsx)(Ge,{value:A,setValue:P,setResultAuthorList:E,defaultAuthorsListValue:a,defaultSearchMode:"authors",inputText:"Search for friends"}),Object(v.jsx)("div",{style:{overflowY:"auto",maxHeight:"100%"},children:Object(v.jsx)(et,{listOfPeople:T,chosenArray:o,setChosenArray:u})})]}),Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(_e,{value:h,setValue:f,placeholder:"Your message"}),Object(v.jsx)($e,{text:"Share with ".concat(o.length," ").concat(o.length>1||0===o.length?"friends":"friend"),action:function(){Ie({shareList:o,currentUser:d,itemId:"author"===c?t.uid:t.id,whatToShare:c,messageText:h,setLoading:S,setCompleted:g}),N()},completed:m,setCompleted:g,bottomMessage:"Message was sent",isActive:!!o.length})]})]}):Object(v.jsx)("h3",{style:{margin:0},children:"No friends added"})},nt=n(33),st=function(e){var t=e.person,n=J().setOpenModal;return Object(v.jsx)(i.b,{to:"/authors/".concat(t.uid),children:Object(v.jsxs)("div",{className:"PersonTinyVerticalItem",onClick:function(){return n(!1)},children:[Object(v.jsx)("div",{className:"personTinyImage",children:Object(v.jsx)("img",{loading:"lazy",src:t.photoURL,alt:""})}),Object(v.jsx)("div",{className:"personTinyName",children:t.displayName})]})})},ct=function(e){var t=e.text,n=void 0===t?"See more":t,s=Object(L.a)(e,["text"]);return Object(v.jsxs)("div",Object(u.a)(Object(u.a)({className:"SeeMoreRoundButton"},s),{},{children:[Object(v.jsx)("button",{children:Object(v.jsx)(ne.b,{})}),Object(v.jsx)("span",{children:n})]}))},at=function(e){var t=e.song,n=$().currentSongData,c=J().setContent,a=Object(s.useState)(t||n),r=Object(l.a)(a,2),i=r[0],o=r[1],u=$(),d=u.displayAuthors,h=u.yourFriends,f=Object(s.useState)([]),O=Object(l.a)(f,2),p=O[0],m=O[1],g=Object(s.useState)(!0),x=Object(l.a)(g,2),y=x[0],S=x[1];function w(){return(w=Object(b.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:S(!0),m([]),h.forEach((function(e){e.addedSongs.includes(i.id)&&m((function(t){return[].concat(Object(T.a)(t),[e])}))})),S(!1);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){void 0!==t&&o(t)}),[t&&t.id]),Object(s.useEffect)((function(){!function(){w.apply(this,arguments)}()}),[i.id]),Object(v.jsxs)("div",{className:"SongInfo",children:[Object(v.jsx)("div",{className:"songImage",style:{backgroundImage:"url(".concat(i.cover,")")}}),Object(v.jsxs)("div",{className:"songInfoContent",children:[Object(v.jsx)("h3",{style:{color:i.imageColors[0]},children:i.name}),Object(v.jsx)("span",{children:d(i.authors,", ")}),Object(v.jsxs)("div",{style:{display:"flex",alignItems:"center",opacity:"0.6",fontSize:".9em",position:"relative",marginTop:"5px"},className:"listensAndDate",children:[Object(v.jsxs)("p",{className:"infoListens",style:{marginRight:"15px",marginBottom:"0",position:"relative"},children:[i.listens," ",Object(v.jsx)(nt.c,{})]}),Object(v.jsx)("span",{children:U(i.releaseDate)})]}),Object(v.jsx)("h4",{style:{margin:"10px 0"},children:p.length>0?"Friends that listen that song":"None of your friends listens this"}),y?Object(v.jsx)("div",{style:{position:"relative",height:"50px"},children:Object(v.jsx)(Te,{top:"50%"})}):Object(v.jsxs)("div",{style:{display:"flex"},children:[p.length>0?p.map((function(e,t){if(t<2)return Object(v.jsx)(st,{person:e},e.uid)})):Object(v.jsx)("button",{className:"shareBtn",style:{minHeight:"35px",background:i.imageColors[0]},onClick:function(){c(Object(v.jsx)(tt,{item:i,whatToShare:"song"}))},children:"Share"}),p.length>2?Object(v.jsx)(ct,{onClick:function(){return c(Object(v.jsx)(et,{listOfPeople:p,title:"Friends listen ".concat(t.name)}))}}):null]})]})]})},rt=function(e){var t=e.listOfAuthors,n=$().displayAuthorsFull;return Object(v.jsx)("div",{className:"rightSideAuthorsList",children:Object(v.jsx)("div",{className:"rightSideAuthorsListCentralBlock",children:n(t)})})},it=function(e){var t=e.errorMessage,n=J().openBottomMessage;return Object(s.useEffect)((function(){t&&n(t,"failure")}),[t]),t&&Object(v.jsx)("div",{className:"Alert",children:t})};function ot(e){for(var t=[],n=0,s=e+" ",c=0;c<s.length;c++)"\n"!==s[c]&&void 0!==s[c+1]||(t.push({startTime:"undefined",text:s.substr(n,c-n)}),n=c+1);return t}var ut=function(e){var t=e.song,n=C().currentUser,c=J().toggleModal,a=Object(s.useState)(t.name),r=Object(l.a)(a,2),i=r[0],o=r[1],u=Object(s.useState)(t.authors),d=Object(l.a)(u,2),h=d[0],f=d[1],O=Object(s.useState)(t.cover),p=Object(l.a)(O,2),g=p[0],x=p[1],y=Object(s.useState)(t.imageColors),S=Object(l.a)(y,2),w=S[0],N=S[1],k=Object(s.useState)(t.lyrics.map((function(e){return e.text})).join("\n")),I=Object(l.a)(k,2),A=I[0],P=I[1],L=Object(s.useState)([]),M=Object(l.a)(L,2),E=M[0],R=M[1],B=Object(s.useState)(""),D=Object(l.a)(B,2),U=D[0],F=D[1],W=Object(s.useState)(""),H=Object(l.a)(W,2),z=H[0],Y=H[1],q=Object(s.useState)(!1),G=Object(l.a)(q,2),Q=G[0],K=G[1],X=Object(s.useState)(!1),_=Object(l.a)(X,2),Z=_[0],$=_[1];function ee(e){var t=h.filter((function(t){return t.uid!==e.uid}));return f(t)}return Object(s.useEffect)((function(){o(t.name),f(t.authors),x(t.cover),N(t.imageColors),P(t.lyrics.map((function(e){return e.text})).join("\n"))}),[t.id]),Object(v.jsxs)("div",{children:[Object(v.jsxs)("div",{className:"SongInfo",style:{flexDirection:"column",marginBottom:"10px"},children:[Object(v.jsx)("h3",{children:"Song cover"}),Object(v.jsxs)("div",{style:{display:"flex"},children:[Object(v.jsx)("div",{children:Object(v.jsx)("img",{loading:"lazy",src:g,alt:"",className:"songImage"})}),Object(v.jsx)("div",{style:{background:"linear-gradient(-135deg, ".concat(w[0],", ").concat(w[5]),width:"100%",borderRadius:"var(--standartBorderRadius2)",display:"flex",justifyContent:"center",alignItems:"center"},children:Object(v.jsx)("h4",{style:{color:w[1]},children:i})})]})]}),Object(v.jsx)("div",{style:{width:"100%",display:"flex"},children:w.map((function(e,t){return Object(v.jsx)("input",{type:"color",value:e,style:{width:"100%",height:"60px",padding:"0",borderRadius:"0px"},onChange:function(e){!function(e,t){w[t]=e.target.value,N(Object(T.a)(w))}(e,t)}})}))}),Object(v.jsxs)("div",{children:[Object(v.jsx)("h3",{children:"Song name"}),Object(v.jsx)("input",{type:"text",className:"standartInput",value:i,onChange:function(e){return o(e.target.value)}})]}),Object(v.jsxs)("div",{children:[Object(v.jsx)("h3",{children:"Authors"}),Object(v.jsx)(Ge,{value:U,setValue:F,setResultAuthorList:R,defaultSearchMode:"authors"}),Object(v.jsx)("div",{className:"songAuthorsList",children:h.map((function(e){return Object(v.jsxs)("div",{className:"chosenAuthorItem",children:[Object(v.jsx)("span",{children:e.displayName}),Object(v.jsx)(ne.G,{onClick:function(){(n.isAdmin||e.uid!==n.uid)&&ee(e)}})]})}))}),Object(v.jsx)("div",{className:"authorsResult",children:E.map((function(e,t){return Object(v.jsx)(V,{data:e,onClick:function(){return function(e){if(!h.some((function(t){return t.uid===e.uid})))return f((function(t){return[].concat(Object(T.a)(t),[{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL}])}));ee(e)}(e)},style:h.includes(e.uid)?{background:"var(--green)"}:{}},t)}))})]}),Object(v.jsxs)("div",{children:[Object(v.jsx)("h3",{children:"Lyrics"}),Object(v.jsx)("textarea",{type:"text",className:"standartInput",style:{height:"200px",fontWeight:"500"},value:A,onChange:function(e){return P(e.target.value)}})]}),Object(v.jsx)(it,{errorMessage:z}),Object(v.jsx)($e,{text:"Update song",action:function(){if(0===i.length)Y("Name shouldn't be empty");else if(0===h.length)Y("Song has to have at least 1 author");else if(0===g.length)Y("Song has to have cover");else{if(K(!0),h.length>t.authors.length)h.filter((function(e){return!t.authors.find((function(t){return t.uid===e.uid}))})).forEach(function(){var e=Object(b.a)(j.a.mark((function e(n){var s,c,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(n.uid).get();case 2:s=e.sent,c=s.data(),(a=c.ownSongs).push(t.id),m.collection("users").doc(n.uid).update({ownSongs:a});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());else if(h.length<t.authors.length){t.authors.filter((function(e){return!h.find((function(t){return t.uid===e.uid}))})).forEach(function(){var e=Object(b.a)(j.a.mark((function e(n){var s,c,a,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(n.uid).get();case 2:s=e.sent,c=s.data(),a=c.ownSongs,r=a.filter((function(e){return e!==t.id})),m.collection("users").doc(n.uid).update({ownSongs:r});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}m.collection("songs").doc(t.id).update({name:i,authors:h,image:g,imageColors:w,lyrics:ot(A)}).then((function(){K(!1),$(!0),c()}))}},isLoading:Q,completed:Z,setCompleted:$,bottomMessage:"Song was updated"})]})},lt=function(e){var t=e.song,n=J().setContent,s=C().currentUser;return Object(v.jsxs)("div",{className:"SongItemMobileMoreWindow",children:[Object(v.jsxs)("div",{className:"simpleSongElement",style:{background:t.imageColors[0]},children:[Object(v.jsx)("div",{className:"simpleSongElementImage",children:Object(v.jsx)("img",{loading:"lazy",src:t.cover,alt:""})}),Object(v.jsx)("span",{children:t.name})]}),s.isAdmin?Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){n(Object(v.jsx)(ut,{song:t}))},children:[Object(v.jsx)(te.h,{}),"Edit"]}):null,Object(v.jsx)("div",{className:"songItemMenuWindowItem",children:Object(v.jsx)(xe,{song:t})}),Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){return n(Object(v.jsx)(Se,{song:t}))},children:[Object(v.jsx)(Oe.c,{}),"Add to playlist"]}),Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){n(Object(v.jsx)(tt,{item:t,whatToShare:"song"}))},children:[Object(v.jsx)(ne.z,{}),"Share"]}),Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){n(Object(v.jsx)(at,{song:t}))},children:[Object(v.jsx)(ne.n,{}),"Info"]}),Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){n(Object(v.jsx)(rt,{listOfAuthors:t.authors,title:"Authors"}))},children:[Object(v.jsx)(ne.E,{}),"Authors"]})]})},dt=function(e){var t=e.openMoreWindow,n=e.song,s=e.moreWindowPosRelativeToViewport,c=J(),a=c.toggleModal,r=c.setContent,i=c.openBottomMessage,o=C().currentUser,u=$().setCurrentSongQueue;return t?Object(v.jsxs)("div",{className:"songItemMenuWindow",style:s>window.innerHeight/2+100?{top:"auto",bottom:"110%"}:{top:"110%",bottom:"auto"},onClick:function(e){return e.stopPropagation()},children:[o.isAdmin||n.authors.find((function(e){return e.uid===o.uid}))?Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){a(),r(Object(v.jsx)(ut,{song:n}))},children:[Object(v.jsx)(te.h,{}),"Edit"]}):null,Object(v.jsx)("div",{className:"songItemMenuWindowItem",children:Object(v.jsx)(xe,{song:n})}),Object(v.jsxs)("div",{className:"songItemMenuWindowItem",children:[Object(v.jsx)("div",{className:"songItemMenuWindow inner",children:Object(v.jsx)(Se,{song:n})}),Object(v.jsx)(Oe.c,{}),"Add to playlist ",Object(v.jsx)(Oe.a,{})]}),Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){a(),r(Object(v.jsx)(tt,{item:n,whatToShare:"song"}))},children:[Object(v.jsx)(ne.z,{}),"Share"]}),Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){a(),r(Object(v.jsx)(at,{song:n}))},children:[Object(v.jsx)(ne.n,{}),"Info"]}),Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){u((function(e){return[].concat(Object(T.a)(e),[n])})),i("Song was added to queue")},children:[Object(v.jsx)(te.k,{}),"Add to queue"]})]}):null},jt=function(e,t){Object(s.useEffect)((function(){function n(n){e.current&&!e.current.contains(n.target)&&t(!1)}return document.addEventListener("mousedown",n),function(){document.removeEventListener("mousedown",n)}}),[e])},bt=function(e,t,n){var s={id:t,type:n};m.collection("searchHistory").doc(e).get().then((function(n){n.data().history?n.data().history.find((function(e){return e.id===t}))||m.collection("searchHistory").doc(e).update({history:[s].concat(Object(T.a)(n.data().history.slice(0,15)))}):m.collection("searchHistory").doc(e).set({history:[s]})}))},ht=function(e){var t=C(),n=t.currentUser,s=(t.setCurrentUser,$().yourSongs),c=J(),a=c.openBottomMessage,r=c.openConfirm,i=c.closeConfirm;return[function(t){pe(t,e,n),a("".concat(re(e.name,15)," added to your library"))},function(t){t.stopPropagation(),r('You sure you want to delete "'.concat(e.name,'" from library?'),"Yes, delete it","No, just kidding",(function(t){ge(t,e,n,s),i(),a("".concat(re(e.name,15)," removed from your library"),"failure")}))}]},ft=function(e){var t=e.song,n=C().currentUser,s=ht(t),c=Object(l.a)(s,2),a=c[0],r=c[1];return n.addedSongs.includes(t.id)?Object(v.jsxs)("button",{onClick:r,style:{position:"relative"},children:[Object(v.jsx)(fe,{text:"delete song"}),Object(v.jsx)(ne.F,{})]}):Object(v.jsxs)("button",{onClick:a,style:{position:"relative"},children:[Object(v.jsx)(fe,{text:"add song"}),Object(v.jsx)(ne.w,{})]})};function Ot(e){return e<1e3?e:e<1e6?parseFloat(e/1e3).toFixed(1)+"K":e<1e9?parseFloat(e/1e6).toFixed(1)+"M":void 0}var pt,mt=function(e){var t=e.showListens,n=e.isNewSong,s=e.song;return t?Object(v.jsxs)("span",{style:{display:"flex",alignItems:"center",opacity:.7,fontSize:".8em"},className:n?"newSongMarker":"",children:[Ot(s.listens)," ",Object(v.jsx)(nt.c,{})]}):n?Object(v.jsx)("span",{style:{display:"flex",alignItems:"center",fontSize:".7em"},className:"newSongMarker",children:"New"}):null},gt=function(e){var t=e.song,n=e.localIndex,c=e.showListens,a=void 0!==c&&c,r=e.isNewSong,i=void 0!==r&&r,o=e.listOfChosenSongs,u=e.setListOfSongs,d=e.position,j=e.shouldSaveSearchHistory,b=void 0!==j&&j,h=$(),f=h.setCurrentSong,O=h.currentSong,p=h.displayAuthors,g=h.play,x=h.songRef,y=h.setPlay,S=h.setCurrentSongInQueue,w=A().isMobile,N=Object(s.useState)(!1),k=Object(l.a)(N,2),I=k[0],P=k[1],L=Object(s.useState)(0),M=Object(l.a)(L,2),T=M[0],E=M[1],B=Object(s.useRef)(null),D=C().currentUser,U=J(),F=U.toggleModal,W=U.setContent;return jt(B,P),Object(v.jsxs)("div",{style:{display:"flex",alignItems:"center",width:"100%"},children:[Object(v.jsx)(R,{listOfChosenItems:o,setListOfChosenItems:u,itemId:t.id}),Object(v.jsxs)("div",{className:"SongItem "+(t.id===O&&g?"playingNow":""),onClick:function(){if(f(t.id),m.collection("users").doc(D.uid).update({lastSongPlayed:t.id}),S(n),t.id===O&&g)return x.current.pause(),void y(!1);x.current.play(),y(!0),b&&bt(D.uid,t.id,"songs"),Y(t.id,D)},ref:I?B:null,style:I?{background:"var(--playlistsColor)"}:{},children:[Object(v.jsxs)("div",{className:"songItemImageAndName",children:[Object(v.jsxs)("div",{className:"songItemImage",children:[Object(v.jsx)("div",{className:"songItemPlayOrPause",children:t.id===O&&g?null:Object(v.jsx)(he.c,{})}),Object(v.jsxs)("div",{className:"playingAnimation",style:t.id===O&&g?{opacity:1,visibility:"visible"}:{},children:[Object(v.jsx)(he.b,{}),Object(v.jsx)(de,{play:g})]}),Object(v.jsx)("img",{loading:"lazy",src:t.cover,alt:""})]}),Object(v.jsxs)("div",{className:"songItemNameAndAuthor",children:[Object(v.jsxs)("div",{className:"songItemName",style:{display:"flex",alignItems:"center"},children:[re(t.name,w?17:30),Object(v.jsx)("span",{style:{marginLeft:"10px",fontWeight:"500"},children:Object(v.jsx)(mt,{showListens:a,isNewSong:i,song:t})})]}),w?Object(v.jsx)("div",{className:"songItemAuthor",children:ie(t.authors," & ",30)}):Object(v.jsx)("div",{className:"songItemAuthor",children:p(t.authors)})]})]}),Object(v.jsxs)("div",{className:"songItemMoreBtn",children:[Object(v.jsx)(ft,{song:t}),Object(v.jsxs)("button",{onClick:w?function(e){e.stopPropagation(),F(),W(Object(v.jsx)(lt,{song:t}))}:function(e){e.stopPropagation(),P(!I),E(d||e.target.getBoundingClientRect().top)},children:[Object(v.jsx)(fe,{text:"more"}),Object(v.jsx)(ne.s,{})]})]}),Object(v.jsx)(dt,{openMoreWindow:I,song:t,moreWindowPosRelativeToViewport:T})]})]})},xt=n(66),vt=H.a.button(pt||(pt=Object(M.a)(['\n  width: 100%;\n  padding: 0;\n  box-sizing: border-box;\n  background: linear-gradient(45deg, #852de5, #5c38c1);\n  color: #fff;\n  font-weight: bold;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  height: 40px;\n  border-radius: var(--standartBorderRadius3);\n  position: relative;\n  overflow: hidden;\n  z-index: 2;\n  margin: 8px 0;\n\n  @keyframes button-animation-out {\n    0% {\n      opacity: 0;\n      transform: scale(0.9);\n    }\n    100% {\n      opacity: 1;\n      transform: scale(1);\n    }\n  }\n\n  .inner-button {\n    z-index: 1;\n    position: relative;\n    width: 100%;\n    height: 100%;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n\n    .inner-button-content {\n      width: 100%;\n      height: 100%;\n    }\n\n    .inner-button-success {\n      animation: button-animation-out 2s forwards;\n    }\n\n    .inner-button-text {\n      cursor: pointer;\n      width: 100%;\n      height: 100%;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n\n      svg {\n        margin-right: 7px;\n        width: 20px;\n        height: 20px;\n      }\n    }\n\n    .inner-button-download {\n      width: 100%;\n      background: red;\n\n      input[type="file"] {\n        /* display: none; */\n        width: 100%;\n        height: 100%;\n        position: absolute;\n        left: 50%;\n        top: 50%;\n        transform: translate(-50%, -50%);\n        display: none;\n      }\n    }\n  }\n\n  &::before {\n    content: "";\n    position: absolute;\n    display: block;\n    top: 50%;\n    left: 0%;\n    transform: translateY(-50%);\n    background: var(--green);\n    width: ',";\n    height: 100%;\n    transition: 0.6s;\n    z-index: 0;\n  }\n\n  .LoadingCircle {\n    position: relative;\n    transform: none;\n    left: auto;\n    top: auto;\n    width: 30px;\n    height: 30px;\n\n    img {\n      width: 30px;\n      height: 30px;\n    }\n  }\n"])),(function(e){return e.completed?"100%":"0"})),yt=function(e){var t=e.title,n=void 0===t?"":t,c=e.text,a=e.place,r=e.setItemSrc,i=e.setImageLocalPath,o=J().openBottomMessage,u=Object(s.useState)(""),d=Object(l.a)(u,2),h=d[0],f=d[1],O=Object(s.useState)(!1),m=Object(l.a)(O,2),g=m[0],x=m[1],y=Object(s.useState)(!1),S=Object(l.a)(y,2),w=S[0],N=S[1];function C(){return(C=Object(b.a)(j.a.mark((function e(t,n,s){var c,a,r,o,u,l,d;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),f(""),x(!0),N(!1),c="songsImages/"===n||"usersImages/"===n||"chatCovers/"===n,a=t.target.files[0],r=!1,c?(o=[".jpg",".png",".jpeg"]).find((function(e){return a.name.substr(a.name.length-e.length,e.length)===e}))?r=!0:(f("Format of your file is not valid. Download file with one of these: ".concat(o.map((function(e){return" "+e})))),x(!1)):"songs/"===n&&((u=[".mp3",".mp4a",".flac",".wav",".wma"]).find((function(e){return a.name.substr(a.name.length-e.length,e.length)===e}))?r=!0:(f("Format of your file is not valid. Download file with one of these: ".concat(u.map((function(e){return e})))),x(!1))),!r){e.next=21;break}return c&&i(URL.createObjectURL(a)),l=p.ref(),d=l.child(n+a.name),e.next=14,d.put(a);case 14:return N(!0),x(!1),e.t0=s,e.next=19,d.getDownloadURL();case 19:e.t1=e.sent,(0,e.t0)(e.t1);case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){h.length&&o(h,"failure")}),[h]),Object(v.jsxs)(v.Fragment,{children:[!!n&&Object(v.jsx)("h3",{children:n}),Object(v.jsx)(vt,{completed:w,children:Object(v.jsx)("div",{className:"inner-button",children:w?Object(v.jsxs)("div",{className:"inner-button-success",children:[Object(v.jsx)(ze.b,{})," Done"]}):g?Object(v.jsx)(Te,{top:0}):Object(v.jsx)("div",{className:"inner-button-content",children:Object(v.jsxs)("label",{className:"inner-button-download",children:[Object(v.jsxs)("div",{className:"inner-button-text",children:[Object(v.jsx)(xt.b,{}),c]}),Object(v.jsx)("input",{type:"file",name:"",id:"",onChange:function(e){return function(e,t,n){return C.apply(this,arguments)}(e,a,r)}})]})})})})]})},St=function(e){var t=e.loading;return Object(v.jsx)("div",{className:"FullScreenLoading",style:t?{}:{opacity:"0",visibility:"hidden"},children:Object(v.jsx)("img",{loading:"lazy",src:"https://icon-library.com/images/spinner-icon-gif/spinner-icon-gif-28.jpg",alt:""})})},wt=function(e){var t=e.currentActive,n=e.id,s=e.label,c=e.onClick;return Object(v.jsxs)("div",{className:"RadioBtn",id:n,onClick:c,children:[Object(v.jsx)("span",{className:"radioLabel",style:t===n?{color:"var(--blue)",opacity:1,fontWeight:"bold"}:{},children:s}),Object(v.jsx)("span",{className:"radioCircle",style:t===n?{background:"var(--blue)"}:{}})]})},Nt=function(){var e=C().currentUser,t=Object(s.useState)(""),n=Object(l.a)(t,2),c=n[0],a=n[1],r=Object(s.useState)(""),i=Object(l.a)(r,2),o=i[0],u=i[1],d=Object(s.useState)(""),h=Object(l.a)(d,2),f=h[0],O=h[1],p=Object(s.useState)([]),g=Object(l.a)(p,2),x=g[0],y=g[1],S=Object(s.useState)(e.isAdmin?[]:[{uid:e.uid,photoURL:e.photoURL,displayName:e.displayName}]),N=Object(l.a)(S,2),k=N[0],I=N[1],A=Object(s.useState)(e.isAdmin?"":(new Date).toString()),P=Object(l.a)(A,2),L=P[0],M=P[1],E=Object(s.useState)(""),R=Object(l.a)(E,2),B=R[0],D=R[1],U=Object(s.useState)([]),F=Object(l.a)(U,2),W=F[0],H=F[1],z=Object(s.useState)([]),Y=Object(l.a)(z,2),q=Y[0],G=Y[1],Q=Object(s.useState)(0),K=Object(l.a)(Q,2),X=K[0],J=K[1],_=Object(s.useState)(0),Z=Object(l.a)(_,2),$=Z[0],ee=Z[1],te=Object(s.useState)(""),se=Object(l.a)(te,2),ce=se[0],ae=se[1],re=Object(s.useState)([]),ie=Object(l.a)(re,2),oe=ie[0],ue=ie[1],le=Object(s.useState)(""),de=Object(l.a)(le,2),je=(de[0],de[1]),he=Object(s.useState)(!1),fe=Object(l.a)(he,2),Oe=fe[0],pe=fe[1],me=Object(s.useState)(!1),ge=Object(l.a)(me,2),xe=ge[0],ve=ge[1];function ye(e){var t=k.filter((function(t){return t.uid!==e.uid}));return I(t)}function Se(){return(Se=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),n=we(),0===c.length?je("Playlist has to have some name"):0===k.length?je("Playlist has to have at least 1 author"):0===L.length?je("You have to set release date for a playlist"):(pe(!0),m.collection("playlists").doc(n).set({id:n,name:c,songs:q,authors:k,image:o,listens:0,creationDate:L,subscribers:0,isAlbum:1===X,imageColors:oe,isPrivate:!0===$}).then((function(){y([]),O(""),I([]),u(""),a(""),M(""),D(""),G([]),ee(0),pe(!1),ve(!0)})).catch((function(e){je(e),pe(!1)})),k.forEach(function(){var e=Object(b.a)(j.a.mark((function e(t){var s,c,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(t.uid).get();case 2:s=e.sent,c=s.data(),(a=c.ownPlaylists).push(n),m.collection("users").doc(t.uid).update({ownPlaylists:a});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),m.collection("search").doc(n).set({place:"playlists",uid:n,rank:0,variantsOfName:w(c)}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(v.jsxs)("div",{className:"AddSong",children:[Object(v.jsx)(St,{loading:Oe}),Object(v.jsx)(be.a,{src:ce,getColors:function(e){return ue(e)}}),Object(v.jsxs)("div",{children:[Object(v.jsx)(_e,{title:"Playlist name",value:c,setValue:a,placeholder:"Enter playlist name"}),Object(v.jsxs)("label",{children:[Object(v.jsx)("h3",{children:"Playlist authors"}),Object(v.jsx)(Ge,{value:f,setValue:O,setResultAuthorList:y,defaultSearchMode:"authors",inputText:"Search for authors"}),Object(v.jsx)("div",{className:"chosenAuthorsList",children:k.map((function(t){return Object(v.jsxs)("div",{className:"chosenAuthorItem",children:[Object(v.jsx)("span",{children:t.displayName}),Object(v.jsx)(ne.G,{onClick:function(){return t.uid===e.uid?null:ye(t)}})]})}))}),Object(v.jsx)("div",{className:"authorsResult",children:x.map((function(e,t){return Object(v.jsx)(V,{data:e,onClick:function(){return function(e){if(!k.some((function(t){return t.uid===e.uid})))return I((function(t){return[].concat(Object(T.a)(t),[{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL}])}));ye(e)}(e)},style:k.includes(e.uid)?{background:"var(--green)"}:{}},t)}))})]}),Object(v.jsxs)("label",{children:[Object(v.jsx)("h3",{children:"Search for songs"}),Object(v.jsx)(Ge,{value:B,setValue:D,setAllFoundSongs:H,defaultSearchMode:"songs",inputText:"Search for songs"}),Object(v.jsx)("div",{className:"chosenAuthorsList",children:q.map((function(e){return Object(v.jsxs)("div",{className:"chosenAuthorItem",children:[Object(v.jsx)("span",{children:e}),Object(v.jsx)(ne.G,{onClick:function(){return function(e){var t=q.filter((function(t){return t!==e}));return G(t)}(e)}})]})}))}),Object(v.jsx)("div",{className:"authorsResult",children:W.map((function(e,t){return Object(v.jsx)(gt,{song:e,localIndex:t,listOfChosenSongs:q,setListOfSongs:G})}))})]}),e.isAdmin||e.isAuthor?Object(v.jsxs)("div",{style:{display:"flex",justifyContent:"flex-start",margin:"15px 0"},children:[Object(v.jsx)(wt,{label:"Playlist",onClick:function(){return J(0)},currentActive:X,id:0}),Object(v.jsx)(wt,{label:"Album",onClick:function(){return J(1)},currentActive:X,id:1})]}):null,Object(v.jsxs)("div",{style:{display:"flex",justifyContent:"flex-start",margin:"15px 0"},children:[Object(v.jsx)(wt,{label:"Not Private",onClick:function(){return ee(0)},currentActive:$,id:0}),Object(v.jsx)(wt,{label:"Private",onClick:function(){return ee(1)},currentActive:$,id:1})]}),(e.isAdmin||e.isAuthor)&&Object(v.jsx)(_e,{title:"Release Date",type:"date",value:L,setValue:M,placeholder:"Enter release date"}),Object(v.jsx)(yt,{text:"Download playlist cover",place:"songsImages/",setItemSrc:u,setImageLocalPath:ae}),Object(v.jsx)($e,{text:"Add playlists",action:function(e){return Se.apply(this,arguments)},isLoading:Oe,completed:xe,setCompleted:ve,bottomMessage:"Playlist was uploaded to database"})]})]})},Ct=function(){return Object(v.jsx)("div",{className:"CreatePlaylistPage",children:Object(v.jsx)(Nt,{})})},kt="/login",It="/signup",At="/home",Pt="/library",Lt="/search",Mt="/chat",Tt="/history",Et=[{id:0,icon:Object(v.jsx)(ne.l,{}),title:"Home",link:At},{id:1,icon:Object(v.jsx)(te.m,{}),title:"Library",link:Pt},{id:2,icon:Object(v.jsx)(te.n,{}),title:"Search",link:Lt},{id:3,icon:Object(v.jsx)(ne.p,{}),title:"Chat",link:Mt}];n(266);function Rt(e){var t=e.id,n=e.title,s=e.icon,c=e.link,a=e.currentPage,r=e.setCurrentPage;return Object(v.jsx)(i.b,{to:c,children:Object(v.jsxs)("div",{className:"NavigationItem "+(t===a?"active":""),onClick:function(){return r(t)},children:[Object(v.jsx)("div",{className:"icon",children:s}),Object(v.jsx)("b",{children:n})]})})}var Bt=function(e){var t=e.userUID,n=Object(s.useState)(!1),c=Object(l.a)(n,2),a=c[0],r=c[1];return Object(s.useEffect)((function(){var e=m.collection("users").doc(t).onSnapshot((function(e){if(void 0!==t){var n=(new Date).getTime()-3e5,s=e.data().online>n;r(s)}}));return function(){e()}}),[m,t]),a?Object(v.jsx)("div",{className:"onlineCircle"}):null},Dt=function(e){var t=e.index,n=e.friend,c=C().currentUser,a=J().openBottomMessage,r=Object(s.useState)(0),o=Object(l.a)(r,2),u=o[0],d=o[1],j=Object(s.useState)(!1),b=Object(l.a)(j,2),h=b[0],f=b[1],O=Object(s.useState)(""),p=Object(l.a)(O,2),m=p[0],g=p[1],x=$(),y=(x.currentSong,x.currentSongData),S=Object(s.useState)(!1),w=Object(l.a)(S,2),N=w[0],k=w[1];return Object(s.useEffect)((function(){Ce([n.uid],c,f,d)}),[]),Object(s.useEffect)((function(){(null===m||void 0===m?void 0:m.length)>0&&(k(!0),setTimeout((function(){g(""),k(!1)}),600))}),[m]),Object(v.jsxs)("div",{className:"person",id:n.uid,children:[Object(v.jsx)("img",{loading:"lazy",src:y.cover,alt:"",className:"sendSongImage "+m}),Object(v.jsxs)("div",{className:"personBtns",children:[Object(v.jsx)(i.b,{to:"/chat/".concat(u),children:Object(v.jsxs)("button",{onClick:function(){h&&Ne([c.uid,n.uid],u)},children:[Object(v.jsx)(fe,{text:"chat"}),Object(v.jsx)(ne.p,{})]})}),Object(v.jsx)(i.b,{to:"/authors/".concat(n.uid),children:Object(v.jsxs)("button",{children:[Object(v.jsx)(fe,{text:"profile"}),Object(v.jsx)(ne.B,{})]})}),Object(v.jsxs)("button",{onClick:function(){N||(Ie([n.uid]),g("sendAnimation"),a("".concat(y.name," was sent to ").concat(n.displayName)))},children:[Object(v.jsx)(fe,{text:"share"}),Object(v.jsx)(te.o,{})]})]}),Object(v.jsx)(i.b,{className:"pesronImg",style:{pointerEvents:"none"},to:"/authors/".concat(n.uid),children:Object(v.jsx)("img",{loading:"lazy",src:n.photoURL,alt:""})}),Object(v.jsx)(Bt,{userUID:n.uid}),Object(v.jsx)("div",{className:"personName",style:{pointerEvents:"none"},children:n.displayName})]},t)},Ut=function(e,t,n){var c=$(),a=c.currentSongPlaylistSource,r=c.playSong,i=c.setCurrentSongQueue,o=c.setCurrentSong,u=c.setPlay,l=c.songRef,d=c.setCurrentSongInQueue,h=c.setCurrentSongPlaylistSource,f=C().currentUser;return Object(s.useEffect)((function(){if(t.length){var n={source:"/albums/".concat(e.id),name:e.name,image:e.image,songsList:t},s=t.map((function(e){return e.id}));i(t),d(0),o(t[0].id),l.current.play(),u(!0),h(n),m.collection("users").doc(f.uid).update({lastSongPlayed:t[0].id,lastQueue:{image:n.image,name:n.name,songsList:s,source:n.source}})}}),[t.length]),function(t){t.preventDefault(),a.name!==e.name?(n([]),0!==e.length&&e.songs.map(function(){var e=Object(b.a)(j.a.mark((function e(t){var s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("songs").doc(t).get();case 2:s=e.sent.data(),n((function(e){return[].concat(Object(T.a)(e),[s])}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())):r()}},Ft=function(e){var t=e.playlist,n=J(),c=n.toggleModal,a=n.setContent,r=Object(s.useState)([]),u=Object(l.a)(r,2),d=u[0],j=u[1],b=Ut(t,d,j),h=ve(t.id),f=Object(l.a)(h,2),O=f[0],p=f[1],m=C().currentUser,g=Object(o.g)();return Object(v.jsxs)("div",{className:"TinyPlaylist",children:[Object(v.jsxs)("div",{className:"TinyPlaylistBtns",children:[t.authors.find((function(e){return e.uid===m.uid}))?Object(v.jsx)("button",{onClick:O,children:p?Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(fe,{text:"remove song"}),Object(v.jsx)(ne.c,{})]}):Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(fe,{text:"add song"}),Object(v.jsx)(ne.w,{})]})}):Object(v.jsxs)("button",{onClick:function(){c(),a(Object(v.jsx)(tt,{item:t,whatToShare:"playlist"}))},children:[Object(v.jsx)(fe,{text:"share"}),Object(v.jsx)(ne.z,{})]}),Object(v.jsx)(i.b,{to:"/albums/".concat(t.id),children:Object(v.jsxs)("button",{children:[Object(v.jsx)(fe,{text:"album"}),Object(v.jsx)(te.a,{})]})}),Object(v.jsxs)("button",{onClick:b,children:[Object(v.jsx)(fe,{text:"play"}),Object(v.jsx)(ne.u,{})]})]}),Object(v.jsx)("div",{className:"TinyPlaylistImg",style:{backgroundImage:"url(".concat(t.image,")"),display:"inline-block",backgroundPosition:"center center",backgroundSize:"cover",position:"relative"},onClick:function(){return g.push("/albums/".concat(t.id))},children:t.image?null:Object(v.jsx)(te.a,{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",width:"20px",height:"20px"}})}),Object(v.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[Object(v.jsx)("span",{children:re(t.name,13)}),Object(v.jsx)("span",{style:{fontSize:"0.8em",color:"grey",fontWeight:"500"},children:t.isAlbum?"album":"playlist"})]})]})},Wt=function(){var e=C().currentUser,t=$(),n=t.leftSideBarInputRef,c=t.setOpenFullScreenPlayer,a=t.currentSongData,r=t.yourFriends,o=t.yourPlaylists,u=J(),d=u.toggleModal,j=u.setContent,b=Object(s.useState)(0),h=Object(l.a)(b,2),f=h[0],O=h[1],p=Object(s.useState)((function(){var e=Et.find((function(e,t){return!!window.location.hash.includes(S(e.title))}));return void 0===e?-1:e.id})),m=Object(l.a)(p,2),g=m[0],y=m[1];return Object(v.jsxs)("div",{className:"LeftsideBar",children:[Object(v.jsxs)("div",{className:"logo",children:[Object(v.jsx)("img",{loading:"lazy",src:x,alt:""}),Object(v.jsx)("h3",{children:"Soundbubble"})]}),Object(v.jsx)("div",{className:"leftSideBarContainer",onClick:function(){return y(-1)},children:Object(v.jsx)(i.b,{to:"/authors/".concat(e.uid),children:Object(v.jsxs)("div",{className:"person",style:-1===g?{background:"var(--blue)"}:{},children:[e.friends.some((function(e){return"requested"===e.status}))?Object(v.jsx)(se,{}):null,Object(v.jsx)("div",{className:"pesronImg",style:{backgroundImage:"url(".concat(e.photoURL,")")}}),Object(v.jsx)("div",{className:"personName",children:re(e.displayName,9)})]})})}),Object(v.jsx)("div",{className:"NavigationPanel",children:Et.map((function(e,t){var n=e.id,s=e.title,c=e.icon,a=e.link;return Object(v.jsx)(Rt,{id:n,title:s,icon:c,link:a,currentPage:g,setCurrentPage:y},t)}))}),Object(v.jsxs)("div",{className:"leftSideBarContainer friendsAndPlaylists",children:[Object(v.jsx)("span",{style:{display:f?"none":"block",animation:"scrollFromBottom .2s forwards"},children:r.length>0?Object(v.jsxs)(v.Fragment,{children:[r.map((function(e,t){return t<=2?Object(v.jsx)(Dt,{index:e.uid,friend:e}):null})),Object(v.jsx)("h4",{className:"seeMoreBtn",onClick:function(){d(),j(Object(v.jsx)(tt,{item:a,whatToShare:"song"}))},children:"See more"})]}):Object(v.jsx)("h4",{style:{alignSelf:"center",width:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:"No friends added"})}),Object(v.jsxs)("span",{style:{display:f?"block":"none",animation:"scrollFromTop .2s forwards"},children:[o.map((function(e,t){if(t<=2)return Object(v.jsx)(Ft,{playlist:e},e.id)})),Object(v.jsxs)("button",{className:"createPlaylistBtn",onClick:function(){d(),j(Object(v.jsx)(Ct,{}))},style:{margin:"5px 0"},children:[Object(v.jsx)(te.i,{}),"Create Playlist"]})]}),Object(v.jsxs)("div",{className:"upAndDownBtns",children:[Object(v.jsx)("button",{onClick:function(){return O(0)},style:f?{}:{opacity:"0.3"},children:Object(v.jsx)(ne.g,{})}),Object(v.jsx)("button",{onClick:function(){return O(1)},style:f?{opacity:"0.3"}:{},children:Object(v.jsx)(ne.d,{})})]})]}),Object(v.jsx)("div",{className:"leftSideBarContainer",children:-1===a.id?null:Object(v.jsxs)("div",{className:"littlePlayer",children:[Object(v.jsx)(je,{textLimit:15,inputRef:n}),Object(v.jsx)("div",{className:"fullScreenBtn",onClick:function(){return c(!0)},children:Object(v.jsx)(te.j,{})})]})})]})},Ht=function(){var e=$(),t=e.currentSongData,n=e.currentSongPlaylistSource,c=e.nextSong,a=e.prevSong,r=e.songRef,i=e.setPlay,o=function(){navigator.mediaSession.setPositionState({duration:r.current.duration,playbackRate:r.current.playbackRate,position:r.current.currentTime})};function u(){r.current.pause(),i(!1)}Object(s.useEffect)((function(){"mediaSession"in navigator&&-1!==t.id&&(navigator.mediaSession.metadata=new window.MediaMetadata({title:t.name,artist:ie(t.authors),album:n.name,artwork:[{src:t.cover,sizes:"512x512",type:"image/png"}]}),navigator.mediaSession.setActionHandler("play",(function(){r.current.play(),i(!0)})),navigator.mediaSession.setActionHandler("pause",u),navigator.mediaSession.setActionHandler("stop",u),navigator.mediaSession.setActionHandler("nexttrack",(function(){c(),o()})),navigator.mediaSession.setActionHandler("previoustrack",(function(){a(),o()})))}),[t.id])},zt=function(e){var t=e.func,n=e.lenOfList,s=e.maxLen,c=void 0===s?5:s,a=e.boolVal;return Object(v.jsx)("div",{onClick:n>c?t:null,className:"MoreBtn",style:n<=c?{display:"none"}:{},children:Object(v.jsx)("button",{style:a?{background:"var(--pink)",color:"#ff8db2"}:{},children:a?"Close":"More"})})},Vt=function(e){var t=e.title,n=e.func,s=e.boolVal,c=e.lenOfList,a=e.maxLen,r=void 0===a?5:a,i=e.marginBottom,o=void 0===i?0:i;return 0!==c?Object(v.jsxs)("div",{className:"topTitle",style:{margin:"10px 0"},children:[Object(v.jsx)("h2",{style:{margin:o},children:t}),Object(v.jsx)(zt,{func:n,boolVal:s,lenOfList:c,maxLen:r})]}):null},Yt=function(e){var t=e.listOfSongs,n=e.source,c=e.title,a=void 0===c?"":c,r=e.showListens,o=void 0!==r&&r,u=e.isNewSong,d=void 0!==u&&u,j=e.showCount,b=void 0!==j&&j,h=e.listOfChosenSongs,f=e.setListOfSongs,O=e.showSearch,p=void 0!==O&&O,g=e.displayIfEmpty,x=e.showhistory,y=void 0!==x&&x,S=e.saveSearchHistory,w=void 0!==S&&S,N=e.isHorizontal,k=void 0!==N&&N,I=$(),A=I.setCurrentSongQueue,P=I.setCurrentSongPlaylistSource,L=(I.playSong,I.setCurrentSong,C()),M=L.currentUser,T=(L.searchValue,Object(s.useState)(!1)),E=Object(l.a)(T,2),R=E[0],B=E[1],D=Object(s.useState)(""),U=Object(l.a)(D,2),F=U[0],W=U[1],H=Object(s.useState)(t),z=Object(l.a)(H,2),V=z[0],Y=z[1];$().currentSong;return Object(s.useEffect)((function(){Y(t)}),[t]),Object(v.jsxs)("div",{className:"SongList",onClick:function(){if("no"!==n&&0!==t.length){A(t),P(n);var e=t.map((function(e){return e.id}));m.collection("users").doc(M.uid).update({lastQueue:{image:n.image,name:n.name,songsList:e,source:n.source}})}},children:[0!==a.length?Object(v.jsx)(Vt,{title:a,func:function(){return B(!R)},boolVal:R,lenOfList:t.length}):null,p?Object(v.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[Object(v.jsx)(Ge,{value:F,setValue:W,allFoundSongs:V,setAllFoundSongs:Y,defaultSearchMode:"songs",defaultSongsListValue:t,inputText:"Search for songs",background:"#00000061"}),y?Object(v.jsx)(i.b,{to:Tt,children:Object(v.jsx)("button",{className:"standartButton",style:{marginTop:"10px",marginBottom:"0",height:"44px",width:"44px",padding:"0",marginLeft:"6px",background:"var(--playlistsColor)"},children:Object(v.jsx)(ce.d,{style:{marginRight:"0"}})})}):null]}):null,Object(v.jsx)("div",{className:"list-of-songs"+(k?" horizontal":""),children:V.map((function(e,t){return 0===a.length||R||t<5?Object(v.jsxs)("span",{className:"topSongItem",children:[b?Object(v.jsx)("h3",{style:{opacity:"0.7"},children:t+1}):null,Object(v.jsx)(gt,{song:e,localIndex:t,showListens:o,isNewSong:d,listOfChosenSongs:h,setListOfSongs:f,shouldSaveSearchHistory:w},e.id)]}):void 0}))}),Object(v.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:0===t.length?g:null})]})},qt=function(e){var t=e.playlist,n=C().currentUser,c=Object(s.useState)(t.name),a=Object(l.a)(c,2),r=a[0],i=a[1],o=Object(s.useState)(t.image),u=Object(l.a)(o,2),d=u[0],h=u[1],f=Object(s.useState)(""),O=Object(l.a)(f,2),p=O[0],g=O[1],x=Object(s.useState)([]),y=Object(l.a)(x,2),S=y[0],w=y[1],N=Object(s.useState)(t.authors),k=Object(l.a)(N,2),I=k[0],A=k[1],P=Object(s.useState)(t.creationDate),L=Object(l.a)(P,2),M=L[0],E=L[1],R=Object(s.useState)(""),B=Object(l.a)(R,2),D=B[0],U=B[1],F=Object(s.useState)([]),W=Object(l.a)(F,2),H=W[0],z=W[1],Y=Object(s.useState)(t.songs),q=Object(l.a)(Y,2),G=q[0],Q=q[1],K=Object(s.useState)(t.isAlbum?1:0),X=Object(l.a)(K,2),J=X[0],_=X[1],Z=Object(s.useState)(t.isPrivate?1:0),$=Object(l.a)(Z,2),ee=$[0],te=$[1],se=Object(s.useState)(!1),ce=Object(l.a)(se,2),ae=ce[0],re=(ce[1],Object(s.useState)(!1)),ie=Object(l.a)(re,2),oe=ie[0],ue=ie[1],le=Object(s.useState)(""),de=Object(l.a)(le,2),je=de[0],he=de[1],fe=Object(s.useState)(t.imageColors),Oe=Object(l.a)(fe,2),pe=Oe[0],me=Oe[1],ge=Object(s.useState)(!1),xe=Object(l.a)(ge,2),ve=xe[0],ye=xe[1],Se=Object(s.useState)(!1),Ne=Object(l.a)(Se,2),Ce=Ne[0],ke=Ne[1];function Ie(e){var t=I.filter((function(t){return t.uid!==e.uid}));return A(t)}function Ae(){return(Ae=Object(b.a)(j.a.mark((function e(n){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.preventDefault(),we(),I.length>t.authors.length?I.filter((function(e){return!t.authors.find((function(t){return t.uid===e.uid}))})).forEach(function(){var e=Object(b.a)(j.a.mark((function e(n){var s,c,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(n.uid).get();case 2:s=e.sent,c=s.data(),(a=c.ownPlaylists).push(t.id),m.collection("users").doc(n.uid).update({ownPlaylists:a});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()):I.length<t.authors.length&&t.authors.filter((function(e){return!I.find((function(t){return t.uid===e.uid}))})).forEach(function(){var e=Object(b.a)(j.a.mark((function e(n){var s,c,a,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(n.uid).get();case 2:s=e.sent,c=s.data(),a=c.ownPlaylists,r=a.filter((function(e){return e!==t.id})),m.collection("users").doc(n.uid).update({ownPlaylists:r});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),m.collection("playlists").doc(t.id).update({id:t.id,name:r,songs:G,authors:I,image:d,listens:t.listens,creationDate:M,subscribers:t.subscribers,isAlbum:1===J,imageColors:pe,isPrivate:1===ee}).then((function(){ye(!1),ke(!0)}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){i(t.name),h(t.image),A(t.authors)}),[t.id]),Object(s.useEffect)((function(){0===D.length&&t.songs.map(function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("songs").doc(t).get();case 2:n=e.sent.data(),ue(!1),z((function(e){return[].concat(Object(T.a)(e),[n])}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[D]),Object(v.jsxs)("div",{className:"AddSong",children:[Object(v.jsx)(be.a,{src:je,getColors:function(e){return me(e)}}),Object(v.jsx)(_e,{title:"Playlist name",value:r,setValue:i,placeholder:"Enter playlist name"}),Object(v.jsxs)("label",{children:[Object(v.jsx)("h3",{children:"Playlist authors"}),Object(v.jsx)(Ge,{value:p,setValue:g,setResultAuthorList:w,defaultSearchMode:"authors",inputText:"Search for authors"}),Object(v.jsx)("div",{className:"chosenAuthorsList",children:I.map((function(e){return Object(v.jsxs)("div",{className:"chosenAuthorItem",children:[Object(v.jsx)("span",{children:e.displayName}),Object(v.jsx)(ne.G,{onClick:function(){return e.uid===n.uid?null:Ie(e)}})]})}))}),Object(v.jsx)("div",{className:"authorsResult",children:ae?Object(v.jsx)("div",{style:{position:"relative",width:"100%",height:"50px"},children:Object(v.jsx)(Te,{})}):S.map((function(e,t){return Object(v.jsx)(V,{data:e,onClick:function(){return function(e){if(!I.some((function(t){return t.uid===e.uid})))return A((function(t){return[].concat(Object(T.a)(t),[{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL}])}));Ie(e)}(e)},style:I.includes(e.uid)?{background:"var(--green)"}:{}},t)}))})]}),Object(v.jsxs)("label",{children:[Object(v.jsx)("h3",{children:"Search for songs"}),Object(v.jsx)(Ge,{value:D,setValue:U,setAllFoundSongs:z,defaultSearchMode:"songs",inputText:"Search for songs"}),Object(v.jsx)("div",{className:"authorsResult",children:oe?Object(v.jsx)("div",{style:{position:"relative",width:"100%",height:"50px"},children:Object(v.jsx)(Te,{})}):Object(v.jsx)(Yt,{listOfSongs:H,source:"no",listOfChosenSongs:G,setListOfSongs:Q})})]}),n.isAdmin||n.isAuthor?Object(v.jsxs)("div",{style:{display:"flex",justifyContent:"flex-start",margin:"15px 0"},children:[Object(v.jsx)(wt,{label:"Playlist",onClick:function(){return _(0)},currentActive:J,id:0}),Object(v.jsx)(wt,{label:"Album",onClick:function(){return _(1)},currentActive:J,id:1})]}):null,Object(v.jsxs)("div",{style:{display:"flex",justifyContent:"flex-start",margin:"15px 0"},children:[Object(v.jsx)(wt,{label:"Not Private",onClick:function(){return te(0)},currentActive:ee,id:0}),Object(v.jsx)(wt,{label:"Private",onClick:function(){return te(1)},currentActive:ee,id:1})]}),(n.isAdmin||n.isAuthor)&&Object(v.jsx)(_e,{title:"Release Date",type:"date",value:M,setValue:E,placeholder:"Enter release date"}),Object(v.jsx)(yt,{text:"Download playlist cover",place:"songsImages/",setItemSrc:h,setImageLocalPath:he}),Object(v.jsx)($e,{text:"Update playlist",action:function(e){return Ae.apply(this,arguments)},isLoading:ve,completed:Ce,setCompleted:ke,bottomMessage:"Playlist was updated"})]})},Gt=function(){var e=Object(b.a)(j.a.mark((function e(t,n){var s,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(n.uid).get();case 2:(s=e.sent.data().addedAuthors).push(t.uid),m.collection("users").doc(n.uid).update({addedAuthors:s}),c=t.subscribers,c++,m.collection("users").doc(t.uid).update({subscribers:c});case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();function Qt(e,t){var n=e.friends,s=t.friends;n.push({status:"requested",uid:t.uid}),s.push({status:"awaiting",uid:e.uid}),m.collection("users").doc(e.uid).update({friends:n}),m.collection("users").doc(t.uid).update({friends:s})}var Kt=function(e,t){},Xt=function(e){var t=e.data,n=e.color,c=C().currentUser,a=Object(s.useState)(!1),r=Object(l.a)(a,2),o=r[0],u=r[1],d=Object(s.useState)(0),j=Object(l.a)(d,2),b=j[0],h=j[1];return Object(s.useEffect)((function(){Ce([t.uid],c,u,h)}),[t.uid]),Object(v.jsx)(i.b,{to:"/chat/".concat(b),style:{display:"block",width:"fit-content",textDecoration:"none"},children:Object(v.jsxs)("button",{onClick:function(){o&&Ne([c.uid,t.uid],b)},style:{background:n},className:"ChatWithFriendButton",children:[Object(v.jsx)(ne.p,{})," Messages"]})})},Jt=function(e){var t=e.author,n=Object(s.useState)(t.displayName),c=Object(l.a)(n,2),a=c[0],r=c[1],i=Object(s.useState)(t.photoURL),o=Object(l.a)(i,2),u=o[0],d=o[1],h=Object(s.useState)(""),f=Object(l.a)(h,2),O=f[0],g=f[1],x=Object(s.useState)(t.imageColors),y=Object(l.a)(x,2),S=y[0],w=y[1];function N(){return(N=Object(b.a)(j.a.mark((function e(t,n,s){var c,a,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=t.target.files[0],g(URL.createObjectURL(c)),a=p.ref(),r=a.child(n+c.name),e.next=6,r.put(c);case 6:return e.t0=s,e.next=9,r.getDownloadURL();case 9:e.t1=e.sent,(0,e.t0)(e.t1);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(v.jsxs)("div",{className:"AddSong",children:[Object(v.jsx)(be.a,{src:O,getColors:function(e){return w(e)}}),Object(v.jsxs)("form",{onSubmit:function(e){return e.preventDefault()},children:[Object(v.jsx)("div",{style:{width:"100%",display:"flex",justifyContent:"center"},children:Object(v.jsx)("div",{className:"chatInfoImage",style:{backgroundImage:"url(".concat(u,")")},children:Object(v.jsxs)("label",{className:"changePhoto",children:[Object(v.jsx)(Oe.b,{}),"Change photo",Object(v.jsx)("input",{type:"file",style:{display:"none"},onChange:function(e){return function(e,t,n){return N.apply(this,arguments)}(e,"chatCovers/",d)}})]})})}),Object(v.jsxs)("label",{children:[Object(v.jsx)("h3",{children:"Your name"}),Object(v.jsx)("input",{type:"text",placeholder:"Enter your name",value:a,onChange:function(e){return r(e.target.value)},required:!0})]}),Object(v.jsx)("button",{type:"button",className:"addSongBtn",onClick:function(e){e.preventDefault(),m.collection("users").doc(t.uid).update({displayName:a,photoURL:u,imageColors:S})},children:"Update author"})]})]})},_t=function(){var e=Object(b.a)(j.a.mark((function e(t,n){var s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(n.uid).get();case 2:(s=e.sent.data().addedPlaylists).push(t.id),m.collection("users").doc(n.uid).update({addedPlaylists:s}),m.collection("playlists").doc(t.id).update({subscribers:++t.subscribers});case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Zt=function(){var e=Object(b.a)(j.a.mark((function e(t,n){var s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=n.addedPlaylists.filter((function(e){return e!==t.id})),m.collection("users").doc(n.uid).update({addedPlaylists:s}),m.collection("playlists").doc(t.id).update({subscribers:--t.subscribers});case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),$t=function(e){var t=Object(s.useState)([]),n=Object(l.a)(t,2),c=n[0],a=n[1],r=Object(s.useState)([]),i=Object(l.a)(r,2),o=i[0],u=i[1];function d(){return(d=Object(b.a)(j.a.mark((function t(){var n,s,c,r;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===(null===e||void 0===e?void 0:e.authors)){t.next=10;break}return n=e.authors.map((function(e){return e.uid})),t.next=4,m.collection("users").where("uid","in",n).get();case 4:s=t.sent,c=[],r=[],s.docs.forEach((function(e){c.push(e.data()),r.push(e.data().photoURL)})),a(c),u(r);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return Object(s.useEffect)((function(){!function(){d.apply(this,arguments)}()}),[null===e||void 0===e?void 0:e.id]),[c,o]},en=function(e){var t=e.color,n=void 0===t?"":t,s=Object(o.g)();return Object(v.jsx)("div",{className:"GoBackBtn",children:Object(v.jsxs)("button",{onClick:function(){return s.goBack()},style:n.length?{color:n}:{},children:[Object(v.jsx)(fe,{text:"go back",direction:"bottom"}),Object(v.jsx)(ne.a,{})]})})},tn=function(e){var t=e.album,n=J().setContent,c=$().yourFriends,a=Object(s.useState)([]),r=Object(l.a)(a,2),i=r[0],o=r[1],u=Object(s.useState)(!0),d=Object(l.a)(u,2),h=d[0],f=d[1];function O(){return(O=Object(b.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f(!0),o([]),c.forEach((function(e){e.addedPlaylists.includes(t.id)&&o((function(t){return[].concat(Object(T.a)(t),[e])}))})),f(!1);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){!function(){O.apply(this,arguments)}()}),[t.uid]),Object(v.jsxs)("div",{className:"SongInfo",children:[Object(v.jsx)("div",{className:"songImage",style:{backgroundImage:"url(".concat(t.image,")")}}),Object(v.jsxs)("div",{className:"songInfoContent",children:[Object(v.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[Object(v.jsx)("span",{style:{opacity:".5",fontWeight:500,fontSize:".7em"},children:t.isAlbum?"Album":"Playlist"}),Object(v.jsx)("h3",{style:{color:t.imageColors[1]},children:t.name})]}),Object(v.jsxs)("div",{style:{display:"flex",opacity:"0.6",fontSize:".9em",position:"relative"},className:"listensAndDate",children:[Object(v.jsxs)("p",{className:"infoListens",style:{marginRight:"20px",position:"relative"},children:[t.listens,Object(v.jsx)(ne.k,{})]}),Object(v.jsxs)("p",{className:"infoListens",style:{marginRight:"20px",position:"relative"},children:[t.subscribers," ",Object(v.jsx)(ne.D,{})]}),Object(v.jsx)("span",{children:U(t.creationDate)})]}),Object(v.jsx)("h4",{style:{margin:"10px 0"},children:i.length>0?"Friends subscribed":"None of your friends subscribed"}),h?Object(v.jsx)("div",{style:{position:"relative",height:"50px"},children:Object(v.jsx)(Te,{top:"50%"})}):Object(v.jsx)("div",{style:{display:"flex"},children:i.length>0?Object(v.jsxs)(v.Fragment,{children:[i.map((function(e,t){if(t<2)return Object(v.jsx)(st,{person:e},e.uid)})),i.length>2?Object(v.jsx)(ct,{onClick:function(){return n(Object(v.jsx)(et,{listOfPeople:i,title:"Friends subscribed to ".concat(t.name)}))}}):null]}):Object(v.jsx)("button",{className:"shareBtn",style:{minHeight:"35px",background:t.imageColors[0]},onClick:function(){n(Object(v.jsx)(tt,{item:t,whatToShare:"playlist"}))},children:"Share"})})]})]})},nn=function(e){var t=e.author,n=J().setContent,c=$().yourFriends,a=Object(s.useState)([]),r=Object(l.a)(a,2),i=r[0],o=r[1],u=Object(s.useState)(!0),d=Object(l.a)(u,2),h=d[0],f=d[1];function O(){return(O=Object(b.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f(!0),o([]),c.forEach((function(e){t.isAuthor?e.addedAuthors.includes(t.uid)&&o((function(t){return[].concat(Object(T.a)(t),[e])})):e.friends.find((function(e){return e.uid===t.uid}))&&o((function(t){return[].concat(Object(T.a)(t),[e])}))})),f(!1);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){!function(){O.apply(this,arguments)}()}),[t.uid]),Object(v.jsxs)("div",{className:"SongInfo",children:[Object(v.jsx)("div",{className:"songImage",style:{backgroundImage:"url(".concat(t.photoURL,")")}}),Object(v.jsxs)("div",{className:"songInfoContent",children:[Object(v.jsxs)("div",{style:{display:"flex",flexDirection:"column-reverse"},children:[Object(v.jsxs)("h3",{style:{color:t.imageColors[1]},children:[t.displayName,t.isVerified?Object(v.jsx)(ze.b,{style:{color:t.imageColors[0],width:"15px",height:"15px",marginLeft:"5px"}}):null]}),Object(v.jsx)("span",{style:{opacity:".5",fontWeight:500,fontSize:".7em"},children:t.isAuthor?"Author":"User"})]}),Object(v.jsxs)("div",{style:{display:"flex",opacity:"0.6",fontSize:".9em",position:"relative"},className:"listensAndDate",children:[Object(v.jsxs)("p",{className:"infoListens",style:{marginRight:"20px",position:"relative"},children:[t.numberOfListenersPerMonth,Object(v.jsx)(ne.k,{})]}),Object(v.jsxs)("p",{className:"infoListens",style:{marginRight:"20px",position:"relative"},children:[t.subscribers," ",Object(v.jsx)(ne.D,{})]}),Object(v.jsx)("span",{children:U(t.regDate)})]}),Object(v.jsx)("h4",{style:{margin:"10px 0"},children:i.length>0?"Friends subscribed":"None of your friends subscribed"}),h?Object(v.jsx)("div",{style:{position:"relative",height:"50px"},children:Object(v.jsx)(Te,{top:"50%"})}):Object(v.jsx)("div",{style:{display:"flex"},children:i.length>0?Object(v.jsxs)(v.Fragment,{children:[i.map((function(e,t){if(t<2)return Object(v.jsx)(st,{person:e},e.uid)})),i.length>2?Object(v.jsx)(ct,{onClick:function(){return n(Object(v.jsx)(et,{listOfPeople:i,title:"Friends subscribed to ".concat(t.displayName)}))}}):null]}):Object(v.jsx)("button",{className:"shareBtn",style:{minHeight:"35px",background:t.imageColors[0]},onClick:function(){n(Object(v.jsx)(tt,{item:t,whatToShare:"author"}))},children:"Share"})})]})]})},sn=function(e){var t=e.data,n=J().setContent;return Object(v.jsxs)("div",{className:"AuthorMoreWindow",style:{top:"110%",bottom:"auto"},onClick:function(e){return e.stopPropagation()},children:[Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){n(Object(v.jsx)(tt,{item:t,whatToShare:void 0!==t.authors?"playlist":"author"}))},children:[Object(v.jsx)(ne.z,{}),"Share"]}),Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){n(void 0!==t.authors?Object(v.jsx)(tn,{album:t}):Object(v.jsx)(nn,{author:t}))},children:[Object(v.jsx)(ne.n,{}),"Info"]})]})},cn=function(e){var t=e.imagesList,n=e.borderColor,s=void 0===n?"#fff":n;return Object(v.jsx)("div",{className:"SmallImages",style:{marginRight:-7*(t.length-1)},children:t.map((function(e,t){return Object(v.jsx)("div",{className:"smallImgContainer",style:{border:"3px solid ".concat(s),transform:"translateX(".concat(-15*t,"px)")},children:Object(v.jsx)("img",{loading:"lazy",src:e,alt:""})},t)}))})},an=function(e){var t,n,c=e.data,a=e.headerColors,r=A().isMobile,o=$().displayAuthors,u=$t(c),d=Object(l.a)(u,2),j=d[0],b=d[1],h=C(),f=h.currentUser,O=h.logout,p=Object(s.useState)(!1),g=Object(l.a)(p,2),x=g[0],y=g[1],S=J(),w=S.toggleModal,N=S.setContent,k=S.openConfirm,I=S.closeConfirm,P=S.openBottomMessage,L=f.friends.find((function(e){return e.uid===c.uid&&"added"===e.status})),M=Object(s.useRef)(null);return jt(M,y),Object(v.jsxs)("div",{className:"Header",style:a.length?{background:"linear-gradient(45deg, ".concat(a[2],", ").concat(a[0],")")}:{background:"var(--yellowAndPinkGrad)"},children:[Object(v.jsxs)("div",{className:"headerBtns",style:{background:a[2]},children:[Object(v.jsx)(en,{}),Object(v.jsxs)("div",{style:{display:"flex"},children:[Object(v.jsx)("div",{className:"headerBackBtn",children:c.authors?f.ownPlaylists.includes(c.id)&&1===c.authors.length?Object(v.jsxs)("button",{onClick:function(){return k("Are you sure you want to DELETE this playlist forever?!","Yes, pretty sure","No, I Don't!",(function(){var e;e=c.id,m.collection("users").where("addedPlaylists","array-contains",e).get().then((function(t){t.docs.forEach((function(t){var n=t.data().addedPlaylists.filter((function(t){return t!==e}));m.collection("users").doc(t.data().uid).update({addedPlaylists:n})}))})),m.collection("users").where("ownPlaylists","array-contains",e).get().then((function(t){t.docs.forEach((function(t){var n=t.data().addedPlaylists.filter((function(t){return t!==e}));m.collection("users").doc(t.data().uid).update({ownPlaylists:n})}))})),m.collection("search").doc(e).delete().then((function(){m.collection("playlists").doc(e).delete()})),I(),P("Playlist ".concat(c.name," was deleted"))}))},children:[Object(v.jsx)(fe,{text:"delete playlist",direction:"bottom"}),Object(v.jsx)(ne.A,{})]}):f.ownPlaylists.includes(c.id)?Object(v.jsxs)("button",{onClick:function(){return k("Are you sure you want to quit this playlist?","Yes, pretty sure","No, I Don't!",(function(){!function(e,t){m.collection("users").doc(t.uid).update({ownPlaylists:t.ownPlaylists.filter((function(t){return t!==e.id}))}),m.collection("playlists").doc(e.id).update({authors:e.authors.filter((function(e){return e.uid!==t.uid}))})}(c,f),I(),P("You left ".concat(c.name))}))},children:[Object(v.jsx)(fe,{text:"quit playlist",direction:"bottom"}),Object(v.jsx)(te.e,{})]}):f.addedPlaylists.includes(c.id)?Object(v.jsxs)("button",{onClick:function(){return k("Are you sure you want to remove this playlist from library?","Yes, pretty sure","No-no-no, go away",(function(){Zt(c,f),I(),P("Playlist was removed from library")}))},children:[Object(v.jsx)(fe,{text:"remove playlist from library",direction:"bottom"}),Object(v.jsx)(nt.a,{})]}):Object(v.jsxs)("button",{onClick:function(){_t(c,f),P("Playlist ".concat(c.name," was added to library"))},children:[Object(v.jsx)(fe,{text:"add playlist",direction:"bottom"}),Object(v.jsx)(ne.w,{})]}):f.addedAuthors.includes(c.uid)?Object(v.jsxs)("button",{onClick:function(){return Kt(c,f)},children:[Object(v.jsx)(fe,{text:"delete author from library",direction:"bottom"}),Object(v.jsx)(nt.a,{})]}):f.uid===c.uid?Object(v.jsx)(i.b,{to:"/settings",children:Object(v.jsxs)("button",{children:[Object(v.jsx)(fe,{text:"settings",direction:"bottom"}),Object(v.jsx)(ne.y,{})]})}):!c.isAuthor&&f.friends.find((function(e){return e.uid===c.uid&&"added"===e.status}))?Object(v.jsxs)("button",{onClick:function(){return k("Are you sure you want to unfriend ".concat(c.displayName,"?"),"Yes, pretty sure","No-no-no, go away",(function(){!function(e,t){var n=e.friends.filter((function(e){return e.uid!==t.uid})),s=t.friends.filter((function(t){return t.uid!==e.uid}));m.collection("users").doc(e.uid).update({friends:n}),m.collection("users").doc(t.uid).update({friends:s})}(f,c),I(),P("".concat(c.displayName," was unfriended"))}))},children:[Object(v.jsx)(fe,{text:"remove from friend list",direction:"bottom"}),Object(v.jsx)(ne.C,{})]}):!c.isAuthor&&f.friends.find((function(e){return e.uid===c.uid&&"awaiting"===e.status}))?Object(v.jsxs)("button",{onClick:Qt,children:[Object(v.jsx)(fe,{text:"waiting for response",direction:"bottom"}),Object(v.jsx)(te.l,{style:{animation:"loading 1s infinite linear"}})]}):c.isAuthor?Object(v.jsxs)("button",{onClick:function(){Gt(c,f),P("".concat(c.displayName," was added to your library"))},children:[Object(v.jsx)(fe,{text:"subscribe",direction:"bottom"}),Object(v.jsx)(ne.w,{})]}):Object(v.jsxs)("button",{onClick:function(){Qt(c,f),P("Friend request was sent to ".concat(c.displayName))},children:[Object(v.jsx)(fe,{text:"add friend",direction:"bottom"}),Object(v.jsx)(ne.D,{})]})}),Object(v.jsxs)("div",{className:"headerMoreBtn",ref:M,children:[Object(v.jsxs)("button",{onClick:r?function(){w(),N(Object(v.jsx)(sn,{data:c}))}:function(){return y(!x)},children:[Object(v.jsx)(fe,{text:"more",direction:"bottom"}),Object(v.jsx)(ne.s,{})]}),x?Object(v.jsxs)("div",{className:"songItemMenuWindow",style:{top:"110%",bottom:"auto"},onClick:function(e){return e.stopPropagation()},children:[c.authors&&c.authors.find((function(e){return e.uid===f.uid}))||c.authors&&f.isAdmin?Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){w(),N(Object(v.jsx)(qt,{playlist:c}))},children:[Object(v.jsx)(ne.i,{}),"Edit"]}):c.uid!==f.uid||c.isAuthor?null:Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){w(),N(Object(v.jsx)(Jt,{author:c}))},children:[Object(v.jsx)(ne.i,{}),"Edit"]}),Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){w(),N(Object(v.jsx)(tt,{item:c,whatToShare:void 0!==c.authors?"playlist":"author"}))},children:[Object(v.jsx)(ne.z,{}),"Share"]}),Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){w(),N(void 0!==c.authors?Object(v.jsx)(tn,{album:c}):Object(v.jsx)(nn,{author:c}))},children:[Object(v.jsx)(ne.n,{}),"Info"]})]}):null]})]}),f.uid===c.uid?Object(v.jsxs)("button",{onClick:function(){return k("Are you sure you want to quit?","Yes, pretty sure","No, I Don't!",(function(){O(),I()}))},children:[Object(v.jsx)(fe,{text:"quit",direction:"bottom"}),Object(v.jsx)(E.c,{})]}):null]}),Object(v.jsx)("div",{className:"headerAuthorsImage",style:void 0===c.authors?{animation:"floatingBorderRadius 10s infinite ease-in-out",backgroundImage:"url(".concat(c.photoURL,")"),position:"relative"}:{backgroundImage:"url(".concat(c.image,")"),position:"relative",backgroundColor:"var(--red)"},children:void 0===c.authors||c.image?null:Object(v.jsx)(te.a,{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",width:"60px",height:"60px"}})}),Object(v.jsxs)("div",{className:"headerAuthorInfo",children:[Object(v.jsxs)("div",{className:"headerAuthorsName",children:[void 0!==c.authors?c.isAlbum?Object(v.jsx)("h5",{children:"Album"}):Object(v.jsx)("h5",{children:"Playlist"}):c.isAuthor?Object(v.jsx)("h5",{children:"Author"}):Object(v.jsxs)("h5",{children:["User"," ",void 0===c.authors&&L?Object(v.jsx)(W,{userUID:c.uid}):null]}),Object(v.jsxs)("div",{style:{display:"flex",alignItems:"center",margin:"2px 0 10px 0"},children:[Object(v.jsx)("h1",{children:c.displayName||c.name}),c.isVerified?Object(v.jsx)(ze.b,{style:{color:a[0]}}):null,c.isPrivate?Object(v.jsx)(nt.b,{}):null]})]}),void 0!==c.authors?Object(v.jsxs)("div",{className:"headerAuthorsImagesAndNames",children:[Object(v.jsx)(cn,{imagesList:b,borderColor:a[2]}),Object(v.jsx)("div",{className:"headerAuthors",children:o(j,", ")})]}):null,Object(v.jsxs)("div",{className:"headerListenersAndSubs",children:[Object(v.jsxs)("div",{className:"headerListenersAndSubsItem",children:[Object(v.jsx)(fe,{text:(null!==(t=c.listens)&&void 0!==t?t:c.numberOfListenersPerMonth)+" listens",style:{fontSize:"0.8em"}}),Object(v.jsx)("span",{children:Ot(null!==(n=c.listens)&&void 0!==n?n:c.numberOfListenersPerMonth)}),Object(v.jsx)(ne.k,{})]}),Object(v.jsxs)("div",{className:"headerListenersAndSubsItem",children:[Object(v.jsx)(fe,{text:c.subscribers+" subscribers",style:{fontSize:"0.8em"}}),Object(v.jsx)("span",{children:Ot(c.subscribers)}),Object(v.jsx)(ne.D,{})]}),void 0!==c.creationDate?Object(v.jsxs)("div",{className:"headerListenersAndSubsItem",children:[Object(v.jsx)(fe,{text:"creation date",style:{fontSize:"0.8em"}}),Object(v.jsx)("span",{children:U(c.creationDate)})]}):null]}),L?Object(v.jsx)(Xt,{data:c,color:a[3]}):null]})]})},rn=function(e){var t=e.children,n=Object(L.a)(e,["children"]);return Object(v.jsx)("div",Object(u.a)(Object(u.a)({className:"content-container"},n),{},{children:t}))},on=function(){var e=Object(o.h)("/albums/:albumId"),t=Object(s.useState)([]),n=Object(l.a)(t,2),c=n[0],a=n[1],r=Object(s.useState)([]),i=Object(l.a)(r,2),u=i[0],d=i[1],h=e.params.albumId,f=Object(s.useState)([]),O=Object(l.a)(f,2),p=O[0],g=O[1],x=Object(s.useState)(!0),y=Object(l.a)(x,2),S=y[0],w=y[1],N=Object(o.g)();function C(){return(C=Object(b.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:m.collection("playlists").doc(h).onSnapshot((function(e){e.exists?(g(e.data()),d(e.data().imageColors)):N.push("/not-found")}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){!function(){C.apply(this,arguments)}()}),[h,m]),Object(s.useEffect)((function(){!function(){var e;(null===(e=p.songs)||void 0===e?void 0:e.length)?K(p.songs,"songs",a,(function(e){return e}),(function(){return w(!1)})):w(!1)}()}),[p]),Object(v.jsx)("div",{className:"AlbumPage",style:{animation:"zoomIn .2s forwards"},children:S?Object(v.jsx)(Te,{top:"50%"}):Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(an,{data:p,headerColors:u,setHeaderColors:d}),Object(v.jsxs)(rn,{style:{display:"flex",flexDirection:"column",minHeight:"100%",borderRadius:"25px 25px 0 0",flex:"1 1 auto",position:"relative",overflow:"hidden",boxShadow:"0px 0px 100px #060606"},children:[Object(v.jsx)("div",{className:"content-background",style:{background:"linear-gradient(360deg, black, ".concat(u[0],")")}}),Object(v.jsx)(Yt,{listOfSongs:c,source:{source:"/albums/".concat(p.id),name:p.name,image:p.image,songsList:c},showSearch:!0,defaultSearchMode:"songs"})]})]})})},un=function(){var e=C().currentUser,t=Object(s.useState)(""),n=Object(l.a)(t,2),c=n[0],a=n[1],r=Object(s.useState)(""),i=Object(l.a)(r,2),o=i[0],u=i[1],d=Object(s.useState)(""),h=Object(l.a)(d,2),f=h[0],O=h[1],p=Object(s.useState)(""),g=Object(l.a)(p,2),x=g[0],y=g[1],S=Object(s.useState)([]),N=Object(l.a)(S,2),k=N[0],I=N[1],A=Object(s.useState)(e.isAdmin?[]:[{uid:e.uid,photoURL:e.photoURL,displayName:e.displayName}]),P=Object(l.a)(A,2),L=P[0],M=P[1],E=Object(s.useState)(""),R=Object(l.a)(E,2),B=R[0],D=R[1],U=Object(s.useState)(""),F=Object(l.a)(U,2),W=F[0],H=F[1],z=Object(s.useState)(""),Y=Object(l.a)(z,2),q=Y[0],G=Y[1],Q=Object(s.useState)([]),K=Object(l.a)(Q,2),X=K[0],J=K[1],_=Object(s.useState)(!1),Z=Object(l.a)(_,2),$=(Z[0],Z[1],Object(s.useState)("")),ee=Object(l.a)($,2),te=(ee[0],ee[1]),se=Object(s.useState)(!1),ce=Object(l.a)(se,2),ae=ce[0],re=ce[1],ie=Object(s.useState)(!1),oe=Object(l.a)(ie,2),ue=oe[0],le=oe[1];function de(e){var t=L.filter((function(t){return t.uid!==e.uid}));return M(t)}function je(){return(je=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),n=we(),te(""),0===c.length?te("Song has to have some name"):0===L.length?te("Song has to have at least 1 author"):0===o.length?te("You didn't load song cover"):0===f.length?te("You didn't load song file"):0===B.length?te("You have to set release date for a song"):(le(!0),m.collection("songs").doc(n).set({id:n,name:c,songSrc:f,authors:L,cover:o,listens:0,releaseDate:B,lyrics:ot(W),imageColors:X}).then((function(){I([]),y(""),M([]),H([]),u(""),a(""),O(""),D(""),H([]),re(!0),J([]),le(!1)})).catch((function(e){te(e),le(!1)})),L.forEach(function(){var e=Object(b.a)(j.a.mark((function e(t){var s,c,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(t.uid).get();case 2:s=e.sent,c=s.data(),(a=c.ownSongs).push(n),m.collection("users").doc(t.uid).update({ownSongs:a});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),m.collection("search").doc(n).set({place:"songs",uid:n,rank:0,variantsOfName:w(c)}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(v.jsxs)("div",{className:"AddSong",children:[Object(v.jsx)(St,{loading:ue}),Object(v.jsx)(be.a,{src:q,getColors:function(e){return J(e)}}),Object(v.jsxs)("div",{children:[Object(v.jsx)(_e,{title:"Song name",value:c,setValue:a,placeholder:"Enter song name"}),Object(v.jsxs)("label",{children:[Object(v.jsx)("h3",{children:"Song authors"}),Object(v.jsx)(Ge,{value:x,setValue:y,setResultAuthorList:I,defaultSearchMode:"authors",inputText:"Search for authors"}),Object(v.jsx)("div",{className:"chosenAuthorsList",children:L.map((function(t){return Object(v.jsxs)("div",{className:"chosenAuthorItem",children:[Object(v.jsx)("span",{children:t.displayName}),Object(v.jsx)(ne.G,{onClick:function(){(e.isAdmin||t.uid!==e.uid)&&de(t)}})]})}))}),Object(v.jsx)("div",{className:"authorsResult",children:k.map((function(e,t){return Object(v.jsx)(V,{data:e,onClick:function(){return function(e){if(!L.some((function(t){return t.uid===e.uid})))return M((function(t){return[].concat(Object(T.a)(t),[{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL}])}));de(e)}(e)},style:L.includes(e.uid)?{background:"var(--green)"}:{}},t)}))})]}),Object(v.jsx)(_e,{title:"Release Date",type:"date",value:B,setValue:D,placeholder:"Enter release date"}),Object(v.jsx)("div",{style:{width:"100%",display:"flex"},children:X.map((function(e,t){return Object(v.jsx)("input",{type:"color",value:e,style:{width:"100%",height:"60px",padding:"0",borderRadius:"0px"},onChange:function(e){!function(e,t){X[t]=e.target.value,J(Object(T.a)(X))}(e,t)}})}))}),Object(v.jsx)(yt,{text:"Download song cover",place:"songsImages/",setItemSrc:u,setImageLocalPath:G}),Object(v.jsx)(yt,{text:"Download song file",place:"songs/",setItemSrc:O}),Object(v.jsx)("label",{children:Object(v.jsx)("textarea",{name:"",id:"",placeholder:"Add song lyrics",value:W,onChange:function(e){return H(e.target.value)}})}),Object(v.jsx)($e,{text:"Add song",action:function(e){return je.apply(this,arguments)},isLoading:ue,completed:ae,setCompleted:re,bottomMessage:"Song was uploaded to database"})]})]})},ln=function(e){var t=e.pages,n=e.currentPage,s=e.setCurrentPage;return Object(v.jsx)("div",{className:"Slider",children:t.map((function(e,t){return Object(v.jsx)("div",{className:"sliderItem "+(t===n?"current":""),onClick:function(){return s(t)},children:e},t)}))})},dn=function(e){var t=e.data,n=C().currentUser,c=Object(s.useState)(!1),a=Object(l.a)(c,2),r=a[0],i=a[1],o=Object(s.useState)(0),u=Object(l.a)(o,2),d=u[0],j=u[1],b=[Object(v.jsx)(un,{}),Object(v.jsx)(Nt,{})];return(n.isAdmin||t.isAuthor)&&t.uid===n.uid?Object(v.jsxs)("div",{className:"AddSong",children:[Object(v.jsx)("button",{onClick:function(){return i(!r)},style:r?{background:"var(--red)"}:{},className:"openAddSongWindowBtn",children:Object(v.jsx)(ne.v,{style:r?{transform:"rotate(45deg)"}:{}})}),Object(v.jsxs)("div",{className:"addSongWindow",style:r?{display:"flex"}:{},children:[Object(v.jsx)(ln,{pages:["Song","Playlist"],currentPage:d,setCurrentPage:j}),b[d]]})]}):null},jn=function(e){var t=e.data,n=e.title,c=Object(s.useState)([]),a=Object(l.a)(c,2),r=a[0],i=a[1],o=Object(s.useState)(0),u=Object(l.a)(o,2),d=u[0],h=u[1],f=Object(s.useRef)(null),O=Object(s.useState)(!1),p=Object(l.a)(O,2),g=p[0],x=p[1];return Object(s.useEffect)((function(){r.length>0&&(f.current.scrollWidth>f.current.offsetWidth&&x(!0))}),[r]),Object(s.useEffect)((function(){i([]),i([]),t.friends.forEach(function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("added"!==t.status){e.next=5;break}return e.next=3,m.collection("users").doc(t.uid).get();case 3:n=e.sent.data(),i((function(e){return[].concat(Object(T.a)(e),[n])}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[t.uid]),r.length>0?Object(v.jsxs)("div",{className:"PersonTinyList",children:[n&&Object(v.jsx)("h2",{children:n}),Object(v.jsxs)("div",{style:{position:"relative"},children:[Object(v.jsx)("div",{className:"personTinyListWrapper",ref:f,onScroll:function(e){return h(e.target.scrollLeft)},children:r.map((function(e,t){return Object(v.jsx)(st,{person:e},e.uid)}))}),Object(v.jsxs)("div",{className:"authorsShiftButtons",children:[Object(v.jsx)("button",{onClick:function(){var e=f.current.scrollLeft;f.current.scrollLeft=e-200,h(e-200)},style:d<=0?{visibility:"hidden",opacity:"0"}:{},children:Object(v.jsx)(ne.e,{})}),Object(v.jsx)("button",{onClick:function(){var e=f.current.scrollLeft;f.current.scrollLeft=e+200,h(e+200)},style:g&&f.current&&f.current.scrollWidth-f.current.offsetWidth!==d?{}:{visibility:"hidden",opacity:"0"},children:Object(v.jsx)(ne.f,{})})]})]})]}):null},bn=function(){var e=Object(b.a)(j.a.mark((function e(t,n,s,c){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n([]),a=[],void 0!==t.ownPlaylists&&0!==t.ownPlaylists.length&&t.ownPlaylists.forEach(function(){var e=Object(b.a)(j.a.mark((function e(r,i){var o;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("playlists").doc(r).get();case 2:(o=e.sent.data())&&(!o.isPrivate||t.uid===s&&o.isPrivate)&&a.push(o),i===t.ownPlaylists.length-1&&(a.sort((function(e,t){return new Date(t.creationDate).getTime()-new Date(e.creationDate).getTime()})),c(!1),n(a));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e)})));return function(t,n,s,c){return e.apply(this,arguments)}}(),hn=n(51),fn=function(){return Object(v.jsxs)("div",{style:{textDecoration:"none"},className:"playlistWrapper",children:[Object(v.jsx)("div",{className:"playlistItem",style:{background:"var(--playlistsColor)",display:"flex",justifyContent:"center",alignItems:"center"},children:Object(v.jsx)("img",{loading:"lazy",src:x,alt:"",style:{width:"70px",height:"70px",filter:"grayscale(80%)"}})}),Object(v.jsx)("h4",{style:{display:"flex",alignItems:"center",margin:"5px 0"},children:"Playlist was deleted"})]})},On=function(e){var t=e.playlist,n=void 0===t?null:t,c=e.listOfChosenAlbums,a=e.setListOfChosenAlbums,r=e.shouldSaveSearchHistory,o=new Date(null===n||void 0===n?void 0:n.creationDate),u=A().isMobile,d=C().currentUser,j=$(),b=j.currentSongPlaylistSource,h=j.play,f=Object(s.useState)([]),O=Object(l.a)(f,2),p=O[0],m=O[1],g=Ut(n,p,m);return null!==n?Object(v.jsxs)(i.b,{to:"/albums/".concat(n.id),style:{textDecoration:"none"},className:"playlistWrapper",onClick:function(){r&&bt(d.uid,n.id,"playlists")},children:[Object(v.jsx)(R,{listOfChosenItems:c,setListOfChosenItems:a,itemId:n.id}),Object(v.jsxs)("div",{className:"playlistItem",style:n.image?{backgroundImage:"url(".concat(n.image,")")}:{background:"var(--yellowAndPinkGrad)"},children:[n.image?null:Object(v.jsx)(te.a,{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",width:"60px",height:"60px"}}),u?null:Object(v.jsx)("button",{onClick:g,children:b.name===n.name&&h?Object(v.jsx)(hn.b,{}):Object(v.jsx)(hn.c,{})})]}),Object(v.jsxs)("h4",{style:{display:"flex",alignItems:"center",margin:"5px 0"},children:[re(n.name,u?10:15),Object(v.jsx)("span",{style:{fontSize:".6em",opacity:.6,fontWeight:"500",marginLeft:"7px"},children:n.isAlbum?1===n.songs.length?"single":"album":"playlist"})]}),Object(v.jsx)("h5",{style:{margin:"5px 0"},children:o.getFullYear()})]}):Object(v.jsx)(fn,{})},pn=function(e){var t=e.listOfAlbums,n=e.title,c=void 0===n?"":n,a=e.loading,r=void 0===a||a,i=e.listOfChosenAlbums,o=e.setListOfChosenAlbums,u=e.saveSearchHistory,d=Object(s.useState)(0),j=Object(l.a)(d,2),b=j[0],h=j[1],f=Object(s.useRef)(null),O=Object(s.useState)(!1),p=Object(l.a)(O,2),m=p[0],g=p[1];return Object(s.useEffect)((function(){t.length>0&&!r&&(f.current.scrollWidth>f.current.offsetWidth&&g(!0))}),[t]),t.length>0?r?Object(v.jsx)(Te,{}):Object(v.jsxs)("div",{className:"AuthorsList",children:[0!==c.length?Object(v.jsx)("h2",{children:c}):null,Object(v.jsx)("div",{className:"authorsWrapper",ref:f,onScroll:function(e){return h(e.target.scrollLeft)},children:t.map((function(e,t){return Object(v.jsx)(On,{playlist:e,listOfChosenAlbums:i,setListOfChosenAlbums:o,shouldSaveSearchHistory:u},t)}))}),Object(v.jsxs)("div",{className:"authorsShiftButtons",children:[Object(v.jsx)("button",{onClick:function(){var e=f.current.scrollLeft;f.current.scrollLeft=e-220,h(e-220)},style:b<=0?{visibility:"hidden",opacity:"0"}:{},children:Object(v.jsx)(ne.e,{})}),Object(v.jsx)("button",{onClick:function(){var e=f.current.scrollLeft;f.current.scrollLeft=e+220,h(e+220)},style:m&&f.current&&f.current.scrollWidth-f.current.offsetWidth!==b?{}:{visibility:"hidden",opacity:"0"},children:Object(v.jsx)(ne.f,{})})]})]}):null},mn=function(e){var t=e.authorsData,n=C().currentUser,c=Object(s.useState)([]),a=Object(l.a)(c,2),r=a[0],i=a[1],o=Object(s.useState)(!0),u=Object(l.a)(o,2),d=u[0],j=u[1];return Object(s.useEffect)((function(){bn(t,i,n.uid,j)}),[t.ownPlaylists]),Object(v.jsx)(pn,{listOfAlbums:r,title:n.isAuthor?"Albums":"Playlists",loading:d})},gn=function(e){var t=e.person,n=e.addFriend,s=e.rejectFriend;return Object(v.jsxs)("div",{className:"FriendRequestItem",children:[Object(v.jsx)(i.b,{to:"/authors/".concat(t.uid),children:Object(v.jsxs)("div",{className:"friendRequestImageAndName",children:[Object(v.jsx)("div",{className:"requestImage",children:Object(v.jsx)("img",{loading:"lazy",src:t.photoURL,alt:""})}),Object(v.jsx)("h3",{children:t.displayName})]})}),Object(v.jsxs)("div",{className:"requestButtons",children:[Object(v.jsxs)("button",{style:{color:"var(--green)"},onClick:function(){return n(t.uid)},children:[Object(v.jsx)(ne.c,{}),Object(v.jsx)("span",{children:"Add"})]}),Object(v.jsxs)("button",{style:{color:"var( --lightRed)"},onClick:function(){return s(t.uid)},children:[Object(v.jsx)(ne.F,{}),Object(v.jsx)("span",{children:"Reject"})]})]})]})},xn=function(){var e=C().currentUser,t=Object(s.useState)([]),n=Object(l.a)(t,2),c=n[0],a=n[1];return Object(s.useEffect)((function(){!function(){var t=[];e.friends.forEach(function(){var n=Object(b.a)(j.a.mark((function n(s,c){var r;return j.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("requested"!==s.status){n.next=6;break}return n.next=3,m.collection("users").doc(s.uid).get();case 3:r=n.sent.data(),t.push(r),c===e.friends.length-1&&a(t);case 6:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())}()}),[JSON.stringify(e.friends)]),[c,function(t){var n=e.friends,s=c.find((function(e){return e.uid===t})).friends;n.find((function(e){return e.uid===t})).status="added",s.find((function(t){return t.uid===e.uid})).status="added",m.collection("users").doc(e.uid).update({friends:n}),m.collection("users").doc(t).update({friends:s}),a((function(e){return e.filter((function(e){return e.uid!==t}))}))},function(t){var n=e.friends.filter((function(e){return e.uid!==t}));m.collection("users").doc(t).get().then((function(s){var c=s.data().friends.filter((function(t){return t.uid!==e.uid}));m.collection("users").doc(e.uid).update({friends:n}),m.collection("users").doc(t).update({friends:c}),a((function(e){return e.filter((function(e){return e.uid!==t}))}))}))}]},vn=function(){var e=xn(),t=Object(l.a)(e,3),n=t[0],s=t[1],c=t[2];return Object(v.jsx)(v.Fragment,{children:n.map((function(e,t){return Object(v.jsx)(gn,{person:e,addFriend:s,rejectFriend:c},t)}))})};function yn(e){var t=new Date(e.releaseDate);return(new Date).getTime()-t.getTime()<18144e5}var Sn=function(e){e.authorId;var t=e.authorsData,n=(e.headerColors,Object(s.useState)([])),c=Object(l.a)(n,2),a=c[0],r=c[1],i=Object(s.useState)([]),o=Object(l.a)(i,2),u=o[0],d=o[1];function h(){return(h=Object(b.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.isAuthor?K(t.ownSongs,"songs",r,(function(e){return e.forEach((function(e){yn(e)&&!u.includes(e)&&d((function(t){return[].concat(Object(T.a)(t),[e])}))})),e.sort((function(e,t){return t.listens-e.listens}))})):K(t.addedSongs.slice(0).reverse(),"songs",r);case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){!function(){h.apply(this,arguments)}(),d([])}),[t.ownSongs]),t.isAuthor?Object(v.jsxs)("div",{className:"TopSongs",children:[Object(v.jsx)(Yt,{listOfSongs:u,source:{source:"/authors/".concat(t.uid),name:t.displayName,image:t.photoURL,songsList:u},isNewSong:!0}),Object(v.jsx)(Yt,{listOfSongs:a,source:{source:"/authors/".concat(t.uid),name:t.displayName,image:t.photoURL,songsList:a},title:"Popular Songs",showListens:!0,showCount:!0,isHorizontal:!0})]}):Object(v.jsx)(Yt,{listOfSongs:a,source:{source:"/authors/".concat(t.uid),name:t.displayName+"'s Library",image:t.photoURL,songsList:a},title:t.displayName+"'s Library",showListens:!0,showCount:!0,isHorizontal:!0})},wn=function(e){var t=e.data,n=e.listOfChosenAuthors,s=e.setListOfChosenAuthors,c=e.shouldSaveSearchHistory,a=void 0!==c&&c,r=C().currentUser;return Object(v.jsxs)(i.b,{to:"/authors/".concat(t.uid),className:"AuthorItemBig",onClick:function(){a&&bt(r.uid,t.uid,"users")},children:[Object(v.jsx)(R,{listOfChosenItems:n,setListOfChosenItems:s,itemId:t.uid}),Object(v.jsxs)("div",{children:[Object(v.jsx)("div",{className:"AuthorItemBigImage",style:{backgroundImage:"url(".concat(t.photoURL,")")}}),Object(v.jsx)("h3",{children:t.displayName})]})]})},Nn=function(e){var t=e.listOfAuthors,n=e.title,c=void 0===n?"":n,a=e.listOfChosenAuthors,r=e.setListOfChosenAuthors,i=e.saveSearchHistory,o=Object(s.useState)(0),u=Object(l.a)(o,2),d=u[0],j=u[1],b=Object(s.useRef)(null),h=Object(s.useState)(!1),f=Object(l.a)(h,2),O=f[0],p=f[1];return Object(s.useEffect)((function(){t.length>0&&(b.current.scrollWidth>b.current.offsetWidth&&p(!0))}),[t]),t.length>0?Object(v.jsxs)("div",{className:"AuthorsList",children:[0!==c.length?Object(v.jsx)("h2",{children:c}):null,Object(v.jsx)("div",{className:"authorsWrapper",ref:b,onScroll:function(e){return j(e.target.scrollLeft)},children:t.map((function(e){return Object(v.jsx)(wn,{data:e,listOfChosenAuthors:a,setListOfChosenAuthors:r,shouldSaveSearchHistory:i},e.uid)}))}),Object(v.jsxs)("div",{className:"authorsShiftButtons",children:[Object(v.jsx)("button",{onClick:function(){var e=b.current.scrollLeft;b.current.scrollLeft=e-200,j(e-200)},style:d<=0?{visibility:"hidden",opacity:"0"}:{},children:Object(v.jsx)(ne.e,{})}),Object(v.jsx)("button",{onClick:function(){var e=b.current.scrollLeft;b.current.scrollLeft=e+200,j(e+200)},style:O&&null!==b.current&&b.current.scrollWidth-b.current.offsetWidth!==d?{}:{visibility:"hidden",opacity:"0"},children:Object(v.jsx)(ne.f,{})})]})]}):null};function Cn(e,t,n){var s=[];e.forEach((function(e){var t=e.authors;0!==t.length&&s.push(t)})),s=s.flat();for(var c=new Set(s.map((function(e){return e.uid})).filter((function(e){return e!==t.uid}))),a=Array.from(c),r=[],i=0;i<a.length;i++)for(var o=0;o<s.length;o++)if(a[i]===s[o].uid){r.push(s[o]);break}return n(r),r}function kn(e,t){return In.apply(this,arguments)}function In(){return(In=Object(b.a)(j.a.mark((function e(t,n){var s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0!==t&&void 0!==t.ownSongs&&0!==t.ownSongs.length&&(s=[],t.ownSongs.forEach(function(){var e=Object(b.a)(j.a.mark((function e(c,a){var r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("songs").doc(c).get();case 2:if(r=e.sent.data(),s.push(r),a!==t.ownSongs.length-1){e.next=6;break}return e.abrupt("return",Cn(s,t,n));case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var An=function(e){var t=e.data,n=Object(s.useState)([]),c=Object(l.a)(n,2),a=c[0],r=c[1];return Object(s.useEffect)((function(){kn(t,r)}),[t]),Object(v.jsx)(Nn,{listOfAuthors:a,title:"Similar Authors"})},Pn=(n(267),function(){var e=Object(o.h)("/authors/:authorId"),t=C().currentUser,n=Object(s.useState)([]),c=Object(l.a)(n,2),a=c[0],r=c[1],i=e.params.authorId,u=Object(s.useState)([]),d=Object(l.a)(u,2),h=d[0],f=d[1],O=Object(s.useState)(!0),p=Object(l.a)(O,2),g=p[0],x=p[1],y=Object(o.g)(),S=J().openBottomMessage;function w(){return(w=Object(b.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:m.collection("users").doc(i).get().then((function(e){e.exists?(f(e.data()),r(e.data().imageColors),x(!1)):y.push("/not-found")})).catch((function(e){console.log("Error getting document:",e),S("Failed to load author's data","failure")}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){!function(){w.apply(this,arguments)}()}),[i]),Object(v.jsx)(v.Fragment,{children:Object(v.jsx)("div",{className:"AuthorPage",style:{animation:"zoomIn .2s forwards"},children:g?Object(v.jsx)(Te,{}):Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(an,{data:h,headerColors:a,setHeaderColors:r}),Object(v.jsxs)(rn,{style:{display:"flex",flexDirection:"column",minHeight:"100%",borderRadius:"25px 25px 0 0",flex:"auto",position:"relative",overflow:"hidden",boxShadow:"0px 0px 100px #060606"},children:[Object(v.jsx)("div",{className:"content-background",style:{background:"linear-gradient(360deg, black, ".concat(a[0],")")}}),t.uid===h.uid?Object(v.jsx)(vn,{}):null,Object(v.jsx)(dn,{data:h}),Object(v.jsx)(Sn,{author:i,authorsData:h,headerColors:a}),h.friends&&!h.isAuthor?Object(v.jsx)(jn,{data:h,title:"Friends"}):null,Object(v.jsx)(mn,{authorsData:h,headerColors:a}),h.isAuthor?Object(v.jsx)(An,{data:h}):null]})]})})})}),Ln=function(e){var t=e.amountOfUnseen;return 0!==t&&Object(v.jsx)("div",{className:"AmountOfUnseenMessages",children:t})},Mn=function(e){var t=e.listOfSeen;return Object(v.jsx)("div",{className:"SeenByCircle",style:void 0!==t?t.length<=1?{opacity:"1",visibility:"visible"}:{}:null})},Tn=function(e){var t=e.typingPeople,n=Object(s.useState)([]),c=Object(l.a)(n,2),a=c[0],r=c[1],i=C().currentUser;return Object(s.useEffect)((function(){r([]),t.map(function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(t).get();case 2:(n=e.sent.data()).uid!==i.uid&&r((function(e){return[].concat(Object(T.a)(e),[n])}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[t]),a.length>0?Object(v.jsxs)("div",{className:"typingWrapper",children:[Object(v.jsx)(cn,{imagesList:a.map((function(e){return e.photoURL})),borderColor:"var(--navItemColor)"}),Object(v.jsxs)("div",{className:"TypingAnimation",children:[Object(v.jsx)("span",{className:"typingCircle"}),Object(v.jsx)("span",{className:"typingCircle"}),Object(v.jsx)("span",{className:"typingCircle"})]})]}):null},En=function(e){var t=e.sender,n=e.isGroup,c=e.message,a=e.showUnseenCircle,r=void 0!==a&&a,i=e.messageLen,o=void 0===i?30:i,u=(e.chatId,C().currentUser),d=Object(s.useState)(""),h=Object(l.a)(d,2),f=h[0],O=h[1],p=Object(s.useState)(!1),g=Object(l.a)(p,2),x=g[0],y=g[1],S=Object(s.useState)(""),w=Object(l.a)(S,2),N=w[0],k=w[1],I=[null,Object(v.jsx)(ne.t,{}),Object(v.jsx)(te.a,{}),Object(v.jsx)(ne.B,{})],A=Object(s.useState)(0),P=Object(l.a)(A,2),L=P[0],M=P[1],T=Object(s.useState)(!1),E=Object(l.a)(T,2),R=E[0],B=E[1];function D(){return(D=Object(b.a)(j.a.mark((function e(){var t,n,s,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===c){e.next=22;break}if(t=c,k((function(e){return e+t.message})),y(0!==t.message.length),!t.attachedSongs.length){e.next=10;break}return e.next=7,m.collection("songs").doc(t.attachedSongs[0]).get();case 7:n=e.sent.data().name,M(1),O((function(e){return e+n}));case 10:if(!t.attachedAlbums.length){e.next=16;break}return e.next=13,m.collection("playlists").doc(t.attachedAlbums[0]).get();case 13:(s=e.sent).exists?O((function(e){return e+s.data().name})):O((function(e){return e+"Deleted Album "})),M(2);case 16:if(!t.attachedAuthors.length){e.next=22;break}return e.next=19,m.collection("users").doc(t.attachedAuthors[0]).get();case 19:a=e.sent.data().displayName,M(3),O((function(e){return e+a}));case 22:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){m.collection("chats").where("participants","array-contains",u.uid).onSnapshot((function(e){e.docChanges().map(function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.doc.data(),"modified"===t.type&&n.messages.length&&(n.typing.length?B(!0):B(!1));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}))}),[]),Object(s.useEffect)((function(){!function(){D.apply(this,arguments)}()}),[]),R?Object(v.jsx)(Tn,{typingPeople:[t.uid]}):Object(v.jsxs)("div",{className:"messageShowOutside",children:[Object(v.jsxs)("span",{style:c.sender===u.uid||n?{marginRight:"5px"}:{},children:[" ","".concat(c.sender===u.uid?"You: ":n?(null===t||void 0===t?void 0:t.displayName)+": ":"")]}),re(N,o),x&&f.length?Object(v.jsx)(hn.a,{}):null,I[L],f,r&&Object(v.jsx)(Mn,{listOfSeen:c.seenBy})]})};var Rn=function(e){var t=e.chatData,n=C().currentUser,c=t.chatName,a=t.chatImage,r=t.participants,o=t.messages,u=Object(s.useState)({}),d=Object(l.a)(u,2),h=d[0],f=d[1],O=Object(s.useState)(0),p=Object(l.a)(O,2),g=p[0],x=p[1];function y(){return(y=Object(b.a)(j.a.mark((function e(){var t,s,a,i;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==c){e.next=8;break}return t=r.find((function(e){return e!==n.uid})),e.next=4,m.collection("users").doc(t).get();case 4:s=e.sent.data(),f(s),e.next=14;break;case 8:return a=o[o.length-1].sender,e.next=11,m.collection("users").doc(a).get();case 11:i=e.sent.data(),console.log(i,c),f(i);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){x(function(e,t){return e.reduce((function(e,n){return n.sender===t.uid||void 0===n.seenBy||n.seenBy.includes(t.uid)?e:++e}),0)}(o,n))}),[]),Object(s.useEffect)((function(){!function(){y.apply(this,arguments)}()}),[]),t&&(null===h||void 0===h?void 0:h.uid)?Object(v.jsx)(i.b,{to:"/chat/".concat(t.id),children:Object(v.jsxs)("div",{className:"ChatItem "+(g>0?"unseen":""),children:[Object(v.jsx)("div",{className:"chatItemImage",children:Object(v.jsx)("img",{loading:"lazy",src:a||h.photoURL,alt:""})}),Object(v.jsx)(Bt,{userUID:h.uid}),Object(v.jsxs)("div",{style:{width:"100%"},children:[Object(v.jsxs)("h4",{style:{display:"flex",justifyContent:"space-between",width:"100%"},children:[Object(v.jsx)("span",{children:c||h.displayName}),Object(v.jsxs)("div",{children:[o.length?Object(v.jsx)("span",{style:{opacity:".6",fontWeight:"500",fontSize:".8em"},children:U(o[o.length-1].sentTime,t&&Date.now()-new Date(o[o.length-1].sentTime).getTime()>86e6?0:2)}):null,Object(v.jsx)(Ln,{amountOfUnseen:g})]})]}),o.length?Object(v.jsx)("p",{style:o[o.length-1].sender!==n.uid?{color:"#fff"}:{},children:Object(v.jsx)(En,{sender:h,isGroup:c.length,message:o[o.length-1],showUnseenCircle:!0})}):null]})]})}):null},Bn=function(){var e=C().currentUser,t=J().toggleModal,n=$().yourFriends,c=Object(s.useState)(""),a=Object(l.a)(c,2),r=a[0],i=a[1],u=Object(s.useState)(n),d=Object(l.a)(u,2),j=d[0],b=d[1],h=Object(s.useState)([]),f=Object(l.a)(h,2),O=f[0],p=f[1],m=Object(s.useState)(""),g=Object(l.a)(m,2),x=g[0],v=g[1],y=Object(s.useState)(""),S=Object(l.a)(y,2),w=S[0],N=S[1],k=Object(s.useState)(""),I=Object(l.a)(k,2),A=(I[0],I[1]),P=we(),L=Object(o.g)(),M=Object(s.useState)(!1),E=Object(l.a)(M,2),R=E[0],B=E[1],D=Object(s.useState)(0),U=Object(l.a)(D,2),F=U[0],W=U[1],H=Object(s.useState)(!1),z=Object(l.a)(H,2),V=z[0],Y=z[1];Object(s.useEffect)((function(){O.length>=1&&Ce(O,e,B,W)}),[O]),Object(s.useEffect)((function(){0===w.length||0===O.length?Y(!1):Y(!0),A("")}),[O.length,w]);return{searchValue:r,setSearchValue:i,foundFriends:j,setFoundFriends:b,chosenFriends:O,setChosenFriends:p,chatName:w,setChatName:N,setChatCover:v,handleCreateChat:function(){R?V?Ne([e.uid].concat(Object(T.a)(O)),P,w,x,[e.uid]).then((function(){L.push("/chat/".concat(P)),t()})):A("Chat has to have a name"):(L.push("/chat/".concat(F)),t())},shouldCreate:R,allowedToCreate:V}},Dn=function(){var e=Bn(),t=e.searchValue,n=e.setSearchValue,s=e.foundFriends,c=e.setFoundFriends,a=e.chosenFriends,r=e.setChosenFriends,i=e.chatName,o=e.setChatName,u=e.setChatCover,l=e.handleCreateChat,d=e.shouldCreate,j=e.allowedToCreate;return Object(v.jsxs)("div",{className:"CreateChat",children:[Object(v.jsx)(Ge,{value:t,setValue:n,setResultAuthorList:c,focus:!0,inputText:"Search for friends",defaultSearchMode:"authors"}),Object(v.jsx)(et,{listOfPeople:s,chosenArray:a,setChosenArray:r,lastSeen:!0}),a.length>1&&d&&Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(_e,{title:"Chat name",value:i,setValue:o,placeholder:"Enter chat name"}),Object(v.jsx)(yt,{title:"Chat image",text:"Download chat image",place:"chatCovers/",setItemSrc:u,setImageLocalPath:function(){return null}})]}),Object(v.jsx)($e,{text:d?"Create Chat":"Go to chat",action:l,isActive:a.length>0&&(d&&j||!d)})]})},Un=(n(268),function(){var e=Object(s.useState)([]),t=Object(l.a)(e,2),n=t[0],c=t[1],a=J(),r=a.toggleModal,i=a.setContent,o=C().currentUser,u=Object(s.useState)(!0),d=Object(l.a)(u,2),j=d[0],b=d[1];return Object(s.useEffect)((function(){K(o.chats,"chats",c,(function(e){return e.sort((function(e,t){if(e.messages.length&&t.messages.length)return new Date(t.messages[t.messages.length-1].sentTime).getTime()-new Date(e.messages[e.messages.length-1].sentTime).getTime()}))}),(function(){return b(!1)}))}),[]),Object(v.jsx)("div",{style:{animation:"zoomIn .2s forwards",minHeight:"100%"},children:Object(v.jsxs)(rn,{children:[Object(v.jsx)("div",{style:{marginBottom:"10px",display:"flex",alignItems:"start",width:"100%"},children:Object(v.jsxs)("button",{className:"standartButton",onClick:function(){r(),i(Object(v.jsx)(Dn,{}))},children:[Object(v.jsx)(ne.v,{}),"Create chat"]})}),j?Object(v.jsx)(Te,{}):Object(v.jsx)("div",{className:"chatsWrapper",children:n.length?n.map((function(e,t){return Object(v.jsx)(Rn,{chatData:e},t)})):Object(v.jsx)("h3",{children:"No chats"})})]})})}),Fn=function(e){var t=e.date;return Object(v.jsx)("div",{className:"DateOnTop",children:U(t)})},Wn=n(67),Hn=function(){var e=Object(b.a)(j.a.mark((function e(t,n){var s,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("chats").doc(t).get();case 2:s=e.sent.data(),c=s.participants.filter((function(e){return e!==n.uid})),ke(t,s,"soundbubble","".concat(n.displayName," left the chat")),m.collection("chats").doc(t).update({participants:c});case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),zn=function(e){var t=e.chat,n=e.user,s=C().currentUser,c=J(),a=c.openConfirm,r=c.closeConfirm,i=c.setContent,o=s.uid===n.uid;return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(fe,{text:o?"quit chat":"kick"}),Object(v.jsx)(Ke,{onClick:function(){return a("Are you sure you want to ".concat(o?"leave":"kick ".concat(n.displayName," ")," from this chat?"),"Yes","No",(function(){Hn(t.id,n),r(),i(Object(v.jsx)(Qn,{data:t}))}))},icon:o?Object(v.jsx)(ne.o,{}):Object(v.jsx)(ne.F,{})})]})},Vn=function(e){var t=e.chatId,n=Object(s.useState)([]),c=Object(l.a)(n,2),a=c[0],r=c[1],i=Object(s.useState)(!0),o=Object(l.a)(i,2),u=o[0],d=o[1],h=Object(s.useState)(0),f=Object(l.a)(h,2),O=f[0],p=f[1],g=[Object(v.jsx)(Yt,{listOfSongs:a,source:{source:"/chat/".concat(t),name:"Chat with ".concat(t),image:"",songsList:a}}),Object(v.jsx)(Nn,{listOfAuthors:a}),Object(v.jsx)(pn,{listOfAlbums:a,loading:u})];function x(e,t){return y.apply(this,arguments)}function y(){return(y=Object(b.a)(j.a.mark((function e(n,s){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("chats").doc(t).get();case 2:e.sent.data().messages.forEach((function(e){e[n].length>0&&K(e[n],s,r,(function(e){return e}),(function(){return d(!1)}),void 0,1)}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){switch(O){case 0:x("attachedSongs","songs").then((function(){return d(!1)}));break;case 1:x("attachedAuthors","users").then((function(){return d(!1)}));break;case 2:x("attachedAlbums","playlists").then((function(){return d(!1)}))}}),[O]),Object(s.useEffect)((function(){r([])}),[t]),Object(v.jsxs)("div",{className:"AttachmentList",children:[Object(v.jsx)(ln,{pages:["Songs","Authors","Playlists"],currentPage:O,setCurrentPage:function(e){p(e),d(!0),r([])}}),u?Object(v.jsx)(Te,{}):a.length>0?g[O]:Object(v.jsx)("h2",{children:"Nothing here"})]})},Yn=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"uid",s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return s?e.filter((function(e){return!t.includes(e[n])})):e.filter((function(e){return t.includes(e[n])}))},qn=function(){var e=Object(b.a)(j.a.mark((function e(t,n,s,c){var a,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(!0),c(!1),e.next=4,m.collection("chats").doc(t).get();case 4:a=e.sent.data(),r=a.participants,n.forEach((function(e){return r.push(e.uid)})),m.collection("chats").doc(t).update({participants:r}),ke(t,a,"soundbubble","".concat(n.map((function(e){return e.displayName}))," entered the chat")),s(!1),c(!0);case 11:case"end":return e.stop()}}),e)})));return function(t,n,s,c){return e.apply(this,arguments)}}(),Gn=function(e){var t=e.chat,n=$().yourFriends,c=Object(s.useState)(""),a=Object(l.a)(c,2),r=a[0],i=a[1],o=Object(s.useState)([]),u=Object(l.a)(o,2),d=u[0],j=u[1],b=Object(s.useState)(!1),h=Object(l.a)(b,2),f=h[0],O=h[1],p=Object(s.useState)(!1),m=Object(l.a)(p,2),g=m[0],x=m[1],y=Yn(n,t.participants),S=Object(s.useState)([]),w=Object(l.a)(S,2),N=w[0],C=w[1];return Object(v.jsxs)("div",{children:[Object(v.jsx)(Ge,{value:r,setValue:i,setResultAuthorList:j,defaultSearchMode:"authors",defaultAuthorsListValue:y}),Object(v.jsx)(et,{listOfPeople:d,chosenArray:N,setChosenArray:C,lastSeen:!0}),!!N.length&&Object(v.jsx)($e,{text:"Add ".concat(N.length," friends"),action:function(){return qn(t.id,Yn(n,N,"uid",!1),O,x)},isLoading:f,completed:g,setCompleted:x,bottomMessage:"".concat(N.length," friends have been added to ").concat(t.chatName)})]})},Qn=function(e){var t=e.data,n=C().currentUser,c=Object(s.useState)([]),a=Object(l.a)(c,2),r=a[0],i=a[1],o=Object(s.useState)(!0),u=Object(l.a)(o,2),d=u[0],h=u[1],f=Object(s.useState)(t.chatName),O=Object(l.a)(f,2),g=O[0],x=O[1],y=Object(s.useState)(t.chatImage),S=Object(l.a)(y,2),w=S[0],N=S[1],k=Object(s.useState)(""),I=Object(l.a)(k,2),A=I[0],P=I[1],L=Object(s.useState)(t.imageColors||[]),M=Object(l.a)(L,2),T=M[0],E=M[1],R=J().setContent,B=Object(s.useState)(0),D=Object(l.a)(B,2),U=D[0],F=D[1],W=Object(s.useState)(!1),H=Object(l.a)(W,2),z=H[0],Y=H[1];function q(){return(q=Object(b.a)(j.a.mark((function e(t,n,s){var c,a,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=t.target.files[0],P(URL.createObjectURL(c)),a=p.ref(),r=a.child(n+c.name),e.next=6,r.put(c);case 6:return e.t0=s,e.next=9,r.getDownloadURL();case 9:e.t1=e.sent,(0,e.t0)(e.t1);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){h(!0),K(t.participants,"users",i,(function(e){return e}),(function(){return h(!1)}))}),[t.id]),Object(s.useEffect)((function(){g.trim()!==t.chatName.trim()||w!==t.chatImage?Y(!0):Y(!1)}),[g,w]),Object(s.useEffect)((function(){x(t.chatName)}),[t.id]),Object(s.useEffect)((function(){x(t.chatName),N(t.chatImage)}),[t.chatName,t.chatImage]),Object(v.jsxs)("div",{className:"ChatInfo",children:[Object(v.jsx)(be.a,{src:A,getColors:function(e){return E(e)}}),Object(v.jsxs)("div",{className:"chatInfoImageAndName",children:[Object(v.jsxs)("div",{className:"chatInfoImage",children:[Object(v.jsxs)("label",{className:"changePhoto",children:[Object(v.jsx)(Oe.b,{}),"Change photo",Object(v.jsx)("input",{type:"file",style:{display:"none"},onChange:function(e){return function(e,t,n){return q.apply(this,arguments)}(e,"chatCovers/",N)}})]}),Object(v.jsx)("img",{loading:"lazy",src:w,alt:""})]}),Object(v.jsxs)("div",{children:[Object(v.jsx)(_e,{value:g,setValue:x,placeholder:"Enter chat name",required:!0}),Object(v.jsxs)("div",{className:"chatInfoButtons",children:[Object(v.jsxs)("button",{className:"chatInfoButton",children:[Object(v.jsx)(ne.y,{}),"Settings"]}),Object(v.jsxs)("button",{className:"chatInfoButton",onClick:function(){return R(Object(v.jsx)(Vn,{chatId:t.id}))},children:[Object(v.jsx)(ze.a,{}),re("Attachments",7)]}),Object(v.jsxs)("button",{className:"chatInfoButton",children:[Object(v.jsx)(Wn.b,{}),"Sound"]})]})]}),z?Object(v.jsx)("button",{className:"standartButton",onClick:function(){m.collection("chats").doc(t.id).update({chatName:g,chatImage:w,imageColors:T})},children:"Update Chat"}):null]}),Object(v.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[Object(v.jsx)("h4",{children:"Chat participants"}),Object(v.jsx)(Ke,{text:"Add",icon:Object(v.jsx)(ne.D,{}),onClick:function(){return R(Object(v.jsx)(Gn,{chat:t}))}})]}),Object(v.jsx)(ln,{pages:["All participants","Administrators"],currentPage:U,setCurrentPage:F}),d?Object(v.jsx)(Te,{}):r.map((function(e){return 1!==U?Object(v.jsx)(V,{data:e,lastSeen:!0,rightButton:e.uid===n.uid?Object(v.jsx)(zn,{chat:t,user:n}):t.admins.includes(n.uid)?Object(v.jsx)(zn,{chat:t,user:e}):null},e.uid):t.admins.includes(e.uid)?Object(v.jsx)(V,{data:e,lastSeen:!0},e.uid):void 0}))]})},Kn=function(e){var t=e.chatId,n=e.image,s=e.currentWallpaper;return Object(v.jsx)("div",{className:"WallpaperItem "+(n===s?"active":""),onClick:function(){m.collection("chats").doc(t).update({wallpaper:n})},style:"undefined"===n?{background:"var(--playlistsColor)"}:{},children:"undefined"!==n?Object(v.jsx)("img",{loading:"lazy",src:n,alt:""}):null})},Xn=function(e){var t=e.chatId,n=e.currentWallpaper,c=Object(s.useState)([]),a=Object(l.a)(c,2),r=a[0],i=a[1],o=Object(s.useState)(!0),u=Object(l.a)(o,2),d=u[0];return function(e,t,n,c,a,r,i,o){var u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:[];function l(){return d.apply(this,arguments)}function d(){return(d=Object(b.a)(j.a.mark((function s(){var u;return j.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(u=[],void 0!==n){s.next=15;break}if(void 0===r){s.next=9;break}return s.next=5,m.collection(t).where(r,i,o).get();case 5:s.sent.docs.forEach((function(e){u.push(e.data())})),s.next=13;break;case 9:return s.next=11,m.collection(t).get();case 11:s.sent.docs.forEach((function(e){u.push(e.data())}));case 13:s.next=18;break;case 15:return s.next=17,n.forEach(function(){var e=Object(b.a)(j.a.mark((function e(s,r){var i;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection(t).doc(s).get();case 2:i=e.sent.data(),u.push(i),r===n.length-1&&(void 0!==a?(u.sort(a),c(u)):c(u));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 17:e(!1);case 18:return s.abrupt("return",u);case 19:case"end":return s.stop()}}),s)})))).apply(this,arguments)}Object(s.useEffect)((function(){e(!0),c([]),l().then((function(t){void 0===n&&(c(t),e(!1))}))}),u)}(u[1],"chatWallpapers",void 0,i),d?Object(v.jsx)(Te,{}):Object(v.jsxs)("div",{className:"Wallpapers",children:[Object(v.jsx)("h2",{children:"Wallpapers"}),Object(v.jsxs)("div",{className:"wallpapreWrapper",children:[Object(v.jsx)(Kn,{chatId:t,image:"undefined"}),r.map((function(e,s){return Object(v.jsx)(Kn,{chatId:t,image:e.image,currentWallpaper:n},e.id)}))]})]})},Jn=function(e){var t=e.chatId,n=e.currentWallpaper,c=e.data,a=Object(s.useState)(),r=Object(l.a)(a,2),i=r[0],o=r[1],u=J(),d=u.toggleModal,j=u.setContent,b=Object(s.useRef)(null);return jt(b,o),Object(v.jsxs)("div",{className:"ChatMoreBtn",ref:b,children:[Object(v.jsx)("button",{onClick:function(){return o(!i)},children:Object(v.jsx)(ne.r,{})}),Object(v.jsxs)("div",{className:"chatHeaderMenuWindow",style:i?{}:{display:"none"},children:[c.participants.length>2?Object(v.jsxs)("div",{className:"chatHeaderMenuWindowItem",onClick:function(){d(),j(Object(v.jsx)(Qn,{data:c}))},children:[Object(v.jsx)(ne.n,{}),Object(v.jsx)("span",{children:"Info"})]}):null,Object(v.jsxs)("div",{className:"chatHeaderMenuWindowItem",onClick:function(){d(),j(Object(v.jsx)(Vn,{chatId:t}))},children:[Object(v.jsx)(ne.j,{}),Object(v.jsx)("span",{children:"Attachments"})]}),Object(v.jsxs)("div",{className:"chatHeaderMenuWindowItem",onClick:function(){d(),j(Object(v.jsx)(Xn,{chatId:t,currentWallpaper:n}))},children:[Object(v.jsx)(ne.m,{}),Object(v.jsx)("span",{children:"Change wallpaper"})]})]})]})},_n=function(e){var t=e.data,n=C().currentUser,c=J(),a=c.toggleModal,r=c.setContent,o=Object(s.useState)({}),u=Object(l.a)(o,2),d=u[0],h=u[1],f=Object(s.useState)(""===t.chatName?[]:t.imageColors),O=Object(l.a)(f,2),p=O[0],g=O[1];function x(){return(x=Object(b.a)(j.a.mark((function e(){var s,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=t.participants.find((function(e){return e!==n.uid})),e.next=3,m.collection("users").doc(s).get();case 3:c=e.sent.data(),h(c),g(c.imageColors);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){""===t.chatName&&function(){x.apply(this,arguments)}()}),[t.id]),Object(v.jsxs)("div",{className:"ChatHeader",style:p.length?{background:"linear-gradient(45deg, ".concat(p[0],", ").concat(p[1],")")}:{},children:[Object(v.jsx)(en,{}),2===t.participants.length?Object(v.jsxs)(i.b,{className:"chatHeaderImageAndName",to:"/authors/".concat(d.uid),children:[Object(v.jsx)("div",{className:"chatHeaderImage",style:{backgroundImage:"url(".concat(d.photoURL||t.chatImage,")")}}),Object(v.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center"},children:[Object(v.jsx)("h4",{children:d.displayName||t.chatName}),Object(v.jsx)(W,{userUID:d.uid})]})]}):Object(v.jsxs)("div",{className:"chatHeaderImageAndName",onClick:function(){a(),r(Object(v.jsx)(Qn,{data:t}))},children:[Object(v.jsx)("div",{className:"chatHeaderImage",style:{backgroundImage:"url(".concat(d.photoURL||t.chatImage,")")}}),Object(v.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center"},children:[Object(v.jsx)("h4",{children:d.displayName||t.chatName}),Object(v.jsx)(W,{userUID:d.uid})]})]}),Object(v.jsx)(Jn,{chatId:t.id,data:t,currentWallpaper:t.wallpaper})]})};function Zn(e){return e.attachedSongs.length?"Audio":e.attachedAlbums.length?"Album":e.attachedAuthors.length?"Author":e.inResponseToMessage&&e.inResponseToMessage.length?"Forwarded message":""}var $n=function(e){var t=e.attachedItems,n=e.setAttachedItems,s=e.icon;return Object(v.jsx)("div",{className:"AttachedItemsInChatInput",children:t.map((function(e,c){return Object(v.jsxs)("div",{className:"attachedSongItem",children:[s,Object(v.jsx)("span",{children:e}),Object(v.jsx)("button",{className:"removeMessageFromResponse",onClick:function(){return function(e,t,n){t(e.filter((function(e){return e!==n})))}(t,n,e)},children:Object(v.jsx)(ne.F,{})})]},e)}))})},es=function(e){var t=e.chatId,n=e.chatData,c=e.messageText,a=e.setMessageText,r=e.inResponseToMessage,i=e.setInResponseToMessage,o=e.otherMessages,u=C().currentUser,d=Object(s.useState)(!1),h=Object(l.a)(d,2),f=h[0],O=h[1],p=$(),g=p.yourSongs,x=p.yourAuthors,y=p.yourPlaylists,S=Object(s.useState)(""),w=Object(l.a)(S,2),N=w[0],k=w[1],I=Object(s.useState)(g),A=Object(l.a)(I,2),P=A[0],L=A[1],M=Object(s.useState)([]),E=Object(l.a)(M,2),R=E[0],B=E[1],D=Object(s.useState)([]),U=Object(l.a)(D,2),F=U[0],W=U[1],H=Object(s.useState)([]),z=Object(l.a)(H,2),V=z[0],Y=z[1],q=Object(s.useState)(y),G=Object(l.a)(q,2),Q=G[0],K=G[1],X=Object(s.useState)(x),J=Object(l.a)(X,2),_=J[0],Z=J[1],ee=Object(s.useState)([]),se=Object(l.a)(ee,2),ce=se[0],ae=se[1],ie=Object(s.useState)([]),oe=Object(l.a)(ie,2),ue=oe[0],le=oe[1],de=Object(s.useRef)(null);function je(){ke(t,n,u.uid,c,R,F,V,r),a(""),B([]),Y([]),W([]),i([]),O(!1)}return jt(de,O),Object(s.useEffect)((function(){0===N.length&&L(g)}),[N]),Object(s.useEffect)((function(){if(0===c.length)m.collection("chats").doc(t).update({typing:n.typing.filter((function(e){return e!==u.uid}))});else if(!n.typing.includes(u.uid)){var e=n.typing;e.push(u.uid),m.collection("chats").doc(t).update({typing:e})}}),[c]),Object(s.useEffect)((function(){ae([]),r.forEach(function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(o[t].sender).get();case 2:n=e.sent.data().displayName,ae((function(e){return[].concat(Object(T.a)(e),[n])}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[r.length]),Object(s.useEffect)((function(){le([]),R.forEach(function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("songs").doc(t).get();case 2:n=e.sent.data().name,le((function(e){return[].concat(Object(T.a)(e),[n])}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[R.length]),Object(v.jsxs)("div",{className:"chatInput",style:f?{borderRadius:"0 0 var(--standartBorderRadius) var(--standartBorderRadius)",transition:".2s"}:{},ref:de,children:[Object(v.jsx)("div",{className:"attachWindow",style:f?{height:"400px",opacity:"1"}:{},children:f?Object(v.jsxs)("div",{style:f?{maxHeight:"100%",overflow:"hidden",display:"flex",flexDirection:"column"}:{display:"none"},children:[Object(v.jsx)(Ge,{value:N,setValue:k,setAllFoundSongs:L,setResultPlaylists:K,setResultAuthorList:Z}),Object(v.jsxs)("div",{style:{height:"100%",overflowY:"auto"},children:[Object(v.jsx)(Yt,{listOfSongs:P,source:"no",listOfChosenSongs:R,setListOfSongs:B}),Object(v.jsx)(Nn,{listOfAuthors:_,listOfChosenAuthors:V,setListOfChosenAuthors:Y}),Object(v.jsx)(pn,{listOfAlbums:Q,loading:!1,listOfChosenAlbums:F,setListOfChosenAlbums:W})]})]}):null}),Object(v.jsxs)("div",{className:"inResponseArea",style:r.length||ue.length||V.length||F.length?{}:{height:"0",padding:"0",opacity:"0",top:"0",visibility:"hidden"},children:[Object(v.jsx)("div",{className:"responseMessages",children:r.map((function(e,t){return Object(v.jsxs)("div",{className:"responseItem",children:[Object(v.jsx)("h5",{style:o[e].sender===u.uid?{color:"var(--lightPurple)"}:{},children:ce[t]}),Object(v.jsxs)("p",{children:[re(o[e].message,35),Object(v.jsx)("span",{style:{marginLeft:"5px",color:"var(--reallyLightBlue)"},children:Zn(o[e])})]}),Object(v.jsx)("button",{onClick:function(){return t=e,void i(r.filter((function(e){return e!==t})));var t},className:"removeMessageFromResponse",children:Object(v.jsx)(ne.F,{})})]},e)}))}),Object(v.jsx)($n,{attachedItems:R,setAttachedItems:B,icon:Object(v.jsx)(nt.c,{})}),Object(v.jsx)($n,{attachedItems:V,setAttachedItems:Y,icon:Object(v.jsx)(ne.B,{})}),Object(v.jsx)($n,{attachedItems:F,setAttachedItems:W,icon:Object(v.jsx)(te.a,{})})]}),Object(v.jsxs)("div",{className:"attachAndEmojis",children:[Object(v.jsx)("div",{className:"attachBtn",children:Object(v.jsx)("button",{onClick:function(){O(!f)},children:Object(v.jsx)(ze.a,{})})}),Object(v.jsx)("input",{type:"text",style:{background:"var(--lightGrey)",border:"none",outline:"none",minHeight:"100%"},value:c,onChange:function(e){a(e.target.value)},onKeyDown:function(e){"Enter"===e.key&&je()}})]}),Object(v.jsx)("button",{className:"sendBtn",onClick:function(){je()},children:Object(v.jsx)(Oe.d,{})})]})},ts=n(52);function ns(e){var t=Object(s.useState)(!1),n=Object(l.a)(t,2),c=n[0],a=n[1],r=new IntersectionObserver((function(e){var t=Object(l.a)(e,1)[0];return a(t.isIntersecting)}));return Object(s.useEffect)((function(){return r.observe(e.current),function(){r.disconnect()}}),[]),c}var ss,cs,as,rs,is,os=function(e,t,n){var c=Object(s.useRef)(),a=ns(c),r=C().currentUser;return Object(s.useEffect)((function(){if(void 0!==t.seenBy&&r.uid!==t.sender&&a&&!t.seenBy.includes(r.uid)){var s=n;s[t.id].seenBy.push(r.uid),m.collection("chats").doc(e).update({messages:s})}}),[a]),[c,a]},us=function(){return Object(v.jsx)("div",{className:"SongItem SongItemLoading",children:Object(v.jsxs)("div",{className:"songItemImageAndName",children:[Object(v.jsx)("div",{className:"songItemImage"}),Object(v.jsxs)("div",{className:"songItemNameAndAuthor",children:[Object(v.jsx)("div",{className:"songItemName"}),Object(v.jsx)("div",{className:"songItemAuthor"})]})]})})},ls=function(e){var t=e.messageData,n=e.chatId,c=e.scrollToMessageRef,a=e.setScrollToMessageId,r=e.scrollToMessageId,i=e.showPhoto,o=void 0===i||i,u=e.otherMessages,d=e.inResponseToMessageArr,h=e.setInResponseToMessageArr,f=C().currentUser,O=A(),p=O.isMobile,g=O.screenHeight,x=t.message,y=t.attachedAlbums,S=t.attachedSongs,w=t.attachedAuthors,N=t.sender,k=t.inResponseToMessage,I=t.id,P=t.sentTime,L=Object(s.useState)({}),M=Object(l.a)(L,2),E=M[0],R=M[1],B=U(P,2),D=Object(s.useState)([]),F=Object(l.a)(D,2),W=F[0],H=F[1],z=Object(s.useState)([]),V=Object(l.a)(z,2),Y=V[0],q=V[1],G=Object(s.useState)([]),Q=Object(l.a)(G,2),K=Q[0],X=Q[1],J=Object(s.useState)([]),_=Object(l.a)(J,2),Z=_[0],$=_[1],ee=Object(s.useState)([]),ne=Object(l.a)(ee,2),se=ne[0],ce=ne[1],ae=os(n,t,u),re=Object(l.a)(ae,2),ie=re[0],oe=re[1],ue=Object(s.useState)(0),le=Object(l.a)(ue,2),de=le[0],je=le[1],be=Object(s.useState)(0),he=Object(l.a)(be,2),fe=he[0],Oe=he[1],pe=Object(ts.useSwipeable)({onSwiping:function(e){e.deltaX<0&&je(e.deltaX)}});function me(){return(me=Object(b.a)(j.a.mark((function e(){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(t.sender).get();case 2:n=e.sent.data(),R(n);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ge(e,t,n){return e.forEach(function(){var e=Object(b.a)(j.a.mark((function e(s){var c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection(t).doc(s).get();case 2:(c=e.sent).exists?n((function(e){return[].concat(Object(T.a)(e),[c.data()])})):n((function(e){return[].concat(Object(T.a)(e),[null])}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}function xe(){d.includes(I)||h((function(e){return[].concat(Object(T.a)(e),[I])}))}function ve(){var e;clearTimeout(e),Oe(.2),e=setTimeout((function(){je(0),Oe(0)}),200)}return Object(s.useEffect)((function(){!function(){me.apply(this,arguments)}(),ge(S,"songs",H),ge(w,"users",q),ge(y,"playlists",X),null!==k&&k.forEach(function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return $((function(e){return[].concat(Object(T.a)(e),[u[t]])})),e.next=3,m.collection("users").doc(u[t].sender).get();case 3:n=e.sent.data().displayName,ce((function(e){return[n].concat(Object(T.a)(e))}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]),Object(s.useEffect)((function(){de<-160&&(ve(),xe())}),[de]),Object(v.jsxs)("div",{className:"MessageItem "+(N===f.uid?"your":""),ref:I===r?c:function(e){pe.ref(e),ie.current=e},style:o?{paddingBottom:"15px",transform:"translateX(".concat(de,"px)"),transition:fe}:{transform:"translateX(".concat(de,"px)"),transition:fe},onTouchEnd:ve,children:[Object(v.jsx)("div",{className:"messageItemImage",children:o?Object(v.jsx)("img",{loading:"lazy",src:E.photoURL,alt:""}):null}),Object(v.jsxs)("div",{className:"messageItemBody",style:I===r?{animation:"showResponseMessage .5s forwards"}:o?{borderRadius:"var(--standartBorderRadius2) var(--standartBorderRadius) var(--standartBorderRadius) 5px"}:{},children:[Object(v.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"5px"},children:[Object(v.jsx)("h5",{className:"messageUserName",children:E.displayName}),Object(v.jsx)("div",{style:{fontSize:".7em",opacity:".8",marginLeft:"10px"},children:B})]}),null!==k?Z.map((function(e,t){return Object(v.jsxs)("div",{className:"responseItem",onClick:function(){return a(e.id)},children:[Object(v.jsxs)("span",{style:{display:"flex",alignItems:"center"},children:[Object(v.jsx)("h5",{style:e.sender===f.uid?{color:"var(--lightPurple)"}:{},children:se[t]}),Object(v.jsx)("div",{style:{fontSize:".7em",opacity:".8",marginLeft:"10px"},children:U(e.sentTime,2)})]}),Object(v.jsxs)("p",{children:[e.message,Object(v.jsx)("span",{style:{marginLeft:"5px",color:"var(--reallyLightBlue)"},children:Zn(e)})]})]})})):null,Object(v.jsxs)("div",{children:[Object(v.jsx)("p",{children:x}),W.map((function(e,t){return oe?Object(v.jsx)(gt,{song:e,localIndex:t,position:g},t):Object(v.jsx)(us,{})})),K.map((function(e,t){return Object(v.jsx)(On,{playlist:e},t)})),Y.map((function(e,t){return Object(v.jsx)(wn,{data:e},t)}))]})]}),Object(v.jsx)(Mn,{listOfSeen:t.seenBy}),Object(v.jsx)("button",{className:"respondToMessageBtn",onClick:xe,style:p?{opacity:-de/80}:{},children:Object(v.jsx)(te.o,{})})]})},ds=function(e){var t=e.message,n=e.index,c=e.messageList,a=e.chatId,r=e.inResponseToMessage,i=e.setInResponseToMessage,o=e.scrollToMessageRef,u=e.scrollToMessageId,d=e.setScrollToMessageId,j=e.setDateRefsArray,b=Object(s.useState)(!1),h=Object(l.a)(b,2),f=h[0],O=h[1],p=Object(s.useState)(!1),m=Object(l.a)(p,2),g=m[0],x=m[1],y=Object(s.useRef)(null);return Object(s.useEffect)((function(){(n===c.length-1||c[n+1].sender!==c[n].sender||U(c[n+1].sentTime)!==U(c[n].sentTime))&&O(!0),(0===n||U(c[n].sentTime)!==U(c[n-1].sentTime))&&x(!0)}),[]),Object(s.useEffect)((function(){null!==y.current&&j((function(e){return[].concat(Object(T.a)(e),[y])}))}),[g]),Object(v.jsxs)(v.Fragment,{children:[g?Object(v.jsx)("div",{ref:y,style:{width:"100%",display:"flex",justifyContent:"center",alignItems:"center",padding:"10px 0"},children:U(t.sentTime)}):null,Object(v.jsx)(ls,{messageData:t,chatId:a,scrollToMessageRef:o,scrollToMessageId:u,setScrollToMessageId:d,showPhoto:f,otherMessages:c,inResponseToMessageArr:r,setInResponseToMessageArr:i},t.id)]})},js=H.a.div(ss||(ss=Object(M.a)(["\n  width: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  opacity: 0.5;\n"]))),bs=function(e){var t=e.chatId,n=e.message,s=e.messageList,c=os(t,n,s),a=Object(l.a)(c,2),r=a[0];a[1];return Object(v.jsx)(js,{ref:r,children:n.message})},hs=function(e){var t=e.chatId,n=e.messageList,c=e.inResponseToMessage,a=e.setInResponseToMessage,r=e.messagesWindowRef,i=e.setDateRefsArray,o=Object(s.useRef)(null),u=Object(s.useState)(-1),d=Object(l.a)(u,2),j=d[0],b=d[1];return Object(s.useEffect)((function(){-1!==j&&(r.current.scrollTo(0,o.current.offsetTop-65<0?0:o.current.offsetTop-65),setTimeout((function(){b(-1)}),500))}),[j]),n.length?Object(v.jsx)(v.Fragment,{children:n.map((function(e,s){return"soundbubble"!==e.sender?Object(v.jsx)(ds,{message:e,index:s,messageList:n,chatId:t,inResponseToMessage:c,setInResponseToMessage:a,scrollToMessageRef:o,scrollToMessageId:j,setScrollToMessageId:b,setDateRefsArray:i},e.id):Object(v.jsx)(bs,{chatId:t,message:e,messageList:n})}))}):null},fs=function(e){var t=e.chatId,n=e.chatData,c=e.messageList,a=e.findTopDate,r=e.inResponseToMessage,i=e.setInResponseToMessage,o=e.setDateRefsArray,u=A(),l=u.screenHeight,d=u.isMobile,j=Object(s.useRef)(null);return Object(s.useEffect)((function(){setTimeout((function(){!function(){var e,t,n,s=(null===(e=j.current)||void 0===e?void 0:e.scrollHeight)-(null===(t=j.current)||void 0===t?void 0:t.clientHeight);null===(n=j.current)||void 0===n||n.scrollTo(0,s)}()}),200)}),[c]),Object(v.jsxs)("div",{className:"chatMessagesWindow",ref:j,onScroll:a,style:{height:d?l-125+"px":l-105+"px"},children:[Object(v.jsx)(hs,{chatId:t,messageList:c,inResponseToMessage:r,setInResponseToMessage:i,messagesWindowRef:j,setDateRefsArray:o}),Object(v.jsx)(Tn,{typingPeople:n.typing})]})},Os=function(){var e=Object(o.h)("/chat/:chatId"),t=C().currentUser,n=e.params.chatId,c=Object(s.useState)(""),a=Object(l.a)(c,2),r=a[0],i=a[1],u=Object(s.useState)([]),d=Object(l.a)(u,2),j=d[0],b=d[1],h=Object(s.useState)([]),f=Object(l.a)(h,2),O=f[0],p=f[1],g=Object(o.g)(),x=function(e,t){var n=Object(s.useState)(null),c=Object(l.a)(n,2),a=c[0],r=c[1],i=Object(s.useState)([]),o=Object(l.a)(i,2),u=o[0],d=o[1],j=Object(s.useState)(!0),b=Object(l.a)(j,2),h=b[0],f=b[1],O=Object(s.useState)(""),p=Object(l.a)(O,2),g=p[0],x=p[1];return Object(s.useEffect)((function(){var t=m.collection("chats").doc(e).onSnapshot((function(e){var t,n;r(e.data()),d(null===(t=e.data())||void 0===t?void 0:t.messages),x((null===(n=e.data())||void 0===n?void 0:n.messages.length)?e.data().messages[0].sentTime:(new Date).toString()),f(!1)}));return function(){t()}}),[m,e]),[a,u,h,g,function(e){t.forEach((function(t){null!==t.current&&t.current.offsetTop-70<=e.target.scrollTop&&x(t.current.innerHTML)}))}]}(n,O),y=Object(l.a)(x,5),S=y[0],w=y[1],N=y[2],k=y[3],I=y[4];return Object(s.useEffect)((function(){void 0===S?g.push("/not-found"):void 0!==(null===S||void 0===S?void 0:S.participants)&&(S.participants.includes(t.uid)||g.push("/chat"))}),[S]),null!==S&&void 0!==S?Object(v.jsxs)("div",{className:"DialoguePage",style:{height:"100%"},children:[N?Object(v.jsx)(Te,{top:"50%"}):Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(_n,{data:S}),Object(v.jsx)(Fn,{date:k}),Object(v.jsx)(fs,{chatId:n,chatData:S,messageList:w,findTopDate:I,setDateRefsArray:p,inResponseToMessage:j,setInResponseToMessage:b}),Object(v.jsx)(es,{chatId:n,chatData:S,messageText:r,setMessageText:i,inResponseToMessage:j,setInResponseToMessage:b,otherMessages:w})]}),"undefined"!==(null===S||void 0===S?void 0:S.wallpaper)?Object(v.jsx)("img",{loading:"lazy",src:S.wallpaper,className:"chatWallpaper",alt:""}):null]}):null},ps=function(){var e=Object(s.useState)([]),t=Object(l.a)(e,2),n=t[0],c=t[1],a=Object(s.useState)([]),r=Object(l.a)(a,2),i=r[0],o=r[1],u=C().currentUser;return Object(s.useEffect)((function(){m.collection("history").doc(u.uid).onSnapshot((function(e){c(e.data().history)}))}),[m]),Object(s.useEffect)((function(){K(n,"songs",o)}),[n]),Object(v.jsx)("div",{className:"HistoryPage",style:{animation:"zoomIn .2s forwards"},children:Object(v.jsxs)(rn,{children:[Object(v.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[Object(v.jsx)(en,{}),Object(v.jsx)("h2",{style:{margin:"0px",marginLeft:"8px"},children:"History"})]}),Object(v.jsx)(Yt,{listOfSongs:i,source:{source:"/history",name:"History",image:"https://www.seekpng.com/png/full/781-7815113_history-icon-white-png.png",songsList:i},showCount:!0,showSearch:!0,displayIfEmpty:"Nothing here"})]})})},ms=function(){var e=Object(s.useState)([]),t=Object(l.a)(e,2),n=t[0],c=t[1],a=Object(s.useState)(0),r=Object(l.a)(a,2),i=r[0],o=r[1],u=Object(s.useState)(!0),d=Object(l.a)(u,2),h=d[0],f=d[1],O=Object(s.useState)({}),p=Object(l.a)(O,2),g=p[0],x=p[1],y=Object(s.useState)({}),S=Object(l.a)(y,2),w=S[0],N=S[1],C=Object(s.useState)({}),k=Object(l.a)(C,2),I=k[0],A=k[1];function P(e,t,n){return L.apply(this,arguments)}function L(){return(L=Object(b.a)(j.a.mark((function e(t,n,s){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection(n).orderBy(s,"desc").limit(1).get();case 2:a=e.sent.docs[0].data(),t(a),c((function(e){return[].concat(Object(T.a)(e),[a.imageColors[0]])})),"playlists"===n&&f(!1);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){P(x,"users","subscribers"),P(N,"songs","listens"),P(A,"playlists","listens")}),[]),Object(v.jsx)("div",{className:"MainBanner",style:{background:n[i]},children:h?Object(v.jsx)(Te,{}):Object(v.jsxs)(v.Fragment,{children:[Object(v.jsxs)("div",{className:"slider",children:[Object(v.jsxs)("div",{className:"sliderItem "+(0===i?"current":""),style:{transform:"translateX(-".concat(100*i,"%)")},children:[Object(v.jsx)("h3",{children:"Most popular artist on platform"}),Object(v.jsx)(wn,{data:g})]}),Object(v.jsxs)("div",{className:"sliderItem "+(1===i?"current":""),style:{transform:"translateX(-".concat(100*i,"%)")},children:[Object(v.jsx)("h3",{children:"Most popular song on platform"}),Object(v.jsx)(gt,{song:w,localIndex:0,showListens:!0})]}),Object(v.jsxs)("div",{className:"sliderItem "+(2===i?"current":""),style:{transform:"translateX(-".concat(100*i,"%)")},children:[Object(v.jsx)("h3",{children:"Most popular album on platform"}),Object(v.jsx)(On,{playlist:I})]})]}),Object(v.jsxs)("div",{className:"sliderBtns",children:[Object(v.jsx)("button",{onClick:function(){return o(Q(i-1,2,0))},children:Object(v.jsx)(te.c,{})}),Object(v.jsx)("button",{onClick:function(){return o(Q(i+1,2,0))},children:Object(v.jsx)(te.d,{})})]})]})})},gs=function(){var e=$().yourAuthors,t=Object(s.useState)([]),n=Object(l.a)(t,2),c=n[0],a=n[1];return Object(s.useEffect)((function(){void 0!==e&&0!==e.length&&0===c.length&&function(){var t=[];e.forEach((function(e,n){e.ownSongs.forEach(function(){var e=Object(b.a)(j.a.mark((function e(n){var s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("songs").doc(n).get();case 2:yn(s=e.sent.data())&&!t.includes(s.id)&&(a((function(e){return[].concat(Object(T.a)(e),[s])})),t.push(s.id));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}))}()}),[]),Object(v.jsx)("div",{children:Object(v.jsx)(Yt,{listOfSongs:c,source:{source:"/home",name:"New Songs",image:"",songsList:c},title:"New Songs",isNewSong:!0})})},xs=function(){var e=$().yourAuthors,t=Object(s.useState)([]),n=Object(l.a)(t,2),c=n[0],a=n[1],r=Object(s.useState)([]),i=Object(l.a)(r,2),o=i[0],u=i[1],d=C().currentUser;return Object(s.useEffect)((function(){void 0!==e&&e.forEach((function(e){kn(e,a)}))}),[]),Object(s.useEffect)((function(){c.forEach((function(e){var t=o.map((function(e){return e.uid}));d.addedAuthors.includes(e.uid)||t.includes(e.uid)||u((function(t){return[].concat(Object(T.a)(t),[e])}))}))}),[c]),Object(v.jsx)("div",{className:"RecommendedAuthors",children:Object(v.jsx)(Nn,{listOfAuthors:o,title:"Recommended Authors"})})},vs=function(e){var t=e.message,n=e.image,s=e.button;return Object(v.jsx)("div",{className:"importantMessage",children:Object(v.jsxs)("div",{children:[n?Object(v.jsx)("img",{loading:"lazy",src:n,alt:""}):null,Object(v.jsx)("h3",{children:t}),s||null]})})},ys=function(){var e=$().yourAuthors,t=C().currentUser,n=Object(s.useState)([]),c=Object(l.a)(n,2),a=c[0],r=c[1];return Object(s.useEffect)((function(){!function(){var n=[];e.forEach((function(e,s){e.ownSongs.forEach(function(){var e=Object(b.a)(j.a.mark((function e(s,c){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("songs").doc(s).get();case 2:a=e.sent.data(),!t.addedSongs.includes(s)&&!n.includes(a.id)&&c<=3&&(r((function(e){return[].concat(Object(T.a)(e),[a])})),n.push(a.id));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}))}()}),[]),Object(v.jsx)("div",{className:"RecommendedSongs",children:Object(v.jsx)(Yt,{listOfSongs:a,source:{source:"/home",name:"Recommended Songs",image:"",songsList:a},title:"Recommended Songs",displayIfEmpty:Object(v.jsx)(vs,{message:"No songs recommended. Add favorite authors so we could know what to recommend",image:"https://i.pinimg.com/originals/b2/3d/f6/b23df649311586e74a8455c92eb3d76b.png"})})})},Ss=function(){var e=Object(s.useState)([]),t=Object(l.a)(e,2),n=t[0],c=t[1],a=Object(s.useState)(!0),r=Object(l.a)(a,2),i=r[0],o=r[1];return Object(s.useEffect)((function(){o(!0),m.collection("songs").orderBy("listens","desc").limit(15).get().then((function(e){e.docs.forEach((function(e){c((function(t){return[].concat(Object(T.a)(t),[e.data()])}))})),o(!1)}))}),[]),i?Object(v.jsx)(Te,{}):Object(v.jsx)(Yt,{listOfSongs:n,source:{source:"/home",name:"Top 15 Songs",image:"https://media.istockphoto.com/vectors/fire-icon-illustration-for-design-stock-vector-vector-id931601050?k=6&m=931601050&s=170667a&w=0&h=fhRQfwwsW6aXK9OSDM-yj842SFFl2Q9ll6ch-xCK5es=",songsList:n},title:"Top 15 Songs",showListens:!0,showCount:!0})},ws=(n(269),function(){return Object(v.jsxs)("div",{style:{animation:"zoomIn .2s forwards"},className:"HomePage",children:[Object(v.jsx)(ms,{}),Object(v.jsxs)(rn,{children:[Object(v.jsx)(gs,{}),Object(v.jsx)(Ss,{}),Object(v.jsx)(ys,{}),Object(v.jsx)(xs,{})]})]})}),Ns=(n(270),n.p+"static/media/wave2.f62cb572.svg"),Cs=function(e){var t=e.playlist,n=$(),c=n.currentSongPlaylistSource,a=n.play,r=A().isMobile,o=Object(s.useState)([]),u=Object(l.a)(o,2),d=u[0],j=u[1],b=Ut(t,d,j);return Object(v.jsx)(i.b,{to:"/albums/".concat(t.id),className:"playlistWrapper",children:Object(v.jsxs)("div",{className:"library playlistItem",style:{backgroundImage:"url(".concat(t.image,")")},children:[Object(v.jsx)("h2",{style:{background:t.imageColors[2]},children:re(t.name,10)}),t.image?null:Object(v.jsx)(te.a,{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",width:"60px",height:"60px"}}),r?null:Object(v.jsx)("button",{onClick:b,children:c.name===t.name&&a?Object(v.jsx)(he.b,{}):Object(v.jsx)(he.c,{})})]})})},ks=function(e){return e<1990&&e>=1780?7:e<1780&&e>=1570?6:e<1570&&e>=1360?5:e<1360&&e>=1150?4:e<1150&&e>=1e3?3:e<1e3&&e>=892?6:e<892&&e>=754?5:e<754&&e>=614?4:e<614&&e>=464?3:2},Is=function(){var e=$(),t=e.yourSongs,n=e.yourPlaylists,c=(e.setYourSongs,C().currentUser),a=A().screenWidth,r=Object(s.useState)(ks(a)),i=Object(l.a)(r,2),o=i[0],u=i[1];return Object(s.useEffect)((function(){u(ks(a))}),[a]),Object(v.jsxs)("div",{className:"SongsPage",children:[Object(v.jsxs)("div",{className:"playLists",children:[Object(v.jsx)("div",{className:"playlistContent",children:n.length?n.map((function(e,t){if(t<o)return Object(v.jsx)(Cs,{playlist:e},t)})):Object(v.jsx)("h3",{style:{position:"absolute",left:"50%",top:"40%",transform:"translate(-50%, -50%)"},children:"You don't have playlists"})}),Object(v.jsx)("div",{className:"playlistsBackground",children:Object(v.jsx)("img",{loading:"lazy",src:Ns,alt:"erwerrnjeqjweqwqeqwewerbjfrwjfbewjerbh"})})]}),Object(v.jsx)("div",{className:"yourSongsList",children:Object(v.jsx)(Yt,{listOfSongs:t,source:{source:"/library",name:"Your Library",image:c.photoURL,songsList:t},showSearch:!0,showhistory:!0,displayIfEmpty:Object(v.jsx)("h3",{children:"Your library is empty"})})})]})},As=function(){var e=$().yourPlaylists,t=Object(s.useState)(e),n=Object(l.a)(t,2),c=n[0],a=n[1],r=J(),i=r.toggleModal,o=r.setContent,u=Object(s.useState)(""),d=Object(l.a)(u,2),j=d[0],b=d[1];return Object(v.jsx)("div",{className:"PlaylistsPage",children:Object(v.jsxs)(rn,{children:[Object(v.jsxs)("div",{style:{display:"flex"},className:"searchAndCreatePlaylist",children:[Object(v.jsx)(Ge,{value:j,setValue:b,setResultPlaylists:a,defaultSearchMode:"playlists",defaultPlaylistsListValue:e}),Object(v.jsxs)("button",{className:"createPlaylistBtn",onClick:function(){i(),o(Object(v.jsx)(Ct,{}))},children:[Object(v.jsx)(te.i,{}),"Create Playlist"]})]}),Object(v.jsx)("div",{className:"playlistsContainer",children:c&&c.map((function(e,t){return Object(v.jsx)(On,{playlist:e},e.id)}))})]})})},Ps=function(){var e=$().yourAuthors,t=Object(s.useState)(""),n=Object(l.a)(t,2),c=n[0],a=n[1],r=Object(s.useState)(e),i=Object(l.a)(r,2),o=i[0],u=i[1];return Object(v.jsx)("div",{className:"AuthorsPage",children:Object(v.jsxs)(rn,{children:[Object(v.jsx)(Ge,{value:c,setValue:a,setResultAuthorList:u,defaultSearchMode:"authors",defaultAuthorsListValue:e}),Object(v.jsx)("div",{className:"authorsContainer",children:o.map((function(e){return Object(v.jsx)(wn,{data:e},e.uid)}))})]})})},Ls=function(){var e=Object(s.useState)(0),t=Object(l.a)(e,2),n=t[0],c=t[1],a=[Object(v.jsx)(Is,{}),Object(v.jsx)(As,{}),Object(v.jsx)(Ps,{})];return Object(v.jsxs)("div",{className:"LibraryPage",style:{animation:"zoomIn .2s forwards"},children:[Object(v.jsx)(ln,{pages:["Songs","Playlists","Authors"],currentPage:n,setCurrentPage:c}),a[n]]})},Ms=function(){return Object(v.jsxs)("div",{className:"BlurredBg",children:[Object(v.jsx)("div",{className:"circle circle1"}),Object(v.jsx)("div",{className:"circle circle2"}),Object(v.jsx)("div",{className:"circle circle3"}),Object(v.jsx)("div",{className:"circle circle4"}),Object(v.jsx)("div",{className:"circle circle5"})]})},Ts=function(e){var t=e.title;return Object(v.jsxs)("div",{className:"titleAndLogo",children:[Object(v.jsx)("div",{className:"title",children:Object(v.jsx)("h1",{children:t})}),Object(v.jsx)("div",{className:"logo",children:Object(v.jsx)("img",{loading:"lazy",src:x,alt:""})})]})},Es=function(){var e=C().login,t=Object(s.useState)(""),n=Object(l.a)(t,2),c=n[0],a=n[1],r=Object(s.useState)(""),o=Object(l.a)(r,2),u=o[0],d=o[1],h=Object(s.useState)(""),f=Object(l.a)(h,2),O=f[0],p=f[1],m=Object(s.useState)(!1),g=Object(l.a)(m,2),x=g[0],y=g[1],S=0!==c.length&&0!==u.length;function w(){return(w=Object(b.a)(j.a.mark((function t(n){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),S){t.next=3;break}return t.abrupt("return",p("One of your fields is totaly empty"));case 3:return t.next=5,e(c,u,p,y);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return Object(v.jsxs)("div",{className:"In-Up-Container",children:[Object(v.jsxs)("div",{className:"CentralPlate",children:[Object(v.jsx)(St,{loading:x}),Object(v.jsx)(Ts,{title:"Log In"}),Object(v.jsx)(it,{errorMessage:O}),Object(v.jsxs)("div",{className:"inner-plate-content",children:[Object(v.jsx)("input",{type:"email",placeholder:"Enter your Email",className:"emailInput",onChange:function(e){return a(e.target.value)}}),Object(v.jsx)("input",{type:"password",name:"",id:"",placeholder:"Enter your password",onChange:function(e){return d(e.target.value)}}),Object(v.jsxs)("div",{className:"inAndUpBtns",children:[Object(v.jsx)("button",{className:"upBtn",disabled:x,onClick:function(e){return w.apply(this,arguments)},children:"Log In"}),Object(v.jsx)(i.b,{to:It,children:Object(v.jsx)("button",{className:"inBtn",children:"Create new account"})})]})]})]}),Object(v.jsx)(Ms,{})]})},Rs=function(e){var t=e.currentTime,n=e.timeSpan,s=e.id;return Object(v.jsx)("div",{className:"Loading",id:s,children:Object(v.jsx)("div",{className:"outer",style:{pointerEvents:"none"},children:Object(v.jsx)("div",{className:"inner",style:t/n<1?{width:t/n*100+"%"}:{width:"0%",opacity:"0"}})})})},Bs=function(e){var t=e.el,n=e.index,c=e.lyricsModeratorMode,a=e.karaokeModeratorTimes,r=e.setKaraokeModeratorTimes,i=e.setInputKaraokeTime,o=e.inputKaraokeTime,u=$(),l=u.currentSongData,d=u.currentParagraph,j=(u.displayAuthors,u.changeCurrentTime),b=u.play,h=u.currentTime,f=u.currentParagraphRef,O=u.lyrics,p=Object(s.useRef)(),m=ns(d===n?f:p),g=d===n?{}:window.innerWidth>1e3?Math.abs(d-n)<2?{transform:"scale(.8) translateX(-58px)"}:{transform:"scale(.75) translateX(-78px)"}:Math.abs(d-n)<2?{transform:"scale(.8) translateX(-11.5%)"}:{transform:"scale(.75) translateX(-15.6%)"};function x(e,t){var n=a;if("down"===t)return n.splice(e+1,0,void 0),r(n),l.lyrics.splice(e+1,0,{startTime:"undefined",text:"@loading"});n.splice(e,0,void 0),r(n),l.lyrics.splice(e,0,{startTime:"undefined",text:"@loading"})}return Object(v.jsxs)("div",{className:"lyricsBlock "+(m?"":"notVisible"),id:n,onClick:function(e){return j(e,t.startTime)},style:b?d===n?{}:Math.abs(d-n)<2?{opacity:.5}:{opacity:.1}:{},ref:d===n?f:p,children:[1===c?Object(v.jsxs)("div",{className:"lyricsBlockInput",children:[Object(v.jsxs)("span",{onClick:function(e){return e.stopPropagation()},children:[void 0!==a[n]&&0!==a[n].length?Object(v.jsx)(te.b,{style:{background:"var(--themeColor3)",color:"var(--themeColor)"}}):Object(v.jsx)(ne.G,{})," "]}),Object(v.jsx)("input",{type:"number",value:a[n]||o,onChange:function(e){return function(e,t){var n=a,s=e.target.value;n[t]=s,i(e.target.value),r(n)}(e,n)},onClick:function(e){return e.stopPropagation()}}),Object(v.jsxs)("div",{className:"addLyricsElementBtns",onClick:function(e){return e.stopPropagation()},children:[Object(v.jsx)("button",{onClick:function(){x(n,"up")},children:Object(v.jsx)(te.p,{})}),Object(v.jsx)("button",{onClick:function(){x(n,"down")},children:Object(v.jsx)(te.g,{})})]})]}):null,"@loading"===t.text?Object(v.jsx)(Rs,{currentTime:h-O[n].startTime,timeSpan:O[n+1].startTime-O[n].startTime,id:n}):"@end"===t.text?Object(v.jsx)(v.Fragment,{}):Object(v.jsx)("p",{id:n,style:g,children:t.text},n)]},n)},Ds=H.a.div(cs||(cs=Object(M.a)(["\n  max-height: 500px;\n  width: 1000px;\n  overflow-y: auto;\n\n  .lyricsBlock {\n    padding: 10px;\n    box-sizing: border-box;\n    font-size: 1.8em;\n    font-weight: 700;\n    margin: 10px 0;\n    user-select: none;\n    cursor: pointer;\n    border-radius: var(--standartBorderRadius2);\n\n    &:hover {\n      background: #ffffff5c;\n    }\n  }\n"]))),Us=function(e){var t=e.song;return Object(v.jsx)(Ds,{children:t.lyrics.map((function(e,t){return Object(v.jsx)("div",{className:"lyricsBlock",children:e.text})}))})},Fs=H.a.div(as||(as=Object(M.a)(["\n  width: 100%;\n  max-width: 800px;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n\n  .song-image {\n    width: 300px;\n    height: 300px;\n    background-size: cover;\n    background-position: center center;\n    border-radius: var(--standartBorderRadius);\n  }\n"]))),Ws=function(e){var t=e.song;return Object(v.jsxs)(Fs,{children:[Object(v.jsx)("div",{className:"song-image",style:{backgroundImage:"url(".concat(t.cover,")")}}),Object(v.jsx)("h3",{children:t.name})]})},Hs=Object(H.a)(rn)(rs||(rs=Object(M.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n  background: ",";\n\n  h2 {\n    margin: 0;\n  }\n\n  .image-and-lyrics {\n    display: flex;\n    align-items: center;\n  }\n"])),(function(e){var t=e.colors;return"linear-gradient(45deg, ".concat(t[2],", ").concat(t[3],");")})),zs=function(){var e=Object(s.useState)("3e35c47f-2186-4dea-a415-55616c525874"),t=Object(l.a)(e,2),n=t[0],c=(t[1],Object(s.useState)(null)),a=Object(l.a)(c,2),r=a[0],i=a[1];return Object(s.useEffect)((function(){m.collection("songs").doc(n).get().then((function(e){i(e.data())}))}),[]),!!r&&Object(v.jsx)(Hs,{colors:r.imageColors,children:Object(v.jsxs)("div",{children:[Object(v.jsxs)("div",{className:"image-and-lyrics",children:[Object(v.jsx)(Ws,{song:r}),Object(v.jsx)(Us,{song:r})]}),Object(v.jsx)("div",{})]})})},Vs=(n(271),function(){var e=Object(o.g)();return Object(v.jsxs)("div",{className:"PageNotFound",children:[Object(v.jsx)("img",{loading:"lazy",src:"https://i.pinimg.com/originals/b2/3d/f6/b23df649311586e74a8455c92eb3d76b.png",alt:""}),Object(v.jsx)("h2",{children:"Page not found"}),Object(v.jsx)("button",{className:"standartButton",onClick:function(){return e.push("/library")},children:"Back to library"})]})}),Ys=function(){var e=Object(s.useState)([]),t=Object(l.a)(e,2),n=t[0],c=t[1],a=Object(s.useState)([]),r=Object(l.a)(a,2),i=r[0],o=r[1],u=Object(s.useState)([]),d=Object(l.a)(u,2),h=d[0],f=d[1],O=C().currentUser;return Object(s.useEffect)((function(){m.collection("searchHistory").doc(O.uid).get().then((function(e){var t;(null===(t=e.data())||void 0===t?void 0:t.history)&&e.data().history.forEach(function(){var e=Object(b.a)(j.a.mark((function e(t){var n,s,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,s=t.type,e.next=3,m.collection(s).doc(n).get();case 3:a=e.sent.data(),e.t0=s,e.next="songs"===e.t0?7:"playlists"===e.t0?9:"users"===e.t0?11:13;break;case 7:return c((function(e){return[].concat(Object(T.a)(e),[a])})),e.abrupt("break",14);case 9:return o((function(e){return[].concat(Object(T.a)(e),[a])})),e.abrupt("break",14);case 11:return f((function(e){return[].concat(Object(T.a)(e),[a])})),e.abrupt("break",14);case 13:return e.abrupt("break",14);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}))}),[]),[n,i,h]},qs=function(){var e=C().searchValue,t=Ys(),n=Object(l.a)(t,3),s=n[0],c=n[1],a=n[2];return e?null:Object(v.jsxs)("div",{className:"search-history",style:{animation:"zoomIn .2s forwards"},children:[Object(v.jsx)(Yt,{listOfSongs:s,source:{source:"/search",name:"Search",image:"https://www.pngkey.com/png/full/87-872187_lupa-search-icon-white-png.png",songsList:s},title:"Search history",showListens:!0,displayIfEmpty:"",isHorizontal:!0}),Object(v.jsx)(Nn,{listOfAuthors:a}),Object(v.jsx)(pn,{listOfAlbums:c,loading:!1})]})},Gs=(n(272),function(){var e=C(),t=e.searchValue,n=e.setSearchValue,c=Object(s.useState)([]),a=Object(l.a)(c,2),r=a[0],i=a[1],o=Object(s.useState)([]),u=Object(l.a)(o,2),d=u[0],j=u[1],b=Object(s.useState)([]),h=Object(l.a)(b,2),f=h[0],O=h[1],p=Object(s.useState)(""),m=Object(l.a)(p,2),g=m[0],x=m[1];return Object(s.useEffect)((function(){i([]),j([]),O([])}),[t]),Object(s.useEffect)((function(){0!==r.length?x(r[0].imageColors[0]+"a6"):0!==d.length?x(d[0].imageColors[0]+"a6"):0!==f.length?x(f[0].imageColors[0]+"a6"):x("")}),[r,d,f]),Object(v.jsx)("div",{className:"SearchPage",style:{animation:"zoomIn .2s forwards"},children:Object(v.jsxs)(rn,{children:[Object(v.jsx)(Ge,{value:t,setValue:n,allFoundSongs:r,setAllFoundSongs:i,setResultPlaylists:O,setResultAuthorList:j,focus:!0}),Object(v.jsx)(qs,{}),Object(v.jsx)(Yt,{listOfSongs:r,source:{source:"/search",name:"Search",image:"https://www.pngkey.com/png/full/87-872187_lupa-search-icon-white-png.png",songsList:r},title:"Songs",showListens:!0,saveSearchHistory:!0,displayIfEmpty:"",isHorizontal:!0}),Object(v.jsx)(Nn,{listOfAuthors:d,title:"Authors",saveSearchHistory:!0}),Object(v.jsx)(pn,{listOfAlbums:f,title:"Albums and Playlists",loading:!1,saveSearchHistory:!0}),Object(v.jsx)("div",{className:"colorfullShadow",style:{background:g}})]})})}),Qs=function(){return Object(v.jsx)(rn,{children:Object(v.jsx)("h2",{children:"Settings"})})},Ks=(n(273),[{path:kt,Component:Es},{path:It,Component:function(){var e=Object(s.useState)(1),t=Object(l.a)(e,2),n=t[0],c=t[1],a=Object(s.useState)(""),r=Object(l.a)(a,2),o=r[0],u=r[1],d=Object(s.useState)(""),h=Object(l.a)(d,2),f=h[0],O=h[1],p=Object(s.useState)(""),m=Object(l.a)(p,2),g=m[0],x=m[1],y=Object(s.useState)(""),S=Object(l.a)(y,2),w=S[0],N=S[1],k=Object(s.useState)(!1),I=Object(l.a)(k,2),A=I[0],P=I[1],L=C().signup,M=Object(s.useState)(""),T=Object(l.a)(M,2),E=T[0],R=T[1],B=0!==o.length&&0!==f.length&&0!==g.length,D=Object(s.useState)(""),U=Object(l.a)(D,2),F=U[0],W=U[1],H=Object(s.useState)([]),z=Object(l.a)(H,2),V=z[0],Y=z[1];function q(){return(q=Object(b.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),B){e.next=3;break}return e.abrupt("return",N("One of your fields is totaly empty"));case 3:return e.next=5,L(o,g,f,n,E,V,N,P);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(v.jsxs)("div",{className:"In-Up-Container",children:[Object(v.jsx)(be.a,{src:F,getColors:function(e){return Y(e)}}),Object(v.jsxs)("div",{className:"CentralPlate",children:[Object(v.jsx)(St,{loading:A}),Object(v.jsx)(Ts,{title:"Sign Up"}),w&&Object(v.jsx)("div",{className:"Alert",children:w}),Object(v.jsxs)("div",{className:"inner-plate-content",children:[Object(v.jsx)("input",{type:"email",placeholder:"Enter your Email",className:"emailInput",onChange:function(e){return u(e.target.value)}}),Object(v.jsx)("input",{type:"text",placeholder:"Enter your name",onChange:function(e){return x(e.target.value)}}),Object(v.jsx)("input",{type:"password",name:"",id:"",placeholder:"Create a password",onChange:function(e){return O(e.target.value)}}),Object(v.jsxs)("div",{style:{display:"flex",width:"100%",justifyContent:"center",margin:"5px 0 15px 0"},children:[Object(v.jsx)(wt,{label:"User",onClick:function(){return c(0)},currentActive:n,id:0}),Object(v.jsx)(wt,{label:"Author",onClick:function(){return c(1)},currentActive:n,id:1})]}),Object(v.jsx)(yt,{text:"Download photo",place:"usersImages/",setItemSrc:R,setImageLocalPath:W}),Object(v.jsxs)("div",{className:"inAndUpBtns",children:[Object(v.jsx)("button",{className:"upBtn",type:"submit",disabled:A,onClick:function(e){return q.apply(this,arguments)},children:"Sign Up"}),Object(v.jsx)(i.b,{to:kt,children:Object(v.jsx)("button",{className:"inBtn",children:"Already have the account"})})]})]})]}),Object(v.jsx)(Ms,{})]})}}]),Xs=[{path:At,Component:ws},{path:Pt,Component:Ls},{path:Lt,Component:Gs},{path:Mt,Component:Un},{path:"/not-found",Component:Vs},{path:"/chat/:chatId",Component:Os},{path:"/albums/:albumId",Component:on},{path:"/authors/:authorId",Component:Pn},{path:Tt,Component:ps},{path:"/settings",Component:Qs},{path:"/lyrics-editing",Component:zs}],Js=function(){return Object(v.jsxs)(o.d,{children:[Xs.map((function(e,t){var n=e.path,s=e.Component;return Object(v.jsx)(o.b,{path:n,component:s,exact:!0},n)})),Object(v.jsx)(o.a,{to:At})]})},_s=function(){var e=Object(s.useState)([]),t=Object(l.a)(e,2),n=t[0],c=t[1],a=C().currentUser;return Object(s.useEffect)((function(){var e=m.collection("chats").where("participants","array-contains",a.uid).onSnapshot((function(e){c((function(t){var n=Object(T.a)(t);return e.docChanges().map(function(){var e=Object(b.a)(j.a.mark((function e(t){var s,c,r,i,o,u;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"modified"===t.type&&t.doc.data().messages.length&&(s=t.doc.data(),c=s.id,r=s.chatName,i=s.chatImage,o=s.messages,u=o[o.length-1],u.sender!==a.uid&&!u.seenBy.includes(a.uid)&&n.push({chatId:c,chatName:r,chatImage:i,message:o[o.length-1],userId:o[o.length-1].sender}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),n}))}));return function(){e()}}),[]),Object(s.useEffect)((function(){n.length&&setTimeout((function(){c((function(e){return e.slice(1,e.length)}))}),4700)}),[n.length]),[n,c]},Zs=(n(274),n(275),function(e){var t=e.element,n=e.currentPage,s=e.setCurrentPage;return Object(v.jsx)(i.b,{to:t.link,className:"MobileControlBarItem",onClick:function(){return s(t.id)},style:t.id===n?{color:"var(--blue)"}:{},children:t.icon})}),$s=function(){var e=C().currentUser,t={icon:Object(v.jsx)(te.q,{}),link:"/authors/".concat(e.uid)},n=Object(s.useState)((function(){var e=Et.find((function(e,t){return!!window.location.hash.includes(S(e.title))}));return void 0===e?0:e.id})),c=Object(l.a)(n,2),a=c[0],r=c[1];return Object(v.jsxs)("div",{className:"BottomControlBar",children:[Et.map((function(e,t){return Object(v.jsx)(Zs,{element:e,currentPage:a,setCurrentPage:r},t)})),Object(v.jsx)(Zs,{element:t,currentPage:a,setCurrentPage:r})]})},ec=function(){var e=$(),t=e.setOpenFullScreenPlayer,n=e.inputRange;return Object(v.jsxs)("div",{className:"FullBottomSide",children:[Object(v.jsxs)("span",{onClick:function(){return t(!0)},style:{display:"block",position:"relative"},children:[Object(v.jsx)(je,{textLimit:25,linkToAuthors:!1}),Object(v.jsx)("span",{className:"mobileSongRange",style:{width:n+"%"}})]}),Object(v.jsx)($s,{})]})},tc=n.p+"static/media/notification.d7ea662a.mp3",nc=H.a.div(is||(is=Object(M.a)(["\n  color: #fff;\n  padding: 20px;\n  box-sizing: border-box;\n  border-radius: var(--standartBorderRadius2);\n  background: #000000b9;\n  position: absolute;\n  bottom: 20px;\n  right: 20px;\n  transition: 0.2s;\n  transform: translateY(\n    ","\n  );\n  opacity: ",";\n  width: 250px;\n  height: 90px;\n\n  a {\n    text-decoration: none;\n  }\n\n  &:hover {\n    background: #1f1f1fb3;\n  }\n\n  .image-and-name {\n    display: flex;\n    justify-content: flex-start;\n    align-items: center;\n    font-weight: bold;\n\n    img {\n      width: 25px;\n      height: 25px;\n      border-radius: 100%;\n      margin-right: 7px;\n    }\n  }\n\n  .message {\n    margin-top: 10px;\n    display: flex;\n    white-space: nowrap;\n    overflow: hidden;\n  }\n"])),(function(e){var t=e.show,n=e.index;return t?"-".concat(90*n+10*n,"px"):"90px"}),(function(e){return e.show?"1":"0"})),sc=function(e){var t=e.chatId,n=e.chatName,c=e.chatImage,a=e.message,r=e.userId,o=e.index,u=(e.notifsLen,Object(s.useState)(null)),d=Object(l.a)(u,2),j=d[0],b=d[1],h=Object(s.useState)(!1),f=Object(l.a)(h,2),O=f[0],p=f[1];return Object(s.useEffect)((function(){m.collection("users").doc(r).get().then((function(e){p(!0),new Audio(tc).play(),b(e.data()),setTimeout((function(){p(!1)}),4500)}))}),[]),Object(v.jsx)(nc,{show:O,index:o,children:Object(v.jsxs)(i.b,{to:"/chat/".concat(t),children:[Object(v.jsxs)("div",{className:"image-and-name",children:[Object(v.jsx)("img",{src:(null===c||void 0===c?void 0:c.length)?c:null===j||void 0===j?void 0:j.photoURL,alt:""}),n.length?n:null===j||void 0===j?void 0:j.displayName]}),Object(v.jsx)("div",{className:"message",children:Object(v.jsx)(En,{sender:j,isGroup:n.length,message:a,messageLen:20})})]})})},cc=function(){var e=J(),t=e.isOpenConfirm,n=e.confirmContent,c=e.setIsOpenConfirm,a=(e.closeConfirm,Object(s.useRef)(null));return jt(a,c),Object(v.jsx)("div",{className:"modal_darkBg confirm",style:t?{}:{opacity:0,visibility:"hidden"},children:Object(v.jsxs)("div",{className:"ConfirmWindow",ref:a,style:t?{}:{transform:"translateY(40px)"},children:[Object(v.jsx)("h3",{children:n.question}),Object(v.jsxs)("div",{className:"confirmButtons",children:[Object(v.jsx)("button",{onClick:n.onConfirm,className:"standartButton",children:n.confirmText}),Object(v.jsx)("button",{onClick:n.onReject,className:"standartButton",children:n.rejectText})]})]})})},ac=function(){var e=J().bottomMessage,t=function(){switch(e.type){case"success":return{light:"#69e985",dark:"#12321ce6"};case"failure":return{light:"#f4546a",dark:"#581921d8"};default:return{light:"#69e985",dark:"#12321ce6"}}};return Object(v.jsxs)("div",{className:"bottom-message ".concat(e.isOpenned?"openned":""),style:{background:t().dark,color:t().light},children:[function(){switch(e.type){case"success":return Object(v.jsx)(ce.g,{});case"failure":return Object(v.jsx)(ce.h,{});default:return Object(v.jsx)(ce.g,{})}}(),Object(v.jsx)("span",{children:e.message})]})},rc=function(e){var t=Object.assign({},e),n=J(),c=n.openModal,a=n.setOpenModal,r=n.content,i=Object(s.useRef)(null),o=A().screenHeight;return jt(i,a),Object(v.jsx)("div",{className:"modal_darkBg",style:c?{height:o}:{opacity:0,visibility:"hidden"},children:Object(v.jsx)("div",Object(u.a)(Object(u.a)({className:"ModalWindow"},t),{},{ref:i,style:c?{}:{opacity:0,visibility:"hidden",transform:"translateY(40px)"},children:r}))})},ic=[{id:0,icon:Object(v.jsx)(te.o,{}),title:"Share",component:function(){var e=$().currentSongData,t=[Object(v.jsx)(ze.c,{}),Object(v.jsx)(ce.b,{}),Object(v.jsx)(ce.i,{}),Object(v.jsx)(ce.j,{}),Object(v.jsx)(xt.a,{})];return Object(v.jsxs)("div",{className:"Share",children:[Object(v.jsxs)("button",{className:"shareCopyLink",children:[Object(v.jsx)(ne.h,{}),"Copy link"]}),Object(v.jsx)("div",{className:"shareOnSocial",children:t.map((function(e,t){return Object(v.jsx)("div",{className:"shareSocialIcon",children:e},t)}))}),Object(v.jsx)("div",{className:"sharePeopleShort",children:Object(v.jsx)(tt,{item:e,whatToShare:"song"})})]})}},{id:1,icon:Object(v.jsx)(te.f,{}),title:"More",component:function(){var e=$(),t=e.currentSongData,n=e.setRightSideCurrentPage;return Object(v.jsxs)("div",{className:"Options",children:[Object(v.jsx)("div",{className:"OptionItem",children:Object(v.jsx)(xe,{song:t})}),Object(v.jsxs)("div",{className:"OptionItem",onClick:function(){return n(4)},children:[Object(v.jsx)(te.q,{}),"Go to author"]}),Object(v.jsxs)("div",{className:"OptionItem",onClick:function(){return n(5)},children:[Object(v.jsx)(Oe.c,{}),"Add to playlist"]}),Object(v.jsxs)("div",{className:"OptionItem",onClick:function(){return n(6)},children:[Object(v.jsx)(ne.n,{}),"Info"]})]})}},{id:2,icon:Object(v.jsx)(ae.c,{}),title:"Lyrics",component:function(){var e=$(),t=e.setIsThereKaraoke,n=e.currentSongData,c=e.setCurrentSongData,a=e.isThereKaraoke,r=e.currentParagraph,i=e.displayAuthors,o=(e.changeCurrentTime,e.play,e.currentTime,e.currentParagraphRef),u=(e.currentSong,e.lyrics),d=e.rightSideCurrentPage,j=e.openFullScreenPlayer,b=e.openMenu,h=C().currentUser,f=Object(s.useState)(0),O=Object(l.a)(f,2),p=O[0],g=O[1],x=Object(s.useState)([]),y=Object(l.a)(x,2),S=y[0],w=y[1],N=Object(s.useState)(0),k=Object(l.a)(N,2),I=k[0],A=k[1],P=Object(s.useState)(!1),L=Object(l.a)(P,2),M=L[0],T=L[1];function E(e,t){var n=S,s=e.target.value;n[t]=s,g(e.target.value),w(n)}function R(e,t){var s=S;if("down"===t)return s.splice(e+1,0,void 0),w(s),n.lyrics.splice(e+1,0,{startTime:"undefined",text:"@loading"});s.splice(e,0,void 0),w(s),n.lyrics.splice(e,0,{startTime:"undefined",text:"@loading"})}return Object(s.useEffect)((function(){a&&b&&2===d&&j&&o.current.scrollIntoView()}),[r]),Object(s.useEffect)((function(){u&&"undefined"!==u[0].startTime&&(u.forEach((function(e){S.push(e.startTime)})),T(!0))}),[]),Object(s.useEffect)((function(){var e,s=n;void 0!==s&&0!==p&&(s.lyrics.forEach((function(e,t){e.startTime=S[t]||"undefined"})),c(s),t(!0)),(null===(e=n.lyrics)||void 0===e?void 0:e.some((function(e){return"undefined"===e.startTime})))?T(!1):T(!0)}),[p]),u?Object(v.jsxs)("div",{className:"Lyrics",children:[h.isAdmin?Object(v.jsx)(ln,{pages:["Listen mode","Edit Mode"],currentPage:I,setCurrentPage:A}):null,a?u.map((function(e,t){return Object(v.jsx)(Bs,{el:e,index:t,lyricsModeratorMode:I,karaokeModeratorTimes:S,setKaraokeModeratorTimes:w,setInputKaraokeTime:g,inputKaraokeTime:E})})):u.map((function(e,t){return Object(v.jsxs)("div",{className:"lyricsBlock",children:[1===I?Object(v.jsxs)("div",{className:"lyricsBlockInput",children:[void 0!==S[t]&&0!==S[t].length?Object(v.jsx)(te.b,{style:{background:"var(--themeColor3)",color:"var(--themeColor)"}}):Object(v.jsx)(ne.G,{}),Object(v.jsx)("input",{type:"number",value:S[t]||p,onChange:function(e){return E(e,t)},onClick:function(e){return e.stopPropagation()}}),Object(v.jsxs)("div",{className:"addLyricsElementBtns",children:[Object(v.jsx)("button",{onClick:function(){return R(t,"up")},children:Object(v.jsx)(te.p,{})}),Object(v.jsx)("button",{onClick:function(){return R(t,"down")},children:Object(v.jsx)(te.g,{})})]})]}):null,Object(v.jsx)("p",{children:e.text})]},t)})),Object(v.jsxs)("h6",{className:"lyricsAuthors "+(r===u.length-1?"active":""),children:["Authors:  ",i()]}),1===I?Object(v.jsx)("button",{onClick:M?function(){m.collection("songs").doc(n.id).update({lyrics:n.lyrics})}:null,className:"updateLyricsBtn",style:M?{}:{opacity:.3},children:"Update Lyrics"}):null]}):Object(v.jsx)("h3",{children:"No lyrics"})}},{id:3,icon:Object(v.jsx)(Wn.a,{}),title:"Queue",component:function(){var e=$(),t=e.currentSongQueue,n=e.currentSongPlaylistSource,s=e.setOpenFullScreenPlayer;return Object(v.jsxs)("div",{className:"Queue",children:[Object(v.jsx)("div",{className:"queueNowIsPlaying",children:Object(v.jsxs)("h5",{style:{marginTop:2},children:["Now is playing:",Object(v.jsxs)(i.b,{onClick:function(){return s(!1)},to:n.source,className:"queueAlbumName",children:[Object(v.jsx)("div",{className:"queueImage",style:n.image?{}:{display:"none"},children:Object(v.jsx)("img",{loading:"lazy",src:n.image,alt:""})}),Object(v.jsx)("span",{children:re(n.name,25)})]})]})}),t.map((function(e,t){return Object(v.jsx)(gt,{song:e,localIndex:t},t)}))]})}},{id:4,icon:null,title:"Go To Authors",component:rt},{id:5,icon:null,title:"Add to playlist",component:Se},{id:6,icon:null,title:"Info",component:at}];function oc(){var e=$(),t=e.imgColors,n=e.inputRef,a=e.rightSideCurrentPage,r=e.setRightSideCurrentPage,i=e.openFullScreenPlayer,o=e.setOpenFullScreenPlayer,d=e.lyrics,j=e.openMenu,b=e.setOpenMenu,h=A(),f=h.isMobile,O=(h.screenHeight,h.screenWidth,Object(s.useRef)(null)),p=Object(s.useState)(.05),m=Object(l.a)(p,2),g=m[0],x=m[1],y=Object(s.useState)(0),S=Object(l.a)(y,2),w=S[0],N=S[1],C=Object(s.useState)(0),k=Object(l.a)(C,2),I=k[0],P=k[1],L=Object(s.useState)(0),M=Object(l.a)(L,2),T=M[0],E=M[1],R=Object(s.useRef)(),B=c.a.useRef();jt(B,b);var D=Object(ts.useSwipeable)({onSwiping:function(e){e.deltaY>0&&P(e.deltaY)}}),U=c.a.useRef(),F=Object(ts.useSwipeable)({onSwiping:function(e){e.event.stopPropagation(),(j&&0===R.current.scrollTop&&e.deltaY>0||!j&&e.deltaY<0)&&E(e.deltaY)},onSwipedLeft:function(){r(Q(a+1,3))},onSwipedRight:function(){r(Q(a-1,3))}});Object(s.useEffect)((function(){I>150&&o(!1)}),[I]),Object(s.useEffect)((function(){!j&&T<-100?(b(!0),E(0),N(.2)):j&&T>150?(b(!1),E(0),N(.2)):function(){var e;clearTimeout(e),N(0),e=setTimeout((function(){N(.2),E(0)}),300)}()}),[T]);function W(e){var t=ic[e].component;return Object(v.jsx)(t,{})}function H(){return d&&0===d.length}function z(e){if(2===e.id&&H())return null;N(.2),r(e.id),b(!0)}return Object(s.useEffect)((function(){0!==t.length&&(document.documentElement.style.setProperty("--themeColor",t[1]),document.documentElement.style.setProperty("--themeColor2",t[0]),document.documentElement.style.setProperty("--themeColor3",t[2]),document.documentElement.style.setProperty("--themeColor4",t[5]),document.documentElement.style.setProperty("--themeColorTransparent",t[0]+"6e"))}),[t]),Object(v.jsxs)("div",Object(u.a)(Object(u.a)({className:"bg",style:i?{top:0,opacity:1,visibility:"visible",zIndex:10,transform:"translateY(".concat(I,"px)"),borderRadius:"".concat(I<20?I:20,"px ").concat(I<20?I:20,"px 0 0"),transition:".4s opacity, ".concat(g,"s transform, .4s top, .4s visibility")}:{transform:"translateY(".concat(I,"px)"),transition:".4s opacity, ".concat(g,"s transform, .4s top, .4s visibility")},ref:function(e){D.ref(e),U.current=e}},D),{},{onTouchEnd:function(){var e;clearTimeout(e),x(.2),e=setTimeout((function(){P(0),x(0)}),100)},children:[Object(v.jsx)("div",{className:"closeFullScreen",onClick:function(){o(!1)},children:window.innerWidth>1e3?Object(v.jsx)(he.a,{}):Object(v.jsx)(ne.q,{style:{opacity:.6}})}),Object(v.jsxs)("div",{className:"FullScreenPlayer",children:[Object(v.jsx)("div",{className:"leftSide",style:j?f?{opacity:.6,visibility:"visible",transform:"translateY(20px)",borderRadius:"10px",transition:".4s"}:null:{width:"100%"},children:Object(v.jsx)(je,{inputRef:n})}),window.innerWidth>1e3?Object(v.jsxs)("div",{className:"rightSideWrapper",style:j?{}:{transform:"translateX(calc(100% - 90px))",width:0},children:[Object(v.jsx)("button",{className:"menuBtn",style:j?{transform:"rotate(180deg)"}:{opacity:0,visibility:"hidden"},onClick:function(){return b(!j)},children:Object(v.jsx)(te.c,{})}),Object(v.jsx)("div",{className:"rightSideControl",children:ic.map((function(e,t){return Object(v.jsx)("div",{className:"controlIcon",style:e.id===a&&j?{background:"var(--themeColor)"}:2===e.id&&H()?{opacity:.4}:{},onClick:function(){return z(e)},children:e.icon},e.id)}))}),Object(v.jsx)("div",{className:"rightSide",ref:O,style:j?{}:{display:"none"},children:W(a)})]}):Object(v.jsxs)("div",Object(u.a)(Object(u.a)({className:"mobilePlayerMenu"},F),{},{ref:function(e){F.ref(e),B.current=e},style:j?{top:"calc(100% - calc(70vh + 55px) + ".concat(T,"px)"),transition:"".concat(w,"s")}:{top:"calc(100% - 55px + ".concat(T,"px)"),transition:"".concat(w,"s")},children:[Object(v.jsx)("div",{className:"mobilePlayerMenuClose",children:Object(v.jsx)(ne.q,{style:{opacity:.6,width:"50px"},onClick:function(){return b(!j)}})}),Object(v.jsx)("div",{className:"controlIconsWrapper",children:ic.map((function(e,t){if(t<=3)return Object(v.jsx)("div",{className:"controlIcon",style:e.id===a&&j?{background:"var(--transparentWhite)"}:2===e.id&&H()?{opacity:.4}:{},onClick:function(t){return z(e)},children:e.title},e.id)}))}),Object(v.jsx)("div",{className:"mobilePlayerMenuContent",ref:R,style:j?{}:{opacity:0},children:W(a)})]}))]})]}))}var uc=function(){var e=$(),t=e.songRef,n=e.loadSongData,c=e.playing,a=e.songSrc,r=e.openFullScreenPlayer,i=e.repeatMode,o=e.setPlay,d=e.prevSong,h=e.currentSongQueue,f=e.nextSong,O=A(),p=O.isMobile,g=O.screenHeight,x=C().currentUser,y=Object(s.useState)(!0),S=Object(l.a)(y,2),w=S[0],N=S[1],k=_s(),I=Object(l.a)(k,2),P=I[0],L=I[1];Ht();var M=function(){var e=Object(s.useRef)(),t=$(),n=t.currentSongData,c=t.currentSongPlaylistSource,a=t.songDuration,r=t.play;function i(){-1!==n.id&&(e.current=setTimeout(Object(b.a)(j.a.mark((function e(){var t,s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("songs").doc(n.id).get();case 2:t=e.sent.data().listens,++t,m.collection("songs").doc(n.id).update({listens:t}),"albums"===c.source.substr(1,6)&&(s=c.source.substr(8,c.source.length-8),m.collection("playlists").doc(s).get().then((function(e){var t=e.data().listens;t++,m.collection("playlists").doc(s).update({listens:t})}))),n.authors.forEach(function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(t.uid).get();case 2:n=e.sent.data().numberOfListenersPerMonth,++n,m.collection("users").doc(t.uid).update({numberOfListenersPerMonth:n});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 7:case"end":return e.stop()}}),e)}))),1e3*a*.5))}return Object(s.useEffect)((function(){clearTimeout(e.current),r&&i()}),[r,n.id]),i}();return Object(s.useEffect)((function(){var e=setInterval((function(){m.collection("users").doc(x.uid).update({online:(new Date).getTime()}),N(!w)}),3e5);return function(){return clearInterval(e)}}),[w]),Object(s.useEffect)((function(){m.collection("users").doc(x.uid).update({online:(new Date).getTime()})}),[]),Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)("audio",{src:a,ref:t,onLoadedData:n,onTimeUpdate:c,onEnded:function(){return 0===i?(t.current.pause(),o(!1),d()):1===i?1===h.length?(d(),M(),t.current.play()):f():(d(),M(),void t.current.play())}}),Object(v.jsxs)("div",{className:"Wrapper "+(r?"turnedOff":""),style:p?{height:g}:{height:"100vh"},children:[p?"chat"===window.location.hash.substr(2,4)&&window.location.hash.length>6?null:Object(v.jsx)(ec,{}):Object(v.jsx)(Wt,{}),Object(v.jsx)("div",{className:"Content",children:Object(v.jsx)(Js,{})}),Object(v.jsx)(ac,{}),Object(v.jsx)(rc,{}),Object(v.jsx)(cc,{}),P.map((function(e,t){return Object(v.jsx)(sc,Object(u.a)(Object(u.a)({},e),{},{index:t,notifsLen:P.length,setNotifications:L}))}))]}),Object(v.jsx)(oc,{})]})},lc=function(){return C().currentUser.uid?Object(v.jsx)(o.d,{children:Object(v.jsx)(o.b,{path:"/",component:uc})}):Object(v.jsxs)(o.d,{children:[Ks.map((function(e,t){var n=e.path,s=e.Component;return Object(v.jsx)(o.b,{path:n,component:s,exact:!0},t)})),Object(v.jsx)(o.a,{to:kt})]})};function dc(){return Object(v.jsx)(i.a,{basename:"/",children:Object(v.jsx)(lc,{})})}r.a.render(Object(v.jsx)(c.a.StrictMode,{children:Object(v.jsx)(P,{children:Object(v.jsx)(k,{children:Object(v.jsx)(_,{children:Object(v.jsx)(ee,{children:Object(v.jsx)(dc,{})})})})})}),document.getElementById("root"))},91:function(e,t,n){}},[[276,1,2]]]);
//# sourceMappingURL=main.eb74c55c.chunk.js.map