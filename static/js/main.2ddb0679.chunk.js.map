{"version":3,"sources":["firebase.js","images/Logo3.svg","components/Loading/LoadingData.jsx","functions/other/normalizeString.js","functions/find/findVariantsOfName.js","contexts/AuthContext.jsx","contexts/ScreenContext.jsx","shared/ui/molecules/add-to-list-circle.jsx","functions/display/displayDate.js","components/Basic/LastSeen.jsx","components/Basic/PersonTiny.jsx","functions/add/addSongToHistory.js","functions/other/shuffleSongs.js","hooks/useConditionFunc.js","shared/lib/check-number.js","shared/lib/fetch-item-list.js","contexts/ModalContext.jsx","contexts/SongContext.jsx","functions/check/checkKaraoke.js","shared/lib/hooks/use-outside-click.js","shared/lib/get-short-string.js","functions/display/displayAuthorsStr.js","functions/find/findLenOfAuthors.js","functions/other/correctTimeDisplay.js","features/full-screen-player/ui/atoms/color-circles.jsx","features/full-screen-player/ui/organisms/player.jsx","components/AuthorPage/PersonTinyVerticalItem.jsx","functions/other/getUID.js","shared/lib/create-—Åhat.js","shared/lib/find-chat-url.js","functions/other/sendMessage.js","functions/other/shareWithManyFriends.js","components/Loading/LoadingCircle.jsx","features/search/lib/hooks/use-search.jsx","features/search/lib/rank-current-hint.js","features/search/ui/molecules/search-bar-buttons.jsx","features/search/ui/atoms/search-filter-item.jsx","features/search/ui/molecules/search-filters.jsx","features/search/lib/find-search-hints.js","features/search/lib/translite-word.js","features/search/lib/hooks/use-load-hints.jsx","shared/lib/find-right-icon.js","features/search/ui/atoms/search-hint-item.jsx","features/search/ui/organisms/search-hints.jsx","shared/ui/organisms/search-bar.jsx","shared/ui/atoms/button.jsx","shared/ui/atoms/input.jsx","shared/ui/atoms/submit-button.jsx","components/Lists/TinyPersonsList.jsx","components/Lists/FriendsListToShareWith.jsx","components/Buttons/SeeMoreRoundButton.jsx","components/Info/SongInfo.jsx","features/search/lib/save-search-history.js","features/author/ui/molecules/author-item-big.jsx","components/Lists/AuthorsList.jsx","hooks/useAddOrDeleteSong.js","components/Basic/Hint.jsx","components/Playlist/AddToPlaylistItem.jsx","features/full-screen-player/ui/molecules/add-to-playlists.jsx","features/song/lib/add-song-to-library.js","functions/other/filterArrayWithArray.js","functions/other/deleteSongFromLibrary.js","features/full-screen-player/ui/molecules/add-or-delete-song-button.jsx","features/full-screen-player/ui/organisms/options.jsx","components/MessagePlates/ErrorPlate.jsx","functions/other/transformLyricsToArrayOfObject.js","components/AdminAndAuthor/EditSong.jsx","components/Windows/SongItemMobileMoreWindow.jsx","components/Windows/SongItemMoreWindow.jsx","features/song/lib/hooks/use-add-or-delete-song.js","features/song/ui/molecules/add-or-delete-button.jsx","functions/other/rightFormatForBigNumber.js","features/song/ui/molecules/show-additional-info.jsx","features/song/ui/organisms/song-item.jsx","shared/ui/molecules/slider.jsx","features/full-screen-player/ui/atoms/loading.jsx","hooks/useOnScreen.js","features/full-screen-player/ui/molecules/lyrics-paragraph.jsx","shared/data/player-right-side.js","features/full-screen-player/ui/organisms/share.jsx","features/full-screen-player/ui/organisms/lyrics.jsx","features/full-screen-player/ui/organisms/queue.jsx","features/full-screen-player/ui/full-screen-player.jsx","components/Basic/NotificationCircle.jsx","shared/ui/atoms/download-button.jsx","components/Loading/FullScreenLoading.jsx","components/SignIn-Up/RadioBtn.jsx","components/AddWindow/AddPlaylist.jsx","components/LibraryPage/CreatePlaylistPage.jsx","utils/route-consts.js","shared/data/left-side-bar.js","features/leftside-bar/ui/atoms/container.jsx","features/chats/lib/amount-of-unseen-messages.js","features/leftside-bar/lib/use-amount-of-unseen-messages.js","features/leftside-bar/ui/atoms/navigation-item.jsx","features/leftside-bar/ui/molecules/navigation-panel.jsx","shared/lib/hooks/use-user-online.js","components/Basic/IsUserOnlineCircle.jsx","shared/ui/atoms/online-circle-animation.jsx","shared/api/song-api.js","features/author/lib/hooks/use-last-song-listened.jsx","features/leftside-bar/ui/molecules/Person.jsx","hooks/usePlaylistSongs.js","features/leftside-bar/ui/molecules/TinyPlaylist.jsx","features/leftside-bar/ui/organisms/leftside-bar.jsx","hooks/useMediaMetadata.js","components/Buttons/MoreBtn.jsx","pages/settings/ui/molecules/title-with-more-btn.jsx","components/Lists/SongList.jsx","features/album/ui/organisms/customize-album.jsx","features/author/lib/add-author-to-library.js","features/author/lib/add-friend.js","features/author/lib/delete-author-from-library.js","features/author/ui/molecules/chat-with-friend-button.jsx","features/author/ui/molecules/last-song-listened.jsx","features/author/ui/organisms/customize-author.jsx","functions/add/addPlaylistToLibrary.js","functions/other/removePlaylistFromLibrary.js","hooks/useAlbumAuthors.js","shared/ui/atoms/go-back-button.jsx","components/Info/AlbumInfo.jsx","components/Info/AuthorInfo.jsx","components/Windows/AuthorMoreWindow.jsx","components/AuthorPage/SmallImages.jsx","components/AuthorPage/Header.jsx","functions/delete/deletePlaylist.js","functions/other/quitPlaylist.js","features/author/lib/delete-friend.js","components/Containers/ContentContainer.jsx","pages/album/index.jsx","components/AddWindow/AddSong.jsx","components/AdminAndAuthor/AddWindow.jsx","components/AuthorPage/PersonTinyList.jsx","functions/find/findAuthorsAlbums.js","components/Playlist/DeletedPlaylist.jsx","components/AuthorPage/PlaylistItem.jsx","components/Lists/AlbumList.jsx","components/AuthorPage/Playlists.jsx","features/author/ui/atoms/friend-request-item.jsx","features/author/lib/hooks/use-friend-request.jsx","features/author/ui/molecules/friend-request.jsx","functions/find/findIfSongIsNew.js","features/author/ui/molecules/top-songs.jsx","shared/lib/find-similar-artists.js","features/author/ui/organisms/similar-artists.jsx","pages/author/index.jsx","features/chats/ui/atoms/amount-of-unseen-messages.jsx","features/dialogue/ui/atoms/seen-by-circle.jsx","features/dialogue/ui/atoms/typing-animation.jsx","features/chats/ui/molecules/last-sent-message.jsx","features/chats/ui/organisms/chat-item.jsx","features/chats/lib/hooks/use-create-chat.jsx","features/chats/ui/organisms/create-chat.jsx","pages/chats/index.jsx","features/dialogue/ui/atoms/date-on-top.jsx","features/dialogue/lib/hooks/use-chat-header.js","features/dialogue/lib/leave-chat.js","features/dialogue/ui/atoms/leave-chat-button.jsx","features/dialogue/ui/molecules/attachment-list.jsx","shared/lib/filter-array-of-objects-with-array.js","features/dialogue/lib/add-people-to-chat.js","features/dialogue/ui/organisms/add-people-to-chat.jsx","features/dialogue/ui/organisms/chat-info.jsx","features/dialogue/ui/atoms/wallpaper-item.jsx","features/dialogue/ui/molecules/wallpapers.jsx","hooks/fetchFirebaseData.js","features/dialogue/ui/molecules/chat-more-button.jsx","features/dialogue/ui/organisms/chat-header.jsx","features/dialogue/lib/what-to-write-in-response-item.js","features/dialogue/ui/molecules/attached-items-in-chat-input.jsx","features/dialogue/ui/organisms/chat-input.jsx","features/dialogue/lib/hooks/use-mark-message-read.js","components/Loading/SongItemLoading.jsx","features/dialogue/ui/molecules/message-item.jsx","features/dialogue/ui/organisms/message-field.jsx","features/dialogue/ui/molecules/system-message.jsx","features/dialogue/ui/molecules/display-chat-messages.jsx","features/dialogue/ui/organisms/chat-messages-window.jsx","pages/dialogue/index.jsx","hooks/useRealTimeMessages.js","pages/history/index.jsx","features/home/ui/organisms/main-banner.jsx","features/home/ui/organisms/recent-songs.jsx","features/home/ui/organisms/recommended-authors.jsx","components/MessagePlates/ImportantMessage.jsx","features/home/ui/organisms/recommended-songs.jsx","features/home/ui/organisms/top-15-Songs.jsx","pages/home/index.jsx","functions/find/findVisiblePlaylists.js","images/wave2.svg","components/LibraryPage/LibraryPlaylistItem.jsx","components/LibraryPage/SongsPage.jsx","components/LibraryPage/PlaylistsPage.jsx","components/LibraryPage/AuthorsPage.jsx","pages/library/index.jsx","components/SignIn-Up/BlurredBg.jsx","components/SignIn-Up/TitleAndLogo.jsx","pages/login/index.jsx","features/lyrics-editing/ui/molecules/lyrics.jsx","features/lyrics-editing/ui/molecules/song-image-and-name.jsx","pages/lyrics-editing/index.jsx","pages/page-not-found/index.jsx","features/search/lib/hooks/use-search-history.jsx","features/search/ui/organisms/search-history.jsx","pages/search/index.jsx","pages/settings/ui/orgamisms/account-settings.jsx","pages/settings/ui/molecules/switch-toggle.jsx","pages/settings/ui/atoms/settings-item.jsx","pages/settings/ui/orgamisms/chat-settings.jsx","pages/settings/ui/orgamisms/music-settings.jsx","pages/settings/ui/molecules/settings-list.jsx","pages/settings/ui/atoms/settings-section-item.jsx","pages/settings/ui/molecules/settings-sections.jsx","pages/settings/index.jsx","routes.js","pages/signup/index.jsx","routers/ContentRouter.js","shared/lib/hooks/use-chat-notifications.js","components/BottomControlBar/MobileControlBarItem.js","components/Mobile/BottomControlBar.jsx","components/Mobile/FullBottomSide.jsx","music/notification.mp3","components/Windows/chat-notification-window.jsx","components/Windows/ConfirmWindow.jsx","components/Windows/MessageWindow.jsx","components/Windows/ModalWindow.jsx","components/Basic/ContentWrapper.jsx","hooks/useUpdateListenCount.js","routers/AppRouter.js","app/index.js","index.js"],"names":["app","firebase","initializeApp","apiKey","process","authDomain","projectId","storageBucket","messagingSenderId","appId","measurementId","analytics","auth","storage","firestore","LoadingData","className","loading","src","Logo","alt","normalizeString","str","replace","toLowerCase","findVariantsOfName","name","variantsOfName","personName","i","length","push","substr","AuthContext","React","createContext","useAuth","useContext","AuthProvider","children","useState","currentUser","setCurrentUser","userId","setUserId","setLoading","searchValue","setSearchValue","useEffect","collection","doc","onSnapshot","user","data","undefined","uid","onAuthStateChanged","a","value","login","email","password","setError","signInWithEmailAndPassword","then","catch","err","message","signup","role","photoURL","imageColors","createUserWithEmailAndPassword","result","set","displayName","isAuthor","parseInt","isVerified","numberOfListenersPerMonth","ownSongs","ownPlaylists","addedSongs","addedPlaylists","addedAuthors","lastSongPlayed","chats","friends","subscribers","regDate","FieldValue","serverTimestamp","place","rank","history","logout","signOut","Provider","ScreenContext","useScreen","ScreenProvider","window","innerWidth","screenWidth","setScreenWidth","innerHeight","screenHeight","setScreenHeight","isMobile","setIsMobile","handleResize","addEventListener","removeEventListener","AddToListCircle","listOfChosenItems","setListOfChosenItems","itemId","onClick","e","preventDefault","style","width","includes","type","filteredList","filter","el","color","prev","amountOfZeros","number","toDateTime","secs","t","Date","setSeconds","displayDate","stringDate","displayMode","Months","newDate","isNaN","seconds","getMonth","getDate","getFullYear","getHours","getMinutes","LastSeen","userUID","lastSeen","setLastSeen","isOnline","setIsOnline","unsubscribe","fiveMinutesAgo","getTime","online","RightIconWrapper","styled","div","PersonTiny","chosenArray","setChosenArray","rightButton","restProps","addSongToHistory","songId","get","res","songsList","unshift","update","shuffleSongs","songsArray","randomIndexesArray","newSongsNumbersArray","Array","counter","randNum","Math","floor","random","useConditionFunc","fetchFunc","changeCondition","dep","JSON","stringify","checkNumber","max","min","fetchItemList","list","setList","resManipulation","lastFunc","lengthRestrict","assignMode","tempArray","map","Promise","all","finalResult","temp","forEach","item","find","ModalContext","useModal","ModalClassProvider","openModal","setOpenModal","content","setContent","isOpenned","bottomMessage","setBottomMessage","isOpenConfirm","setIsOpenConfirm","confirmText","rejectText","onConfirmL","onReject","confirmContent","setConfirmContent","closeConfirm","toggleModal","openConfirm","question","onConfirm","openBottomMessage","time","setTimeout","SongContext","useSong","SongProvider","yourSongs","setYourSongs","yourPlaylists","setYourPlaylists","yourAuthors","setYourAuthors","yourFriends","setYourFriends","currentSongQueue","setCurrentSongQueue","currentSong","setCurrentSong","currentSongInQueue","setCurrentSongInQueue","currentSongPlaylistSource","setCurrentSongPlaylistSource","inputRange","setInputRange","id","currentSongData","setCurrentSongData","imgColors","setImgColors","play","setPlay","currentTime","setCurrentTime","songDuration","setSongDuration","repeatMode","setRepeatMode","shuffleMode","setShuffleMode","currentParagraph","setCurrentParagraph","isThereKaraoke","setIsThereKaraoke","openFullScreenPlayer","setOpenFullScreenPlayer","songRef","useRef","currentParagraphRef","inputRef","leftSideBarInputRef","rightSideCurrentPage","setRightSideCurrentPage","openMenu","setOpenMenu","fetchQueue","lastQueue","findIndex","fetchYourSongs","slice","reverse","fetchCurrentSongInitial","tempSongObject","songSrc","authors","cover","listens","releaseDate","lyrics","curSong","curQueue","source","image","docRef","exists","songData","error","console","log","defineCurrentParagraph","first","last","roundedTime","parseFloat","current","toFixed","midPoint","blockStartTime","startTime","nextBlockStartTime","correctSongNumber","currentSongId","playlistId","String","concat","friend","status","obj","shuffledSongsArray","song","document","title","nextSong","prevSong","playSong","pause","playing","event","target","defineCurrentParagraphLight","changeCurrentTime","localName","displayAuthors","authorsList","separatingSign","to","stopPropagation","displayAuthorsFull","loadSongData","duration","useOutsideClick","ref","setFunc","handleClickOutside","contains","getShortString","word","len","displayAuthorsStr","authorslist","separator","lenLimit","authorsString","author","join","findLenOfAuthors","correctTimeDisplay","ColorCircles","opacity","transform","Player","textLimit","linkToAuthors","overflow","animation","whiteSpace","step","onChange","background","PersonTinyVerticalItem","person","getUID","c","piece","toString","createChat","participants","chatUID","chatName","chatImage","admins","messages","wallpaper","typing","personId","chatInfo","findChatURL","allParticipants","setShouldCreate","setFriendChatId","foundChat","chatId","where","docs","chat","count","every","sendMessage","chatData","sender","messageText","attachedSongs","attachedAlbums","attachedAuthors","inResponseToMessage","trim","tempMessages","sentTime","seenBy","shareWithFriends","shareList","whatToShare","setCompleted","sortedFriends","resolve","LoadingCircle","top","useSearch","setAllFoundSongs","setResultAuthorList","setResultPlaylists","defaultSearchMode","searchMode","defaultSongsListValue","defaultAuthorsListValue","defaultPlaylistsListValue","setMessage","foundAnything","setFoundAnything","inputValue","setInputValue","findItem","defaultList","foundItemTempArray","normalizedSearch","itemData","realData","isPrivate","authorsIdsArray","sort","b","songsIdsArray","albumsIdsArray","findSomething","searchText","rankCurrentHint","hintName","hintUid","SearchBarButtons","props","setValue","visibility","cursor","SearchFilterItem","text","setSearchMode","index","SearchFilters","display","findSearchHints","hints","hint","transliteWord","dictionaryRuToEn","dictionaryEnToRu","'","split","reduce","acc","letter","useLoadHints","setCurrentHint","inputFocused","setSearchHints","sortedHints","findRightIcon","SearcHintItem","currentHint","setInputFocused","height","marginLeft","SearchHints","searchHints","key","SearchBar","focus","inputText","marginTop","onFocus","borderRadius","placeholder","onKeyDown","handleCurrentHint","position","ButtonWrapper","button","textLen","Button","icon","visible","Wrapper","margin","InputWrapper","input","Input","required","SubmitButtonWrapper","isLoading","isActive","completed","SubmitButton","action","TinyPersonsList","listOfPeople","marginBottom","FriendsListToShareWith","chosenFriends","setChosenFriends","setMessageText","foundPeople","setFoundPeople","maxHeight","overflowY","flexDirection","SeeMoreRoundButton","SongInfo","setSongData","friendsThatHaveThisSong","setFriendsThatHaveThisSong","findFriendsThatHaveThisSong","backgroundImage","alignItems","fontSize","marginRight","minHeight","saveSearchHistory","itemType","newItemSaved","AuthorItemBig","listOfChosenAuthors","setListOfChosenAuthors","shouldSaveSearchHistory","AuthorsList","listOfAuthors","scrollLeft","setScrollLeft","wrapperRef","shouldRenderRightArrow","setShouldRenderRightArrow","scrollWidth","offsetWidth","onScroll","useAddOrDeleteSong","playlistSongs","setPlaylistSongs","isAdded","setIsAdded","response","songs","newSongsList","songNum","sortedPlaylists","Hint","direction","AddToPlaylistItem","playlist","addFunc","AddToPlaylists","addSongToLibrary","songAuthorsUIDS","finalAuthorsUIDS","authorId","newList","filterArrayWithArray","whatToFilter","withWhatToFilter","this","indexOf","deleteSongFromLibrary","songObj","filtered","finalFilteredAuthors","AddOrDeleteButtonFull","ErrorPlate","errorMessage","transformLyricsToArrayOfObjects","arrayOfParagraphs","startSubstr","fixedLyrics","EditSong","songName","setSongName","songAuthors","setSongAuthors","songCover","setSongCover","setImageColors","setLyrics","foundAuthors","setFoundAuthors","setErrorMessage","removeAuthorFromList","people","justifyContent","padding","manuallyChangeColor","isAdmin","some","addAuthor","fontWeight","authorRef","authorData","authorSongs","filteredSongs","SongItemMobileMoreWindow","SongItemMoreWindow","openMoreWindow","moreWindowPosRelativeToViewport","bottom","AddOrDeleteButton","addSong","removeSong","rightFormanForBigNumber","ShowAdditionInfo","showListens","isNewSong","SongItem","memo","localIndex","listOfChosenSongs","setListOfSongs","setOpenMoreWindow","setMoreWindowPosRelativeToViewport","currentItemRef","getBoundingClientRect","Slider","pages","currentPage","setCurrentPage","pageName","Loading","timeSpan","pointerEvents","useOnScreen","isIntersecting","setIntersecting","observer","IntersectionObserver","entry","observe","disconnect","LyricsParagraph","lyricsModeratorMode","karaokeModeratorTimes","setKaraokeModeratorTimes","setInputKaraokeTime","inputKaraokeTime","paragraphRef","isVisible","paragraphStyle","abs","addLyricsBlock","indexOfRelativeElement","tempTimes","splice","convertedToNumber","inputKaraoke","rightSide","component","socialMedia","social","setLyricsModeratorMode","canUpdateLyrics","setCanUpdateLyrics","scrollIntoView","paragraph","tempSongData","FullScreenPlayer","lyricsRef","transformTransition","setTransformTransition","mobileMenuTransition","setMobileMenuTransition","deltaY","setDeltaY","deltaYMobileMenu","setDeltaYMobileMenu","mobileContentScroll","mobileMenuRef","handlers","useSwipeable","onSwiping","bgRef","handlersForMobileMenu","scrollTop","onSwipedLeft","onSwipedRight","dropDelta","clearTimeout","returnToInitialMobileMenu","rightSideContent","RightSidePage","noLyrics","changeRightSidePage","documentElement","setProperty","zIndex","transition","onTouchEnd","NotificationCircleWrapper","NotificationCircle","DownloadButtonWrapper","DownloadButton","setItemSrc","setImageLocalPath","isImage","file","files","isValid","validExtensions","ext","ex","URL","createObjectURL","storageRef","fileRef","child","put","getDownloadURL","onFileChange","FullScreenLoading","RadioBtn","currentActive","label","AddPlaylist","playlistName","setPlaylistName","playlistCover","setPlaylistCover","authorsInputValue","setAuthorsInputValue","allAuthors","setAllAuthors","chosenAuthors","setChosenAuthors","setReleaseDate","songsSearch","setSongsSearch","allSongs","setAllSongs","chosenSongs","setChosenSongs","playlistStatus","setPlaylistStatus","isPlaylistPrivate","setIsPlaylistPrivate","imageLocalPath","loadingPlaylist","setLoadingPlaylist","creationDate","isAlbum","authorPlaylists","getColors","colors","removeSongFromList","CreatePlaylistPage","LOGIN_ROUTE","SIGNUP_ROUTE","HOME_ROUTE","LIBRARY_ROUTE","SEARCH_ROUTE","CHAT_ROUTE","HISTORY_ROUTE","leftSideBar","link","LeftsideBarContainer","amountOfUnseenMessages","accum","useAmountOfUnseenMessages","amount","setAmount","snapshot","NavigationItem","notificationValue","NavigationPanel","home","library","search","useUserOnline","IsUserOnlineCircle","OnlineCircleAnimationWrapper","OnlineCircleAnimation","getSongById","useLastSongListened","Person","friendChatId","shouldCreate","sendAnimation","setSendAnimation","loadingSendSong","setLoadingSendSong","chooseSongItem","shareWithManyFriends","usePlaylistSongs","listSongsIds","albumSong","TinyPlaylist","playSongsInPlaylist","useHistory","backgroundPosition","backgroundSize","left","LeftsideBar","userNotifications","setUserNotifications","currentFriendToPlaylistPage","setCurrentFriendToPlaylistPage","page","location","hash","alignSelf","useMediaMetadata","updatePositionState","navigator","mediaSession","setPositionState","playbackRate","pauseSong","metadata","MediaMetadata","artist","album","artwork","sizes","setActionHandler","MoreBtn","func","lenOfList","maxLen","boolVal","TitleWithMoreBtn","SongList","listOfSongs","showCount","showSearch","displayIfEmpty","showhistory","isHorizontal","showMoreSongs","setShowMoreSongs","localSearchValue","setLocalSearchValue","displaySongs","setDisplaySongs","allFoundSongs","CustomizeAlbum","loadingAuthors","loadingSongs","setLoadingSongs","filteredPlaylists","addAuthorToLibrary","addFriend","friendData","updatedDataForFriend","updatedDataForCurrentUser","deleteAuthorFromLibrary","ChatWithFriendButton","textDecoration","LastSongListened","CustomizeAuthor","authorName","authorCover","setAuthorCover","onSubmit","addPlaylistToLibrary","playlistData","removePlaylistFromLibrary","useAlbumAuthors","albumAuthors","setAlbumAuthors","authorsImages","setAuthorsImages","ids","authrorsData","tempArrayAuthors","tempArrayImages","fetchAuthorsData","GoBackBtn","goBack","AlbumInfo","friendsThatHaveThisAlbum","setFriendsThatHaveThisAlbum","findFriendsThatHaveThisAlbum","AuthorInfo","setFriendsThatHaveThisAuthor","findFriendsThatHaveThisAuthor","AuthorMoreWindow","SmallImages","imagesList","borderColor","border","Header","headerColors","isFriend","moreWindowRef","personFilteredPlaylists","pId","delete","quitPlaylist","filteredUserFriends","filteredOtherUserFriends","deleteFriend","backgroundColor","ContentContainer","AlbumPage","match","useRouteMatch","setHeaderColors","albumId","params","albumData","setAlbumData","fetchAlbumsData","fetchSongsInAlbum","flex","boxShadow","AddSong","setSongSrc","loadingSong","setLoadingSong","AddWindow","openAddSongWindow","setOpenAddSongWindow","currentSliderPage","setCurrentSliderPage","sliderPages","PersonTinyList","setListOfPeople","personObj","personData","findAuthorsAlbums","authorsData","setAuthorsPlaylists","currentUserUID","DeletedPlaylist","PlaylistItem","listOfChosenAlbums","setListOfChosenAlbums","playlistDate","AlbumList","listOfAlbums","Playlists","authorsPlaylists","FriendRequestItem","rejectFriend","useFriendRequest","friendRequests","setFriendRequests","friendObj","fetchFriendRequests","friendsList","otherUserFriendList","arrOfReqs","FriendRequest","findIfSongIsNew","songReleaseDate","TopSongs","popularSongs","setPopularSongs","newSongs","setNewSongs","prevSongs","findAuthorsSongs","findSimilarArtistsNames","authorsSongsArr","setSimilarAuthors","peopleArray","newAuthors","flat","uniqueAuthorsSet","Set","uniqueAuthorsIdsArray","from","uniqueAuthorsDataArray","j","findSimilarArtists","authorsSongsArray","SimilarArtists","similarArtists","setSimilarArtists","AuthorPage","setAuthorsData","AmountOfUnseenMessages","amountOfUnseen","SeenByCircle","listOfSeen","TypingAnimation","typingPeople","typingPeopleData","setTypingPeopleData","LastSentMessage","isGroup","showUnseenCircle","messageLen","lastAttachedItem","setLastAttachedItem","shouldPutDot","setShouldPutDot","lastMessage","setLastMessage","messageIcons","lastIcon","setLastIcon","findWhatToWriteUnderName","ChatItem","otherPerson","setOtherPerson","setAmountOfUnseen","setMessages","setTyping","otherPersonId","fetchOtherPerson","now","useCreateChat","foundFriends","setFoundFriends","chatCover","setChatCover","setChatName","allowedToCreate","setAllowedToCreate","handleCreateChat","CreateChat","ChatPage","yourChats","setYourChats","DateOnTop","date","useChatHeader","leaveChat","newParticipants","participantId","LeaveChatButton","isCurrentUserLeaving","AttachmentList","attachmentList","setAttachmentList","sliderCurrentPage","setSliderCurrentPage","attachmentContent","fetchAttachedData","attachedType","firebaseCollection","filterArrayOfObjectsWithArray","filterParametr","isInverted","addPeopleToChat","AddPeopleToChat","filteredFriends","ChatInfo","setParticipants","chatNameValue","setChatNameValue","newChatPhoto","setNewChatPhoto","newImageLocalPath","setNewImageLocalPath","newImageColors","setNewImageColors","participantsPage","setParticipantsPage","showUpdateBtn","setShowUpdateBtn","WallpaperItem","currentWallpaper","Wallpapers","wallpaperList","setWallpaperList","setState","sortCondition","whereCondFP","whereCondSP","whereCondTP","deps","fetchData","useFetchFirebaseData","ChatMoreBtn","chatMoreBtnRef","ChatHeader","whatToWriteInResponseToItem","referedMessage","AttachedItemsInChatInput","attachedItems","setAttachedItems","setItems","removeItemFromAttached","ChatInput","setInResponseToMessage","otherMessages","openAttachWindow","setOpenAttachWindow","setAttachedSongs","setAttachedAlbums","setAttachedAuthors","resultPlaylists","resultAuthorList","inResponseNames","setInResponseNames","attachedSongsNames","setAttachedSongsNames","attachWindowRef","sendMessageFull","messageId","outline","useMarkMessageRead","messageData","messageRef","SongItemLoading","MessageItem","scrollToMessageRef","setScrollToMessageId","scrollToMessageId","showPhoto","inResponseToMessageArr","setInResponseToMessageArr","userThatSentMessage","setUserThatSentMessage","messageSentTime","attachedSongsData","setAttachedSongsData","attachedAuthorsData","setAttachedAuthorsData","attachedPlaylistsData","setAttachedPlaylistsData","inResponseToMessagesData","setInResponseToMessagesData","swipeDeltaX","setSwipeDeltaX","deltaX","addMessageToResponseList","returnToInitial","fetchSentMessageUser","paddingBottom","MessageField","messageList","setDateRefsArray","setShowPhoto","showDate","setShowDate","dateRef","SystemMessageWrapper","SystemMessage","DisplayChatMessages","messagesWindowRef","scrollTo","offsetTop","ChatMessagesWindow","findTopDate","scroll","scrollHeight","clientHeight","scrollToBottom","DialoguePage","dateRefsArray","setChatData","setMessageList","currentDateOnTop","setCurrentDateOnTop","innerHTML","useRealTimeMessages","HistoryPage","historySongsIds","setHistorySongsIds","historySongs","setHistorySongs","MainBanner","bannerColors","setBannerColors","setcurrentSliderPage","topAuthor","setTopAuthor","topSong","setTopSong","topAlbum","setTopAlbum","findTop","criterion","orderBy","limit","RecentSongs","recentSongs","setRecentSongs","tempSongsIds","findRecentSongs","RecommendedAuthors","recommendationAuthors","setRecommendationAuthors","uniqueAuthors","setUniqueAuthors","uniqueAuthorsUIDSArray","ImportantMessage","RecommendedSongs","recommendedSongs","setRecommendedSongs","fetchRecommendedSongs","Top15Songs","topSongs","setTopSongs","HomePage","findVisiblePlaylists","LibraryPlaylistItem","SongsPage","playlistsVisible","setPlaylistsVisible","p","wave","PlaylistsPage","playlistsDisplay","setPlaylistsDisplay","AuthorsPage","setDisplayAuthors","LibraryPage","libraryPages","BlurredBg","TitleAndLogo","LogInPage","setEmail","setPassword","disabled","LyricsWrapper","Lyrics","lyricItem","SongImageAndNameWrapper","SongImageAndName","LyricsEditingWrapper","LyricsEditingPage","PageNotFound","useSearchHistory","historyPlaylists","setHistoryPlaylists","historyAuthors","setHistoryAuthors","SearchHistory","SearchPage","resultSongList","setResultSongList","resultAlbumList","setResultAlbumList","shadowColor","setShadowColor","AccountSettings","SwitchToggle","boolValue","setBoolValue","SettingsItemWrapper","SettingsItem","handleChangeToggle","val","ChatSettings","MusicSettings","SettingsListWrapper","SettingsList","settingsPages","SettingsSectionItemWrapper","SettingsSectionItem","SettingsSectionsWrapper","SettingsSections","SettingsPageWrapper","SettingsPage","publicRoutes","path","Component","currentRoleChoice","setCurrentRoleChoice","setName","setPhotoURL","privateRoutes","ContentRouter","exact","useChatNotifications","notifications","setNotifications","tempObj","docChanges","MobileControlBarItem","element","BottomControlBar","userElement","FullBottomSide","ChatNotificationWindowWrapper","show","ChatNotificationWindow","notifsLen","userData","setUserData","setShow","Audio","notifSound","ConfirmWindow","confirmRef","MessageWindow","findColor","light","dark","findIcon","ModalWindow","modalRef","ContentWrapper","intervalExciter","setIntervalExciter","updateListenCount","listenCountTimeOut","sourceId","listedData","authorNumberOfListenersPerMonth","useUpdateListenCount","interval","setInterval","clearInterval","onLoadedData","onTimeUpdate","onEnded","notif","AppRouter","App","basename","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.2ddb0679.chunk.js","sourcesContent":["import firebase from 'firebase/app'\r\nimport 'firebase/storage'\r\nimport 'firebase/auth'\r\nimport 'firebase/firestore'\r\nimport 'firebase/analytics'\r\nimport seedDatabase from './seedDatabase';\r\n\r\nconst app = firebase.initializeApp({\r\n\tapiKey: process.env.REACT_APP_FIREBASE_API_KEY,\r\n\tauthDomain: process.env.REACT_APP_FIREBASE_AUTH_DOMAIN,\r\n\tprojectId: process.env.REACT_APP_FIREBASE_PROJECT_ID,\r\n\tstorageBucket: process.env.REACT_APP_FIREBASE_STORAGE_BUCKET,\r\n\tmessagingSenderId: process.env.REACT_APP_FIREBASE_MESSAGING_SENDER_ID,\r\n\tappId:process.env.REACT_APP_FIREBASE_APP_ID,\r\n\tmeasurementId: process.env.REACT_APP_MEASUREMENT_ID\r\n});\r\nfirebase.analytics();\r\nexport const auth = app.auth()\r\nexport const storage = app.storage()\r\nexport const firestore = app.firestore()\r\n// seedDatabase(firestore)\r\nexport default app","export default __webpack_public_path__ + \"static/media/Logo3.fc53f4ac.svg\";","import React from 'react'\r\nimport Logo from '../../images/Logo3.svg'\r\nexport const LoadingData = () => {\r\n\treturn (\r\n\t\t<div className = \"LoadingData\">\r\n\t\t\t<img loading = \"lazy\" src={Logo} alt=\"\" />\r\n\t\t</div>\r\n\t)\r\n}\r\n","export default function normalizeString(str) {\r\n\treturn str.replace(/\\s/g, '').replace(/\\$/g, \"s\").replace(/[,'._/]/g, '').replace(/-/g, '').toLowerCase()\r\n}","import normalizeString from \"../other/normalizeString\"\r\n\r\nexport const findVariantsOfName = (name) => {\r\n\tlet variantsOfName = []\r\n\tlet personName = normalizeString(name)\r\n\tfor (let i = 1; i < personName.length + 1; i++) {\r\n\t\tvariantsOfName.push(personName.substr(0, i))\r\n\t}\r\n\treturn variantsOfName\r\n}","import React, { useContext, useEffect, useState } from \"react\";\r\nimport { auth, firestore } from \"../firebase\";\r\nimport firebase from \"firebase\";\r\nimport { LoadingData } from \"../components/Loading/LoadingData\";\r\nimport { findVariantsOfName } from \"../functions/find/findVariantsOfName\";\r\n\r\nconst AuthContext = React.createContext();\r\n\r\nexport const useAuth = () => {\r\n  return useContext(AuthContext);\r\n};\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n  const [currentUser, setCurrentUser] = useState({});\r\n  const [userId, setUserId] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [searchValue, setSearchValue] = useState(\"\");\r\n  function login(email, password, setError, setLoading) {\r\n    setLoading(true);\r\n    return auth\r\n      .signInWithEmailAndPassword(email, password)\r\n      .then()\r\n      .catch((err) => {\r\n        setError(err.message);\r\n        setLoading(false);\r\n      });\r\n  }\r\n\r\n  function logout() {\r\n    return auth.signOut();\r\n  }\r\n\r\n  function signup(\r\n    email,\r\n    name,\r\n    password,\r\n    role,\r\n    photoURL,\r\n    imageColors,\r\n    setError,\r\n    setLoading\r\n  ) {\r\n    setLoading(true);\r\n    return auth\r\n      .createUserWithEmailAndPassword(email, password)\r\n      .then((result) => {\r\n        firestore\r\n          .collection(\"users\")\r\n          .doc(result.user.uid)\r\n          .set({\r\n            uid: result.user.uid,\r\n            displayName: name,\r\n            photoURL:\r\n              photoURL ||\r\n              \"https://images.fineartamerica.com/images/artworkimages/mediumlarge/1/music-icon-mohammed-jabir-ap.jpg\",\r\n            isAuthor: parseInt(role) === 1,\r\n            isVerified: parseInt(role) === 1,\r\n            numberOfListenersPerMonth: 0,\r\n            ownSongs: [],\r\n            ownPlaylists: [],\r\n            addedSongs: [],\r\n            addedPlaylists: [],\r\n            addedAuthors: [],\r\n            lastSongPlayed: \"\",\r\n            chats: [],\r\n            friends: [],\r\n            subscribers: 0,\r\n            regDate: firebase.firestore.FieldValue.serverTimestamp(),\r\n            imageColors: imageColors,\r\n          });\r\n        firestore\r\n          .collection(\"search\")\r\n          .doc(result.user.uid)\r\n          .set({\r\n            place: \"users\",\r\n            uid: result.user.uid,\r\n            rank: 0,\r\n            variantsOfName: findVariantsOfName(name),\r\n          });\r\n\r\n        firestore.collection(\"searchHistory\").doc(result.user.uid).set({\r\n          history: [],\r\n        });\r\n\r\n        firestore.collection(\"history\").doc(result.user.uid).set({\r\n          history: [],\r\n        });\r\n        setLoading(false);\r\n      })\r\n      .catch((err) => {\r\n        setError(err.message);\r\n      });\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (userId !== null) {\r\n      const unsubscribe = firestore\r\n        .collection(\"users\")\r\n        .doc(userId)\r\n        .onSnapshot((user) => {\r\n          if (user.data()) {\r\n            if (currentUser.uid === undefined) {\r\n              setCurrentUser(user.data());\r\n            }\r\n          }\r\n        });\r\n      return unsubscribe;\r\n    }\r\n  }, [firestore, userId]);\r\n\r\n  useEffect(() => {\r\n    const unsubscribe = auth.onAuthStateChanged(async (user) => {\r\n      if (user) {\r\n        setUserId(user.uid);\r\n      } else {\r\n        setUserId(null);\r\n        setCurrentUser({});\r\n        setLoading(false);\r\n      }\r\n    });\r\n    return unsubscribe;\r\n  }, []);\r\n\r\n  const value = {\r\n    currentUser,\r\n    setCurrentUser,\r\n    login,\r\n    signup,\r\n    logout,\r\n    loading,\r\n    setLoading,\r\n    searchValue,\r\n    setSearchValue,\r\n  };\r\n  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;\r\n};\r\n","import React, { useContext, useEffect, useState } from \"react\";\r\n\r\nconst ScreenContext = React.createContext();\r\n\r\nexport const useScreen = () => {\r\n  return useContext(ScreenContext);\r\n};\r\n\r\nexport const ScreenProvider = ({ children }) => {\r\n  const [screenWidth, setScreenWidth] = useState(window.innerWidth);\r\n  const [screenHeight, setScreenHeight] = useState(window.innerHeight);\r\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 1000);\r\n  function handleResize() {\r\n    setScreenWidth(window.innerWidth);\r\n    setScreenHeight(window.innerHeight);\r\n    setIsMobile(window.innerWidth < 1000);\r\n  }\r\n\r\n  useEffect(() => {\r\n    window.addEventListener(\"resize\", handleResize);\r\n    return () => {\r\n      window.removeEventListener(\"resize\", handleResize);\r\n    };\r\n  }, []);\r\n\r\n  const value = {\r\n    screenWidth,\r\n    screenHeight,\r\n    isMobile,\r\n  };\r\n  return (\r\n    <ScreenContext.Provider value={value}>{children}</ScreenContext.Provider>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport { IoIosCheckmarkCircle, IoIosRadioButtonOff } from \"react-icons/io\";\r\n\r\nexport const AddToListCircle = ({\r\n  listOfChosenItems,\r\n  setListOfChosenItems,\r\n  itemId,\r\n}) => {\r\n  return listOfChosenItems !== undefined ? (\r\n    <div onClick={(e) => e.preventDefault()} style={{ width: \"35px\" }}>\r\n      {listOfChosenItems.includes(itemId) ? (\r\n        <button\r\n          type=\"button\"\r\n          onClick={(e) => {\r\n            let filteredList = listOfChosenItems.filter((el) => el !== itemId);\r\n            setListOfChosenItems(filteredList);\r\n          }}\r\n          className=\"addToListBtn\"\r\n        >\r\n          <IoIosCheckmarkCircle style={{ color: \"var(--lightBlue)\" }} />\r\n        </button>\r\n      ) : (\r\n        <button\r\n          type=\"button\"\r\n          onClick={() => setListOfChosenItems((prev) => [...prev, itemId])}\r\n          className=\"addToListBtn\"\r\n        >\r\n          <IoIosRadioButtonOff />\r\n        </button>\r\n      )}\r\n    </div>\r\n  ) : null;\r\n};\r\n","\r\nfunction amountOfZeros(number) {\r\n\treturn number % 10 === number ? \"0\" + number : number\r\n}\r\n\r\nfunction toDateTime(secs) {\r\n\tvar t = new Date(1970, 0, 1); // Epoch\r\n\tt.setSeconds(secs);\r\n\treturn t;\r\n}\r\n\r\nexport default function displayDate(stringDate, displayMode = 0){\r\n\tconst Months = [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"]\r\n\tlet newDate = !isNaN(stringDate)?stringDate.seconds?toDateTime(stringDate.seconds + 10800):toDateTime((stringDate/1000) + 10800):new Date(stringDate)\r\n\tif(displayMode === 0){\r\n\t\treturn Months[newDate.getMonth()] + \" \" + newDate.getDate() + \", \" + newDate.getFullYear() \r\n\t}\r\n\r\n\tif(displayMode === 1){\r\n\t\treturn Months[newDate.getMonth()] + \" \" + newDate.getDate()\r\n\t}\r\n\r\n\tif(displayMode === 2){\r\n\t\treturn amountOfZeros(newDate.getHours()) + \":\" + amountOfZeros(newDate.getMinutes())\r\n\t}\r\n\r\n\tif(displayMode === 3){\r\n\t\treturn Months[newDate.getMonth()] + \" \" + newDate.getDate() + \", \" + newDate.getFullYear() + \" at \" + amountOfZeros(newDate.getHours()) + \":\" + amountOfZeros(newDate.getMinutes())\r\n\t}\r\n}","import React, { useEffect, useState } from \"react\";\r\nimport { firestore } from \"../../firebase\";\r\nimport displayDate from \"../../functions/display/displayDate\";\r\n\r\nexport const LastSeen = ({ userUID, ...restProps }) => {\r\n  const [lastSeen, setLastSeen] = useState(\"\");\r\n  const [isOnline, setIsOnline] = useState(false);\r\n  useEffect(() => {\r\n    const unsubscribe = firestore\r\n      .collection(\"users\")\r\n      .doc(userUID)\r\n      .onSnapshot((doc) => {\r\n        if (userUID !== undefined) {\r\n          const fiveMinutesAgo = new Date().getTime() - 300000;\r\n          const isOnline = doc.data().online > fiveMinutesAgo;\r\n          setIsOnline(isOnline);\r\n          if (doc.data().online === undefined) setLastSeen(\"offline\");\r\n          else if (!isOnline)\r\n            setLastSeen(\"last seen \" + displayDate(doc.data().online, 3));\r\n        }\r\n      });\r\n    return () => {\r\n      unsubscribe();\r\n    };\r\n  }, [firestore, userUID]);\r\n  return isOnline ? (\r\n    <span className=\"is-online\">Online</span>\r\n  ) : (\r\n    <span className=\"is-not-online\">{lastSeen}</span>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport { AddToListCircle } from \"../../shared/ui/molecules/add-to-list-circle\";\r\nimport { LastSeen } from \"./LastSeen\";\r\nimport styled from \"styled-components\";\r\n\r\nconst RightIconWrapper = styled.div`\r\n  position: absolute;\r\n  top: 50%;\r\n  right: 8px;\r\n  transform: translateY(-50%);\r\n`;\r\n\r\nexport const PersonTiny = ({\r\n  data,\r\n  chosenArray,\r\n  setChosenArray,\r\n  lastSeen = false,\r\n  rightButton,\r\n  ...restProps\r\n}) => {\r\n  return (\r\n    <div className=\"person\" {...restProps}>\r\n      <AddToListCircle\r\n        listOfChosenItems={chosenArray}\r\n        setListOfChosenItems={setChosenArray}\r\n        itemId={data.uid}\r\n      />\r\n      <div className=\"personImg\">\r\n        <img loading=\"lazy\" src={data.photoURL} alt=\"\" />\r\n      </div>\r\n      <div className=\"personName\">{data.displayName}</div>\r\n      {lastSeen && <LastSeen userUID={data.uid} className=\"is-online\" />}\r\n      <RightIconWrapper>{rightButton}</RightIconWrapper>\r\n    </div>\r\n  );\r\n};\r\n","import { firestore } from \"../../firebase\"\r\n\r\nexport const addSongToHistory = (songId, currentUser) => {\r\n\tfirestore.collection('history').doc(currentUser.uid).get().then(res=>{\r\n\t\tconst songsList = res.data().history\r\n\t\tif(songsList[0] !== songId) songsList.unshift(songId)\r\n\t\tif(songsList.length > 30) songsList.length = 30\r\n\r\n\t\tfirestore.collection('history').doc(currentUser.uid).update({\r\n\t\t\thistory:songsList\r\n\t\t})\r\n\t})\r\n}","export default function shuffleSongs(songsArray){\r\n\tconst randomIndexesArray = []\r\n\tconst newSongsNumbersArray = new Array(songsArray.length)\r\n\tlet counter = 0\r\n\twhile(counter < songsArray.length){\r\n\t\tconst randNum = Math.floor(Math.random()*(songsArray.length))\r\n\t\tif(!randomIndexesArray.includes(randNum)){\r\n\t\t\trandomIndexesArray.push(randNum)\r\n\t\t\tnewSongsNumbersArray[randNum] = songsArray[counter]\r\n\t\t\tcounter++\r\n\t\t}\r\n\t}\r\n\treturn newSongsNumbersArray\r\n}","import { useEffect } from 'react'\r\n\r\nexport const useConditionFunc = (currentUser, fetchFunc, changeCondition, dep) => {\r\n\tuseEffect(() => {\r\n\t\tif (currentUser.uid) {\r\n\t\t\tif (changeCondition) {\r\n\t\t\t\tfetchFunc()\r\n\t\t\t}\r\n\t\t}\r\n\t}, [JSON.stringify(dep)])\r\n}\r\n","export default function checkNumber(number, max, min = 0){\r\n\tif(number > max) return min\r\n\tif(number < min) return max\r\n\r\n\treturn number\r\n}","import { firestore } from \"../../firebase\"\r\n\r\nexport const fetchItemList = (list, collection, setList, resManipulation = (res) => res, lastFunc = () => null, lengthRestrict, assignMode = 0) => {\r\n\tif (list?.length) {\r\n\t\tconst tempArray = list.map(async (itemId, i) => {\r\n\t\t\treturn (await firestore.collection(collection).doc(itemId).get()).data()\r\n\t\t})\r\n\t\tPromise.all(tempArray).then(res => {\r\n\t\t\tlet finalResult = resManipulation(res)\r\n\t\t\tif (finalResult?.length > lengthRestrict) finalResult.length = lengthRestrict\r\n\t\t\tif (assignMode === 0) setList(finalResult)\r\n\t\t\telse setList(prev => {\r\n\t\t\t\tlet temp = []\r\n\t\t\t\tfinalResult.forEach(item => {\r\n\t\t\t\t\tif (item) {\r\n\t\t\t\t\t\tif (!prev.find(el => el['id'] === item['id'])) {\r\n\t\t\t\t\t\t\ttemp.push(item)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\treturn [...prev, ...temp]\r\n\t\t\t})\r\n\t\t\tlastFunc()\r\n\t\t})\r\n\t}\r\n}","import React, { useContext, useState } from \"react\";\r\n\r\nconst ModalContext = React.createContext();\r\n\r\nexport const useModal = () => {\r\n  return useContext(ModalContext);\r\n};\r\n\r\nexport const ModalClassProvider = ({ children }) => {\r\n  const [openModal, setOpenModal] = useState(false);\r\n  const [content, setContent] = useState(<h1>Test</h1>);\r\n  const [bottomMessage, setBottomMessage] = useState({\r\n    isOpenned: false,\r\n    type: \"success\",\r\n    message: \"Action is successfully done!\",\r\n  });\r\n  const [isOpenConfirm, setIsOpenConfirm] = useState(false);\r\n  const [confirmContent, setConfirmContent] = useState({\r\n    confirmText: \"Confirm Action\",\r\n    rejectText: \"Cancel\",\r\n    onConfirmL: () => {\r\n      return null;\r\n    },\r\n    onReject: () => {\r\n      return null;\r\n    },\r\n  });\r\n  function toggleModal() {\r\n    setOpenModal(!openModal);\r\n  }\r\n\r\n  //{question:question, confirmText:..., rejectText:..., onConfirm..., onReject:...}\r\n  function openConfirm(\r\n    question,\r\n    confirmText,\r\n    rejectText = \"Cancel\",\r\n    onConfirm,\r\n    onReject = closeConfirm\r\n  ) {\r\n    setIsOpenConfirm(true);\r\n    setConfirmContent({\r\n      question: question,\r\n      confirmText: confirmText,\r\n      rejectText: rejectText,\r\n      onConfirm: onConfirm,\r\n      onReject: onReject,\r\n    });\r\n  }\r\n\r\n  function closeConfirm() {\r\n    setIsOpenConfirm(false);\r\n  }\r\n\r\n  const openBottomMessage = (\r\n    message = \"Success\",\r\n    type = \"success\",\r\n    time = 3000\r\n  ) => {\r\n    setBottomMessage({\r\n      isOpenned: true,\r\n      type: type,\r\n      message: message,\r\n    });\r\n\r\n    setTimeout(() => {\r\n      setBottomMessage({\r\n        isOpenned: false,\r\n        type: type,\r\n        message: message,\r\n      });\r\n    }, time);\r\n  };\r\n\r\n  const value = {\r\n    openModal,\r\n    setOpenModal,\r\n    toggleModal,\r\n    setContent,\r\n    content,\r\n    isOpenConfirm,\r\n    setIsOpenConfirm,\r\n    openConfirm,\r\n    closeConfirm,\r\n    confirmContent,\r\n    bottomMessage,\r\n    openBottomMessage,\r\n  };\r\n  return (\r\n    <ModalContext.Provider value={value}>{children}</ModalContext.Provider>\r\n  );\r\n};\r\n","import React, {\r\n  createContext,\r\n  useContext,\r\n  useEffect,\r\n  useRef,\r\n  useState,\r\n} from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { PersonTiny } from \"../components/Basic/PersonTiny\";\r\nimport { LoadingData } from \"../components/Loading/LoadingData\";\r\nimport { firestore } from \"../firebase\";\r\nimport { addSongToHistory } from \"../functions/add/addSongToHistory\";\r\nimport { checkKaraoke } from \"../functions/check/checkKaraoke\";\r\nimport shuffleSongs from \"../functions/other/shuffleSongs\";\r\nimport { useConditionFunc } from \"../hooks/useConditionFunc\";\r\nimport checkNumber from \"../shared/lib/check-number\";\r\nimport { fetchItemList } from \"../shared/lib/fetch-item-list\";\r\nimport { useAuth } from \"./AuthContext\";\r\nimport { useModal } from \"./ModalContext\";\r\nconst SongContext = createContext(null);\r\n\r\nexport const useSong = () => {\r\n  return useContext(SongContext);\r\n};\r\n\r\nexport const SongProvider = ({ children }) => {\r\n  const { currentUser, loading, setLoading } = useAuth();\r\n  const { setOpenModal } = useModal();\r\n  const [yourSongs, setYourSongs] = useState([]);\r\n  const [yourPlaylists, setYourPlaylists] = useState([]);\r\n  const [yourAuthors, setYourAuthors] = useState([]);\r\n  const [yourFriends, setYourFriends] = useState([]);\r\n  const [currentSongQueue, setCurrentSongQueue] = useState([]);\r\n  const [currentSong, setCurrentSong] = useState(-1);\r\n  const [currentSongInQueue, setCurrentSongInQueue] = useState(0);\r\n  const [currentSongPlaylistSource, setCurrentSongPlaylistSource] = useState(\r\n    {}\r\n  );\r\n  const [inputRange, setInputRange] = useState(0);\r\n  const [currentSongData, setCurrentSongData] = useState({ id: -1 });\r\n\r\n  const [imgColors, setImgColors] = useState([]);\r\n  const [play, setPlay] = useState(false);\r\n  const [currentTime, setCurrentTime] = useState(0);\r\n  const [songDuration, setSongDuration] = useState(0);\r\n  const [repeatMode, setRepeatMode] = useState(1);\r\n  const [shuffleMode, setShuffleMode] = useState(0);\r\n  const [currentParagraph, setCurrentParagraph] = useState(0);\r\n  const [isThereKaraoke, setIsThereKaraoke] = useState(false);\r\n  const [openFullScreenPlayer, setOpenFullScreenPlayer] = useState(false);\r\n  const songRef = useRef(null);\r\n  const currentParagraphRef = useRef(null);\r\n  const inputRef = useRef(null);\r\n  const leftSideBarInputRef = useRef(null);\r\n  const [rightSideCurrentPage, setRightSideCurrentPage] = useState(0);\r\n  const [openMenu, setOpenMenu] = useState(false);\r\n\r\n  function fetchYourFriends() {\r\n    fetchItemList(\r\n      currentUser.friends\r\n        .filter((friend) => friend.status === \"added\")\r\n        .map((obj) => obj.uid),\r\n      \"users\",\r\n      setYourFriends\r\n    );\r\n  }\r\n\r\n  function fetchQueue() {\r\n    fetchItemList(\r\n      currentUser?.lastQueue?.songsList,\r\n      \"songs\",\r\n      setCurrentSongQueue,\r\n      (res) => res,\r\n      () =>\r\n        setCurrentSongInQueue(\r\n          currentUser.lastQueue.songsList.findIndex(\r\n            (songId) => songId === currentUser.lastSongPlayed\r\n          )\r\n        )\r\n    );\r\n  }\r\n\r\n  function fetchYourSongs() {\r\n    fetchItemList(\r\n      currentUser.addedSongs.slice(0).reverse(),\r\n      \"songs\",\r\n      setYourSongs,\r\n      (res) => res,\r\n      fetchQueue\r\n    );\r\n  }\r\n\r\n  function fetchYourAuthors() {\r\n    fetchItemList(currentUser.addedAuthors, \"users\", setYourAuthors);\r\n  }\r\n\r\n  async function fetchCurrentSongInitial() {\r\n    if (currentUser.uid !== undefined) {\r\n      const tempSongObject = {\r\n        id: -1,\r\n        name: \"\",\r\n        songSrc: \"\",\r\n        authors: [],\r\n        cover: \"\",\r\n        listens: 0,\r\n        releaseDate: \"\",\r\n        lyrics: [],\r\n        imageColors: [],\r\n      };\r\n      const curSong =\r\n        currentUser.lastSongPlayed ||\r\n        currentUser.addedSongs[0] ||\r\n        tempSongObject.id;\r\n      const curQueue =\r\n        currentUser.lastQueue || {\r\n          source: \"/library\",\r\n          name: \"Your Library\",\r\n          image: currentUser.photoURL,\r\n          songsList: yourSongs,\r\n        } ||\r\n        [];\r\n      setCurrentSong(curSong);\r\n      setCurrentSongPlaylistSource(curQueue);\r\n\r\n      if (curSong !== -1) {\r\n        const docRef = firestore.collection(\"songs\").doc(curSong);\r\n        const docData = docRef\r\n          .get()\r\n          .then((doc) => {\r\n            if (doc.exists) {\r\n              const songData = doc.data();\r\n              setCurrentSongData(songData);\r\n              setImgColors(songData.imageColors || []);\r\n              setLoading(false);\r\n            }\r\n          })\r\n          .catch((error) => {\r\n            console.log(\"Error getting document:\", error);\r\n            setLoading(false);\r\n          });\r\n      } else {\r\n        setCurrentSongData(tempSongObject);\r\n        setImgColors([]);\r\n        setLoading(false);\r\n      }\r\n    }\r\n  }\r\n\r\n  async function fetchCurrentSong() {\r\n    if (currentSong !== -1) {\r\n      firestore\r\n        .collection(\"songs\")\r\n        .doc(currentSong)\r\n        .get()\r\n        .then((doc) => {\r\n          if (doc.exists) {\r\n            const songData = doc.data();\r\n            setImgColors(songData.imageColors || []);\r\n            setCurrentSongData(songData);\r\n          }\r\n        });\r\n    } else fetchCurrentSongInitial();\r\n  }\r\n\r\n  function fetchYourPlaylists() {\r\n    const tempArray = [];\r\n    if (currentUser.ownPlaylists) {\r\n      currentUser.ownPlaylists.map((playlistId, i) => {\r\n        const response = firestore.collection(\"playlists\").doc(playlistId);\r\n        response\r\n          .get()\r\n          .then((doc) => {\r\n            if (doc.exists) {\r\n              tempArray.push(doc.data());\r\n              if (i === currentUser.ownPlaylists.length - 1)\r\n                setYourPlaylists(tempArray);\r\n            } else {\r\n              console.log(\"No such document!\");\r\n            }\r\n          })\r\n          .catch((error) => {\r\n            console.log(\"Error getting document:\", error);\r\n          });\r\n      });\r\n    }\r\n\r\n    if (currentUser.addedPlaylists) {\r\n      currentUser.addedPlaylists.map((playlistId, i) => {\r\n        const response = firestore.collection(\"playlists\").doc(playlistId);\r\n        response\r\n          .get()\r\n          .then((doc) => {\r\n            if (doc.exists) {\r\n              tempArray.push(doc.data());\r\n              if (i === currentUser.addedPlaylists.length - 1)\r\n                setYourPlaylists(tempArray);\r\n            } else {\r\n              console.log(\"No such document!\");\r\n            }\r\n          })\r\n          .catch((error) => {\r\n            console.log(\"Error getting document:\", error);\r\n          });\r\n      });\r\n    }\r\n  }\r\n\r\n  useConditionFunc(\r\n    currentUser,\r\n    fetchYourSongs,\r\n    currentUser.addedSongs &&\r\n      currentUser.addedSongs.length !== yourSongs.length,\r\n    [currentUser.addedSongs]\r\n  );\r\n  useConditionFunc(\r\n    currentUser,\r\n    fetchYourPlaylists,\r\n    currentUser.ownPlaylists &&\r\n      String(currentUser.ownPlaylists.concat(currentUser.addedPlaylists)) !==\r\n        String(yourPlaylists),\r\n    [currentUser.ownPlaylists]\r\n  );\r\n  useConditionFunc(\r\n    currentUser,\r\n    fetchYourFriends,\r\n    currentUser.friends &&\r\n      String(currentUser.friends.filter((obj) => obj.status === \"added\")) !==\r\n        String(yourFriends),\r\n    [currentUser.friends]\r\n  );\r\n  useConditionFunc(\r\n    currentUser,\r\n    fetchYourAuthors,\r\n    currentUser.addedAuthors &&\r\n      currentUser.addedAuthors.length !== yourAuthors.length,\r\n    [currentUser.addedAuthors]\r\n  );\r\n  useConditionFunc(\r\n    currentUser,\r\n    fetchCurrentSong,\r\n    currentUser &&\r\n      (currentSongData.id === -1 || currentSong || currentUser.lastSongPlayed),\r\n    [currentSong, currentUser.lastSongPlayed]\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (currentUser.uid === undefined) {\r\n      setCurrentSongData({ id: -1 });\r\n      setCurrentSong(-1);\r\n      setCurrentSongQueue([]);\r\n      setYourAuthors([]);\r\n      setYourSongs([]);\r\n      setYourFriends([]);\r\n      setYourPlaylists([]);\r\n    }\r\n  }, [currentUser.uid]);\r\n\r\n  useEffect(() => {\r\n    setIsThereKaraoke(checkKaraoke(currentSongData.lyrics));\r\n  }, [currentSongData.lyrics]);\r\n\r\n  useEffect(() => {\r\n    if (!loading) {\r\n      if (shuffleMode) {\r\n        let shuffledSongsArray = shuffleSongs(currentSongQueue);\r\n        setCurrentSongQueue(shuffledSongsArray);\r\n        setCurrentSongInQueue(\r\n          shuffledSongsArray.findIndex((song) => song.id === currentSong)\r\n        );\r\n      } else {\r\n        setCurrentSongQueue(currentSongPlaylistSource.songsList);\r\n        setCurrentSongInQueue(\r\n          currentSongPlaylistSource.songsList.findIndex(\r\n            (song) => song.id === currentSong\r\n          )\r\n        );\r\n      }\r\n    }\r\n  }, [shuffleMode]);\r\n\r\n  function playSong() {\r\n    if (play) {\r\n      songRef.current.pause();\r\n    } else {\r\n      songRef.current.play();\r\n    }\r\n\r\n    setPlay(!play);\r\n  }\r\n\r\n  useEffect(() => {\r\n    setCurrentParagraph(0);\r\n  }, [currentSongData.id]);\r\n\r\n  function loadSongData(e) {\r\n    setCurrentTime(e.target.currentTime);\r\n    setSongDuration(e.target.duration);\r\n    inputRef.current.max = e.target.duration;\r\n    if (window.innerWidth > 1000)\r\n      leftSideBarInputRef.current.max = e.target.duration;\r\n    setInputRange(0);\r\n    if (play) {\r\n      e.target.play();\r\n    } else e.target.pause();\r\n  }\r\n\r\n  function defineCurrentParagraph() {\r\n    //Binary Search\r\n    let first = 0,\r\n      last = currentSongData.lyrics.length - 1;\r\n    let roundedTime = parseFloat(\r\n      parseFloat(songRef.current.currentTime).toFixed(1)\r\n    );\r\n    while (first <= last) {\r\n      let midPoint = Math.floor((first + last) / 2);\r\n      let blockStartTime = parseFloat(\r\n        parseFloat(currentSongData.lyrics[midPoint].startTime).toFixed(1)\r\n      );\r\n      let nextBlockStartTime =\r\n        midPoint !== currentSongData.lyrics.length - 1\r\n          ? parseFloat(\r\n              parseFloat(\r\n                currentSongData.lyrics[midPoint + 1].startTime\r\n              ).toFixed(1)\r\n            )\r\n          : last;\r\n      if (currentSongData.lyrics[midPoint].startTime !== \"undefined\") {\r\n        if (\r\n          roundedTime >= blockStartTime &&\r\n          roundedTime <= nextBlockStartTime\r\n        ) {\r\n          setCurrentParagraph(midPoint);\r\n          break;\r\n        } else if (blockStartTime < roundedTime) first = midPoint + 1;\r\n        else last = midPoint - 1;\r\n      } else return;\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (rightSideCurrentPage === 2) defineCurrentParagraph();\r\n  }, [rightSideCurrentPage]);\r\n\r\n  function defineCurrentParagraphLight() {\r\n    if (\r\n      currentParagraph !== currentSongData.lyrics.length - 1 &&\r\n      parseFloat(currentSongData.lyrics[currentParagraph + 1].startTime) <=\r\n        songRef.current.currentTime\r\n    ) {\r\n      return setCurrentParagraph(currentParagraph + 1);\r\n    }\r\n  }\r\n  function playing(event) {\r\n    setCurrentTime(event.target.currentTime);\r\n    if (\r\n      isThereKaraoke &&\r\n      rightSideCurrentPage === 2 &&\r\n      openFullScreenPlayer &&\r\n      openMenu\r\n    ) {\r\n      defineCurrentParagraphLight();\r\n    }\r\n\r\n    setInputRange((event.target.currentTime / songDuration) * 100);\r\n  }\r\n\r\n  async function nextSong() {\r\n    let correctSongNumber = checkNumber(\r\n      currentSongInQueue + 1,\r\n      currentSongQueue.length - 1\r\n    );\r\n    let currentSongId = await (\r\n      await firestore\r\n        .collection(\"songs\")\r\n        .doc(currentSongQueue[correctSongNumber].id)\r\n        .get()\r\n    ).data().id;\r\n    addSongToHistory(currentSongId, currentUser);\r\n    setCurrentParagraph(0);\r\n    setCurrentSong(currentSongId);\r\n    setCurrentSongInQueue(\r\n      checkNumber(correctSongNumber, currentSongQueue.length - 1)\r\n    );\r\n    firestore.collection(\"users\").doc(currentUser.uid).update({\r\n      lastSongPlayed: currentSongId,\r\n    });\r\n  }\r\n\r\n  async function prevSong() {\r\n    if (currentTime > 5) {\r\n      songRef.current.currentTime = 0;\r\n      setCurrentTime(0);\r\n      setCurrentParagraph(0);\r\n      return;\r\n    }\r\n    let correctSongNumber = checkNumber(\r\n      currentSongInQueue - 1,\r\n      currentSongQueue.length - 1\r\n    );\r\n    let currentSongId = await (\r\n      await firestore\r\n        .collection(\"songs\")\r\n        .doc(currentSongQueue[correctSongNumber].id)\r\n        .get()\r\n    ).data().id;\r\n    addSongToHistory(currentSongId, currentUser);\r\n    setCurrentParagraph(0);\r\n    setCurrentSong(currentSongId);\r\n    setCurrentSongInQueue(\r\n      checkNumber(correctSongNumber, currentSongQueue.length - 1)\r\n    );\r\n    firestore.collection(\"users\").doc(currentUser.uid).update({\r\n      lastSongPlayed: currentSongId,\r\n    });\r\n  }\r\n\r\n  function changeCurrentTime(event, startTime = 0) {\r\n    if (event.target.localName === \"div\" || event.target.localName === \"p\") {\r\n      if (startTime !== undefined) {\r\n        setCurrentTime(startTime);\r\n        songRef.current.currentTime = startTime;\r\n        setInputRange((startTime / songDuration) * 100);\r\n        if (\r\n          isThereKaraoke &&\r\n          rightSideCurrentPage === 2 &&\r\n          openFullScreenPlayer\r\n        )\r\n          setCurrentParagraph(parseInt(event.target.id));\r\n        songRef.current.play();\r\n        setPlay(true);\r\n        return;\r\n      }\r\n    } else {\r\n      setCurrentTime(event.target.value);\r\n      songRef.current.currentTime = event.target.value;\r\n      setInputRange((event.target.value / songDuration) * 100);\r\n      if (isThereKaraoke && rightSideCurrentPage === 2 && openFullScreenPlayer)\r\n        defineCurrentParagraph();\r\n    }\r\n  }\r\n\r\n  function displayAuthors(\r\n    authorsList = currentSongData.authors,\r\n    separatingSign = \" & \"\r\n  ) {\r\n    return authorsList.map((el, i) => {\r\n      return (\r\n        <>\r\n          <Link\r\n            to={`/authors/${el.uid}`}\r\n            key={el.uid}\r\n            onClick={(e) => {\r\n              e.stopPropagation();\r\n              setOpenFullScreenPlayer(false);\r\n            }}\r\n          >\r\n            {el.displayName}\r\n          </Link>\r\n          {i === authorsList.length - 1 ? \"\" : separatingSign}\r\n        </>\r\n      );\r\n    });\r\n  }\r\n\r\n  function displayAuthorsFull(\r\n    authorsList = currentSongData.authors,\r\n    separatingSign = \" & \"\r\n  ) {\r\n    return authorsList.map((el, i) => {\r\n      return (\r\n        <>\r\n          <Link\r\n            to={`/authors/${el.uid}`}\r\n            key={el.uid}\r\n            onClick={(e) => {\r\n              e.stopPropagation();\r\n              setOpenFullScreenPlayer(false);\r\n              setOpenModal(false);\r\n            }}\r\n          >\r\n            <PersonTiny data={el} />\r\n          </Link>\r\n        </>\r\n      );\r\n    });\r\n  }\r\n\r\n  useEffect(() => {\r\n    document.title = currentSongData.name || \"Soundbubble\";\r\n  }, [currentSongData.name]);\r\n  return (\r\n    <SongContext.Provider\r\n      value={{\r\n        yourSongs,\r\n        setYourSongs,\r\n        yourPlaylists,\r\n        yourFriends,\r\n        currentSongQueue,\r\n        currentSongPlaylistSource,\r\n        setCurrentSongPlaylistSource,\r\n        setCurrentSongQueue,\r\n        setCurrentSongInQueue,\r\n        play,\r\n        setPlay,\r\n        songSrc: currentSongData.songSrc,\r\n        currentTime,\r\n        setCurrentTime,\r\n        songDuration,\r\n        songRef,\r\n        name: currentSongData.name,\r\n        authors: currentSongData.authors,\r\n        lyrics: currentSongData.lyrics,\r\n        cover: currentSongData.cover,\r\n        imgColors,\r\n        setImgColors,\r\n        currentSong,\r\n        setCurrentSong,\r\n        repeatMode,\r\n        setRepeatMode,\r\n        shuffleMode,\r\n        setShuffleMode,\r\n        inputRef,\r\n        leftSideBarInputRef,\r\n        isThereKaraoke,\r\n        rightSideCurrentPage,\r\n        currentParagraph,\r\n        currentParagraphRef,\r\n        nextSong,\r\n        prevSong,\r\n        playSong,\r\n        playing,\r\n        defineCurrentParagraph,\r\n        setRightSideCurrentPage,\r\n        changeCurrentTime,\r\n        displayAuthors,\r\n        displayAuthorsFull,\r\n        openFullScreenPlayer,\r\n        setOpenFullScreenPlayer,\r\n        loadSongData,\r\n        fetchYourSongs,\r\n        setOpenMenu,\r\n        openMenu,\r\n        currentSongData,\r\n        setCurrentSongData,\r\n        setIsThereKaraoke,\r\n        setYourPlaylists,\r\n        yourAuthors,\r\n        setYourAuthors,\r\n        inputRange,\r\n      }}\r\n    >\r\n      {!loading ? children : <LoadingData />}\r\n    </SongContext.Provider>\r\n  );\r\n};\r\n","export function checkKaraoke(lyrics) {\r\n\tif (lyrics !== undefined && lyrics.length === 0) return false\r\n\r\n\tif (lyrics !== undefined) {\r\n\t\tif (lyrics[0].startTime === 'undefined') return false\r\n\t}\r\n\r\n\treturn true\r\n}\r\n","import { useEffect } from 'react';\r\n\r\nconst useOutsideClick = (ref, setFunc) => {\r\n\tuseEffect(() => {\r\n\t\tfunction handleClickOutside(event) {\r\n\t\t\tif (ref.current && !ref.current.contains(event.target)) {\r\n\t\t\t\tsetFunc(false)\r\n\t\t\t}\r\n\t\t}\r\n\t\tdocument.addEventListener(\"mousedown\", handleClickOutside);\r\n\t\treturn () => {\r\n\t\t\tdocument.removeEventListener(\"mousedown\", handleClickOutside);\r\n\t\t};\r\n\t}, [ref]);\r\n}\r\n\r\nexport default useOutsideClick\r\n","export default function getShortString(word, len = 50) {\r\n\treturn word.substr(0, len) + (word.length > len ? \"...\" : \"\")\r\n}","import getShortString from \"../../shared/lib/get-short-string\"\r\n\r\n\r\nconst displayAuthorsStr = (authorslist, separator = ' & ', lenLimit = 100) => {\r\n\tconst authorsString = authorslist?.map(author => author.displayName).join(separator)\r\n\treturn authorsString ? getShortString(authorsString, lenLimit) : \"\"\r\n}\r\n\r\nexport default displayAuthorsStr","export function findLenOfAuthors(authors) {\r\n\tlet str = \"\"\r\n\tauthors.forEach(el => {str += el.displayName})\r\n\treturn str.length\r\n}","function amountOfZeros(number) {\r\n\treturn number % 10 === number ? \"0\" + number : number\r\n}\r\n\r\nexport default function correctTimeDisplay(seconds) {\r\n\treturn amountOfZeros(Math.floor(seconds / 60)) + \":\" + amountOfZeros(Math.floor(seconds % 60))\r\n}","import React from \"react\";\r\n\r\nconst ColorCircles = ({ play }) => {\r\n  return (\r\n    <div\r\n      className=\"ColorCircles\"\r\n      style={!play ? { opacity: 0, transform: \"scale(.95)\" } : {}}\r\n    >\r\n      <span className=\"colorCircle\"></span>\r\n      <span className=\"colorCircle\"></span>\r\n      <span className=\"colorCircle\"></span>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ColorCircles;\r\n","import React from \"react\";\r\nimport { FaBackward, FaForward, FaPause, FaPlay } from \"react-icons/fa\";\r\nimport { TiArrowRepeat, TiArrowShuffle } from \"react-icons/ti\";\r\nimport { useSong } from \"../../../../contexts/SongContext\";\r\nimport displayAuthorsStr from \"../../../../functions/display/displayAuthorsStr\";\r\nimport { findLenOfAuthors } from \"../../../../functions/find/findLenOfAuthors\";\r\nimport correctTimeDisplay from \"../../../../functions/other/correctTimeDisplay\";\r\nimport checkNumber from \"../../../../shared/lib/check-number\";\r\nimport ColorCircles from \"../atoms/color-circles\";\r\nexport const Player = ({ inputRef, textLimit = 18, linkToAuthors = true }) => {\r\n  const {\r\n    currentSongData,\r\n    currentTime,\r\n    changeCurrentTime,\r\n    songDuration,\r\n    setRepeatMode,\r\n    repeatMode,\r\n    play,\r\n    prevSong,\r\n    playSong,\r\n    nextSong,\r\n    setShuffleMode,\r\n    shuffleMode,\r\n    displayAuthors,\r\n    name,\r\n    authors,\r\n    cover,\r\n    inputRange,\r\n  } = useSong();\r\n  return currentSongData.id !== -1 ? (\r\n    <div className=\"player\">\r\n      <div className=\"playerUpperSide\">\r\n        <div className=\"songCover\">\r\n          <img loading=\"lazy\" src={cover} alt=\"\" />\r\n        </div>\r\n        <div className=\"nameAndAuthors\">\r\n          <h2\r\n            title={name.length > textLimit ? name : null}\r\n            style={{ overflow: \"hidden\" }}\r\n          >\r\n            <div\r\n              style={\r\n                name.length > textLimit\r\n                  ? {\r\n                      animation: \"outSideText 17s infinite\",\r\n                      whiteSpace: \"nowrap\",\r\n                    }\r\n                  : {}\r\n              }\r\n            >\r\n              {name}\r\n            </div>\r\n          </h2>\r\n          <h3\r\n            style={{ overflow: \"hidden\" }}\r\n            title={authors.map((el) => \" \" + el.displayName)}\r\n          >\r\n            {linkToAuthors ? (\r\n              <div\r\n                style={\r\n                  findLenOfAuthors(currentSongData.authors) > textLimit\r\n                    ? {\r\n                        animation: \"outSideText 17s infinite\",\r\n                        whiteSpace: \"nowrap\",\r\n                      }\r\n                    : {}\r\n                }\r\n              >\r\n                {displayAuthors()}\r\n              </div>\r\n            ) : (\r\n              <div>{displayAuthorsStr(authors, \" & \", 33)}</div>\r\n            )}\r\n          </h3>\r\n        </div>\r\n      </div>\r\n      <div className=\"controlPanel\">\r\n        <input\r\n          type=\"range\"\r\n          min=\"0\"\r\n          ref={inputRef}\r\n          step=\"1\"\r\n          value={currentTime}\r\n          onChange={(event) => {\r\n            changeCurrentTime(event);\r\n          }}\r\n          style={{\r\n            background: `linear-gradient(to right, var(--themeColor2) ${inputRange}%, #fff ${inputRange}%)`,\r\n          }}\r\n        />\r\n        <div className=\"startAndEndTime\">\r\n          <span>{correctTimeDisplay(currentTime)}</span>\r\n          <span>{correctTimeDisplay(songDuration)}</span>\r\n        </div>\r\n        <div className=\"btns\">\r\n          <button\r\n            className=\"shuffleBtn\"\r\n            onClick={() => setShuffleMode(checkNumber(shuffleMode + 1, 1))}\r\n            style={\r\n              shuffleMode ? { background: \"var(--reallyTransparentWhite)\" } : {}\r\n            }\r\n          >\r\n            <TiArrowShuffle\r\n              style={shuffleMode ? { color: \"var(--themeColor)\" } : {}}\r\n            />\r\n          </button>\r\n          <button\r\n            onClick={(e) => {\r\n              e.stopPropagation();\r\n              prevSong();\r\n            }}\r\n          >\r\n            <FaBackward />\r\n          </button>\r\n          <button\r\n            onClick={(e) => {\r\n              e.stopPropagation();\r\n              playSong();\r\n            }}\r\n          >\r\n            {play ? <FaPause /> : <FaPlay />}\r\n          </button>\r\n          <button\r\n            onClick={(e) => {\r\n              e.stopPropagation();\r\n              nextSong();\r\n            }}\r\n          >\r\n            <FaForward />\r\n          </button>\r\n          <button\r\n            className=\"repeatBtn\"\r\n            onClick={() => setRepeatMode(checkNumber(repeatMode + 1, 2))}\r\n            style={\r\n              repeatMode ? { background: \"var(--reallyTransparentWhite)\" } : {}\r\n            }\r\n          >\r\n            <TiArrowRepeat\r\n              style={repeatMode ? { color: \"var(--themeColor)\" } : {}}\r\n            />\r\n            <span style={repeatMode === 2 ? { opacity: 1 } : {}}></span>\r\n          </button>\r\n          <ColorCircles play={play} />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  ) : null;\r\n};\r\n","import React from 'react'\r\nimport { Link } from 'react-router-dom'\r\nimport { useModal } from '../../contexts/ModalContext'\r\n\r\nexport const PersonTinyVerticalItem = ({person}) => {\r\n\tconst {setOpenModal} = useModal()\r\n\treturn (\r\n\t\t<Link to = {`/authors/${person.uid}`}>\r\n\t\t\t<div className = \"PersonTinyVerticalItem\" onClick = {()=>setOpenModal(false)}>\r\n\t\t\t\t<div className=\"personTinyImage\">\r\n\t\t\t\t\t<img loading = \"lazy\" src={person.photoURL} alt=\"\" />\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"personTinyName\">\r\n\t\t\t\t\t{person.displayName}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</Link>\r\n\t)\r\n}\r\n","export default function getUID() {\r\n\treturn 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, c => {\r\n\t\tconst piece = (Math.random() * 16) | 0;\r\n\t\tconst elem = c === 'x' ? piece : (piece & 0x3) | 0x8;\r\n\t\treturn elem.toString(16);\r\n\t});\r\n}\r\n","\r\nimport { firestore } from \"../../firebase\"\r\nimport getUID from \"../../functions/other/getUID\"\r\n\r\nexport const createChat = async (participants, chatUID = getUID(), chatName = \"\", chatImage = \"\", admins = [], imageColors = []) => {\r\n\tfirestore.collection('chats').doc(chatUID).set({\r\n\t\tchatImage: chatImage,\r\n\t\tchatName: chatName,\r\n\t\tid: chatUID,\r\n\t\tmessages: [],\r\n\t\tparticipants: participants,\r\n\t\twallpaper: 'undefined',\r\n\t\tadmins: participants.length > 2 ? admins : [],\r\n\t\ttyping: [],\r\n\t\timageColors: imageColors\r\n\t})\r\n\r\n\tparticipants.map(async personId => {\r\n\t\tlet chatInfo = (await firestore.collection('users').doc(personId).get()).data().chats\r\n\t\tchatInfo.push(chatUID)\r\n\t\tfirestore.collection('users').doc(personId).update({\r\n\t\t\tchats: chatInfo\r\n\t\t})\r\n\t})\r\n}","import { firestore } from \"../../firebase\"\r\nimport getUID from \"../../functions/other/getUID\"\r\n\r\nexport const findChatURL = async (allParticipants, currentUser, setShouldCreate, setFriendChatId) => {\r\n\tlet foundChat = false\r\n\tlet chatId = 0\r\n\tif (currentUser.chats) {\r\n\t\t// –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã —Ç–∞–∫–æ–≤: –æ–Ω –∏—â–µ—Ç –≤—Å–µ —á–∞—Ç—ã, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –µ—Å—Ç—å —é–∑–µ—Ä. –ó–∞—Ç–µ–º –æ–Ω –ø—Ä–æ—Ö–æ–¥–∏—Ç –ø–æ –Ω–∏–º. –ó–∞—Ç–µ–º –æ–Ω –ø—Ä–æ—Ö–æ–¥–∏—Ç –ø–æ –≤—ã–±—Ä–∞–Ω–Ω—ã–º –¥—Ä—É–∑—å—è–º\r\n\t\t// –ï—Å–ª–∏ –æ–Ω –Ω–∞—Ö–æ–¥–∏—Ç, —á—Ç–æ –¥—Ä—É–≥ –µ—Å—Ç—å –≤ —Å–ø–∏—Å–∫–µ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —á–∞—Ç–∞, –¥–æ–±–∞–≤–ª—è–µ—Ç –∫ count 1, –µ—Å–ª–∏ –Ω–µ—Ç, —Å—Ä–∞–∑—É –≤—ã—Ö–æ–¥–∏—Ç –∏–∑ —Ü–∏–∫–ª–∞ —É—á–∞—Ç—Å–Ω–∏–∫–æ–≤\r\n\t\t// –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ü–∏–∫–ª–∞ –æ–Ω –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, –µ—Å–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π + 1 (–ø–æ—Ç–æ–º—É —á—Ç–æ –≤ –º–∞—Å—Å–∏–≤ –¥—Ä—É–∑–µ–π –Ω–µ –≤—Ö–æ–¥–∏—Ç —Å–∞–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å) —Ä–∞–≤–Ω–æ\r\n\t\t// –¥–ª–∏–Ω–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —á–∞—Ç–∞ –∏ –µ—Å–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π —Ä–∞–≤–Ω–æ –¥–ª–∏–Ω–µ –ø–æ—Å—Ç—É–ø–∏–≤—à–µ–≥–æ –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –º–∞—Å—Å–∏–≤–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤, —Ç–æ–≥–¥–∞ –Ω—É–∂–Ω—ã–π —á–∞—Ç –Ω–∞–π–¥–µ–Ω\r\n\t\tconst chatsWhereUserIn = await firestore.collection('chats').where('participants', 'array-contains', currentUser.uid).get()\r\n\t\tchatsWhereUserIn.docs.forEach(chat => {\r\n\t\t\tlet count = 0\r\n\t\t\tallParticipants.every(personId => {\r\n\t\t\t\tif (chat.data().participants.includes(personId)) {\r\n\t\t\t\t\tcount++\r\n\t\t\t\t\treturn true\r\n\t\t\t\t}\r\n\t\t\t\telse return false\r\n\t\t\t})\r\n\t\t\tif (count + 1 === chat.data().participants.length && count === allParticipants.length) {\r\n\t\t\t\tfoundChat = true\r\n\t\t\t\tsetShouldCreate(false)\r\n\t\t\t\tsetFriendChatId(chat.data().id)\r\n\t\t\t\tchatId = chat.data().id\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\t\t\telse return true\r\n\t\t})\r\n\r\n\t\tif (!foundChat) {\r\n\t\t\tconst random = getUID()\r\n\t\t\tfoundChat = true\r\n\t\t\tsetShouldCreate(true)\r\n\t\t\tsetFriendChatId(random)\r\n\t\t\tchatId = random\r\n\t\t}\r\n\t\treturn chatId\r\n\t}\r\n}","import { firestore } from \"../../firebase\"\r\n\r\nexport const sendMessage = (chatId, chatData, sender, messageText, attachedSongs = [], attachedAlbums = [], attachedAuthors = [], inResponseToMessage) => {\r\n\tif (messageText.trim().length !== 0 || attachedSongs.length !== 0 || attachedAlbums.length !== 0 || attachedAuthors.length !== 0) {\r\n\t\tconst tempMessages = chatData?.messages || []\r\n\r\n\t\ttempMessages.push({\r\n\t\t\tid: tempMessages.length,\r\n\t\t\tsender: sender,\r\n\t\t\tmessage: messageText,\r\n\t\t\tsentTime: new Date().toString(),\r\n\t\t\tinResponseToMessage: inResponseToMessage || null,\r\n\t\t\tattachedSongs: attachedSongs,\r\n\t\t\tattachedAlbums: attachedAlbums,\r\n\t\t\tattachedAuthors: attachedAuthors,\r\n\t\t\tseenBy: [sender]\r\n\t\t})\r\n\r\n\t\tfirestore.collection('chats').doc(chatId).update({\r\n\t\t\tmessages: tempMessages\r\n\t\t})\r\n\t}\r\n}","import { firestore } from \"../../firebase\";\r\nimport { createChat } from \"../../shared/lib/create-—Åhat\";\r\nimport { findChatURL } from \"../../shared/lib/find-chat-url\";\r\nimport { sendMessage } from \"./sendMessage\";\r\n\r\nexport default function shareWithFriends({ shareList, currentUser, itemId, whatToShare, messageText = \"\", setShouldCreate = () => null, setFriendChatId = () => null, setLoading = () => null, setCompleted = () => null }) {\r\n\tsetLoading(true)\r\n\tsetCompleted(false)\r\n\t//–°–¥–µ–ª–∞—Ç—å —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü–∏—é sendMessage\r\n\tshareList.map(async userId => {\r\n\t\t//–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –ø–æ—Å–ª–µ–¥–Ω–µ–º—É –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—é\r\n\t\tconst sortedFriends = [{ uid: userId, status: 'added' }, ...currentUser.friends.filter(obj => obj.uid !== userId)]\r\n\t\tfirestore.collection('users').doc(currentUser.uid).update({\r\n\t\t\tfriends: sortedFriends\r\n\t\t})\r\n\t\tPromise.resolve(findChatURL([userId], currentUser, () => null, setFriendChatId)).then(async chatId => {\r\n\t\t\tlet chatData = (await firestore.collection('chats').doc(chatId).get()).data()\r\n\t\t\tif (chatData !== undefined) {\r\n\t\t\t\tswitch (whatToShare) {\r\n\t\t\t\t\tcase \"song\":\r\n\t\t\t\t\t\tsendMessage(chatId, chatData, currentUser.uid, messageText, [itemId])\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"playlist\":\r\n\t\t\t\t\t\tsendMessage(chatId, chatData, currentUser.uid, messageText, [], [itemId])\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"author\":\r\n\t\t\t\t\t\tsendMessage(chatId, chatData, currentUser.uid, messageText, [], [], [itemId])\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tsendMessage(chatId, chatData, currentUser.uid, messageText, [itemId])\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tcreateChat([currentUser.uid, userId], chatId).then(async () => {\r\n\t\t\t\t\tchatData = (await firestore.collection('chats').doc(chatId).get()).data()\r\n\t\t\t\t\tsetShouldCreate(false)\r\n\t\t\t\t\tswitch (whatToShare) {\r\n\t\t\t\t\t\tcase \"song\":\r\n\t\t\t\t\t\t\tsendMessage(chatId, chatData, currentUser.uid, messageText, [itemId])\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase \"playlist\":\r\n\t\t\t\t\t\t\tsendMessage(chatId, chatData, currentUser.uid, messageText, [], [itemId])\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase \"author\":\r\n\t\t\t\t\t\t\tsendMessage(chatId, chatData, currentUser.uid, messageText, [], [], [itemId])\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\tsendMessage(chatId, chatData, currentUser.uid, messageText, [itemId])\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}).then(() => {\r\n\t\t\tsetLoading(false)\r\n\t\t\tsetCompleted(true)\r\n\t\t})\r\n\t})\r\n\r\n\r\n}","import React from 'react'\r\n\r\nexport const LoadingCircle = ({top = '20%'}) => {\r\n\treturn (\r\n\t\t<div className = \"LoadingCircle\" style = {{top:top}}>\r\n\t\t\t<img loading = \"lazy\" src=\"https://icon-library.com/images/spinner-icon-gif/spinner-icon-gif-28.jpg\" alt=\"\"/>\r\n\t\t</div>\r\n\t)\r\n}\r\n","import { useEffect, useState } from \"react\";\r\nimport { firestore } from \"../../../../firebase\";\r\nimport normalizeString from \"../../../../functions/other/normalizeString\";\r\nimport { fetchItemList } from \"../../../../shared/lib/fetch-item-list\";\r\n\r\nconst useSearch = (\r\n  value,\r\n  setAllFoundSongs,\r\n  setResultAuthorList,\r\n  setResultPlaylists,\r\n  defaultSearchMode,\r\n  searchMode,\r\n  defaultSongsListValue,\r\n  defaultAuthorsListValue,\r\n  defaultPlaylistsListValue\r\n) => {\r\n  const [message, setMessage] = useState(\"\");\r\n  const [loading, setLoading] = useState(false);\r\n  const [foundAnything, setFoundAnything] = useState(false);\r\n\r\n  const [inputValue, setInputValue] = useState(value);\r\n\r\n  async function findItem(value, place, defaultList = [], setList) {\r\n    const foundItemTempArray = [];\r\n    let normalizedSearch = normalizeString(value);\r\n    const itemsList = await firestore\r\n      .collection(\"search\")\r\n      .where(\"variantsOfName\", \"array-contains\", normalizedSearch)\r\n      .get();\r\n    itemsList.docs.forEach(async (item) => {\r\n      const itemData = item.data();\r\n      if (itemData.place === place) {\r\n        const realData = (\r\n          await firestore.collection(itemData.place).doc(itemData.uid).get()\r\n        ).data();\r\n        if (defaultList !== undefined && defaultList.length) {\r\n          if (\r\n            defaultList\r\n              .map((song) => song.id || song.uid)\r\n              .includes(itemData.uid)\r\n          )\r\n            foundItemTempArray.push(realData);\r\n        } else if (!realData.isPrivate) foundItemTempArray.push(realData);\r\n        if (\r\n          defaultSearchMode === undefined &&\r\n          searchMode === 0 &&\r\n          foundItemTempArray.length !== 0\r\n        ) {\r\n          setList(foundItemTempArray);\r\n          switch (itemData.place) {\r\n            case \"songs\":\r\n              for (let i = 0; i < foundItemTempArray.length; i++) {\r\n                const authorsIdsArray = realData.authors;\r\n                fetchItemList(\r\n                  authorsIdsArray.map((author) => author.uid),\r\n                  \"users\",\r\n                  setResultAuthorList,\r\n                  (res) => res.sort((a, b) => b.subscribers - a.subscribers),\r\n                  undefined,\r\n                  undefined,\r\n                  1\r\n                );\r\n              }\r\n              break;\r\n            case \"users\":\r\n              for (let i = 0; i < foundItemTempArray.length; i++) {\r\n                const songsIdsArray = realData.ownSongs;\r\n                const albumsIdsArray = realData.ownPlaylists;\r\n                fetchItemList(\r\n                  songsIdsArray,\r\n                  \"songs\",\r\n                  setAllFoundSongs,\r\n                  (res) => res.sort((a, b) => b.listens - a.listens),\r\n                  () => null,\r\n                  3,\r\n                  1\r\n                );\r\n                fetchItemList(\r\n                  albumsIdsArray,\r\n                  \"playlists\",\r\n                  setResultPlaylists,\r\n                  (res) => res.sort((a, b) => b.listens - a.listens),\r\n                  () => null,\r\n                  3,\r\n                  1\r\n                );\r\n              }\r\n              break;\r\n            case \"playlists\":\r\n              for (let i = 0; i < foundItemTempArray.length; i++) {\r\n                const authorsIdsArray = realData.authors;\r\n                fetchItemList(\r\n                  authorsIdsArray.map((author) => author.uid),\r\n                  \"users\",\r\n                  setResultAuthorList,\r\n                  (res) => res.sort((a, b) => b.subscribers - a.subscribers),\r\n                  undefined,\r\n                  undefined,\r\n                  1\r\n                );\r\n              }\r\n              break;\r\n            default:\r\n              setMessage(\"Wrong search mode\");\r\n              break;\r\n          }\r\n        }\r\n\r\n        if (foundItemTempArray.length !== 0) {\r\n          setLoading(false);\r\n          setFoundAnything(true);\r\n          setList(foundItemTempArray);\r\n        }\r\n      }\r\n    });\r\n    setLoading(false);\r\n    if (foundItemTempArray.length === 0) {\r\n      setList([]);\r\n      setFoundAnything(false);\r\n    }\r\n  }\r\n  function findSomething(str) {\r\n    if (value.length !== 0) {\r\n      const searchText = str ?? value;\r\n      setInputValue(searchText);\r\n      setLoading(true);\r\n      setFoundAnything(false);\r\n      if (defaultSearchMode === undefined) {\r\n        if (searchMode === 0 || searchMode === 1) {\r\n          findItem(\r\n            searchText,\r\n            \"songs\",\r\n            defaultSongsListValue,\r\n            setAllFoundSongs\r\n          );\r\n          setResultAuthorList([]);\r\n          setResultPlaylists([]);\r\n        }\r\n        if (searchMode === 0 || searchMode === 2) {\r\n          findItem(\r\n            searchText,\r\n            \"users\",\r\n            defaultAuthorsListValue,\r\n            setResultAuthorList\r\n          );\r\n          setAllFoundSongs([]);\r\n          setResultPlaylists([]);\r\n        }\r\n        if (searchMode === 0 || searchMode === 3) {\r\n          findItem(\r\n            searchText,\r\n            \"playlists\",\r\n            defaultPlaylistsListValue,\r\n            setResultPlaylists\r\n          );\r\n          setResultAuthorList([]);\r\n          setAllFoundSongs([]);\r\n        }\r\n      } else {\r\n        switch (defaultSearchMode) {\r\n          case \"songs\":\r\n            findItem(\r\n              searchText,\r\n              \"songs\",\r\n              defaultSongsListValue,\r\n              setAllFoundSongs\r\n            );\r\n            break;\r\n          case \"playlists\":\r\n            findItem(\r\n              searchText,\r\n              \"playlists\",\r\n              defaultPlaylistsListValue,\r\n              setResultPlaylists\r\n            );\r\n            break;\r\n          case \"authors\":\r\n            findItem(\r\n              searchText,\r\n              \"users\",\r\n              defaultAuthorsListValue,\r\n              setResultAuthorList\r\n            );\r\n            break;\r\n          default:\r\n            findItem(\r\n              searchText,\r\n              \"songs\",\r\n              defaultSongsListValue,\r\n              setAllFoundSongs\r\n            );\r\n            break;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (value.length === 0) {\r\n      if (defaultSongsListValue !== undefined)\r\n        setAllFoundSongs(defaultSongsListValue);\r\n      if (defaultAuthorsListValue !== undefined)\r\n        setResultAuthorList(defaultAuthorsListValue);\r\n      if (defaultPlaylistsListValue !== undefined)\r\n        setResultPlaylists(defaultPlaylistsListValue);\r\n      setLoading(false);\r\n    }\r\n  }, [value]);\r\n\r\n  useEffect(() => {\r\n    findSomething();\r\n  }, [searchMode]);\r\n\r\n  return {\r\n    findSomething,\r\n    message,\r\n    loading,\r\n    foundAnything,\r\n    inputValue,\r\n    setInputValue,\r\n  };\r\n};\r\n\r\nexport default useSearch;\r\n","import { firestore } from \"../../../firebase\";\r\n\r\nconst rankCurrentHint = (hintName, hintUid) => {\r\n\tif (hintName) {\r\n\t\tfirestore\r\n\t\t\t.collection(\"search\")\r\n\t\t\t.doc(hintUid)\r\n\t\t\t.get()\r\n\t\t\t.then((res) => {\r\n\t\t\t\tconst rank = res.data().rank ? res.data().rank + 1 : 1;\r\n\t\t\t\tfirestore\r\n\t\t\t\t\t.collection(\"search\")\r\n\t\t\t\t\t.doc(hintUid)\r\n\t\t\t\t\t.update({\r\n\t\t\t\t\t\trank: rank,\r\n\t\t\t\t\t});\r\n\t\t\t});\r\n\t}\r\n};\r\n\r\nexport default rankCurrentHint","import React from \"react\";\r\nimport { FiSearch, FiXCircle } from \"react-icons/fi\";\r\n\r\nconst SearchBarButtons = (props) => {\r\n  const { length, setInputValue, setValue } = props;\r\n  return (\r\n    <div className=\"searchBarElement\">\r\n      <FiSearch />\r\n      <span\r\n        onClick={() => {\r\n          setValue(\"\");\r\n          setInputValue(\"\");\r\n        }}\r\n        style={\r\n          !length\r\n            ? {\r\n                opacity: 0,\r\n                visibility: \"hidden\",\r\n                cursor: \"default\",\r\n              }\r\n            : {}\r\n        }\r\n      >\r\n        <FiXCircle />\r\n      </span>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SearchBarButtons;\r\n","import React from \"react\";\r\n\r\nconst SearchFilterItem = ({ text, searchMode, setSearchMode, index }) => {\r\n  return (\r\n    <button\r\n      onClick={() => setSearchMode(index)}\r\n      style={\r\n        searchMode === index\r\n          ? {\r\n              background: \"var(--lightBlue)\",\r\n            }\r\n          : {}\r\n      }\r\n    >\r\n      {text}\r\n    </button>\r\n  );\r\n};\r\n\r\nexport default SearchFilterItem;\r\n","import React from \"react\";\r\nimport SearchFilterItem from \"../atoms/search-filter-item\";\r\n\r\nconst SearchFilters = ({ defaultSearchMode, searchMode, setSearchMode }) => {\r\n  const filters = [\"All\", \"Songs\", \"Authors\", \"Playlists\"];\r\n  return (\r\n    <div\r\n      className=\"searchFilters\"\r\n      style={\r\n        defaultSearchMode !== undefined\r\n          ? {\r\n              display: \"none\",\r\n            }\r\n          : {}\r\n      }\r\n    >\r\n      {filters.map((filter, index) => {\r\n        return (\r\n          <SearchFilterItem\r\n            text={filter}\r\n            searchMode={searchMode}\r\n            setSearchMode={setSearchMode}\r\n            index={index}\r\n          />\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SearchFilters;\r\n","import { firestore } from \"../../../firebase\"\r\n\r\nconst findSearchHints = async (searchValue) => {\r\n\tif (searchValue.length > 0) {\r\n\t\tconst hints = (await firestore.collection('search')\r\n\t\t\t.where('variantsOfName', 'array-contains', searchValue).get())\r\n\t\t\t.docs.map(async (hint) => {\r\n\t\t\t\tconst { place, uid, rank } = hint.data()\r\n\t\t\t\tconst { name, authors, displayName, isVerified } = (await firestore.collection(place).doc(uid).get()).data()\r\n\t\t\t\treturn {\r\n\t\t\t\t\ttype: place,\r\n\t\t\t\t\tname: name ? name : displayName,\r\n\t\t\t\t\tauthor: authors ? authors[0].displayName : null,\r\n\t\t\t\t\tuid: uid,\r\n\t\t\t\t\trank: rank || 0,\r\n\t\t\t\t\tisVerified: isVerified ?? false\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\treturn hints\r\n\t}\r\n\telse return []\r\n}\r\n\r\nexport default findSearchHints","const transliteWord = (word) => {\r\n\tconst dictionaryRuToEn = {\r\n\t\t'–∞': 'f', '–±': ',', '–≤': 'd', '–≥': 'u', '–¥': 'l', '–µ': 't', '—ë': '`', '–∂': ';',\r\n\r\n\t\t'–∑': 'p', '–∏': 'b', '–π': 'q', '–∫': 'r', '–ª': 'k', '–º': 'v', '–Ω': 'y',\r\n\r\n\t\t'–æ': 'j', '–ø': 'g', '—Ä': 'h', '—Å': 'c', '—Ç': 'n', '—É': 'e', '—Ñ': 'a', '—Ö': '[',\r\n\r\n\t\t'—Ü': 'w', '—á': 'x', '—à': 'i', '—â': 'o', '—ä': ']', '—ã': 's', '—å': 'm', '—ç': '\\'', '—é': '.', '—è': 'z'\r\n\t}\r\n\r\n\tconst dictionaryEnToRu = {\r\n\t\t'f': '–∞', ',': '–±', 'd': '–≤', 'u': '–≥', 'l': '–¥', 't': '–µ', '`': '—ë', ';': '–∂',\r\n\r\n\t\t'p': '–∑', 'b': '–∏', 'q': '–π', 'r': '–∫', 'k': '–ª', 'v': '–º', 'y': '–Ω',\r\n\r\n\t\t'j': '–æ', 'g': '–ø', 'h': '—Ä', 'c': '—Å', 'n': '—Ç', 'e': '—É', 'a': '—Ñ', '[': '—Ö',\r\n\r\n\t\t'w': '—Ü', 'x': '—á', 'i': '—à', 'o': '—â', ']': '—ä', 's': '—ã', 'm': '—å', '\\'': '—ç', '.': '—é', 'z': '—è'\r\n\t}\r\n\r\n\tif (dictionaryRuToEn[word[0]])\r\n\t\treturn word.split('').reduce((acc, letter) => acc + dictionaryRuToEn[letter], '')\r\n\telse return word.split('').reduce((acc, letter) => acc + dictionaryEnToRu[letter], '')\r\n\r\n}\r\n\r\nexport default transliteWord","import { useEffect } from \"react\";\r\nimport normalizeString from \"../../../../functions/other/normalizeString\";\r\nimport findSearchHints from \"../find-search-hints\";\r\nimport transliteWord from \"../translite-word\";\r\n\r\nconst useLoadHints = ({\r\n  setCurrentHint,\r\n  searchValue,\r\n  inputFocused,\r\n  setSearchHints,\r\n}) => {\r\n  useEffect(() => {\r\n    setCurrentHint(-1);\r\n    if (searchValue.length !== 0 && inputFocused) {\r\n      Promise.resolve(findSearchHints(normalizeString(searchValue))).then(\r\n        (res) => {\r\n          Promise.all(res).then((hint) => {\r\n            const sortedHints = hint.sort((a, b) => b.rank - a.rank);\r\n\r\n            if (sortedHints.length) setSearchHints(sortedHints.slice(0, 10));\r\n            else {\r\n              Promise.resolve(\r\n                findSearchHints(transliteWord(normalizeString(searchValue)))\r\n              ).then((res) => {\r\n                Promise.all(res).then((hint) => {\r\n                  const sortedHints = hint.sort((a, b) => b.rank - a.rank);\r\n                  setSearchHints(sortedHints.slice(0, 10));\r\n                });\r\n              });\r\n            }\r\n          });\r\n        }\r\n      );\r\n    } else setSearchHints([]);\r\n  }, [searchValue, inputFocused]);\r\n};\r\n\r\nexport default useLoadHints;\r\n","import { BiAlbum } from \"react-icons/bi\";\r\nimport { FiMusic, FiSearch, FiUser } from \"react-icons/fi\";\r\n\r\nconst findRightIcon = (type) => {\r\n\tswitch (type) {\r\n\t\tcase \"songs\":\r\n\t\t\treturn <FiMusic style={{ color: 'var(--reallyLightBlue)' }} />;\r\n\t\tcase \"playlists\":\r\n\t\t\treturn <BiAlbum style={{ color: 'var(--lightPurple)' }} />;\r\n\t\tcase \"users\":\r\n\t\t\treturn <FiUser style={{ color: 'var(--pink)' }} />;\r\n\t\tcase \"search\":\r\n\t\t\treturn <FiSearch />;\r\n\t\tdefault:\r\n\t\t\treturn <FiMusic />;\r\n\t}\r\n};\r\n\r\nexport default findRightIcon\r\n","import React from \"react\";\r\nimport { ImCheckmark } from \"react-icons/im\";\r\nimport findRightIcon from \"../../../../shared/lib/find-right-icon\";\r\n\r\nconst SearcHintItem = (props) => {\r\n  const {\r\n    name,\r\n    author,\r\n    isVerified,\r\n    type,\r\n    index,\r\n    currentHint,\r\n    setCurrentHint,\r\n    findSomething,\r\n    setInputFocused,\r\n  } = props;\r\n  return (\r\n    <div\r\n      className={\"search-hint-item\" + (currentHint === index ? \" current\" : \"\")}\r\n      onClick={() => {\r\n        setCurrentHint(index);\r\n        setInputFocused(false);\r\n        findSomething(name);\r\n      }}\r\n    >\r\n      {findRightIcon(type)}\r\n      <span>{name}</span>\r\n      {author && <span className=\"search-hint-item-author\">{author}</span>}\r\n      {isVerified ? (\r\n        <ImCheckmark\r\n          style={{\r\n            width: \"12px\",\r\n            height: \"12px\",\r\n            opacity: 0.5,\r\n            marginLeft: \"10px\",\r\n          }}\r\n        />\r\n      ) : null}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SearcHintItem;\r\n","import React from \"react\";\r\nimport useLoadHints from \"../../lib/hooks/use-load-hints\";\r\nimport SearcHintItem from \"../atoms/search-hint-item\";\r\n\r\nexport const SearchHints = ({\r\n  searchValue,\r\n  searchHints,\r\n  setSearchHints,\r\n  currentHint,\r\n  setCurrentHint,\r\n  inputFocused,\r\n  defaultSearchMode,\r\n  findSomething,\r\n  setInputFocused,\r\n}) => {\r\n  useLoadHints({\r\n    setCurrentHint,\r\n    searchValue,\r\n    inputFocused,\r\n    setSearchHints,\r\n  });\r\n\r\n  return (\r\n    <div\r\n      className=\"search-hints\"\r\n      style={\r\n        !searchHints.length\r\n          ? { display: \"none\" }\r\n          : defaultSearchMode\r\n          ? { transform: \"translateY(0px)\" }\r\n          : { transform: \"translateY(-35px)\" }\r\n      }\r\n    >\r\n      <SearcHintItem\r\n        name={searchValue}\r\n        type={\"search\"}\r\n        index={-1}\r\n        key={-1}\r\n        currentHint={currentHint}\r\n        setCurrentHint={setCurrentHint}\r\n        findSomething={findSomething}\r\n        setInputFocused={setInputFocused}\r\n      />\r\n      {searchHints.map((hint, index) => {\r\n        return (\r\n          <SearcHintItem\r\n            {...hint}\r\n            currentHint={currentHint}\r\n            setCurrentHint={setCurrentHint}\r\n            index={index}\r\n            key={hint.uid}\r\n            findSomething={findSomething}\r\n            setInputFocused={setInputFocused}\r\n          />\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n};\r\n","import React, { useEffect, useRef, useState } from \"react\";\r\nimport { LoadingCircle } from \"../../../components/Loading/LoadingCircle\";\r\nimport useSearch from \"../../../features/search/lib/hooks/use-search\";\r\nimport rankCurrentHint from \"../../../features/search/lib/rank-current-hint\";\r\nimport SearchBarButtons from \"../../../features/search/ui/molecules/search-bar-buttons\";\r\nimport SearchFilters from \"../../../features/search/ui/molecules/search-filters\";\r\nimport { SearchHints } from \"../../../features/search/ui/organisms/search-hints\";\r\nimport checkNumber from \"../../lib/check-number\";\r\nimport useOutsideClick from \"../../lib/hooks/use-outside-click\";\r\n\r\nconst SearchBar = ({\r\n  value,\r\n  setValue,\r\n  setAllFoundSongs,\r\n  setResultPlaylists,\r\n  setResultAuthorList,\r\n  focus = false,\r\n  defaultSearchMode = undefined,\r\n  inputText = \"Search for songs or for people\",\r\n  defaultSongsListValue,\r\n  defaultAuthorsListValue,\r\n  defaultPlaylistsListValue,\r\n  background,\r\n}) => {\r\n  const [searchMode, setSearchMode] = useState(0);\r\n  const [currentHint, setCurrentHint] = useState(-1);\r\n  const [searchHints, setSearchHints] = useState([]);\r\n  const [inputFocused, setInputFocused] = useState(focus);\r\n  const inputRef = useRef(null);\r\n\r\n  const { findSomething, loading, foundAnything, inputValue, setInputValue } =\r\n    useSearch(\r\n      searchHints[currentHint]?.name ?? value,\r\n      setAllFoundSongs,\r\n      setResultAuthorList,\r\n      setResultPlaylists,\r\n      defaultSearchMode,\r\n      searchMode,\r\n      defaultSongsListValue,\r\n      defaultAuthorsListValue,\r\n      defaultPlaylistsListValue\r\n    );\r\n\r\n  useEffect(() => {\r\n    if (focus) inputRef.current.focus();\r\n  }, []);\r\n\r\n  const handleCurrentHint = (e) => {\r\n    if (inputFocused) {\r\n      switch (e.key) {\r\n        case \"ArrowDown\":\r\n          setCurrentHint(\r\n            checkNumber(currentHint + 1, searchHints.length - 1, -1)\r\n          );\r\n          setInputValue(\r\n            searchHints[\r\n              checkNumber(currentHint + 1, searchHints.length - 1, -1)\r\n            ]?.name ?? value\r\n          );\r\n          break;\r\n        case \"ArrowUp\":\r\n          setCurrentHint(\r\n            checkNumber(currentHint - 1, searchHints.length - 1, -1)\r\n          );\r\n          setInputValue(\r\n            searchHints[\r\n              checkNumber(currentHint - 1, searchHints.length - 1, -1)\r\n            ]?.name ?? value\r\n          );\r\n          break;\r\n\r\n        default:\r\n          break;\r\n      }\r\n    }\r\n  };\r\n\r\n  useOutsideClick(inputRef, setInputFocused);\r\n\r\n  return (\r\n    <div\r\n      style={{ marginTop: \"10px\", width: \"100%\" }}\r\n      className=\"searchBarWrapper\"\r\n    >\r\n      <div className=\"searchBar\" ref={inputRef}>\r\n        <SearchBarButtons\r\n          setInputValue={setInputValue}\r\n          length={value.length}\r\n          setValue={setValue}\r\n        />\r\n        <input\r\n          type=\"text\"\r\n          onFocus={() => setInputFocused(true)}\r\n          style={\r\n            searchHints.length\r\n              ? {\r\n                  borderRadius:\r\n                    \"var(--standartBorderRadius) var(--standartBorderRadius) 0 0\",\r\n                  background: !!background && background,\r\n                }\r\n              : { background: !!background && background }\r\n          }\r\n          placeholder={inputText}\r\n          value={inputValue}\r\n          onChange={(e) => {\r\n            setInputValue(e.target.value);\r\n            setValue(e.target.value);\r\n          }}\r\n          onKeyDown={(e) => {\r\n            handleCurrentHint(e);\r\n            if (e.key === \"Enter\") {\r\n              findSomething();\r\n              // setValue(inputValue);\r\n              rankCurrentHint(\r\n                searchHints[currentHint]?.name,\r\n                searchHints[currentHint]?.uid\r\n              );\r\n              setSearchHints([]);\r\n            }\r\n          }}\r\n        />\r\n        <SearchFilters\r\n          defaultSearchMode={defaultSearchMode}\r\n          searchMode={searchMode}\r\n          setSearchMode={setSearchMode}\r\n        />\r\n        <SearchHints\r\n          searchValue={value}\r\n          currentHint={currentHint}\r\n          searchHints={searchHints}\r\n          setSearchHints={setSearchHints}\r\n          setCurrentHint={setCurrentHint}\r\n          inputFocused={inputFocused}\r\n          defaultSearchMode={defaultSearchMode}\r\n          findSomething={findSomething}\r\n          setInputFocused={setInputFocused}\r\n        />\r\n      </div>\r\n      <div className=\"authorsResult\">\r\n        {loading ? (\r\n          <div\r\n            style={{\r\n              position: \"relative\",\r\n              width: \"100%\",\r\n              height: \"50px\",\r\n              marginTop: \"40px\",\r\n            }}\r\n          >\r\n            <LoadingCircle />\r\n          </div>\r\n        ) : !foundAnything && value.length !== 0 ? (\r\n          <h2>Not found</h2>\r\n        ) : null}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SearchBar;\r\n","import React from \"react\";\r\nimport styled from \"styled-components\";\r\n\r\nconst ButtonWrapper = styled.button`\r\n  border: none;\r\n  color: var(--lightBlue);\r\n  background: var(--lightGrey);\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  padding: 5px 10px;\r\n  border-radius: var(--standartBorderRadius3);\r\n  font-weight: 600;\r\n\r\n  svg {\r\n    margin-right: ${({ textLen }) => (textLen === 0 ? \"0\" : \"5px\")};\r\n    width: 16px;\r\n    height: 16px;\r\n  }\r\n`;\r\n\r\nconst Button = ({ text = \"\", icon, onClick, visible = true }) => {\r\n  return (\r\n    visible && (\r\n      <ButtonWrapper onClick={onClick} textLen={text.length}>\r\n        {icon}\r\n        <span>{text}</span>\r\n      </ButtonWrapper>\r\n    )\r\n  );\r\n};\r\n\r\nexport default Button;\r\n","import React from \"react\";\r\nimport { FiXCircle } from \"react-icons/fi\";\r\nimport styled from \"styled-components\";\r\nimport Button from \"./button\";\r\n\r\nconst Wrapper = styled.div`\r\n  width: 100%;\r\n  position: relative;\r\n  margin: ${({ margin }) => (margin ? \"0 0 10px 0\" : 0)};\r\n\r\n  button {\r\n    position: absolute;\r\n    right: 8px;\r\n    top: 50%;\r\n    transform: translateY(-50%);\r\n  }\r\n`;\r\n\r\nconst InputWrapper = styled.input`\r\n  width: 100%;\r\n  box-sizing: border-box;\r\n  padding: 12px;\r\n  border-radius: var(--standartBorderRadius);\r\n  border: none;\r\n  background: var(--leftSideBarColor);\r\n  outline: none;\r\n  color: #fff;\r\n  font-weight: 500;\r\n`;\r\n\r\nconst Input = ({\r\n  title,\r\n  type = \"text\",\r\n  value,\r\n  setValue,\r\n  placeholder = \"\",\r\n  required = false,\r\n  margin = false,\r\n}) => {\r\n  return (\r\n    <>\r\n      {!!title && <h3>{title}</h3>}\r\n      <Wrapper margin>\r\n        <InputWrapper\r\n          value={value}\r\n          onChange={(e) => setValue(e.target.value)}\r\n          placeholder={placeholder}\r\n          type={type}\r\n          required={required}\r\n        />\r\n        <Button\r\n          icon={<FiXCircle />}\r\n          onClick={() => setValue(\"\")}\r\n          visible={!!value.length}\r\n        />\r\n      </Wrapper>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Input;\r\n","import React, { useEffect } from \"react\";\r\nimport { ImCheckmark } from \"react-icons/im\";\r\nimport styled from \"styled-components\";\r\nimport { LoadingCircle } from \"../../../components/Loading/LoadingCircle\";\r\nimport { useModal } from \"../../../contexts/ModalContext\";\r\n\r\nconst SubmitButtonWrapper = styled.button`\r\n  width: 100%;\r\n  padding: 10px;\r\n  box-sizing: border-box;\r\n  opacity: ${(props) => (props.isLoading || !props.isActive ? 0.5 : 1)};\r\n  background: var(--purpleAndBlueGrad);\r\n  color: #fff;\r\n  font-weight: bold;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  height: 40px;\r\n  border-radius: var(--standartBorderRadius3);\r\n  position: relative;\r\n  overflow: hidden;\r\n\r\n  @keyframes button-animation-in {\r\n    0% {\r\n      opacity: 0;\r\n      transform: scale(0.95);\r\n    }\r\n    50% {\r\n      opacity: 1;\r\n      transform: scale(1);\r\n    }\r\n    100% {\r\n      opacity: 0;\r\n      transform: scale(0.95);\r\n    }\r\n  }\r\n\r\n  @keyframes button-animation-out {\r\n    0% {\r\n      opacity: 0;\r\n      transform: scale(0.95);\r\n    }\r\n    100% {\r\n      opacity: 1;\r\n      transform: scale(1);\r\n    }\r\n  }\r\n\r\n  .inner-button {\r\n    z-index: 1;\r\n\r\n    .inner-button-success {\r\n      animation: button-animation-in 2s forwards;\r\n    }\r\n\r\n    .inner-button-text {\r\n      animation: button-animation-out 0.5s forwards;\r\n    }\r\n  }\r\n\r\n  &::before {\r\n    content: \"\";\r\n    position: absolute;\r\n    display: block;\r\n    top: 50%;\r\n    left: 50%;\r\n    transform: translate(-50%, -50%);\r\n    background: var(--green);\r\n    width: ${(props) => (props.completed ? \"2000px\" : \"0\")};\r\n    height: ${(props) => (props.completed ? \"2000px\" : \"0\")};\r\n    border-radius: 100%;\r\n    transition: 0.6s;\r\n    z-index: 0;\r\n  }\r\n\r\n  .LoadingCircle {\r\n    position: relative;\r\n    transform: none;\r\n    left: auto;\r\n    top: auto;\r\n    width: 30px;\r\n    height: 30px;\r\n\r\n    img {\r\n      width: 30px;\r\n      height: 30px;\r\n    }\r\n  }\r\n`;\r\n\r\nconst SubmitButton = ({\r\n  text,\r\n  action,\r\n  isLoading,\r\n  completed = false,\r\n  setCompleted,\r\n  bottomMessage,\r\n  isActive = true,\r\n}) => {\r\n  const { openBottomMessage } = useModal();\r\n\r\n  useEffect(() => {\r\n    if (completed) {\r\n      openBottomMessage(bottomMessage ?? undefined);\r\n      setTimeout(() => {\r\n        setCompleted(false);\r\n      }, 2000);\r\n    }\r\n  }, [completed]);\r\n\r\n  return (\r\n    <SubmitButtonWrapper\r\n      isLoading={isLoading}\r\n      className=\"submit-button\"\r\n      completed={completed}\r\n      isActive={isActive}\r\n      onClick={isActive ? action : () => openBottomMessage(\"Nope\", \"failure\")}\r\n    >\r\n      <div className=\"inner-button\">\r\n        {completed ? (\r\n          <div className=\"inner-button-success\">\r\n            <ImCheckmark /> Done\r\n          </div>\r\n        ) : !isLoading ? (\r\n          <div className=\"inner-button-text\">{text}</div>\r\n        ) : (\r\n          <LoadingCircle top={0} />\r\n        )}\r\n      </div>\r\n    </SubmitButtonWrapper>\r\n  );\r\n};\r\n\r\nexport default SubmitButton;\r\n","import React from \"react\";\r\nimport { PersonTiny } from \"../Basic/PersonTiny\";\r\n\r\nexport const TinyPersonsList = ({\r\n  listOfPeople,\r\n  title,\r\n  chosenArray,\r\n  setChosenArray = () => null,\r\n  lastSeen = false,\r\n}) => {\r\n  return (\r\n    <div>\r\n      {title ? (\r\n        <h2 style={{ marginTop: \"0\", marginBottom: \"7px\" }}>{title}</h2>\r\n      ) : null}\r\n      {listOfPeople.map((person) => {\r\n        return (\r\n          <PersonTiny\r\n            data={person}\r\n            chosenArray={chosenArray}\r\n            setChosenArray={setChosenArray}\r\n            lastSeen={lastSeen}\r\n          />\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n};\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { IoIosCheckmarkCircleOutline } from \"react-icons/io\";\r\nimport { useAuth } from \"../../contexts/AuthContext\";\r\nimport { useModal } from \"../../contexts/ModalContext\";\r\nimport { useSong } from \"../../contexts/SongContext\";\r\nimport shareWithFriends from \"../../functions/other/shareWithManyFriends\";\r\nimport { PersonTiny } from \"../Basic/PersonTiny\";\r\nimport SearchBar from \"../../shared/ui/organisms/search-bar\";\r\nimport Input from \"../../shared/ui/atoms/input\";\r\nimport SubmitButton from \"../../shared/ui/atoms/submit-button\";\r\nimport { TinyPersonsList } from \"./TinyPersonsList\";\r\nexport const FriendsListToShareWith = ({ item, whatToShare = \"song\" }) => {\r\n  const { yourFriends } = useSong();\r\n  const [chosenFriends, setChosenFriends] = useState([]);\r\n  const { currentUser } = useAuth();\r\n  const [messageText, setMessageText] = useState(\"\");\r\n  const [completed, setCompleted] = useState(false);\r\n  const [loading, setLoading] = useState(false);\r\n  const { toggleModal, openBottomMessage } = useModal();\r\n  const [searchValue, setSearchValue] = useState(\"\");\r\n  const [foundPeople, setFoundPeople] = useState([]);\r\n\r\n  return yourFriends.length ? (\r\n    <div className=\"FriendsListToShareWith\">\r\n      <div\r\n        style={{\r\n          maxHeight: \"300px\",\r\n          overflowY: \"hidden\",\r\n          display: \"flex\",\r\n          flexDirection: \"column\",\r\n        }}\r\n      >\r\n        <SearchBar\r\n          value={searchValue}\r\n          setValue={setSearchValue}\r\n          setResultAuthorList={setFoundPeople}\r\n          defaultAuthorsListValue={yourFriends}\r\n          defaultSearchMode={\"authors\"}\r\n          inputText={\"Search for friends\"}\r\n        />\r\n        <div style={{ overflowY: \"auto\", maxHeight: \"100%\" }}>\r\n          <TinyPersonsList\r\n            listOfPeople={foundPeople}\r\n            chosenArray={chosenFriends}\r\n            setChosenArray={setChosenFriends}\r\n          />\r\n        </div>\r\n      </div>\r\n      <>\r\n        <Input\r\n          value={messageText}\r\n          setValue={setMessageText}\r\n          placeholder=\"Your message\"\r\n        />\r\n        <SubmitButton\r\n          text={`Share with ${chosenFriends.length} ${\r\n            chosenFriends.length > 1 || chosenFriends.length === 0\r\n              ? \"friends\"\r\n              : \"friend\"\r\n          }`}\r\n          action={() => {\r\n            shareWithFriends({\r\n              shareList: chosenFriends,\r\n              currentUser,\r\n              itemId: whatToShare === \"author\" ? item.uid : item.id,\r\n              whatToShare,\r\n              messageText,\r\n              setLoading,\r\n              setCompleted,\r\n            });\r\n            toggleModal();\r\n          }}\r\n          completed={completed}\r\n          setCompleted={setCompleted}\r\n          bottomMessage={\"Message was sent\"}\r\n          isActive={!!chosenFriends.length}\r\n        />\r\n      </>\r\n    </div>\r\n  ) : (\r\n    <h3 style={{ margin: 0 }}>No friends added</h3>\r\n  );\r\n};\r\n","import React from 'react'\r\nimport { FiArrowRight } from 'react-icons/fi'\r\n\r\nexport const SeeMoreRoundButton = ({text = \"See more\", ...restProps}) => {\r\n\treturn (\r\n\t\t<div className = \"SeeMoreRoundButton\" {...restProps}>\r\n\t\t\t<button>\r\n\t\t\t\t<FiArrowRight/>\r\n\t\t\t</button>\r\n\t\t\t<span>{text}</span>\r\n\t\t</div>\r\n\t)\r\n}\r\n","import React, { useEffect, useState } from 'react'\r\nimport { useSong } from '../../contexts/SongContext'\r\nimport displayDate from '../../functions/display/displayDate'\r\nimport { CgMusicNote } from 'react-icons/cg'\r\nimport { PersonTinyVerticalItem } from '../AuthorPage/PersonTinyVerticalItem'\r\nimport { useModal } from '../../contexts/ModalContext'\r\nimport { FriendsListToShareWith } from '../Lists/FriendsListToShareWith'\r\nimport { LoadingCircle } from '../Loading/LoadingCircle'\r\nimport { SeeMoreRoundButton } from '../Buttons/SeeMoreRoundButton'\r\nimport { TinyPersonsList } from '../Lists/TinyPersonsList'\r\nexport const SongInfo = ({ song }) => {\r\n\tconst { currentSongData } = useSong()\r\n\tconst { setContent } = useModal()\r\n\tconst [songData, setSongData] = useState(song || currentSongData)\r\n\tconst { displayAuthors, yourFriends } = useSong()\r\n\tconst [friendsThatHaveThisSong, setFriendsThatHaveThisSong] = useState([])\r\n\tconst [loading, setLoading] = useState(true)\r\n\tasync function findFriendsThatHaveThisSong() {\r\n\t\tsetLoading(true)\r\n\t\tsetFriendsThatHaveThisSong([])\r\n\t\tyourFriends.forEach(friend => {\r\n\t\t\tif (friend.addedSongs.includes(songData.id)) setFriendsThatHaveThisSong(prev => [...prev, friend])\r\n\t\t})\r\n\t\tsetLoading(false)\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tif (song !== undefined) setSongData(song)\r\n\t}, [song && song.id])\r\n\r\n\tuseEffect(() => {\r\n\t\tfindFriendsThatHaveThisSong()\r\n\t}, [songData.id])\r\n\r\n\treturn (\r\n\t\t<div className='SongInfo'>\r\n\t\t\t<div className=\"songImage\" style={{ backgroundImage: `url(${songData.cover})` }}></div>\r\n\t\t\t<div className=\"songInfoContent\">\r\n\t\t\t\t<h3 style={{ color: songData.imageColors[0] }}>{songData.name}</h3>\r\n\t\t\t\t<span>{displayAuthors(songData.authors, ', ')}</span>\r\n\t\t\t\t<div style={{ display: 'flex', alignItems: 'center', opacity: '0.6', fontSize: '.9em', position: \"relative\", marginTop:'5px' }} className=\"listensAndDate\">\r\n\t\t\t\t\t<p className=\"infoListens\" style={{ marginRight: '15px', marginBottom: '0', position: 'relative' }}>{songData.listens} <CgMusicNote /></p>\r\n\t\t\t\t\t<span>{displayDate(songData.releaseDate)}</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t<h4 style={{ margin: '10px 0' }}>{friendsThatHaveThisSong.length > 0 ? 'Friends that listen that song' : 'None of your friends listens this'}</h4>\r\n\t\t\t\t{!loading ? <div style={{ display: 'flex'}}>\r\n\t\t\t\t\t{friendsThatHaveThisSong.length > 0 ? friendsThatHaveThisSong.map((person, index) => {\r\n\t\t\t\t\t\tif (index < 2) return <PersonTinyVerticalItem person={person} key={person.uid} />\r\n\t\t\t\t\t}) : <button className=\"shareBtn\" style={{ minHeight: '35px', background: songData.imageColors[0] }} onClick={() => { setContent(<FriendsListToShareWith item={songData} whatToShare={'song'} />) }}>Share</button>}\r\n\t\t\t\t\t{friendsThatHaveThisSong.length > 2 ? <SeeMoreRoundButton onClick={() => setContent(<TinyPersonsList listOfPeople={friendsThatHaveThisSong} title={`Friends listen ${song.name}`} />)} /> : null}\r\n\t\t\t\t</div> :\r\n\t\t\t\t\t<div style={{ position: 'relative', height: '50px' }}><LoadingCircle top={\"50%\"} /></div>}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t)\r\n}\r\n","import { firestore } from \"../../../firebase\";\r\n\r\nconst saveSearchHistory = (uid, itemId, itemType) => {\r\n\tconst newItemSaved = {\r\n\t\tid: itemId,\r\n\t\ttype: itemType\r\n\t}\r\n\r\n\tfirestore\r\n\t\t.collection(\"searchHistory\")\r\n\t\t.doc(uid)\r\n\t\t.get()\r\n\t\t.then((res) => {\r\n\t\t\tif (res.data()?.history) {\r\n\t\t\t\tif (!res.data().history.find(({ id }) => id === itemId)) {\r\n\t\t\t\t\tfirestore\r\n\t\t\t\t\t\t.collection(\"searchHistory\")\r\n\t\t\t\t\t\t.doc(uid)\r\n\t\t\t\t\t\t.update({\r\n\t\t\t\t\t\t\thistory: [newItemSaved, ...res.data().history.slice(0, 15)],\r\n\t\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tfirestore\r\n\t\t\t\t\t.collection(\"searchHistory\")\r\n\t\t\t\t\t.doc(uid)\r\n\t\t\t\t\t.set({\r\n\t\t\t\t\t\thistory: [newItemSaved],\r\n\t\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n};\r\n\r\nexport default saveSearchHistory","import React from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { useAuth } from \"../../../../contexts/AuthContext\";\r\n\r\nimport { AddToListCircle } from \"../../../../shared/ui/molecules/add-to-list-circle\";\r\nimport saveSearchHistory from \"../../../search/lib/save-search-history\";\r\n\r\nexport const AuthorItemBig = ({\r\n  data,\r\n  listOfChosenAuthors,\r\n  setListOfChosenAuthors,\r\n  shouldSaveSearchHistory = false,\r\n}) => {\r\n  const { currentUser } = useAuth();\r\n\r\n  const handleSaveSearchHistory = () => {\r\n    if (shouldSaveSearchHistory)\r\n      saveSearchHistory(currentUser.uid, data.uid, \"users\");\r\n  };\r\n\r\n  return (\r\n    <Link\r\n      to={`/authors/${data.uid}`}\r\n      className=\"AuthorItemBig\"\r\n      onClick={handleSaveSearchHistory}\r\n    >\r\n      <AddToListCircle\r\n        listOfChosenItems={listOfChosenAuthors}\r\n        setListOfChosenItems={setListOfChosenAuthors}\r\n        itemId={data.uid}\r\n      />\r\n      <div>\r\n        <div\r\n          className=\"AuthorItemBigImage\"\r\n          style={{ backgroundImage: `url(${data.photoURL})` }}\r\n        ></div>\r\n        <h3>{data.displayName}</h3>\r\n      </div>\r\n    </Link>\r\n  );\r\n};\r\n","import React, { useEffect, useRef, useState } from \"react\";\r\nimport { FiChevronLeft, FiChevronRight } from \"react-icons/fi\";\r\nimport { AuthorItemBig } from \"../../features/author/ui/molecules/author-item-big\";\r\n\r\nexport const AuthorsList = ({\r\n  listOfAuthors,\r\n  title = \"\",\r\n  listOfChosenAuthors,\r\n  setListOfChosenAuthors,\r\n  saveSearchHistory,\r\n}) => {\r\n  const [scrollLeft, setScrollLeft] = useState(0);\r\n  const wrapperRef = useRef(null);\r\n  const [shouldRenderRightArrow, setShouldRenderRightArrow] = useState(false);\r\n  function scrollToLeft() {\r\n    const prev = wrapperRef.current.scrollLeft;\r\n    wrapperRef.current.scrollLeft = prev - 200;\r\n    setScrollLeft(prev - 200);\r\n  }\r\n  function scrollToRight() {\r\n    const prev = wrapperRef.current.scrollLeft;\r\n    wrapperRef.current.scrollLeft = prev + 200;\r\n    setScrollLeft(prev + 200);\r\n  }\r\n  useEffect(() => {\r\n    if (listOfAuthors.length > 0) {\r\n      const scrollBiggerThanScreen =\r\n        wrapperRef.current.scrollWidth > wrapperRef.current.offsetWidth;\r\n      if (scrollBiggerThanScreen) setShouldRenderRightArrow(true);\r\n    }\r\n  }, [listOfAuthors]);\r\n  return listOfAuthors.length > 0 ? (\r\n    <div className=\"AuthorsList\">\r\n      {title.length !== 0 ? <h2>{title}</h2> : null}\r\n      <div\r\n        className=\"authorsWrapper\"\r\n        ref={wrapperRef}\r\n        onScroll={(e) => setScrollLeft(e.target.scrollLeft)}\r\n      >\r\n        {listOfAuthors.map((author) => {\r\n          return (\r\n            <AuthorItemBig\r\n              data={author}\r\n              key={author.uid}\r\n              listOfChosenAuthors={listOfChosenAuthors}\r\n              setListOfChosenAuthors={setListOfChosenAuthors}\r\n              shouldSaveSearchHistory={saveSearchHistory}\r\n            />\r\n          );\r\n        })}\r\n      </div>\r\n      <div className=\"authorsShiftButtons\">\r\n        <button\r\n          onClick={scrollToLeft}\r\n          style={scrollLeft <= 0 ? { visibility: \"hidden\", opacity: \"0\" } : {}}\r\n        >\r\n          <FiChevronLeft />\r\n        </button>\r\n        <button\r\n          onClick={scrollToRight}\r\n          style={\r\n            shouldRenderRightArrow &&\r\n            wrapperRef.current !== null &&\r\n            wrapperRef.current.scrollWidth - wrapperRef.current.offsetWidth !==\r\n              scrollLeft\r\n              ? {}\r\n              : { visibility: \"hidden\", opacity: \"0\" }\r\n          }\r\n        >\r\n          <FiChevronRight />\r\n        </button>\r\n      </div>\r\n    </div>\r\n  ) : null;\r\n};\r\n","import { useEffect, useState } from 'react'\r\nimport { useAuth } from '../contexts/AuthContext'\r\nimport { useSong } from '../contexts/SongContext'\r\nimport { firestore } from '../firebase'\r\n\r\nexport const useAddOrDeleteSong = (playlistId, songId) => {\r\n\tconst [playlistSongs, setPlaylistSongs] = useState([])\r\n\tconst [isAdded, setIsAdded] = useState(false)\r\n\tconst { currentUser } = useAuth()\r\n\tconst { currentSong } = useSong()\r\n\tconst songData = songId || currentSong\r\n\tuseEffect(() => {\r\n\t\tconst response = firestore.collection('playlists').doc(playlistId).onSnapshot(res => {\r\n\t\t\tif (res.exists) setPlaylistSongs(res.data().songs)\r\n\t\t})\r\n\t\treturn () => response()\r\n\t}, [firestore])\r\n\r\n\tuseEffect(() => {\r\n\t\tsetIsAdded(playlistSongs.includes(songData))\r\n\t}, [playlistSongs, songData])\r\n\r\n\tfunction addOrDelete() {\r\n\t\tif (playlistSongs.length > 0 && playlistId !== undefined) {\r\n\t\t\tif (playlistSongs.includes(songData)) {\r\n\t\t\t\tconst newSongsList = playlistSongs.filter(songNum => songNum !== songData)\r\n\t\t\t\tfirestore.collection('playlists').doc(playlistId).update({\r\n\t\t\t\t\tsongs: newSongsList\r\n\t\t\t\t})\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\r\n\t\t\tconst newSongsList = playlistSongs\r\n\t\t\tnewSongsList.unshift(songData)\r\n\t\t\tfirestore.collection('playlists').doc(playlistId).update({\r\n\t\t\t\tsongs: newSongsList\r\n\t\t\t})\r\n\r\n\t\t\tconst sortedPlaylists = [playlistId, ...currentUser.ownPlaylists.filter(id => id !== playlistId)]\r\n\t\t\tfirestore.collection('users').doc(currentUser.uid).update({\r\n\t\t\t\townPlaylists: sortedPlaylists\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\treturn [addOrDelete, isAdded]\r\n}\r\n","import React from 'react'\r\nimport { useScreen } from '../../contexts/ScreenContext'\r\n\r\nexport const Hint = ({text, direction = \"top\", ...restProps}) => {\r\n\tconst {isMobile} = useScreen()\r\n\treturn !isMobile?(\r\n\t\t<div className = {\"Hint \" + direction} {...restProps}>\r\n\t\t\t<h5>{text}</h5>\r\n\t\t</div>\r\n\t):null\r\n}\r\n","import React from 'react'\r\nimport { FiCheck, FiPlusCircle } from 'react-icons/fi'\r\nimport { useAddOrDeleteSong } from '../../hooks/useAddOrDeleteSong'\r\nimport { Hint } from '../Basic/Hint'\r\n\r\nexport const AddToPlaylistItem = ({playlist, song}) => {\r\n\tconst [addFunc, isAdded] = useAddOrDeleteSong(playlist.id, song.id)\r\n\treturn (\r\n\t\t<div className=\"songItemMenuWindowItem\" onClick={addFunc}>\r\n\t\t\t{!isAdded ? <>\r\n\t\t\t\t<Hint text={`Add \"${song.name}\" to playlist`} />\r\n\t\t\t\t<FiPlusCircle />\r\n\t\t\t</> :\r\n\t\t\t\t<>\r\n\t\t\t\t\t<Hint text={`Remove ${song.name} from playlist`} />\r\n\t\t\t\t\t<FiCheck />\r\n\t\t\t\t</>}\r\n\t\t\t{playlist.name}\r\n\t\t</div>\r\n\t)\r\n}\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { AddToPlaylistItem } from \"../../../../components/Playlist/AddToPlaylistItem\";\r\nimport { useAuth } from \"../../../../contexts/AuthContext\";\r\nimport { useSong } from \"../../../../contexts/SongContext\";\r\nexport const AddToPlaylists = ({ song }) => {\r\n  const { yourPlaylists, currentSongData } = useSong();\r\n  const { currentUser } = useAuth();\r\n\r\n  const [songData, setSongData] = useState(song || currentSongData);\r\n  useEffect(() => {\r\n    if (song?.id) {\r\n      setSongData(song);\r\n    }\r\n  }, [song?.id]);\r\n  return (\r\n    <div className=\"AddToPlaylists\">\r\n      <div style={{ display: \"flex\", flexDirection: \"column\" }}>\r\n        {yourPlaylists.length ? (\r\n          yourPlaylists.map((playlist, key) => {\r\n            if (currentUser.ownPlaylists.includes(playlist.id)) {\r\n              return <AddToPlaylistItem playlist={playlist} song={songData} />;\r\n            }\r\n          })\r\n        ) : (\r\n          <div className=\"songItemMenuWindowItem\">No playlists created</div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import { firestore } from \"../../../firebase\"\r\n\r\nexport const addSongToLibrary = (e, song, currentUser, setCurrentUser) => {\r\n\te.stopPropagation()\r\n\tconst songAuthorsUIDS = song.authors.map(author => author.uid)\r\n\tconst finalAuthorsUIDS = []\r\n\tsongAuthorsUIDS.forEach(authorId => {\r\n\t\tif (!currentUser.addedAuthors.includes(authorId)) {\r\n\t\t\tfinalAuthorsUIDS.push(authorId)\r\n\t\t}\r\n\t})\r\n\tlet newList = currentUser.addedSongs\r\n\tnewList.push(song.id)\r\n\tfirestore.collection('users').doc(currentUser.uid).update({\r\n\t\taddedSongs: newList,\r\n\t\taddedAuthors: [...finalAuthorsUIDS, ...currentUser.addedAuthors]\r\n\t})\r\n\r\n\tfinalAuthorsUIDS.forEach(async authorId => {\r\n\t\tlet subscribers = (await firestore.collection('users').doc(authorId).get()).data().subscribers\r\n\t\tsubscribers++\r\n\t\tfirestore.collection('users').doc(authorId).update({\r\n\t\t\tsubscribers: subscribers\r\n\t\t})\r\n\t})\r\n}","export default function filterArrayWithArray(whatToFilter, withWhatToFilter){\r\n\treturn whatToFilter.filter(\r\n\t\tfunction (e) {\r\n\t\t\treturn this.indexOf(e) < 0;\r\n\t\t},\r\n\t\twithWhatToFilter\r\n\t);\r\n}","import { firestore } from \"../../firebase\"\r\nimport filterArrayWithArray from \"./filterArrayWithArray\"\r\n\r\nexport const deleteSongFromLibrary = (e, song, currentUser, yourSongs) => {\r\n\te.stopPropagation()\r\n\tconst songAuthorsUIDS = song.authors.map(author => author.uid)\r\n\tconst finalAuthorsUIDS = [] // –º–∞—Å—Å–∏–≤ –∞–≤—Ç–æ—Ä–æ–≤, –ø–µ—Å–Ω–∏ –∫–æ—Ç–æ—Ä—ã—Ö –µ—â–µ –æ—Å—Ç–∞–ª–∏—Å—å –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è –≤—ã–±—Ä–∞–Ω–Ω–æ–π –ø–µ—Å–Ω–∏\r\n\tlet newList = currentUser.addedSongs.filter(songNum => songNum !== song.id)\r\n\tsongAuthorsUIDS.forEach(authorId => {\r\n\t\tyourSongs.forEach(songObj => {\r\n\t\t\tif (newList.includes(songObj.id) && songObj.authors.find(a => a.uid === authorId)) {\r\n\t\t\t\tfinalAuthorsUIDS.push(authorId)\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n\tconst filtered = filterArrayWithArray(songAuthorsUIDS, finalAuthorsUIDS) // –º–∞—Å—Å–∏–≤ –ª—é–¥–µ–π, –∫–æ—Ç–æ—Ä—ã—Ö –Ω—É–∂–Ω–æ —É–±—Ä–∞—Ç—å –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏\r\n\tconst finalFilteredAuthors = filterArrayWithArray(currentUser.addedAuthors, filtered) // –º–∞—Å—Å–∏–≤ –ª—é–¥–µ–π, –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ\r\n\r\n\tfirestore.collection('users').doc(currentUser.uid).update({\r\n\t\taddedSongs: newList,\r\n\t\taddedAuthors: finalFilteredAuthors\r\n\t})\r\n\r\n\tfiltered.forEach(async authorId=>{\r\n\t\tlet subscribers = (await firestore.collection('users').doc(authorId).get()).data().subscribers\r\n\t\tsubscribers--\r\n\t\tfirestore.collection('users').doc(authorId).update({\r\n\t\t\tsubscribers: subscribers\r\n\t\t})\r\n\t})\r\n\t\r\n}","import { useAuth } from \"../../../../contexts/AuthContext\";\r\nimport { addSongToLibrary } from \"../../../song/lib/add-song-to-library\";\r\nimport { deleteSongFromLibrary } from \"../../../../functions/other/deleteSongFromLibrary\";\r\nimport { FiPlusCircle, FiX } from \"react-icons/fi\";\r\nimport { useSong } from \"../../../../contexts/SongContext\";\r\nimport { useModal } from \"../../../../contexts/ModalContext\";\r\nexport default function AddOrDeleteButtonFull({ song }) {\r\n  const { currentUser } = useAuth();\r\n  const { yourSongs } = useSong();\r\n  const { openConfirm, setOpenModal } = useModal();\r\n  if (!currentUser.addedSongs.includes(song.id)) {\r\n    return (\r\n      <span onClick={(e) => addSongToLibrary(e, song, currentUser)}>\r\n        <FiPlusCircle />\r\n        Add\r\n      </span>\r\n    );\r\n  } else {\r\n    return (\r\n      <span\r\n        onClick={(e) => {\r\n          e.stopPropagation();\r\n          setOpenModal(false);\r\n          openConfirm(\r\n            \"You sure you want to delete this song from library?\",\r\n            \"Yes, delete it\",\r\n            \"No, just kidding\",\r\n            (e) => deleteSongFromLibrary(e, song, currentUser, yourSongs)\r\n          );\r\n        }}\r\n      >\r\n        <FiX />\r\n        Delete\r\n      </span>\r\n    );\r\n  }\r\n}\r\n","import React from \"react\";\r\nimport { MdPlaylistAdd } from \"react-icons/md\";\r\nimport { BiUserCircle } from \"react-icons/bi\";\r\nimport { FiInfo } from \"react-icons/fi\";\r\nimport { useSong } from \"../../../../contexts/SongContext\";\r\nimport AddOrDeleteButtonFull from \"../molecules/add-or-delete-song-button\";\r\nexport const Options = () => {\r\n  const { currentSongData, setRightSideCurrentPage } = useSong();\r\n  return (\r\n    <div className=\"Options\">\r\n      <div className=\"OptionItem\">\r\n        <AddOrDeleteButtonFull song={currentSongData} />\r\n      </div>\r\n      <div className=\"OptionItem\" onClick={() => setRightSideCurrentPage(4)}>\r\n        <BiUserCircle />\r\n        Go to author\r\n      </div>\r\n      <div className=\"OptionItem\" onClick={() => setRightSideCurrentPage(5)}>\r\n        <MdPlaylistAdd />\r\n        Add to playlist\r\n      </div>\r\n      <div className=\"OptionItem\" onClick={() => setRightSideCurrentPage(6)}>\r\n        <FiInfo />\r\n        Info\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import React, { useEffect } from \"react\";\r\nimport { useModal } from \"../../contexts/ModalContext\";\r\n\r\nexport const ErrorPlate = ({ errorMessage }) => {\r\n  const { openBottomMessage } = useModal();\r\n  useEffect(() => {\r\n    if (errorMessage) {\r\n      openBottomMessage(errorMessage, \"failure\");\r\n    }\r\n  }, [errorMessage]);\r\n  return errorMessage && <div className=\"Alert\">{errorMessage}</div>;\r\n};\r\n","export function transformLyricsToArrayOfObjects(lyrics) {\r\n\tconst arrayOfParagraphs = []\r\n\tlet startSubstr = 0\r\n\tconst fixedLyrics = lyrics + ' '\r\n\tfor (let i = 0; i < fixedLyrics.length; i++) {\r\n\t\tif (fixedLyrics[i] === '\\n' || fixedLyrics[i + 1] === undefined) {\r\n\t\t\tarrayOfParagraphs.push({\r\n\t\t\t\tstartTime: 'undefined',\r\n\t\t\t\ttext: fixedLyrics.substr(startSubstr, i - startSubstr)\r\n\t\t\t})\r\n\t\t\tstartSubstr = i + 1\r\n\t\t}\r\n\t}\r\n\treturn arrayOfParagraphs\r\n}","import React, { useState } from \"react\";\r\nimport { useEffect } from \"react\";\r\nimport { ErrorPlate } from \"../MessagePlates/ErrorPlate\";\r\nimport { FiXCircle } from \"react-icons/fi\";\r\nimport { useAuth } from \"../../contexts/AuthContext\";\r\nimport SearchBar from \"../../shared/ui/organisms/search-bar\";\r\nimport { PersonTiny } from \"../Basic/PersonTiny\";\r\nimport { firestore } from \"../../firebase\";\r\nimport { transformLyricsToArrayOfObjects } from \"../../functions/other/transformLyricsToArrayOfObject\";\r\nimport SubmitButton from \"../../shared/ui/atoms/submit-button\";\r\nimport { useModal } from \"../../contexts/ModalContext\";\r\nexport const EditSong = ({ song }) => {\r\n  const { currentUser } = useAuth();\r\n  const { toggleModal } = useModal();\r\n  const [songName, setSongName] = useState(song.name);\r\n  const [songAuthors, setSongAuthors] = useState(song.authors);\r\n  const [songCover, setSongCover] = useState(song.cover);\r\n  const [imageColors, setImageColors] = useState(song.imageColors);\r\n  const [lyrics, setLyrics] = useState(\r\n    song.lyrics.map((obj) => obj.text).join(\"\\n\")\r\n  );\r\n  const [foundAuthors, setFoundAuthors] = useState([]);\r\n  const [searchValue, setSearchValue] = useState(\"\");\r\n  const [errorMessage, setErrorMessage] = useState(\"\");\r\n  const [loading, setLoading] = useState(false);\r\n  const [completed, setCompleted] = useState(false);\r\n\r\n  useEffect(() => {\r\n    setSongName(song.name);\r\n    setSongAuthors(song.authors);\r\n    setSongCover(song.cover);\r\n    setImageColors(song.imageColors);\r\n    setLyrics(song.lyrics.map((obj) => obj.text).join(\"\\n\"));\r\n  }, [song.id]);\r\n\r\n  function manuallyChangeColor(e, i) {\r\n    imageColors[i] = e.target.value;\r\n    setImageColors([...imageColors]);\r\n  }\r\n\r\n  function updateSong() {\r\n    if (songName.length === 0) {\r\n      setErrorMessage(\"Name shouldn't be empty\");\r\n    } else if (songAuthors.length === 0) {\r\n      setErrorMessage(\"Song has to have at least 1 author\");\r\n    } else if (songCover.length === 0) {\r\n      setErrorMessage(\"Song has to have cover\");\r\n    } else {\r\n      setLoading(true);\r\n      if (songAuthors.length > song.authors.length) {\r\n        const newAuthors = songAuthors.filter((author) => {\r\n          return !song.authors.find((a) => a.uid === author.uid);\r\n        });\r\n        newAuthors.forEach(async (author) => {\r\n          const authorRef = await firestore\r\n            .collection(\"users\")\r\n            .doc(author.uid)\r\n            .get();\r\n          const authorData = authorRef.data();\r\n          const authorSongs = authorData.ownSongs;\r\n          authorSongs.push(song.id);\r\n          firestore.collection(\"users\").doc(author.uid).update({\r\n            ownSongs: authorSongs,\r\n          });\r\n        });\r\n      } else if (songAuthors.length < song.authors.length) {\r\n        const newAuthors = song.authors.filter((author) => {\r\n          return !songAuthors.find((a) => a.uid === author.uid);\r\n        });\r\n        newAuthors.forEach(async (author) => {\r\n          const authorRef = await firestore\r\n            .collection(\"users\")\r\n            .doc(author.uid)\r\n            .get();\r\n          const authorData = authorRef.data();\r\n          const authorSongs = authorData.ownSongs;\r\n          const filteredSongs = authorSongs.filter(\r\n            (songId) => songId !== song.id\r\n          );\r\n          firestore.collection(\"users\").doc(author.uid).update({\r\n            ownSongs: filteredSongs,\r\n          });\r\n        });\r\n      }\r\n\r\n      firestore\r\n        .collection(\"songs\")\r\n        .doc(song.id)\r\n        .update({\r\n          name: songName,\r\n          authors: songAuthors,\r\n          image: songCover,\r\n          imageColors: imageColors,\r\n          lyrics: transformLyricsToArrayOfObjects(lyrics),\r\n        })\r\n        .then(() => {\r\n          setLoading(false);\r\n          setCompleted(true);\r\n          toggleModal();\r\n        });\r\n    }\r\n  }\r\n\r\n  function removeAuthorFromList(data) {\r\n    const filtered = songAuthors.filter((people) => people.uid !== data.uid);\r\n    return setSongAuthors(filtered);\r\n  }\r\n  function addAuthor(data) {\r\n    if (!songAuthors.some((person) => person.uid === data.uid)) {\r\n      return setSongAuthors((prev) => [\r\n        ...prev,\r\n        {\r\n          uid: data.uid,\r\n          displayName: data.displayName,\r\n          photoURL: data.photoURL,\r\n        },\r\n      ]);\r\n    }\r\n\r\n    removeAuthorFromList(data);\r\n  }\r\n  return (\r\n    <div>\r\n      <div\r\n        className=\"SongInfo\"\r\n        style={{ flexDirection: \"column\", marginBottom: \"10px\" }}\r\n      >\r\n        <h3>Song cover</h3>\r\n        <div style={{ display: \"flex\" }}>\r\n          <div>\r\n            <img loading=\"lazy\" src={songCover} alt=\"\" className=\"songImage\" />\r\n          </div>\r\n          <div\r\n            style={{\r\n              background: `linear-gradient(-135deg, ${imageColors[0]}, ${imageColors[5]}`,\r\n              width: \"100%\",\r\n              borderRadius: \"var(--standartBorderRadius2)\",\r\n              display: \"flex\",\r\n              justifyContent: \"center\",\r\n              alignItems: \"center\",\r\n            }}\r\n          >\r\n            <h4 style={{ color: imageColors[1] }}>{songName}</h4>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div style={{ width: \"100%\", display: \"flex\" }}>\r\n        {imageColors.map((color, index) => {\r\n          return (\r\n            <input\r\n              type=\"color\"\r\n              value={color}\r\n              style={{\r\n                width: \"100%\",\r\n                height: \"60px\",\r\n                padding: \"0\",\r\n                borderRadius: \"0px\",\r\n              }}\r\n              onChange={(e) => {\r\n                manuallyChangeColor(e, index);\r\n              }}\r\n            />\r\n          );\r\n        })}\r\n      </div>\r\n      <div>\r\n        <h3>Song name</h3>\r\n        <input\r\n          type=\"text\"\r\n          className=\"standartInput\"\r\n          value={songName}\r\n          onChange={(e) => setSongName(e.target.value)}\r\n        />\r\n      </div>\r\n      <div>\r\n        <h3>Authors</h3>\r\n        <SearchBar\r\n          value={searchValue}\r\n          setValue={setSearchValue}\r\n          setResultAuthorList={setFoundAuthors}\r\n          defaultSearchMode={\"authors\"}\r\n        />\r\n        <div className=\"songAuthorsList\">\r\n          {songAuthors.map((author) => {\r\n            return (\r\n              <div className=\"chosenAuthorItem\">\r\n                <span>{author.displayName}</span>\r\n                <FiXCircle\r\n                  onClick={() => {\r\n                    if (currentUser.isAdmin) removeAuthorFromList(author);\r\n                    else if (author.uid !== currentUser.uid)\r\n                      removeAuthorFromList(author);\r\n                  }}\r\n                />\r\n              </div>\r\n            );\r\n          })}\r\n        </div>\r\n        <div className=\"authorsResult\">\r\n          {foundAuthors.map((data, index) => {\r\n            return (\r\n              <PersonTiny\r\n                data={data}\r\n                onClick={() => addAuthor(data)}\r\n                style={\r\n                  songAuthors.includes(data.uid)\r\n                    ? { background: \"var(--green)\" }\r\n                    : {}\r\n                }\r\n                key={index}\r\n              />\r\n            );\r\n          })}\r\n        </div>\r\n      </div>\r\n      <div>\r\n        <h3>Lyrics</h3>\r\n        <textarea\r\n          type=\"text\"\r\n          className=\"standartInput\"\r\n          style={{ height: \"200px\", fontWeight: \"500\" }}\r\n          value={lyrics}\r\n          onChange={(e) => setLyrics(e.target.value)}\r\n        />\r\n      </div>\r\n      <ErrorPlate errorMessage={errorMessage} />\r\n      <SubmitButton\r\n        text={\"Update song\"}\r\n        action={updateSong}\r\n        isLoading={loading}\r\n        completed={completed}\r\n        setCompleted={setCompleted}\r\n        bottomMessage={\"Song was updated\"}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport { BiEditAlt } from \"react-icons/bi\";\r\nimport { FiInfo, FiShare, FiUsers } from \"react-icons/fi\";\r\nimport { MdPlaylistAdd } from \"react-icons/md\";\r\nimport { useAuth } from \"../../contexts/AuthContext\";\r\nimport { useModal } from \"../../contexts/ModalContext\";\r\nimport AddOrDeleteButtonFull from \"../../features/full-screen-player/ui/molecules/add-or-delete-song-button\";\r\nimport { AddToPlaylists } from \"../../features/full-screen-player/ui/molecules/add-to-playlists\";\r\nimport { EditSong } from \"../AdminAndAuthor/EditSong\";\r\nimport { SongInfo } from \"../Info/SongInfo\";\r\nimport { AuthorsList } from \"../Lists/AuthorsList\";\r\nimport { FriendsListToShareWith } from \"../Lists/FriendsListToShareWith\";\r\n\r\nexport const SongItemMobileMoreWindow = ({ song }) => {\r\n  const { setContent } = useModal();\r\n  const { currentUser } = useAuth();\r\n  return (\r\n    <div className=\"SongItemMobileMoreWindow\">\r\n      <div\r\n        className=\"simpleSongElement\"\r\n        style={{ background: song.imageColors[0] }}\r\n      >\r\n        <div className=\"simpleSongElementImage\">\r\n          <img loading=\"lazy\" src={song.cover} alt=\"\" />\r\n        </div>\r\n        <span>{song.name}</span>\r\n      </div>\r\n      {currentUser.isAdmin ? (\r\n        <div\r\n          className=\"songItemMenuWindowItem\"\r\n          onClick={() => {\r\n            setContent(<EditSong song={song} />);\r\n          }}\r\n        >\r\n          <BiEditAlt />\r\n          Edit\r\n        </div>\r\n      ) : null}\r\n      <div className=\"songItemMenuWindowItem\">\r\n        <AddOrDeleteButtonFull song={song} />\r\n      </div>\r\n      <div\r\n        className=\"songItemMenuWindowItem\"\r\n        onClick={() => setContent(<AddToPlaylists song={song} />)}\r\n      >\r\n        <MdPlaylistAdd />\r\n        Add to playlist\r\n      </div>\r\n      <div\r\n        className=\"songItemMenuWindowItem\"\r\n        onClick={() => {\r\n          setContent(\r\n            <FriendsListToShareWith item={song} whatToShare={\"song\"} />\r\n          );\r\n        }}\r\n      >\r\n        <FiShare />\r\n        Share\r\n      </div>\r\n      <div\r\n        className=\"songItemMenuWindowItem\"\r\n        onClick={() => {\r\n          setContent(<SongInfo song={song} />);\r\n        }}\r\n      >\r\n        <FiInfo />\r\n        Info\r\n      </div>\r\n      <div\r\n        className=\"songItemMenuWindowItem\"\r\n        onClick={() => {\r\n          setContent(\r\n            <AuthorsList listOfAuthors={song.authors} title={\"Authors\"} />\r\n          );\r\n        }}\r\n      >\r\n        <FiUsers />\r\n        Authors\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport { BiEditAlt, BiListPlus } from \"react-icons/bi\";\r\nimport { FiInfo, FiShare } from \"react-icons/fi\";\r\nimport { MdKeyboardArrowRight, MdPlaylistAdd } from \"react-icons/md\";\r\nimport { useAuth } from \"../../contexts/AuthContext\";\r\nimport { useModal } from \"../../contexts/ModalContext\";\r\nimport { useSong } from \"../../contexts/SongContext\";\r\nimport AddOrDeleteButtonFull from \"../../features/full-screen-player/ui/molecules/add-or-delete-song-button\";\r\n\r\nimport { AddToPlaylists } from \"../../features/full-screen-player/ui/molecules/add-to-playlists\";\r\nimport { EditSong } from \"../AdminAndAuthor/EditSong\";\r\nimport { SongInfo } from \"../Info/SongInfo\";\r\nimport { FriendsListToShareWith } from \"../Lists/FriendsListToShareWith\";\r\n\r\nconst SongItemMoreWindow = ({\r\n  openMoreWindow,\r\n  song,\r\n  moreWindowPosRelativeToViewport,\r\n}) => {\r\n  const { toggleModal, setContent, openBottomMessage } = useModal();\r\n  const { currentUser } = useAuth();\r\n  const { setCurrentSongQueue } = useSong();\r\n\r\n  const addToQueue = () => {\r\n    setCurrentSongQueue((prev) => [...prev, song]);\r\n    openBottomMessage(\"Song was added to queue\");\r\n  };\r\n\r\n  return openMoreWindow ? (\r\n    <div\r\n      className=\"songItemMenuWindow\"\r\n      style={\r\n        moreWindowPosRelativeToViewport > window.innerHeight / 2 + 100\r\n          ? { top: \"auto\", bottom: \"110%\" }\r\n          : { top: \"110%\", bottom: \"auto\" }\r\n      }\r\n      onClick={(e) => e.stopPropagation()}\r\n    >\r\n      {currentUser.isAdmin ||\r\n      song.authors.find((el) => el.uid === currentUser.uid) ? (\r\n        <div\r\n          className=\"songItemMenuWindowItem\"\r\n          onClick={() => {\r\n            toggleModal();\r\n            setContent(<EditSong song={song} />);\r\n          }}\r\n        >\r\n          <BiEditAlt />\r\n          Edit\r\n        </div>\r\n      ) : null}\r\n      <div className=\"songItemMenuWindowItem\">\r\n        <AddOrDeleteButtonFull song={song} />\r\n      </div>\r\n      <div className=\"songItemMenuWindowItem\">\r\n        <div className=\"songItemMenuWindow inner\">\r\n          <AddToPlaylists song={song} />\r\n        </div>\r\n        <MdPlaylistAdd />\r\n        Add to playlist <MdKeyboardArrowRight />\r\n      </div>\r\n      <div\r\n        className=\"songItemMenuWindowItem\"\r\n        onClick={() => {\r\n          toggleModal();\r\n          setContent(\r\n            <FriendsListToShareWith item={song} whatToShare={\"song\"} />\r\n          );\r\n        }}\r\n      >\r\n        <FiShare />\r\n        Share\r\n      </div>\r\n      <div\r\n        className=\"songItemMenuWindowItem\"\r\n        onClick={() => {\r\n          toggleModal();\r\n          setContent(<SongInfo song={song} />);\r\n        }}\r\n      >\r\n        <FiInfo />\r\n        Info\r\n      </div>\r\n      <div className=\"songItemMenuWindowItem\" onClick={addToQueue}>\r\n        <BiListPlus />\r\n        Add to queue\r\n      </div>\r\n    </div>\r\n  ) : null;\r\n};\r\n\r\nexport default SongItemMoreWindow;\r\n","import { useAuth } from \"../../../../contexts/AuthContext\";\r\nimport { useModal } from \"../../../../contexts/ModalContext\";\r\nimport { useSong } from \"../../../../contexts/SongContext\";\r\nimport { deleteSongFromLibrary } from \"../../../../functions/other/deleteSongFromLibrary\";\r\nimport getShortString from \"../../../../shared/lib/get-short-string\";\r\nimport { addSongToLibrary } from \"../add-song-to-library\";\r\n\r\nconst useAddOrDeleteSong = (song) => {\r\n\tconst { currentUser, setCurrentUser } = useAuth();\r\n\tconst { yourSongs } = useSong();\r\n\tconst { openBottomMessage, openConfirm, closeConfirm } = useModal();\r\n\r\n\tconst addSong = (e) => {\r\n\t\taddSongToLibrary(e, song, currentUser, setCurrentUser);\r\n\t\topenBottomMessage(\r\n\t\t\t`${getShortString(song.name, 15)} added to your library`\r\n\t\t);\r\n\t}\r\n\r\n\tconst removeSong = (e) => {\r\n\t\te.stopPropagation();\r\n\t\topenConfirm(\r\n\t\t\t`You sure you want to delete \"${song.name}\" from library?`,\r\n\t\t\t\"Yes, delete it\",\r\n\t\t\t\"No, just kidding\",\r\n\t\t\t(e) => {\r\n\t\t\t\tdeleteSongFromLibrary(e, song, currentUser, yourSongs);\r\n\t\t\t\tcloseConfirm();\r\n\t\t\t\topenBottomMessage(\r\n\t\t\t\t\t`${getShortString(song.name, 15)} removed from your library`,\r\n\t\t\t\t\t\"failure\"\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\treturn [addSong, removeSong]\r\n}\r\n\r\nexport default useAddOrDeleteSong\r\n","import React from \"react\";\r\nimport { FiPlusCircle, FiX } from \"react-icons/fi\";\r\nimport { Hint } from \"../../../../components/Basic/Hint\";\r\nimport { useAuth } from \"../../../../contexts/AuthContext\";\r\nimport useAddOrDeleteSong from \"../../lib/hooks/use-add-or-delete-song\";\r\n\r\nconst AddOrDeleteButton = ({ song }) => {\r\n  const { currentUser } = useAuth();\r\n  const [addSong, removeSong] = useAddOrDeleteSong(song);\r\n\r\n  if (!currentUser.addedSongs.includes(song.id)) {\r\n    return (\r\n      <button onClick={addSong} style={{ position: \"relative\" }}>\r\n        <Hint text={\"add song\"} />\r\n        <FiPlusCircle />\r\n      </button>\r\n    );\r\n  } else {\r\n    return (\r\n      <button onClick={removeSong} style={{ position: \"relative\" }}>\r\n        <Hint text={\"delete song\"} />\r\n        <FiX />\r\n      </button>\r\n    );\r\n  }\r\n};\r\n\r\nexport default AddOrDeleteButton;\r\n","export default function rightFormanForBigNumber(number){\r\n\tif(number < 1000) return number\r\n\r\n\tif(number < 1000000) return parseFloat(number/1000).toFixed(1) + 'K'\r\n\r\n\tif(number < 1000000000) return parseFloat(number / 1000000).toFixed(1) + 'M'\r\n}","import React from 'react'\r\nimport { CgMusicNote } from 'react-icons/cg';\r\nimport rightFormanForBigNumber from '../../../../functions/other/rightFormatForBigNumber';\r\n\r\nconst ShowAdditionInfo = ({ showListens, isNewSong, song }) => {\r\n\treturn showListens ? (\r\n\t\t<span\r\n\t\t\tstyle={{\r\n\t\t\t\tdisplay: \"flex\",\r\n\t\t\t\talignItems: \"center\",\r\n\t\t\t\topacity: 0.7,\r\n\t\t\t\tfontSize: \".8em\",\r\n\t\t\t}}\r\n\t\t\tclassName={isNewSong ? \"newSongMarker\" : \"\"}\r\n\t\t>\r\n\t\t\t{rightFormanForBigNumber(song.listens)} <CgMusicNote />\r\n\t\t</span>\r\n\t) : isNewSong ? (\r\n\t\t<span\r\n\t\t\tstyle={{ display: \"flex\", alignItems: \"center\", fontSize: \".7em\" }}\r\n\t\t\tclassName={\"newSongMarker\"}\r\n\t\t>\r\n\t\t\tNew\r\n\t\t</span>\r\n\t) : null;\r\n\r\n}\r\n\r\nexport default ShowAdditionInfo\r\n","import { memo, useRef, useState } from \"react\";\r\nimport { FiMoreVertical } from \"react-icons/fi\";\r\nimport { HiPause, HiPlay } from \"react-icons/hi\";\r\nimport { Hint } from \"../../../../components/Basic/Hint\";\r\nimport { SongItemMobileMoreWindow } from \"../../../../components/Windows/SongItemMobileMoreWindow\";\r\nimport SongItemMoreWindow from \"../../../../components/Windows/SongItemMoreWindow\";\r\nimport { useAuth } from \"../../../../contexts/AuthContext\";\r\nimport { useModal } from \"../../../../contexts/ModalContext\";\r\nimport { useScreen } from \"../../../../contexts/ScreenContext\";\r\nimport { useSong } from \"../../../../contexts/SongContext\";\r\nimport { firestore } from \"../../../../firebase\";\r\nimport { addSongToHistory } from \"../../../../functions/add/addSongToHistory\";\r\nimport displayAuthorsStr from \"../../../../functions/display/displayAuthorsStr\";\r\nimport getShortString from \"../../../../shared/lib/get-short-string\";\r\nimport useOutsideClick from \"../../../../shared/lib/hooks/use-outside-click\";\r\nimport useRenderCount from \"../../../../shared/lib/hooks/use-render-count\";\r\nimport { AddToListCircle } from \"../../../../shared/ui/molecules/add-to-list-circle\";\r\nimport ColorCircles from \"../../../full-screen-player/ui/atoms/color-circles\";\r\n\r\nimport saveSearchHistory from \"../../../search/lib/save-search-history\";\r\nimport AddOrDeleteButton from \"../molecules/add-or-delete-button\";\r\nimport ShowAdditionInfo from \"../molecules/show-additional-info\";\r\nexport const SongItem = memo(\r\n  ({\r\n    song,\r\n    localIndex,\r\n    showListens = false,\r\n    isNewSong = false,\r\n    listOfChosenSongs,\r\n    setListOfSongs,\r\n    position,\r\n    shouldSaveSearchHistory = false,\r\n  }) => {\r\n    const {\r\n      setCurrentSong,\r\n      currentSong,\r\n      displayAuthors,\r\n      play,\r\n      songRef,\r\n      setPlay,\r\n      setCurrentSongInQueue,\r\n    } = useSong();\r\n    const { isMobile } = useScreen();\r\n    const [openMoreWindow, setOpenMoreWindow] = useState(false);\r\n    const [\r\n      moreWindowPosRelativeToViewport,\r\n      setMoreWindowPosRelativeToViewport,\r\n    ] = useState(0);\r\n    const currentItemRef = useRef(null);\r\n    const { currentUser } = useAuth();\r\n    const { toggleModal, setContent } = useModal();\r\n    useOutsideClick(currentItemRef, setOpenMoreWindow);\r\n\r\n    function chooseSongItem() {\r\n      setCurrentSong(song.id);\r\n      firestore.collection(\"users\").doc(currentUser.uid).update({\r\n        lastSongPlayed: song.id,\r\n      });\r\n\r\n      setCurrentSongInQueue(localIndex);\r\n      if (song.id === currentSong && play) {\r\n        songRef.current.pause();\r\n        setPlay(false);\r\n        // clearTimeout(listenCountTimeOut)\r\n        return;\r\n      }\r\n      songRef.current.play();\r\n      setPlay(true);\r\n\r\n      if (shouldSaveSearchHistory)\r\n        saveSearchHistory(currentUser.uid, song.id, \"songs\");\r\n      addSongToHistory(song.id, currentUser);\r\n    }\r\n\r\n    function openSongItemMoreWindow(e) {\r\n      e.stopPropagation();\r\n      setOpenMoreWindow(!openMoreWindow);\r\n      setMoreWindowPosRelativeToViewport(\r\n        position || e.target.getBoundingClientRect().top\r\n      );\r\n    }\r\n\r\n    return (\r\n      <div style={{ display: \"flex\", alignItems: \"center\", width: \"100%\" }}>\r\n        <AddToListCircle\r\n          listOfChosenItems={listOfChosenSongs}\r\n          setListOfChosenItems={setListOfSongs}\r\n          itemId={song.id}\r\n        />\r\n        <div\r\n          className={\r\n            \"SongItem \" + (song.id === currentSong && play ? \"playingNow\" : \"\")\r\n          }\r\n          onClick={chooseSongItem}\r\n          ref={openMoreWindow ? currentItemRef : null}\r\n          style={openMoreWindow ? { background: \"var(--playlistsColor)\" } : {}}\r\n        >\r\n          <div className=\"songItemImageAndName\">\r\n            <div className=\"songItemImage\">\r\n              <div className=\"songItemPlayOrPause\">\r\n                {song.id === currentSong && play ? null : <HiPlay />}\r\n              </div>\r\n              <div\r\n                className=\"playingAnimation\"\r\n                style={\r\n                  song.id === currentSong && play\r\n                    ? { opacity: 1, visibility: \"visible\" }\r\n                    : {}\r\n                }\r\n              >\r\n                <HiPause />\r\n                <ColorCircles play={play} />\r\n              </div>\r\n              <img loading=\"lazy\" src={song.cover} alt=\"\" />\r\n            </div>\r\n            <div className=\"songItemNameAndAuthor\">\r\n              <div\r\n                className=\"songItemName\"\r\n                style={{ display: \"flex\", alignItems: \"center\" }}\r\n              >\r\n                {getShortString(song.name, !isMobile ? 30 : 17)}\r\n                <span style={{ marginLeft: \"10px\", fontWeight: \"500\" }}>\r\n                  <ShowAdditionInfo\r\n                    showListens={showListens}\r\n                    isNewSong={isNewSong}\r\n                    song={song}\r\n                  />\r\n                </span>\r\n              </div>\r\n              {!isMobile ? (\r\n                <div className=\"songItemAuthor\">\r\n                  {displayAuthors(song.authors)}\r\n                </div>\r\n              ) : (\r\n                <div className=\"songItemAuthor\">\r\n                  {displayAuthorsStr(song.authors, \" & \", 30)}\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n          <div className=\"songItemMoreBtn\">\r\n            <AddOrDeleteButton song={song} />\r\n            <button\r\n              onClick={\r\n                isMobile\r\n                  ? (e) => {\r\n                      e.stopPropagation();\r\n                      toggleModal();\r\n                      setContent(<SongItemMobileMoreWindow song={song} />);\r\n                    }\r\n                  : openSongItemMoreWindow\r\n              }\r\n            >\r\n              <Hint text={\"more\"} />\r\n              <FiMoreVertical />\r\n            </button>\r\n          </div>\r\n          <SongItemMoreWindow\r\n            openMoreWindow={openMoreWindow}\r\n            song={song}\r\n            moreWindowPosRelativeToViewport={moreWindowPosRelativeToViewport}\r\n          />\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n);\r\n","import React from 'react'\r\n\r\nexport const Slider = ({pages, currentPage, setCurrentPage}) => {\r\n\treturn (\r\n\t\t<div className = \"Slider\">\r\n\t\t\t{pages.map((pageName, index)=>{\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<div className = {\"sliderItem \" + (index === currentPage?\"current\":\"\")} key = {index} onClick = {()=>setCurrentPage(index)}>\r\n\t\t\t\t\t\t{pageName}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)\r\n\t\t\t})}\r\n\t\t</div>\r\n\t)\r\n}\r\n","import React from 'react'\r\n\r\nexport const Loading = ({currentTime, timeSpan, id}) => {\r\n\treturn (\r\n\t\t<div className = \"Loading\" id = {id}>\r\n\t\t\t<div className=\"outer\" style = {{pointerEvents:'none'}}>\r\n\t\t\t\t<div className=\"inner\" style = {currentTime/timeSpan < 1?{width:(currentTime/timeSpan)*100 + \"%\"}:{width:0 + \"%\", opacity:'0'}}></div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t)\r\n}\r\n","import { useEffect, useState } from \"react\"\r\n\r\nexport default function useOnScreen(ref) {\r\n\r\n\tconst [isIntersecting, setIntersecting] = useState(false)\r\n \r\n\tconst observer = new IntersectionObserver(\r\n\t  ([entry]) => setIntersecting(entry.isIntersecting)\r\n\t)\r\n \r\n\tuseEffect(() => {\r\n\t  observer.observe(ref.current)\r\n\t  // Remove the observer as soon as the component is unmounted\r\n\t  return () => { observer.disconnect() }\r\n\t}, [])\r\n \r\n\treturn isIntersecting\r\n }","import React, { useRef } from \"react\";\r\nimport { useSong } from \"../../../../contexts/SongContext\";\r\nimport { Loading } from \"../atoms/loading\";\r\nimport { BiCheckCircle, BiDownArrow, BiUpArrow } from \"react-icons/bi\";\r\nimport { FiXCircle } from \"react-icons/fi\";\r\nimport useOnScreen from \"../../../../hooks/useOnScreen\";\r\nexport const LyricsParagraph = ({\r\n  el,\r\n  index,\r\n  lyricsModeratorMode,\r\n  karaokeModeratorTimes,\r\n  setKaraokeModeratorTimes,\r\n  setInputKaraokeTime,\r\n  inputKaraokeTime,\r\n}) => {\r\n  const {\r\n    currentSongData,\r\n    currentParagraph,\r\n    displayAuthors,\r\n    changeCurrentTime,\r\n    play,\r\n    currentTime,\r\n    currentParagraphRef,\r\n    lyrics,\r\n  } = useSong();\r\n  const paragraphRef = useRef();\r\n  const isVisible = useOnScreen(\r\n    currentParagraph === index ? currentParagraphRef : paragraphRef\r\n  );\r\n  const paragraphStyle =\r\n    currentParagraph === index\r\n      ? {}\r\n      : window.innerWidth > 1000\r\n      ? Math.abs(currentParagraph - index) < 2\r\n        ? { transform: \"scale(.8) translateX(-58px)\" }\r\n        : { transform: \"scale(.75) translateX(-78px)\" }\r\n      : Math.abs(currentParagraph - index) < 2\r\n      ? { transform: \"scale(.8) translateX(-11.5%)\" }\r\n      : { transform: \"scale(.75) translateX(-15.6%)\" };\r\n\r\n  function addLyricsBlock(indexOfRelativeElement, direction) {\r\n    const tempTimes = karaokeModeratorTimes;\r\n    if (direction === \"down\") {\r\n      tempTimes.splice(indexOfRelativeElement + 1, 0, undefined);\r\n      setKaraokeModeratorTimes(tempTimes);\r\n      return currentSongData.lyrics.splice(indexOfRelativeElement + 1, 0, {\r\n        startTime: \"undefined\",\r\n        text: \"@loading\",\r\n      });\r\n    }\r\n\r\n    tempTimes.splice(indexOfRelativeElement, 0, undefined);\r\n    setKaraokeModeratorTimes(tempTimes);\r\n    currentSongData.lyrics.splice(indexOfRelativeElement, 0, {\r\n      startTime: \"undefined\",\r\n      text: \"@loading\",\r\n    });\r\n  }\r\n\r\n  function inputKaraoke(e, index) {\r\n    let tempArray = karaokeModeratorTimes;\r\n    let convertedToNumber = e.target.value;\r\n    tempArray[index] = convertedToNumber;\r\n    setInputKaraokeTime(e.target.value);\r\n    setKaraokeModeratorTimes(tempArray);\r\n  }\r\n\r\n  return (\r\n    <div\r\n      className={\"lyricsBlock \" + (!isVisible ? \"notVisible\" : \"\")}\r\n      key={index}\r\n      id={index}\r\n      onClick={(e) => changeCurrentTime(e, el.startTime)}\r\n      style={\r\n        play\r\n          ? currentParagraph === index\r\n            ? {}\r\n            : Math.abs(currentParagraph - index) < 2\r\n            ? { opacity: 0.5 }\r\n            : { opacity: 0.1 }\r\n          : {}\r\n      }\r\n      ref={currentParagraph === index ? currentParagraphRef : paragraphRef}\r\n    >\r\n      {lyricsModeratorMode === 1 ? (\r\n        <div className=\"lyricsBlockInput\">\r\n          <span onClick={(e) => e.stopPropagation()}>\r\n            {karaokeModeratorTimes[index] !== undefined &&\r\n            karaokeModeratorTimes[index].length !== 0 ? (\r\n              <BiCheckCircle\r\n                style={{\r\n                  background: \"var(--themeColor3)\",\r\n                  color: \"var(--themeColor)\",\r\n                }}\r\n              />\r\n            ) : (\r\n              <FiXCircle />\r\n            )}{\" \"}\r\n          </span>\r\n          <input\r\n            type=\"number\"\r\n            value={karaokeModeratorTimes[index] || inputKaraokeTime}\r\n            onChange={(e) => inputKaraoke(e, index)}\r\n            onClick={(e) => e.stopPropagation()}\r\n          />\r\n          <div\r\n            className=\"addLyricsElementBtns\"\r\n            onClick={(e) => e.stopPropagation()}\r\n          >\r\n            <button\r\n              onClick={() => {\r\n                addLyricsBlock(index, \"up\");\r\n              }}\r\n            >\r\n              <BiUpArrow />\r\n            </button>\r\n            <button\r\n              onClick={() => {\r\n                addLyricsBlock(index, \"down\");\r\n              }}\r\n            >\r\n              <BiDownArrow />\r\n            </button>\r\n          </div>\r\n        </div>\r\n      ) : null}\r\n      {el.text === \"@loading\" ? (\r\n        <Loading\r\n          currentTime={currentTime - lyrics[index].startTime}\r\n          timeSpan={lyrics[index + 1].startTime - lyrics[index].startTime}\r\n          id={index}\r\n        />\r\n      ) : el.text === \"@end\" ? (\r\n        <></>\r\n      ) : (\r\n        <p key={index} id={index} style={paragraphStyle}>\r\n          {el.text}\r\n        </p>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n","import { BiDotsVerticalRounded, BiShare } from 'react-icons/bi';\r\nimport { RiPlayListFill } from 'react-icons/ri';\r\nimport { TiDocumentText } from 'react-icons/ti';\r\nimport { SongInfo } from '../../components/Info/SongInfo';\r\nimport { AuthorsList } from '../../components/Lists/AuthorsList';\r\nimport { AddToPlaylists } from '../../features/full-screen-player/ui/molecules/add-to-playlists';\r\nimport { Options } from '../../features/full-screen-player/ui/organisms/options';\r\nimport { Queue } from '../../features/full-screen-player/ui/organisms/queue';\r\nimport { Share } from '../../features/full-screen-player/ui/organisms/share';\r\nimport { Lyrics } from '../../features/full-screen-player/ui/organisms/lyrics';\r\n\r\n\r\nexport const rightSide = [\r\n\t{\r\n\t\tid: 0,\r\n\t\ticon: <BiShare />,\r\n\t\ttitle: 'Share',\r\n\t\tcomponent: Share\r\n\t},\r\n\t{\r\n\t\tid: 1,\r\n\t\ticon: <BiDotsVerticalRounded />,\r\n\t\ttitle: 'More',\r\n\t\tcomponent: Options\r\n\t},\r\n\t{\r\n\t\tid: 2,\r\n\t\ticon: <TiDocumentText />,\r\n\t\ttitle: 'Lyrics',\r\n\t\tcomponent: Lyrics\r\n\t},\r\n\t{\r\n\t\tid: 3,\r\n\t\ticon: <RiPlayListFill />,\r\n\t\ttitle: 'Queue',\r\n\t\tcomponent: Queue\r\n\t},\r\n\t{\r\n\t\tid: 4,\r\n\t\ticon: null,\r\n\t\ttitle: 'Go To Authors',\r\n\t\tcomponent: AuthorsList\r\n\t},\r\n\t{\r\n\t\tid: 5,\r\n\t\ticon: null,\r\n\t\ttitle: 'Add to playlist',\r\n\t\tcomponent: AddToPlaylists\r\n\t},\r\n\t{\r\n\t\tid: 6,\r\n\t\ticon: null,\r\n\t\ttitle: 'Info',\r\n\t\tcomponent: SongInfo\r\n\t},\r\n]","import React from \"react\";\r\nimport { FaFacebookF, FaTelegramPlane, FaVk } from \"react-icons/fa\";\r\nimport { FiCopy } from \"react-icons/fi\";\r\nimport { AiFillInstagram } from \"react-icons/ai\";\r\nimport { ImWhatsapp } from \"react-icons/im\";\r\nimport { useSong } from \"../../../../contexts/SongContext\";\r\nimport { FriendsListToShareWith } from \"../../../../components/Lists/FriendsListToShareWith\";\r\nexport const Share = () => {\r\n  const { currentSongData } = useSong();\r\n  const socialMedia = [\r\n    <ImWhatsapp />,\r\n    <FaFacebookF />,\r\n    <FaTelegramPlane />,\r\n    <FaVk />,\r\n    <AiFillInstagram />,\r\n  ];\r\n  return (\r\n    <div className=\"Share\">\r\n      <button className=\"shareCopyLink\">\r\n        <FiCopy />\r\n        Copy link\r\n      </button>\r\n      <div className=\"shareOnSocial\">\r\n        {socialMedia.map((social, index) => {\r\n          return (\r\n            <div className=\"shareSocialIcon\" key={index}>\r\n              {social}\r\n            </div>\r\n          );\r\n        })}\r\n      </div>\r\n      <div className=\"sharePeopleShort\">\r\n        <FriendsListToShareWith item={currentSongData} whatToShare={\"song\"} />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { BiCheckCircle, BiDownArrow, BiUpArrow } from \"react-icons/bi\";\r\nimport { FiXCircle } from \"react-icons/fi\";\r\nimport { useAuth } from \"../../../../contexts/AuthContext\";\r\nimport { useSong } from \"../../../../contexts/SongContext\";\r\nimport { firestore } from \"../../../../firebase\";\r\nimport { Slider } from \"../../../../shared/ui/molecules/slider\";\r\nimport { LyricsParagraph } from \"../molecules/lyrics-paragraph\";\r\n\r\nexport const Lyrics = () => {\r\n  const {\r\n    setIsThereKaraoke,\r\n    currentSongData,\r\n    setCurrentSongData,\r\n    isThereKaraoke,\r\n    currentParagraph,\r\n    displayAuthors,\r\n    currentParagraphRef,\r\n    lyrics,\r\n    rightSideCurrentPage,\r\n    openFullScreenPlayer,\r\n    openMenu,\r\n  } = useSong();\r\n  const { currentUser } = useAuth();\r\n  const [inputKaraokeTime, setInputKaraokeTime] = useState(0);\r\n  const [karaokeModeratorTimes, setKaraokeModeratorTimes] = useState([]);\r\n  const [lyricsModeratorMode, setLyricsModeratorMode] = useState(0);\r\n  const [canUpdateLyrics, setCanUpdateLyrics] = useState(false);\r\n  useEffect(() => {\r\n    if (\r\n      isThereKaraoke &&\r\n      openMenu &&\r\n      rightSideCurrentPage === 2 &&\r\n      openFullScreenPlayer\r\n    )\r\n      currentParagraphRef.current.scrollIntoView();\r\n  }, [currentParagraph]);\r\n  function inputKaraoke(e, index) {\r\n    let tempArray = karaokeModeratorTimes;\r\n    let convertedToNumber = e.target.value;\r\n    tempArray[index] = convertedToNumber;\r\n    setInputKaraokeTime(e.target.value);\r\n    setKaraokeModeratorTimes(tempArray);\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (lyrics && lyrics[0].startTime !== \"undefined\") {\r\n      lyrics.forEach((paragraph) => {\r\n        karaokeModeratorTimes.push(paragraph.startTime);\r\n      });\r\n      setCanUpdateLyrics(true);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    let tempSongData = currentSongData;\r\n    if (tempSongData !== undefined && inputKaraokeTime !== 0) {\r\n      tempSongData.lyrics.forEach((paragraph, index) => {\r\n        paragraph.startTime = karaokeModeratorTimes[index] || \"undefined\";\r\n      });\r\n      setCurrentSongData(tempSongData);\r\n      setIsThereKaraoke(true);\r\n    }\r\n\r\n    if (\r\n      !currentSongData.lyrics?.some(\r\n        (paragraph) => paragraph.startTime === \"undefined\"\r\n      )\r\n    )\r\n      setCanUpdateLyrics(true);\r\n    else setCanUpdateLyrics(false);\r\n  }, [inputKaraokeTime]);\r\n  function updateLyrics() {\r\n    //TODO: add if statement to prevent adding lyrics time spans to not everysingle paragraph block\r\n    firestore.collection(\"songs\").doc(currentSongData.id).update({\r\n      lyrics: currentSongData.lyrics,\r\n    });\r\n  }\r\n\r\n  function addLyricsBlock(indexOfRelativeElement, direction) {\r\n    const tempTimes = karaokeModeratorTimes;\r\n    if (direction === \"down\") {\r\n      tempTimes.splice(indexOfRelativeElement + 1, 0, undefined);\r\n      setKaraokeModeratorTimes(tempTimes);\r\n      return currentSongData.lyrics.splice(indexOfRelativeElement + 1, 0, {\r\n        startTime: \"undefined\",\r\n        text: \"@loading\",\r\n      });\r\n    }\r\n\r\n    tempTimes.splice(indexOfRelativeElement, 0, undefined);\r\n    setKaraokeModeratorTimes(tempTimes);\r\n    currentSongData.lyrics.splice(indexOfRelativeElement, 0, {\r\n      startTime: \"undefined\",\r\n      text: \"@loading\",\r\n    });\r\n  }\r\n\r\n  return lyrics ? (\r\n    <div className=\"Lyrics\">\r\n      {currentUser.isAdmin ? (\r\n        <Slider\r\n          pages={[\"Listen mode\", \"Edit Mode\"]}\r\n          currentPage={lyricsModeratorMode}\r\n          setCurrentPage={setLyricsModeratorMode}\r\n        />\r\n      ) : null}\r\n      {isThereKaraoke\r\n        ? lyrics.map((el, i) => {\r\n            return (\r\n              <LyricsParagraph\r\n                el={el}\r\n                index={i}\r\n                lyricsModeratorMode={lyricsModeratorMode}\r\n                karaokeModeratorTimes={karaokeModeratorTimes}\r\n                setKaraokeModeratorTimes={setKaraokeModeratorTimes}\r\n                setInputKaraokeTime={setInputKaraokeTime}\r\n                inputKaraokeTime={inputKaraoke}\r\n              />\r\n            );\r\n          })\r\n        : lyrics.map((el, i) => {\r\n            return (\r\n              <div className=\"lyricsBlock\" key={i}>\r\n                {lyricsModeratorMode === 1 ? (\r\n                  <div className=\"lyricsBlockInput\">\r\n                    {karaokeModeratorTimes[i] !== undefined &&\r\n                    karaokeModeratorTimes[i].length !== 0 ? (\r\n                      <BiCheckCircle\r\n                        style={{\r\n                          background: \"var(--themeColor3)\",\r\n                          color: \"var(--themeColor)\",\r\n                        }}\r\n                      />\r\n                    ) : (\r\n                      <FiXCircle />\r\n                    )}\r\n                    <input\r\n                      type=\"number\"\r\n                      value={karaokeModeratorTimes[i] || inputKaraokeTime}\r\n                      onChange={(e) => inputKaraoke(e, i)}\r\n                      onClick={(e) => e.stopPropagation()}\r\n                    />\r\n                    <div className=\"addLyricsElementBtns\">\r\n                      <button onClick={() => addLyricsBlock(i, \"up\")}>\r\n                        <BiUpArrow />\r\n                      </button>\r\n                      <button onClick={() => addLyricsBlock(i, \"down\")}>\r\n                        <BiDownArrow />\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                ) : null}\r\n                <p>{el.text}</p>\r\n              </div>\r\n            );\r\n          })}\r\n      <h6\r\n        className={\r\n          \"lyricsAuthors \" +\r\n          (currentParagraph === lyrics.length - 1 ? \"active\" : \"\")\r\n        }\r\n      >\r\n        Authors: {displayAuthors()}\r\n      </h6>\r\n      {lyricsModeratorMode === 1 ? (\r\n        <button\r\n          onClick={canUpdateLyrics ? updateLyrics : null}\r\n          className=\"updateLyricsBtn\"\r\n          style={!canUpdateLyrics ? { opacity: 0.3 } : {}}\r\n        >\r\n          Update Lyrics\r\n        </button>\r\n      ) : null}\r\n    </div>\r\n  ) : (\r\n    <h3>No lyrics</h3>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { useSong } from \"../../../../contexts/SongContext\";\r\nimport getShortString from \"../../../../shared/lib/get-short-string\";\r\nimport { SongItem } from \"../../../song/ui/organisms/song-item\";\r\n\r\nexport const Queue = () => {\r\n  const {\r\n    currentSongQueue,\r\n    currentSongPlaylistSource,\r\n    setOpenFullScreenPlayer,\r\n  } = useSong();\r\n  return (\r\n    <div className=\"Queue\">\r\n      <div className=\"queueNowIsPlaying\">\r\n        <h5 style={{ marginTop: 2 }}>\r\n          Now is playing:\r\n          <Link\r\n            onClick={() => setOpenFullScreenPlayer(false)}\r\n            to={currentSongPlaylistSource.source}\r\n            className=\"queueAlbumName\"\r\n          >\r\n            <div\r\n              className=\"queueImage\"\r\n              style={currentSongPlaylistSource.image ? {} : { display: \"none\" }}\r\n            >\r\n              <img\r\n                loading=\"lazy\"\r\n                src={currentSongPlaylistSource.image}\r\n                alt=\"\"\r\n              />\r\n            </div>\r\n            <span>{getShortString(currentSongPlaylistSource.name, 25)}</span>\r\n          </Link>\r\n        </h5>\r\n      </div>\r\n      {currentSongQueue.map((song, index) => {\r\n        return <SongItem song={song} localIndex={index} key={index} />;\r\n      })}\r\n    </div>\r\n  );\r\n};\r\n","import \"../../../app/index.css\";\r\nimport React, { useState, useRef, useEffect } from \"react\";\r\nimport { BiChevronLeft } from \"react-icons/bi\";\r\nimport { HiChevronDown } from \"react-icons/hi\";\r\nimport { useSong } from \"../../../contexts/SongContext\";\r\nimport { FiMinus } from \"react-icons/fi\";\r\nimport { useSwipeable } from \"react-swipeable\";\r\nimport checkNumber from \"../../../shared/lib/check-number\";\r\nimport { useScreen } from \"../../../contexts/ScreenContext\";\r\nimport useOutsideClick from \"../../../shared/lib/hooks/use-outside-click\";\r\nimport { Player } from \"./organisms/player\";\r\nimport { rightSide } from \"../../../shared/data/player-right-side\";\r\n\r\nexport default function FullScreenPlayer() {\r\n  const {\r\n    imgColors,\r\n    inputRef,\r\n    rightSideCurrentPage,\r\n    setRightSideCurrentPage,\r\n    openFullScreenPlayer,\r\n    setOpenFullScreenPlayer,\r\n    lyrics,\r\n    openMenu,\r\n    setOpenMenu,\r\n  } = useSong();\r\n  const { isMobile, screenHeight, screenWidth } = useScreen();\r\n  const lyricsRef = useRef(null);\r\n  const [transformTransition, setTransformTransition] = useState(0.05);\r\n  const [mobileMenuTransition, setMobileMenuTransition] = useState(0);\r\n  // const [swipeDown, setSwipeDown] = useState(false)\r\n  const [deltaY, setDeltaY] = useState(0);\r\n  const [deltaYMobileMenu, setDeltaYMobileMenu] = useState(0);\r\n  const mobileContentScroll = useRef();\r\n  // setup ref for your usage\r\n  const mobileMenuRef = React.useRef();\r\n  useOutsideClick(mobileMenuRef, setOpenMenu);\r\n  const handlers = useSwipeable({\r\n    // onSwiped: (eventData) => {setSwipeDown(eventData.dir === 'Down')},\r\n    onSwiping: (event) => {\r\n      if (event.deltaY > 0) setDeltaY(event.deltaY);\r\n    },\r\n  });\r\n\r\n  // setup ref for your usage\r\n  const bgRef = React.useRef();\r\n\r\n  const handlersForMobileMenu = useSwipeable({\r\n    onSwiping: (event) => {\r\n      event.event.stopPropagation();\r\n      if (\r\n        openMenu &&\r\n        mobileContentScroll.current.scrollTop === 0 &&\r\n        event.deltaY > 0\r\n      )\r\n        setDeltaYMobileMenu(event.deltaY);\r\n      else if (!openMenu && event.deltaY < 0) setDeltaYMobileMenu(event.deltaY);\r\n    },\r\n    onSwipedLeft: () => {\r\n      setRightSideCurrentPage(checkNumber(rightSideCurrentPage + 1, 3));\r\n    },\r\n    onSwipedRight: () => {\r\n      setRightSideCurrentPage(checkNumber(rightSideCurrentPage - 1, 3));\r\n    },\r\n  });\r\n\r\n  function returnToInitialMobileMenu() {\r\n    let dropDelta;\r\n    clearTimeout(dropDelta);\r\n    setMobileMenuTransition(0);\r\n    dropDelta = setTimeout(() => {\r\n      setMobileMenuTransition(0.2);\r\n      setDeltaYMobileMenu(0);\r\n    }, 300);\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (deltaY > 150) {\r\n      setOpenFullScreenPlayer(false);\r\n    }\r\n  }, [deltaY]);\r\n\r\n  useEffect(() => {\r\n    if (!openMenu && deltaYMobileMenu < -100) {\r\n      setOpenMenu(true);\r\n      setDeltaYMobileMenu(0);\r\n      setMobileMenuTransition(0.2);\r\n    } else if (openMenu && deltaYMobileMenu > 150) {\r\n      setOpenMenu(false);\r\n      setDeltaYMobileMenu(0);\r\n      setMobileMenuTransition(0.2);\r\n    } else {\r\n      returnToInitialMobileMenu();\r\n    }\r\n  }, [deltaYMobileMenu]);\r\n\r\n  function returnToInitial() {\r\n    let dropDelta;\r\n    clearTimeout(dropDelta);\r\n    setTransformTransition(0.2);\r\n    dropDelta = setTimeout(() => {\r\n      setDeltaY(0);\r\n      setTransformTransition(0);\r\n    }, 100);\r\n  }\r\n\r\n  const refPassthroughBg = (el) => {\r\n    handlers.ref(el);\r\n    bgRef.current = el;\r\n  };\r\n\r\n  const refPassthroughMobileMenu = (el) => {\r\n    handlersForMobileMenu.ref(el);\r\n    mobileMenuRef.current = el;\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (imgColors.length !== 0) {\r\n      document.documentElement.style.setProperty(\"--themeColor\", imgColors[1]);\r\n      document.documentElement.style.setProperty(\"--themeColor2\", imgColors[0]);\r\n      document.documentElement.style.setProperty(\"--themeColor3\", imgColors[2]);\r\n      document.documentElement.style.setProperty(\"--themeColor4\", imgColors[5]);\r\n      document.documentElement.style.setProperty(\r\n        \"--themeColorTransparent\",\r\n        imgColors[0] + \"6e\"\r\n      );\r\n    }\r\n  }, [imgColors]);\r\n\r\n  function rightSideContent(currentPage) {\r\n    let RightSidePage = rightSide[currentPage].component;\r\n    return <RightSidePage />;\r\n  }\r\n\r\n  function noLyrics() {\r\n    return lyrics && lyrics.length === 0;\r\n  }\r\n\r\n  function changeRightSidePage(el) {\r\n    if (el.id === 2 && noLyrics()) return null;\r\n    setMobileMenuTransition(0.2);\r\n    setRightSideCurrentPage(el.id);\r\n    setOpenMenu(true);\r\n  }\r\n  return (\r\n    <div\r\n      className=\"bg\"\r\n      style={\r\n        openFullScreenPlayer\r\n          ? {\r\n              top: 0,\r\n              opacity: 1,\r\n              visibility: \"visible\",\r\n              zIndex: 10,\r\n              transform: `translateY(${deltaY}px)`,\r\n              borderRadius: `${deltaY < 20 ? deltaY : 20}px ${\r\n                deltaY < 20 ? deltaY : 20\r\n              }px 0 0`,\r\n              transition: `.4s opacity, ${transformTransition}s transform, .4s top, .4s visibility`,\r\n            }\r\n          : {\r\n              transform: `translateY(${deltaY}px)`,\r\n              transition: `.4s opacity, ${transformTransition}s transform, .4s top, .4s visibility`,\r\n            }\r\n      }\r\n      ref={refPassthroughBg}\r\n      {...handlers}\r\n      onTouchEnd={returnToInitial}\r\n    >\r\n      {/* <div className=\"auroraWrapper\">\r\n        <svg height={screenHeight} width={screenWidth}>\r\n          <defs>\r\n            <filter id=\"f1\" x=\"0\" y=\"0\">\r\n              <feGaussianBlur in=\"SourceGraphic\" stdDeviation=\"215\" />\r\n            </filter>\r\n          </defs>\r\n          <circle cx={screenWidth/2} cy=\"0\" r={screenHeight}\r\n            fill={imgColors[0]} filter=\"url(#f1)\" />\r\n        </svg>\r\n      </div> */}\r\n\r\n      <div\r\n        className=\"closeFullScreen\"\r\n        onClick={() => {\r\n          setOpenFullScreenPlayer(false);\r\n        }}\r\n      >\r\n        {window.innerWidth > 1000 ? (\r\n          <HiChevronDown />\r\n        ) : (\r\n          <FiMinus style={{ opacity: 0.6 }} />\r\n        )}\r\n      </div>\r\n      <div className=\"FullScreenPlayer\">\r\n        <div\r\n          className=\"leftSide\"\r\n          style={\r\n            !openMenu\r\n              ? { width: \"100%\" }\r\n              : isMobile\r\n              ? {\r\n                  opacity: 0.6,\r\n                  visibility: \"visible\",\r\n                  transform: `translateY(20px)`,\r\n                  borderRadius: `10px`,\r\n                  transition: `.4s`,\r\n                }\r\n              : null\r\n          }\r\n        >\r\n          <Player inputRef={inputRef} />\r\n        </div>\r\n        {window.innerWidth > 1000 ? (\r\n          <div\r\n            className=\"rightSideWrapper\"\r\n            style={\r\n              !openMenu\r\n                ? { transform: \"translateX(calc(100% - 90px))\", width: 0 }\r\n                : {}\r\n            }\r\n          >\r\n            <button\r\n              className=\"menuBtn\"\r\n              style={\r\n                openMenu\r\n                  ? { transform: \"rotate(180deg)\" }\r\n                  : { opacity: 0, visibility: \"hidden\" }\r\n              }\r\n              onClick={() => setOpenMenu(!openMenu)}\r\n            >\r\n              <BiChevronLeft />\r\n            </button>\r\n            <div className=\"rightSideControl\">\r\n              {rightSide.map((el, i) => {\r\n                return (\r\n                  <div\r\n                    className=\"controlIcon\"\r\n                    key={el.id}\r\n                    style={\r\n                      el.id === rightSideCurrentPage && openMenu\r\n                        ? { background: \"var(--themeColor)\" }\r\n                        : el.id === 2 && noLyrics()\r\n                        ? { opacity: 0.4 }\r\n                        : {}\r\n                    }\r\n                    onClick={() => changeRightSidePage(el)}\r\n                  >\r\n                    {el.icon}\r\n                  </div>\r\n                );\r\n              })}\r\n            </div>\r\n            <div\r\n              className=\"rightSide\"\r\n              ref={lyricsRef}\r\n              style={!openMenu ? { display: \"none\" } : {}}\r\n            >\r\n              {rightSideContent(rightSideCurrentPage)}\r\n            </div>\r\n          </div>\r\n        ) : (\r\n          <div\r\n            className=\"mobilePlayerMenu\"\r\n            {...handlersForMobileMenu}\r\n            ref={refPassthroughMobileMenu}\r\n            style={\r\n              openMenu\r\n                ? {\r\n                    top: `calc(100% - calc(70vh + 55px) + ${deltaYMobileMenu}px)`,\r\n                    transition: `${mobileMenuTransition}s`,\r\n                  }\r\n                : {\r\n                    top: `calc(100% - 55px + ${deltaYMobileMenu}px)`,\r\n                    transition: `${mobileMenuTransition}s`,\r\n                  }\r\n            }\r\n            // onTouchStart = {returnToInitialMobileMenu}\r\n          >\r\n            <div className=\"mobilePlayerMenuClose\">\r\n              <FiMinus\r\n                style={{ opacity: 0.6, width: \"50px\" }}\r\n                onClick={() => setOpenMenu(!openMenu)}\r\n              />\r\n            </div>\r\n            <div className=\"controlIconsWrapper\">\r\n              {rightSide.map((el, i) => {\r\n                if (i <= 3) {\r\n                  return (\r\n                    <div\r\n                      className=\"controlIcon\"\r\n                      key={el.id}\r\n                      style={\r\n                        el.id === rightSideCurrentPage && openMenu\r\n                          ? { background: \"var(--transparentWhite)\" }\r\n                          : el.id === 2 && noLyrics()\r\n                          ? { opacity: 0.4 }\r\n                          : {}\r\n                      }\r\n                      onClick={(e) => changeRightSidePage(el)}\r\n                    >\r\n                      {el.title}\r\n                    </div>\r\n                  );\r\n                }\r\n              })}\r\n            </div>\r\n            <div\r\n              className=\"mobilePlayerMenuContent\"\r\n              ref={mobileContentScroll}\r\n              style={!openMenu ? { opacity: 0 } : {}}\r\n            >\r\n              {rightSideContent(rightSideCurrentPage)}\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport styled from \"styled-components\";\r\nimport { useAuth } from \"../../contexts/AuthContext\";\r\n\r\nconst NotificationCircleWrapper = styled.div`\r\n  border-radius: 100%;\r\n  width: 20px;\r\n  height: 20px;\r\n  font-size: 0.7em;\r\n  background: var(--red);\r\n  color: #fff;\r\n  font-weight: bold;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  position: absolute;\r\n  top: 50%;\r\n  right: 10px;\r\n  transform: translateY(-50%);\r\n`;\r\n\r\nexport const NotificationCircle = ({ value }) => {\r\n  return (\r\n    !!value && (\r\n      <NotificationCircleWrapper className=\"notification-circle\">\r\n        {value}\r\n      </NotificationCircleWrapper>\r\n    )\r\n  );\r\n};\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { AiOutlineCloudDownload } from \"react-icons/ai\";\r\nimport { ImCheckmark } from \"react-icons/im\";\r\nimport styled from \"styled-components\";\r\nimport { LoadingCircle } from \"../../../components/Loading/LoadingCircle\";\r\nimport { useModal } from \"../../../contexts/ModalContext\";\r\nimport { storage } from \"../../../firebase\";\r\n\r\nconst DownloadButtonWrapper = styled.button`\r\n  width: 100%;\r\n  padding: 0;\r\n  box-sizing: border-box;\r\n  background: linear-gradient(45deg, #852de5, #5c38c1);\r\n  color: #fff;\r\n  font-weight: bold;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  height: 40px;\r\n  border-radius: var(--standartBorderRadius3);\r\n  position: relative;\r\n  overflow: hidden;\r\n  z-index: 2;\r\n  margin: 8px 0;\r\n\r\n  @keyframes button-animation-out {\r\n    0% {\r\n      opacity: 0;\r\n      transform: scale(0.9);\r\n    }\r\n    100% {\r\n      opacity: 1;\r\n      transform: scale(1);\r\n    }\r\n  }\r\n\r\n  .inner-button {\r\n    z-index: 1;\r\n    position: relative;\r\n    width: 100%;\r\n    height: 100%;\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n\r\n    .inner-button-content {\r\n      width: 100%;\r\n      height: 100%;\r\n    }\r\n\r\n    .inner-button-success {\r\n      animation: button-animation-out 2s forwards;\r\n    }\r\n\r\n    .inner-button-text {\r\n      cursor: pointer;\r\n      width: 100%;\r\n      height: 100%;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n\r\n      svg {\r\n        margin-right: 7px;\r\n        width: 20px;\r\n        height: 20px;\r\n      }\r\n    }\r\n\r\n    .inner-button-download {\r\n      width: 100%;\r\n      background: red;\r\n\r\n      input[type=\"file\"] {\r\n        /* display: none; */\r\n        width: 100%;\r\n        height: 100%;\r\n        position: absolute;\r\n        left: 50%;\r\n        top: 50%;\r\n        transform: translate(-50%, -50%);\r\n        display: none;\r\n      }\r\n    }\r\n  }\r\n\r\n  &::before {\r\n    content: \"\";\r\n    position: absolute;\r\n    display: block;\r\n    top: 50%;\r\n    left: 0%;\r\n    transform: translateY(-50%);\r\n    background: var(--green);\r\n    width: ${(props) => (props.completed ? \"100%\" : \"0\")};\r\n    height: 100%;\r\n    transition: 0.6s;\r\n    z-index: 0;\r\n  }\r\n\r\n  .LoadingCircle {\r\n    position: relative;\r\n    transform: none;\r\n    left: auto;\r\n    top: auto;\r\n    width: 30px;\r\n    height: 30px;\r\n\r\n    img {\r\n      width: 30px;\r\n      height: 30px;\r\n    }\r\n  }\r\n`;\r\n\r\nconst DownloadButton = ({\r\n  title = \"\",\r\n  text,\r\n  place,\r\n  setItemSrc,\r\n  setImageLocalPath,\r\n}) => {\r\n  const { openBottomMessage } = useModal();\r\n  const [errorMessage, setErrorMessage] = useState(\"\");\r\n  const [loading, setLoading] = useState(false);\r\n  const [completed, setCompleted] = useState(false);\r\n\r\n  async function onFileChange(e, place, setFunc) {\r\n    e.preventDefault();\r\n    setErrorMessage(\"\");\r\n    setLoading(true);\r\n    setCompleted(false);\r\n    const isImage =\r\n      place === \"songsImages/\" ||\r\n      place === \"usersImages/\" ||\r\n      place === \"chatCovers/\";\r\n    const file = e.target.files[0];\r\n    let isValid = false;\r\n    if (isImage) {\r\n      const validExtensions = [\".jpg\", \".png\", \".jpeg\"];\r\n      if (\r\n        validExtensions.find(\r\n          (ext) =>\r\n            file.name.substr(file.name.length - ext.length, ext.length) === ext\r\n        )\r\n      )\r\n        isValid = true;\r\n      else {\r\n        setErrorMessage(\r\n          `Format of your file is not valid. Download file with one of these: ${validExtensions.map(\r\n            (ex) => \" \" + ex\r\n          )}`\r\n        );\r\n        setLoading(false);\r\n      }\r\n    } else if (place === \"songs/\") {\r\n      const validExtensions = [\".mp3\", \".mp4a\", \".flac\", \".wav\", \".wma\"];\r\n      if (\r\n        validExtensions.find(\r\n          (ext) =>\r\n            file.name.substr(file.name.length - ext.length, ext.length) === ext\r\n        )\r\n      )\r\n        isValid = true;\r\n      else {\r\n        setErrorMessage(\r\n          `Format of your file is not valid. Download file with one of these: ${validExtensions.map(\r\n            (ex) => ex\r\n          )}`\r\n        );\r\n        setLoading(false);\r\n      }\r\n    }\r\n\r\n    if (isValid) {\r\n      if (isImage) setImageLocalPath(URL.createObjectURL(file));\r\n      const storageRef = storage.ref();\r\n      const fileRef = storageRef.child(place + file.name);\r\n      await fileRef.put(file);\r\n      setCompleted(true);\r\n      setLoading(false);\r\n      setFunc(await fileRef.getDownloadURL());\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (errorMessage.length) openBottomMessage(errorMessage, \"failure\");\r\n  }, [errorMessage]);\r\n\r\n  return (\r\n    <>\r\n      {!!title && <h3>{title}</h3>}\r\n      <DownloadButtonWrapper completed={completed}>\r\n        <div className=\"inner-button\">\r\n          {completed ? (\r\n            <div className=\"inner-button-success\">\r\n              <ImCheckmark /> Done\r\n            </div>\r\n          ) : !loading ? (\r\n            <div className=\"inner-button-content\">\r\n              <label className=\"inner-button-download\">\r\n                <div className=\"inner-button-text\">\r\n                  <AiOutlineCloudDownload />\r\n                  {text}\r\n                </div>\r\n                <input\r\n                  type=\"file\"\r\n                  name=\"\"\r\n                  id=\"\"\r\n                  onChange={(e) => onFileChange(e, place, setItemSrc)}\r\n                />\r\n              </label>\r\n            </div>\r\n          ) : (\r\n            <LoadingCircle top={0} />\r\n          )}\r\n        </div>\r\n      </DownloadButtonWrapper>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default DownloadButton;\r\n","import React from 'react'\r\n\r\nexport const FullScreenLoading = ({loading}) => {\r\n\treturn (\r\n\t\t<div className = \"FullScreenLoading\" style = {loading?{}:{opacity:'0', visibility:'hidden'}}>\r\n\t\t\t<img loading = \"lazy\" src=\"https://icon-library.com/images/spinner-icon-gif/spinner-icon-gif-28.jpg\" alt=\"\"/>\r\n\t\t</div>\r\n\t)\r\n}\r\n","import React from 'react'\r\n\r\nexport const RadioBtn = ({currentActive, id, label, onClick}) => {\r\n\treturn (\r\n\t\t<div className = \"RadioBtn\" id = {id} onClick = {onClick}>\r\n\t\t\t<span className = \"radioLabel\" style = {currentActive === id?{color:'var(--blue)', opacity:1, fontWeight:'bold'}:{}}>\r\n\t\t\t\t{label}\r\n\t\t\t</span>\r\n\t\t\t<span className = \"radioCircle\" style = {currentActive === id?{background:'var(--blue)'}:{}}></span>\r\n\t\t</div>\r\n\t)\r\n}\r\n","import React, { useState } from \"react\";\r\nimport { ColorExtractor } from \"react-color-extractor\";\r\nimport { FiXCircle } from \"react-icons/fi\";\r\nimport { useAuth } from \"../../contexts/AuthContext\";\r\nimport { SongItem } from \"../../features/song/ui/organisms/song-item\";\r\nimport { firestore } from \"../../firebase\";\r\nimport { findVariantsOfName } from \"../../functions/find/findVariantsOfName\";\r\nimport getUID from \"../../functions/other/getUID\";\r\nimport DownloadButton from \"../../shared/ui/atoms/download-button\";\r\nimport Input from \"../../shared/ui/atoms/input\";\r\nimport SubmitButton from \"../../shared/ui/atoms/submit-button\";\r\nimport SearchBar from \"../../shared/ui/organisms/search-bar\";\r\nimport { PersonTiny } from \"../Basic/PersonTiny\";\r\nimport { FullScreenLoading } from \"../Loading/FullScreenLoading\";\r\nimport { ErrorPlate } from \"../MessagePlates/ErrorPlate\";\r\nimport { RadioBtn } from \"../SignIn-Up/RadioBtn\";\r\nexport const AddPlaylist = () => {\r\n  const { currentUser } = useAuth();\r\n  const [playlistName, setPlaylistName] = useState(\"\");\r\n  const [playlistCover, setPlaylistCover] = useState(\"\");\r\n  const [authorsInputValue, setAuthorsInputValue] = useState(\"\");\r\n  const [allAuthors, setAllAuthors] = useState([]);\r\n  const [chosenAuthors, setChosenAuthors] = useState(\r\n    !currentUser.isAdmin\r\n      ? [\r\n          {\r\n            uid: currentUser.uid,\r\n            photoURL: currentUser.photoURL,\r\n            displayName: currentUser.displayName,\r\n          },\r\n        ]\r\n      : []\r\n  );\r\n  const [releaseDate, setReleaseDate] = useState(\r\n    currentUser.isAdmin ? \"\" : new Date().toString()\r\n  );\r\n  const [songsSearch, setSongsSearch] = useState(\"\");\r\n  const [allSongs, setAllSongs] = useState([]);\r\n  const [chosenSongs, setChosenSongs] = useState([]);\r\n  const [playlistStatus, setPlaylistStatus] = useState(0);\r\n  const [isPlaylistPrivate, setIsPlaylistPrivate] = useState(0);\r\n  const [imageLocalPath, setImageLocalPath] = useState(\"\");\r\n  const [imageColors, setImageColors] = useState([]);\r\n  const [errorMessage, setErrorMessage] = useState(\"\");\r\n  const [loadingPlaylist, setLoadingPlaylist] = useState(false);\r\n  const [completed, setCompleted] = useState(false);\r\n\r\n  function removeAuthorFromList(data) {\r\n    const filtered = chosenAuthors.filter((people) => people.uid !== data.uid);\r\n    return setChosenAuthors(filtered);\r\n  }\r\n\r\n  function removeSongFromList(data) {\r\n    const filtered = chosenSongs.filter((song) => song !== data);\r\n    return setChosenSongs(filtered);\r\n  }\r\n\r\n  function addAuthor(data) {\r\n    if (!chosenAuthors.some((person) => person.uid === data.uid)) {\r\n      return setChosenAuthors((prev) => [\r\n        ...prev,\r\n        {\r\n          uid: data.uid,\r\n          displayName: data.displayName,\r\n          photoURL: data.photoURL,\r\n        },\r\n      ]);\r\n    }\r\n\r\n    removeAuthorFromList(data);\r\n  }\r\n\r\n  async function addPlaylistToFirebase(e) {\r\n    e.preventDefault();\r\n    const uid = getUID();\r\n    if (playlistName.length === 0)\r\n      setErrorMessage(\"Playlist has to have some name\");\r\n    else if (chosenAuthors.length === 0)\r\n      setErrorMessage(\"Playlist has to have at least 1 author\");\r\n    else if (releaseDate.length === 0)\r\n      setErrorMessage(\"You have to set release date for a playlist\");\r\n    else {\r\n      setLoadingPlaylist(true);\r\n      firestore\r\n        .collection(\"playlists\")\r\n        .doc(uid)\r\n        .set({\r\n          id: uid,\r\n          name: playlistName,\r\n          songs: chosenSongs,\r\n          authors: chosenAuthors,\r\n          image: playlistCover,\r\n          listens: 0,\r\n          creationDate: releaseDate,\r\n          subscribers: 0,\r\n          isAlbum: playlistStatus === 1,\r\n          imageColors: imageColors,\r\n          isPrivate: isPlaylistPrivate === true,\r\n        })\r\n        .then(() => {\r\n          setAllAuthors([]);\r\n          setAuthorsInputValue(\"\");\r\n          setChosenAuthors([]);\r\n          setPlaylistCover(\"\");\r\n          setPlaylistName(\"\");\r\n          setReleaseDate(\"\");\r\n          setSongsSearch(\"\");\r\n          setChosenSongs([]);\r\n          setIsPlaylistPrivate(0);\r\n          setLoadingPlaylist(false);\r\n          setCompleted(true);\r\n        })\r\n        .catch((err) => {\r\n          setErrorMessage(err);\r\n          setLoadingPlaylist(false);\r\n        });\r\n\r\n      chosenAuthors.forEach(async (author) => {\r\n        const authorRef = await firestore\r\n          .collection(\"users\")\r\n          .doc(author.uid)\r\n          .get();\r\n        const authorData = authorRef.data();\r\n        const authorPlaylists = authorData.ownPlaylists;\r\n        authorPlaylists.push(uid);\r\n        firestore.collection(\"users\").doc(author.uid).update({\r\n          ownPlaylists: authorPlaylists,\r\n        });\r\n      });\r\n\r\n      firestore\r\n        .collection(\"search\")\r\n        .doc(uid)\r\n        .set({\r\n          place: \"playlists\",\r\n          uid: uid,\r\n          rank: 0,\r\n          variantsOfName: findVariantsOfName(playlistName),\r\n        });\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"AddSong\">\r\n      <FullScreenLoading loading={loadingPlaylist} />\r\n      <ColorExtractor\r\n        src={imageLocalPath}\r\n        getColors={(colors) => setImageColors(colors)}\r\n      />\r\n      <div>\r\n        <Input\r\n          title={\"Playlist name\"}\r\n          value={playlistName}\r\n          setValue={setPlaylistName}\r\n          placeholder={\"Enter playlist name\"}\r\n        />\r\n        <label>\r\n          <h3>Playlist authors</h3>\r\n          <SearchBar\r\n            value={authorsInputValue}\r\n            setValue={setAuthorsInputValue}\r\n            setResultAuthorList={setAllAuthors}\r\n            defaultSearchMode={\"authors\"}\r\n            inputText={\"Search for authors\"}\r\n          />\r\n          {/* <input type=\"text\" placeholder=\"Enter author name\" value={authorsInputValue} onChange={(e) => setAuthorsInputValue(e.target.value)} style={{ marginBottom: '5px' }} onKeyUp={() => timerUpFunc(findAuthors)} onKeyDown={() => { return clearTimeout(typingTimeout) }} /> */}\r\n          <div className=\"chosenAuthorsList\">\r\n            {chosenAuthors.map((author) => {\r\n              return (\r\n                <div className=\"chosenAuthorItem\">\r\n                  <span>{author.displayName}</span>\r\n                  <FiXCircle\r\n                    onClick={() =>\r\n                      author.uid === currentUser.uid\r\n                        ? null\r\n                        : removeAuthorFromList(author)\r\n                    }\r\n                  />\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n          <div className=\"authorsResult\">\r\n            {allAuthors.map((data, index) => {\r\n              return (\r\n                <PersonTiny\r\n                  data={data}\r\n                  onClick={() => addAuthor(data)}\r\n                  style={\r\n                    chosenAuthors.includes(data.uid)\r\n                      ? { background: \"var(--green)\" }\r\n                      : {}\r\n                  }\r\n                  key={index}\r\n                />\r\n              );\r\n            })}\r\n          </div>\r\n        </label>\r\n\r\n        <label>\r\n          <h3>Search for songs</h3>\r\n          <SearchBar\r\n            value={songsSearch}\r\n            setValue={setSongsSearch}\r\n            setAllFoundSongs={setAllSongs}\r\n            defaultSearchMode={\"songs\"}\r\n            inputText={\"Search for songs\"}\r\n          />\r\n          <div className=\"chosenAuthorsList\">\r\n            {chosenSongs.map((songId) => {\r\n              return (\r\n                <div className=\"chosenAuthorItem\">\r\n                  <span>{songId}</span>\r\n                  <FiXCircle onClick={() => removeSongFromList(songId)} />\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n          <div className=\"authorsResult\">\r\n            {allSongs.map((data, index) => {\r\n              return (\r\n                <SongItem\r\n                  song={data}\r\n                  localIndex={index}\r\n                  listOfChosenSongs={chosenSongs}\r\n                  setListOfSongs={setChosenSongs}\r\n                />\r\n              );\r\n            })}\r\n          </div>\r\n        </label>\r\n\r\n        {currentUser.isAdmin || currentUser.isAuthor ? (\r\n          <div\r\n            style={{\r\n              display: \"flex\",\r\n              justifyContent: \"flex-start\",\r\n              margin: \"15px 0\",\r\n            }}\r\n          >\r\n            <RadioBtn\r\n              label=\"Playlist\"\r\n              onClick={() => setPlaylistStatus(0)}\r\n              currentActive={playlistStatus}\r\n              id={0}\r\n            />\r\n            <RadioBtn\r\n              label=\"Album\"\r\n              onClick={() => setPlaylistStatus(1)}\r\n              currentActive={playlistStatus}\r\n              id={1}\r\n            />\r\n          </div>\r\n        ) : null}\r\n\r\n        <div\r\n          style={{\r\n            display: \"flex\",\r\n            justifyContent: \"flex-start\",\r\n            margin: \"15px 0\",\r\n          }}\r\n        >\r\n          <RadioBtn\r\n            label=\"Not Private\"\r\n            onClick={() => setIsPlaylistPrivate(0)}\r\n            currentActive={isPlaylistPrivate}\r\n            id={0}\r\n          />\r\n          <RadioBtn\r\n            label=\"Private\"\r\n            onClick={() => setIsPlaylistPrivate(1)}\r\n            currentActive={isPlaylistPrivate}\r\n            id={1}\r\n          />\r\n        </div>\r\n\r\n        {(currentUser.isAdmin || currentUser.isAuthor) && (\r\n          <Input\r\n            title={\"Release Date\"}\r\n            type={\"date\"}\r\n            value={releaseDate}\r\n            setValue={setReleaseDate}\r\n            placeholder={\"Enter release date\"}\r\n          />\r\n        )}\r\n        <DownloadButton\r\n          text={\"Download playlist cover\"}\r\n          place={\"songsImages/\"}\r\n          setItemSrc={setPlaylistCover}\r\n          setImageLocalPath={setImageLocalPath}\r\n        />\r\n        <SubmitButton\r\n          text={\"Add playlists\"}\r\n          action={addPlaylistToFirebase}\r\n          isLoading={loadingPlaylist}\r\n          completed={completed}\r\n          setCompleted={setCompleted}\r\n          bottomMessage={\"Playlist was uploaded to database\"}\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import React from 'react'\r\nimport { AddPlaylist } from '../AddWindow/AddPlaylist'\r\n\r\nexport const CreatePlaylistPage = () => {\r\n\treturn (\r\n\t\t<div className = 'CreatePlaylistPage'>\r\n\t\t\t<AddPlaylist/>\r\n\t\t</div>\r\n\t)\r\n}\r\n","export const LOGIN_ROUTE = '/login'\r\nexport const SIGNUP_ROUTE = '/signup'\r\nexport const HOME_ROUTE = '/home'\r\nexport const LIBRARY_ROUTE = '/library'\r\nexport const SEARCH_ROUTE = '/search'\r\nexport const CHAT_ROUTE = '/chat'\r\nexport const NOTFOUND_ROUTE = '/not-found'\r\nexport const HISTORY_ROUTE = '/history'\r\nexport const SETTINGS_ROUTE = '/settings'\r\nexport const LYRICS_EDITING_ROUTE = '/lyrics-editing'\r\n\r\nexport const TEMPLATE_CHAT = '/chat/:chatId'\r\nexport const TEMPLATE_ALBUM = '/albums/:albumId'\r\nexport const TEMPLATE_AUTHOR = '/authors/:authorId'","import { BiMusic, BiSearch } from \"react-icons/bi\";\r\nimport { FiHome, FiMessageCircle } from \"react-icons/fi\";\r\nimport { CHAT_ROUTE, HOME_ROUTE, LIBRARY_ROUTE, SEARCH_ROUTE } from \"../../utils/route-consts\";\r\n\r\nexport const leftSideBar = [\r\n\t{\r\n\t\tid: 0,\r\n\t\ticon: <FiHome />,\r\n\t\ttitle: 'Home',\r\n\t\tlink: HOME_ROUTE\r\n\t},\r\n\t{\r\n\t\tid: 1,\r\n\t\ticon: <BiMusic />,\r\n\t\ttitle: 'Library',\r\n\t\tlink: LIBRARY_ROUTE\r\n\t},\r\n\t{\r\n\t\tid: 2,\r\n\t\ticon: <BiSearch />,\r\n\t\ttitle: 'Search',\r\n\t\tlink: SEARCH_ROUTE\r\n\t},\r\n\t{\r\n\t\tid: 3,\r\n\t\ticon: <FiMessageCircle />,\r\n\t\ttitle: 'Chat',\r\n\t\tlink: CHAT_ROUTE\r\n\t},\r\n\r\n]","import styled from \"styled-components\";\r\n\r\nconst LeftsideBarContainer = styled.div`\r\n  width: 100%;\r\n  border-radius: var(--standartBorderRadius);\r\n  background: var(--navItemColor);\r\n  color: #fff;\r\n  font-weight: bold;\r\n  min-height: 40px;\r\n  padding: 0.4px 5px;\r\n  box-sizing: border-box;\r\n  scroll-snap-type: y mandatory;\r\n  transition: 0.2s height;\r\n  position: relative;\r\n\r\n  &:hover {\r\n    a {\r\n      text-decoration: none;\r\n    }\r\n  }\r\n\r\n  .personName {\r\n    white-space: nowrap;\r\n    text-overflow: ellipsis;\r\n  }\r\n`;\r\n\r\nexport default LeftsideBarContainer;\r\n","export function amountOfUnseenMessages(messages, currentUser) {\r\n\treturn messages.reduce((accum, message) => {\r\n\t\tif (message.sender !== currentUser.uid) {\r\n\t\t\tif (message.seenBy !== undefined) {\r\n\t\t\t\tif (!message.seenBy.includes(currentUser.uid)) {\r\n\t\t\t\t\treturn ++accum\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn accum\r\n\t}, 0)\r\n}","import { useEffect, useState } from 'react';\r\nimport { useAuth } from '../../../contexts/AuthContext';\r\nimport { firestore } from '../../../firebase';\r\nimport { amountOfUnseenMessages } from '../../chats/lib/amount-of-unseen-messages';\r\n\r\nconst useAmountOfUnseenMessages = () => {\r\n\tconst { currentUser } = useAuth()\r\n\tconst [amount, setAmount] = useState(0)\r\n\r\n\tuseEffect(() => {\r\n\t\tconst unsubscribe = firestore\r\n\t\t\t.collection(\"chats\")\r\n\t\t\t.where(\"participants\", \"array-contains\", currentUser.uid)\r\n\t\t\t.onSnapshot((snapshot) => {\r\n\t\t\t\tsetAmount(0)\r\n\t\t\t\tsnapshot.docs.map((chat) => {\r\n\t\t\t\t\tconst chatData = chat.data()\r\n\t\t\t\t\tsetAmount(prev => prev + amountOfUnseenMessages(chatData.messages, currentUser))\r\n\t\t\t\t})\r\n\t\t\t});\r\n\t\treturn () => {\r\n\t\t\tunsubscribe();\r\n\t\t};\r\n\t}, []);\r\n\r\n\treturn amount\r\n}\r\n\r\nexport default useAmountOfUnseenMessages\r\n","import React from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { NotificationCircle } from \"../../../../components/Basic/NotificationCircle\";\r\n\r\nexport default function NavigationItem({\r\n  id,\r\n  title,\r\n  icon,\r\n  link,\r\n  currentPage,\r\n  setCurrentPage,\r\n  notificationValue,\r\n}) {\r\n  return (\r\n    <Link to={link}>\r\n      <div\r\n        className={\"NavigationItem \" + (id === currentPage ? \"active\" : \"\")}\r\n        onClick={() => setCurrentPage(id)}\r\n      >\r\n        <div className=\"icon\">{icon}</div>\r\n        <b>{title}</b>\r\n        <NotificationCircle value={notificationValue} />\r\n      </div>\r\n    </Link>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport { leftSideBar } from \"../../../../shared/data/left-side-bar\";\r\nimport useAmountOfUnseenMessages from \"../../lib/use-amount-of-unseen-messages\";\r\nimport NavigationItem from \"../atoms/navigation-item\";\r\n\r\nconst NavigationPanel = ({ currentPage, setCurrentPage }) => {\r\n  const [home, library, search, chat] = leftSideBar;\r\n  const amountOfUnseenMessages = useAmountOfUnseenMessages();\r\n  return (\r\n    <div className=\"NavigationPanel\">\r\n      <NavigationItem\r\n        key={0}\r\n        id={home.id}\r\n        title={home.title}\r\n        icon={home.icon}\r\n        link={home.link}\r\n        currentPage={currentPage}\r\n        setCurrentPage={setCurrentPage}\r\n      />\r\n      <NavigationItem\r\n        key={1}\r\n        id={library.id}\r\n        title={library.title}\r\n        icon={library.icon}\r\n        link={library.link}\r\n        currentPage={currentPage}\r\n        setCurrentPage={setCurrentPage}\r\n      />\r\n      <NavigationItem\r\n        key={2}\r\n        id={search.id}\r\n        title={search.title}\r\n        icon={search.icon}\r\n        link={search.link}\r\n        currentPage={currentPage}\r\n        setCurrentPage={setCurrentPage}\r\n      />\r\n      <NavigationItem\r\n        key={3}\r\n        id={chat.id}\r\n        title={chat.title}\r\n        icon={chat.icon}\r\n        link={chat.link}\r\n        currentPage={currentPage}\r\n        setCurrentPage={setCurrentPage}\r\n        notificationValue={amountOfUnseenMessages}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default NavigationPanel;\r\n","import { useEffect, useState } from 'react'\r\nimport { firestore } from '../../../firebase'\r\n\r\nconst useUserOnline = (userUID) => {\r\n\tconst [isOnline, setIsOnline] = useState(false)\r\n\tuseEffect(() => {\r\n\t\tconst unsubscribe = firestore.collection('users').doc(userUID)\r\n\t\t\t.onSnapshot(doc => {\r\n\t\t\t\tif (userUID !== undefined) {\r\n\t\t\t\t\tconst fiveMinutesAgo = new Date().getTime() - 300000\r\n\t\t\t\t\tconst isOnline = doc.data().online > fiveMinutesAgo\r\n\t\t\t\t\tsetIsOnline(isOnline)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\treturn () => {\r\n\t\t\tunsubscribe()\r\n\t\t}\r\n\t}, [userUID])\r\n\r\n\treturn isOnline\r\n}\r\n\r\nexport default useUserOnline\r\n","import React from \"react\";\r\nimport useUserOnline from \"../../shared/lib/hooks/use-user-online\";\r\n\r\nexport const IsUserOnlineCircle = ({ userUID, setIsOnline = null }) => {\r\n  const isOnline = useUserOnline(userUID);\r\n\r\n  return isOnline ? <div className=\"onlineCircle\"></div> : null;\r\n};\r\n","import React from \"react\";\r\nimport styled from \"styled-components\";\r\n\r\nconst OnlineCircleAnimationWrapper = styled.div`\r\n  width: 10px;\r\n  height: 10px;\r\n  background: var(--red);\r\n  box-shadow: 0 0 10px var(--red);\r\n  border-radius: 100%;\r\n  position: relative;\r\n\r\n  @keyframes waveAnimation {\r\n    0% {\r\n      opacity: 0;\r\n      transform: scale(0.95);\r\n    }\r\n    60% {\r\n      opacity: 0.5;\r\n      transform: scale(2);\r\n    }\r\n    100% {\r\n      opacity: 0;\r\n      transform: scale(0.95);\r\n    }\r\n  }\r\n\r\n  &::after {\r\n    content: \"\";\r\n    width: 10px;\r\n    height: 10px;\r\n    background: var(--red);\r\n    filter: brightness(0.3);\r\n    border-radius: 100%;\r\n    animation: waveAnimation 1.5s infinite;\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    z-index: -1;\r\n  }\r\n`;\r\n\r\nconst OnlineCircleAnimation = () => {\r\n  return <OnlineCircleAnimationWrapper></OnlineCircleAnimationWrapper>;\r\n};\r\n\r\nexport default OnlineCircleAnimation;\r\n","import { firestore } from \"../../firebase\"\r\n\r\nexport const getSongById = async (songId) => {\r\n\tconst data = (await firestore.collection('songs').doc(songId).get()).data()\r\n\treturn data\r\n}","import { useEffect, useState } from \"react\";\r\nimport { useAuth } from \"../../../../contexts/AuthContext\";\r\nimport { useSong } from \"../../../../contexts/SongContext\";\r\nimport { firestore } from \"../../../../firebase\";\r\nimport { getSongById } from \"../../../../shared/api/song-api\";\r\n\r\nconst useLastSongListened = (data) => {\r\n  const [songData, setSongData] = useState();\r\n  const {\r\n    setCurrentSong,\r\n    currentSong,\r\n    play,\r\n    songRef,\r\n    setPlay,\r\n    setCurrentSongInQueue,\r\n  } = useSong();\r\n  const { currentUser } = useAuth();\r\n\r\n  function fetchLastSong() {\r\n    getSongById(data.lastSongPlayed).then((song) => setSongData(song));\r\n  }\r\n\r\n  function chooseSongItem() {\r\n    setCurrentSong(songData.id);\r\n    firestore.collection(\"users\").doc(currentUser.uid).update({\r\n      lastSongPlayed: songData.id,\r\n    });\r\n    setCurrentSongInQueue(0);\r\n    if (songData.id === currentSong && play) {\r\n      songRef.current.pause();\r\n      setPlay(false);\r\n      return;\r\n    }\r\n    songRef.current.play();\r\n    setPlay(true);\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (data?.lastSongPlayed) fetchLastSong();\r\n  }, [data.lastSongPlayed]);\r\n\r\n  return [songData, chooseSongItem];\r\n};\r\n\r\nexport default useLastSongListened;\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { BiShare } from \"react-icons/bi\";\r\nimport { FiMessageCircle, FiMusic } from \"react-icons/fi\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { Hint } from \"../../../../components/Basic/Hint\";\r\nimport { IsUserOnlineCircle } from \"../../../../components/Basic/IsUserOnlineCircle\";\r\nimport { useAuth } from \"../../../../contexts/AuthContext\";\r\nimport { useModal } from \"../../../../contexts/ModalContext\";\r\nimport { useSong } from \"../../../../contexts/SongContext\";\r\nimport shareWithManyFriends from \"../../../../functions/other/shareWithManyFriends\";\r\nimport { createChat } from \"../../../../shared/lib/create-—Åhat\";\r\nimport { findChatURL } from \"../../../../shared/lib/find-chat-url\";\r\nimport getShortString from \"../../../../shared/lib/get-short-string\";\r\nimport useUserOnline from \"../../../../shared/lib/hooks/use-user-online\";\r\nimport OnlineCircleAnimation from \"../../../../shared/ui/atoms/online-circle-animation\";\r\nimport useLastSongListened from \"../../../author/lib/hooks/use-last-song-listened\";\r\n\r\nexport const Person = ({ index, friend }) => {\r\n  const { currentUser } = useAuth();\r\n  const { openBottomMessage } = useModal();\r\n  const [friendChatId, setFriendChatId] = useState(0);\r\n  const [shouldCreate, setShouldCreate] = useState(false);\r\n  const [sendAnimation, setSendAnimation] = useState(\"\");\r\n  const { currentSong, currentSongData } = useSong();\r\n  const [loadingSendSong, setLoadingSendSong] = useState(false);\r\n  const isOnline = useUserOnline(friend.uid);\r\n  const [song, chooseSongItem] = useLastSongListened(friend);\r\n\r\n  useEffect(() => {\r\n    findChatURL([friend.uid], currentUser, setShouldCreate, setFriendChatId);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (sendAnimation?.length > 0) {\r\n      setLoadingSendSong(true);\r\n      setTimeout(() => {\r\n        setSendAnimation(\"\");\r\n        setLoadingSendSong(false);\r\n      }, 600);\r\n    }\r\n  }, [sendAnimation]);\r\n  return (\r\n    <div className=\"person\" key={index} id={friend.uid}>\r\n      <img\r\n        loading=\"lazy\"\r\n        src={currentSongData.cover}\r\n        alt=\"\"\r\n        className={\"sendSongImage \" + sendAnimation}\r\n      />\r\n\r\n      <div className=\"personBtns\">\r\n        <Link to={`/chat/${friendChatId}`}>\r\n          <button\r\n            onClick={() => {\r\n              if (shouldCreate)\r\n                createChat([currentUser.uid, friend.uid], friendChatId);\r\n            }}\r\n          >\r\n            <Hint text={\"chat\"} />\r\n            <FiMessageCircle />\r\n          </button>\r\n        </Link>\r\n\r\n        <button onClick={chooseSongItem}>\r\n          <Hint\r\n            text={\r\n              isOnline\r\n                ? getShortString(\r\n                    `${song?.name} | ${song?.authors[0].displayName}` ||\r\n                      \"No song data\",\r\n                    20\r\n                  )\r\n                : \"last listened song\"\r\n            }\r\n          />\r\n          {isOnline ? <OnlineCircleAnimation /> : <FiMusic />}\r\n        </button>\r\n\r\n        <button\r\n          onClick={() => {\r\n            if (!loadingSendSong) {\r\n              shareWithManyFriends({\r\n                shareList: [friend.uid],\r\n                currentUser,\r\n                itemId: currentSong,\r\n                whatToShare: \"song\",\r\n                setShouldCreate,\r\n                setFriendChatId,\r\n              });\r\n              setSendAnimation(\"sendAnimation\");\r\n              openBottomMessage(\r\n                `${currentSongData.name} was sent to ${friend.displayName}`\r\n              );\r\n            }\r\n          }}\r\n        >\r\n          <Hint text={\"share\"} />\r\n          <BiShare />\r\n        </button>\r\n      </div>\r\n      <Link className=\"personImg\" to={`/authors/${friend.uid}`}>\r\n        <img loading=\"lazy\" src={friend.photoURL} alt=\"\" />\r\n      </Link>\r\n      <IsUserOnlineCircle userUID={friend.uid} />\r\n      <div className=\"personName\" style={{ pointerEvents: \"none\" }}>\r\n        {getShortString(friend.displayName, 12)}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import React, { useEffect } from 'react'\r\nimport { useAuth } from '../contexts/AuthContext'\r\nimport { useSong } from '../contexts/SongContext'\r\nimport { firestore } from '../firebase'\r\n\r\nexport const usePlaylistSongs = (playlist, playlistSongs, setPlaylistSongs) => {\r\n\tconst {currentSongPlaylistSource, playSong, setCurrentSongQueue, setCurrentSong, setPlay, songRef, setCurrentSongInQueue, setCurrentSongPlaylistSource} = useSong()\r\n\tconst {currentUser} = useAuth()\r\n\tfunction fetchSongsInAlbum() {\r\n\t\tsetPlaylistSongs([])\r\n\t\tif (playlist.length !== 0) {\r\n\t\t\tplaylist.songs.map(async songId => {\r\n\t\t\t\tlet albumSong = (await firestore.collection('songs').doc(songId).get()).data()\r\n\t\t\t\tsetPlaylistSongs(prev => [...prev, albumSong])\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\tfunction playChosenPlaylist(e) {\r\n\t\te.preventDefault()\r\n\t\tif (currentSongPlaylistSource.name === playlist.name) {\r\n\t\t\tplaySong()\r\n\t\t\treturn\r\n\t\t}\r\n\t\tfetchSongsInAlbum()\r\n\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tif (playlistSongs.length) {\r\n\t\t\tconst source = { source: `/albums/${playlist.id}`, name: playlist.name, image: playlist.image, songsList: playlistSongs }\r\n\t\t\tconst listSongsIds = playlistSongs.map(song => song.id)\r\n\t\t\tsetCurrentSongQueue(playlistSongs)\r\n\t\t\tsetCurrentSongInQueue(0)\r\n\t\t\tsetCurrentSong(playlistSongs[0].id)\r\n\t\t\tsongRef.current.play()\r\n\t\t\tsetPlay(true)\r\n\t\t\tsetCurrentSongPlaylistSource(source)\r\n\t\t\tfirestore.collection('users').doc(currentUser.uid).update({\r\n\t\t\t\tlastSongPlayed: playlistSongs[0].id,\r\n\t\t\t\tlastQueue: {\r\n\t\t\t\t\timage: source.image,\r\n\t\t\t\t\tname: source.name,\r\n\t\t\t\t\tsongsList: listSongsIds,\r\n\t\t\t\t\tsource: source.source\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t}, [playlistSongs.length])\r\n\r\n\treturn playChosenPlaylist\r\n}\r\n","import React, { useState } from \"react\";\r\nimport { BiAlbum } from \"react-icons/bi\";\r\nimport { FiCheck, FiPlayCircle, FiPlusCircle, FiShare } from \"react-icons/fi\";\r\nimport { Link, useHistory } from \"react-router-dom\";\r\nimport { Hint } from \"../../../../components/Basic/Hint\";\r\nimport { FriendsListToShareWith } from \"../../../../components/Lists/FriendsListToShareWith\";\r\nimport { useAuth } from \"../../../../contexts/AuthContext\";\r\nimport { useModal } from \"../../../../contexts/ModalContext\";\r\nimport { useAddOrDeleteSong } from \"../../../../hooks/useAddOrDeleteSong\";\r\nimport { usePlaylistSongs } from \"../../../../hooks/usePlaylistSongs\";\r\nimport getShortString from \"../../../../shared/lib/get-short-string\";\r\n\r\nexport const TinyPlaylist = ({ playlist }) => {\r\n  const { toggleModal, setContent } = useModal();\r\n  const [playlistSongs, setPlaylistSongs] = useState([]);\r\n  const playSongsInPlaylist = usePlaylistSongs(\r\n    playlist,\r\n    playlistSongs,\r\n    setPlaylistSongs\r\n  );\r\n  const [addFunc, isAdded] = useAddOrDeleteSong(playlist.id);\r\n  const { currentUser } = useAuth();\r\n  const history = useHistory();\r\n  return (\r\n    <div className=\"TinyPlaylist\">\r\n      <div className=\"TinyPlaylistBtns\">\r\n        {playlist.authors.find((author) => author.uid === currentUser.uid) ? (\r\n          <button onClick={addFunc}>\r\n            {isAdded ? (\r\n              <>\r\n                <Hint text={`remove song`} />\r\n                <FiCheck />\r\n              </>\r\n            ) : (\r\n              <>\r\n                <Hint text={\"add song\"} />\r\n                <FiPlusCircle />\r\n              </>\r\n            )}\r\n          </button>\r\n        ) : (\r\n          <button\r\n            onClick={() => {\r\n              toggleModal();\r\n              setContent(\r\n                <FriendsListToShareWith\r\n                  item={playlist}\r\n                  whatToShare={\"playlist\"}\r\n                />\r\n              );\r\n            }}\r\n          >\r\n            <Hint text={\"share\"} />\r\n            <FiShare />\r\n          </button>\r\n        )}\r\n        <Link to={`/albums/${playlist.id}`}>\r\n          <button>\r\n            <Hint text={\"album\"} />\r\n            <BiAlbum />\r\n          </button>\r\n        </Link>\r\n        <button onClick={playSongsInPlaylist}>\r\n          <Hint text={\"play\"} />\r\n          <FiPlayCircle />\r\n        </button>\r\n      </div>\r\n      <div\r\n        className=\"TinyPlaylistImg\"\r\n        style={{\r\n          backgroundImage: `url(${playlist.image})`,\r\n          display: \"inline-block\",\r\n          backgroundPosition: \"center center\",\r\n          backgroundSize: \"cover\",\r\n          position: \"relative\",\r\n        }}\r\n        onClick={() => history.push(`/albums/${playlist.id}`)}\r\n      >\r\n        {!playlist.image ? (\r\n          <BiAlbum\r\n            style={{\r\n              position: \"absolute\",\r\n              left: \"50%\",\r\n              top: \"50%\",\r\n              transform: \"translate(-50%, -50%)\",\r\n              width: \"20px\",\r\n              height: \"20px\",\r\n            }}\r\n          />\r\n        ) : null}\r\n      </div>\r\n      <div style={{ display: \"flex\", flexDirection: \"column\" }}>\r\n        <span>{getShortString(playlist.name, 13)}</span>\r\n        <span style={{ fontSize: \"0.8em\", color: \"grey\", fontWeight: \"500\" }}>\r\n          {playlist.isAlbum ? \"album\" : \"playlist\"}\r\n        </span>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { BiFolderPlus, BiFullscreen } from \"react-icons/bi\";\r\nimport { FiChevronDown, FiChevronUp } from \"react-icons/fi\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { NotificationCircle } from \"../../../../components/Basic/NotificationCircle\";\r\nimport { CreatePlaylistPage } from \"../../../../components/LibraryPage/CreatePlaylistPage\";\r\nimport { FriendsListToShareWith } from \"../../../../components/Lists/FriendsListToShareWith\";\r\nimport { useAuth } from \"../../../../contexts/AuthContext\";\r\nimport { useModal } from \"../../../../contexts/ModalContext\";\r\nimport { useSong } from \"../../../../contexts/SongContext\";\r\nimport normalizeString from \"../../../../functions/other/normalizeString\";\r\nimport Logo from \"../../../../images/Logo3.svg\";\r\nimport { leftSideBar } from \"../../../../shared/data/left-side-bar\";\r\nimport getShortString from \"../../../../shared/lib/get-short-string\";\r\nimport \"../../../../styles/LeftsideBar.css\";\r\nimport { Player } from \"../../../full-screen-player/ui/organisms/player\";\r\n\r\nimport LeftsideBarContainer from \"../atoms/container\";\r\nimport NavigationPanel from \"../molecules/navigation-panel\";\r\nimport { Person } from \"../molecules/Person\";\r\nimport { TinyPlaylist } from \"../molecules/TinyPlaylist\";\r\n\r\nexport const LeftsideBar = () => {\r\n  const { currentUser } = useAuth();\r\n  const [userNotifications, setUserNotifications] = useState(0);\r\n  const {\r\n    leftSideBarInputRef,\r\n    setOpenFullScreenPlayer,\r\n    currentSongData,\r\n    yourFriends,\r\n    yourPlaylists,\r\n  } = useSong();\r\n  const { toggleModal, setContent } = useModal();\r\n  const [currentFriendToPlaylistPage, setCurrentFriendToPlaylistPage] =\r\n    useState(0);\r\n  const [currentPage, setCurrentPage] = useState(() => {\r\n    let page = leftSideBar.find((el, i) => {\r\n      if (window.location.hash.includes(normalizeString(el.title))) {\r\n        return true;\r\n      }\r\n\r\n      return false;\r\n    });\r\n    return page === undefined ? -1 : page.id;\r\n  });\r\n\r\n  useEffect(() => {\r\n    setUserNotifications(\r\n      currentUser.friends.reduce((acc, friend) => {\r\n        if (friend.status === \"requested\") return acc + 1;\r\n        else return acc;\r\n      }, 0)\r\n    );\r\n  }, [JSON.stringify(currentUser.friends)]);\r\n\r\n  return (\r\n    <div className=\"LeftsideBar\">\r\n      <div className=\"logo\">\r\n        <img loading=\"lazy\" src={Logo} alt=\"\" />\r\n        <h3>Soundbubble</h3>\r\n      </div>\r\n      <LeftsideBarContainer onClick={() => setCurrentPage(-1)}>\r\n        <Link to={`/authors/${currentUser.uid}`}>\r\n          <div\r\n            className=\"person\"\r\n            style={currentPage === -1 ? { background: \"var(--blue)\" } : {}}\r\n          >\r\n            <NotificationCircle value={userNotifications} />\r\n            <div\r\n              className=\"personImg\"\r\n              style={{ backgroundImage: `url(${currentUser.photoURL})` }}\r\n            ></div>\r\n            <div className=\"personName\">\r\n              {getShortString(currentUser.displayName, 11)}\r\n            </div>\r\n          </div>\r\n        </Link>\r\n      </LeftsideBarContainer>\r\n      <NavigationPanel\r\n        currentPage={currentPage}\r\n        setCurrentPage={setCurrentPage}\r\n      />\r\n      <LeftsideBarContainer className=\"leftSideBarContainer friendsAndPlaylists\">\r\n        <span\r\n          style={{\r\n            display: !currentFriendToPlaylistPage ? \"block\" : \"none\",\r\n            animation: \"scrollFromBottom .2s forwards\",\r\n          }}\r\n        >\r\n          {yourFriends.length > 0 ? (\r\n            <>\r\n              {yourFriends.map((friend, index) => {\r\n                if (index <= 2) {\r\n                  return <Person index={friend.uid} friend={friend} />;\r\n                }\r\n                return null;\r\n              })}\r\n              <h4\r\n                className=\"seeMoreBtn\"\r\n                onClick={() => {\r\n                  toggleModal();\r\n                  setContent(\r\n                    <FriendsListToShareWith\r\n                      item={currentSongData}\r\n                      whatToShare={\"song\"}\r\n                    />\r\n                  );\r\n                }}\r\n              >\r\n                See more\r\n              </h4>\r\n            </>\r\n          ) : (\r\n            <h4\r\n              style={{\r\n                alignSelf: \"center\",\r\n                width: \"100%\",\r\n                display: \"flex\",\r\n                alignItems: \"center\",\r\n                justifyContent: \"center\",\r\n              }}\r\n            >\r\n              No friends added\r\n            </h4>\r\n          )}\r\n        </span>\r\n        <span\r\n          style={{\r\n            display: currentFriendToPlaylistPage ? \"block\" : \"none\",\r\n            animation: \"scrollFromTop .2s forwards\",\r\n          }}\r\n        >\r\n          {yourPlaylists.map((playlist, index) => {\r\n            if (index <= 2) {\r\n              return <TinyPlaylist playlist={playlist} key={playlist.id} />;\r\n            }\r\n          })}\r\n          <button\r\n            className=\"createPlaylistBtn\"\r\n            onClick={() => {\r\n              toggleModal();\r\n              setContent(<CreatePlaylistPage />);\r\n            }}\r\n            style={{ margin: \"5px 0\" }}\r\n          >\r\n            <BiFolderPlus />\r\n            Create Playlist\r\n          </button>\r\n        </span>\r\n        <div className=\"upAndDownBtns\">\r\n          <button\r\n            onClick={() => setCurrentFriendToPlaylistPage(0)}\r\n            style={!currentFriendToPlaylistPage ? { opacity: \"0.3\" } : {}}\r\n          >\r\n            <FiChevronUp />\r\n          </button>\r\n          <button\r\n            onClick={() => setCurrentFriendToPlaylistPage(1)}\r\n            style={currentFriendToPlaylistPage ? { opacity: \"0.3\" } : {}}\r\n          >\r\n            <FiChevronDown />\r\n          </button>\r\n        </div>\r\n      </LeftsideBarContainer>\r\n      <div className=\"leftSideBarContainer\">\r\n        {currentSongData.id === -1 ? null : (\r\n          <div className=\"littlePlayer\">\r\n            <Player textLimit={15} inputRef={leftSideBarInputRef} />\r\n            <div\r\n              className=\"fullScreenBtn\"\r\n              onClick={() => setOpenFullScreenPlayer(true)}\r\n            >\r\n              {/* <Hint text = {\"open full screen\"} style = {{fontSize:'0.8em'}}/> */}\r\n              <BiFullscreen />\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import { useEffect } from 'react';\r\nimport { useSong } from '../contexts/SongContext';\r\nimport displayAuthorsStr from '../functions/display/displayAuthorsStr';\r\n\r\n\r\nexport const useMediaMetadata = () => {\r\n\tconst { currentSongData, currentSongPlaylistSource, nextSong, prevSong, songRef, setPlay } = useSong()\r\n\r\n\tconst updatePositionState = () => {\r\n\t\tnavigator.mediaSession.setPositionState({\r\n\t\t\tduration: songRef.current.duration,\r\n\t\t\tplaybackRate: songRef.current.playbackRate,\r\n\t\t\tposition: songRef.current.currentTime\r\n\t\t});\r\n\t}\r\n\r\n\tfunction playSong() {\r\n\t\tsongRef.current.play()\r\n\t\tsetPlay(true)\r\n\t}\r\n\r\n\tfunction pauseSong() {\r\n\t\tsongRef.current.pause()\r\n\t\tsetPlay(false)\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tif ('mediaSession' in navigator && currentSongData.id !== -1) {\r\n\t\t\tnavigator.mediaSession.metadata = new window.MediaMetadata({\r\n\t\t\t\ttitle: currentSongData.name,\r\n\t\t\t\tartist: displayAuthorsStr(currentSongData.authors),\r\n\t\t\t\talbum: currentSongPlaylistSource.name,\r\n\t\t\t\tartwork: [\r\n\t\t\t\t\t{ src: currentSongData.cover, sizes: '512x512', type: 'image/png' },\r\n\t\t\t\t]\r\n\t\t\t});\r\n\r\n\t\t\tnavigator.mediaSession.setActionHandler('play', () => { playSong(); });\r\n\t\t\tnavigator.mediaSession.setActionHandler('pause', pauseSong);\r\n\t\t\tnavigator.mediaSession.setActionHandler('stop', pauseSong);\r\n\t\t\tnavigator.mediaSession.setActionHandler('nexttrack', () => { nextSong(); updatePositionState() });\r\n\t\t\tnavigator.mediaSession.setActionHandler('previoustrack', () => { prevSong(); updatePositionState() })\r\n\t\t}\r\n\t}, [currentSongData.id])\r\n}\r\n","import React from 'react'\r\n\r\nexport const MoreBtn = ({func, lenOfList, maxLen = 5, boolVal}) => {\r\n\treturn (\r\n\t\t<div onClick = {lenOfList > maxLen?func:null} className = \"MoreBtn\" style = {lenOfList <= maxLen?{display:'none'}:{}}>\r\n\t\t\t<button style = {boolVal?{background:'var(--pink)', color:'#ff8db2'}:{}}>\r\n\t\t\t\t{boolVal?\"Close\":\"More\"}\r\n\t\t\t</button>\r\n\t\t</div>\r\n\t)\r\n}\r\n","import React from \"react\";\r\nimport { MoreBtn } from \"../../../../components/Buttons/MoreBtn\";\r\n\r\nexport const TitleWithMoreBtn = ({\r\n  title,\r\n  func,\r\n  boolVal,\r\n  lenOfList,\r\n  maxLen = 5,\r\n  marginBottom = 0,\r\n}) => {\r\n  return lenOfList !== 0 ? (\r\n    <div className=\"topTitle\" style={{ margin: \"10px 0\" }}>\r\n      <h2 style={{ margin: marginBottom }}>{title}</h2>\r\n      <MoreBtn\r\n        func={func}\r\n        boolVal={boolVal}\r\n        lenOfList={lenOfList}\r\n        maxLen={maxLen}\r\n      />\r\n    </div>\r\n  ) : null;\r\n};\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { FaHistory } from \"react-icons/fa\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { useAuth } from \"../../contexts/AuthContext\";\r\nimport { useSong } from \"../../contexts/SongContext\";\r\nimport { SongItem } from \"../../features/song/ui/organisms/song-item\";\r\nimport { firestore } from \"../../firebase\";\r\nimport shuffleSongs from \"../../functions/other/shuffleSongs\";\r\nimport { HISTORY_ROUTE } from \"../../utils/route-consts\";\r\nimport SearchBar from \"../../shared/ui/organisms/search-bar\";\r\nimport { TitleWithMoreBtn } from \"../../pages/settings/ui/molecules/title-with-more-btn\";\r\n\r\nexport const SongList = ({\r\n  listOfSongs,\r\n  source,\r\n  title = \"\",\r\n  showListens = false,\r\n  isNewSong = false,\r\n  showCount = false,\r\n  listOfChosenSongs,\r\n  setListOfSongs,\r\n  showSearch = false,\r\n  displayIfEmpty,\r\n  showhistory = false,\r\n  saveSearchHistory = false,\r\n  isHorizontal = false,\r\n}) => {\r\n  const {\r\n    setCurrentSongQueue,\r\n    setCurrentSongPlaylistSource,\r\n    playSong,\r\n    setCurrentSong,\r\n  } = useSong();\r\n  const { currentUser } = useAuth();\r\n  const [showMoreSongs, setShowMoreSongs] = useState(false);\r\n  const [localSearchValue, setLocalSearchValue] = useState(\"\");\r\n  const [displaySongs, setDisplaySongs] = useState(listOfSongs);\r\n\r\n  useEffect(() => {\r\n    setDisplaySongs(listOfSongs);\r\n  }, [listOfSongs]);\r\n\r\n  function setQueueInSongList() {\r\n    if (source !== \"no\" && listOfSongs.length !== 0) {\r\n      setCurrentSongQueue(listOfSongs);\r\n      setCurrentSongPlaylistSource(source);\r\n      const listSongsIds = listOfSongs.map((song) => song.id);\r\n      firestore\r\n        .collection(\"users\")\r\n        .doc(currentUser.uid)\r\n        .update({\r\n          lastQueue: {\r\n            image: source.image,\r\n            name: source.name,\r\n            songsList: listSongsIds,\r\n            source: source.source,\r\n          },\r\n        });\r\n    }\r\n  }\r\n\r\n  function playShuffledList(e) {\r\n    e.stopPropagation();\r\n    let newList = shuffleSongs(listOfSongs);\r\n    setCurrentSongQueue(newList);\r\n    setCurrentSongPlaylistSource(source);\r\n    const listSongsIds = newList.map((song) => song.id);\r\n    firestore\r\n      .collection(\"users\")\r\n      .doc(currentUser.uid)\r\n      .update({\r\n        lastQueue: {\r\n          image: source.image,\r\n          name: source.name,\r\n          songsList: listSongsIds,\r\n          source: source.source,\r\n        },\r\n      });\r\n    setCurrentSong(newList[0].id);\r\n    playSong();\r\n  }\r\n\r\n  return (\r\n    <div className=\"SongList\" onClick={setQueueInSongList}>\r\n      {title.length !== 0 ? (\r\n        <TitleWithMoreBtn\r\n          title={title}\r\n          func={() => setShowMoreSongs(!showMoreSongs)}\r\n          boolVal={showMoreSongs}\r\n          lenOfList={listOfSongs.length}\r\n        />\r\n      ) : null}\r\n      {showSearch ? (\r\n        <div style={{ display: \"flex\", alignItems: \"center\" }}>\r\n          <SearchBar\r\n            value={localSearchValue}\r\n            setValue={setLocalSearchValue}\r\n            allFoundSongs={displaySongs}\r\n            setAllFoundSongs={setDisplaySongs}\r\n            defaultSearchMode={\"songs\"}\r\n            defaultSongsListValue={listOfSongs}\r\n            inputText={\"Search for songs\"}\r\n            background={\"#00000061\"}\r\n          />\r\n          {showhistory ? (\r\n            <Link to={HISTORY_ROUTE}>\r\n              <button\r\n                className=\"standartButton\"\r\n                style={{\r\n                  marginTop: \"10px\",\r\n                  marginBottom: \"0\",\r\n                  height: \"44px\",\r\n                  width: \"44px\",\r\n                  padding: \"0\",\r\n                  marginLeft: \"6px\",\r\n                  background: \"var(--playlistsColor)\",\r\n                }}\r\n              >\r\n                <FaHistory style={{ marginRight: \"0\" }} />\r\n              </button>\r\n            </Link>\r\n          ) : null}\r\n        </div>\r\n      ) : null}\r\n\r\n      <div className={\"list-of-songs\" + (isHorizontal ? \" horizontal\" : \"\")}>\r\n        {displaySongs.map((song, index) => {\r\n          if (title.length !== 0) {\r\n            if (showMoreSongs) {\r\n              return (\r\n                <span className=\"topSongItem\">\r\n                  {showCount ? (\r\n                    <h3 style={{ opacity: \"0.7\" }}>{index + 1}</h3>\r\n                  ) : null}\r\n                  <SongItem\r\n                    song={song}\r\n                    key={song.id}\r\n                    localIndex={index}\r\n                    showListens={showListens}\r\n                    isNewSong={isNewSong}\r\n                    listOfChosenSongs={listOfChosenSongs}\r\n                    setListOfSongs={setListOfSongs}\r\n                    shouldSaveSearchHistory={saveSearchHistory}\r\n                  />\r\n                </span>\r\n              );\r\n            } else {\r\n              if (index < 5) {\r\n                return (\r\n                  <span className=\"topSongItem\">\r\n                    {showCount ? (\r\n                      <h3 style={{ opacity: \"0.7\" }}>{index + 1}</h3>\r\n                    ) : null}\r\n                    <SongItem\r\n                      song={song}\r\n                      key={song.id}\r\n                      localIndex={index}\r\n                      showListens={showListens}\r\n                      isNewSong={isNewSong}\r\n                      listOfChosenSongs={listOfChosenSongs}\r\n                      setListOfSongs={setListOfSongs}\r\n                      shouldSaveSearchHistory={saveSearchHistory}\r\n                    />\r\n                  </span>\r\n                );\r\n              }\r\n            }\r\n          } else {\r\n            return (\r\n              <span className=\"topSongItem\">\r\n                {showCount ? (\r\n                  <h3 style={{ opacity: \"0.7\" }}>{index + 1}</h3>\r\n                ) : null}\r\n                <SongItem\r\n                  song={song}\r\n                  key={song.id}\r\n                  localIndex={index}\r\n                  showListens={showListens}\r\n                  isNewSong={isNewSong}\r\n                  listOfChosenSongs={listOfChosenSongs}\r\n                  setListOfSongs={setListOfSongs}\r\n                  shouldSaveSearchHistory={saveSearchHistory}\r\n                />\r\n              </span>\r\n            );\r\n          }\r\n        })}\r\n      </div>\r\n      <div style={{ display: \"flex\", justifyContent: \"center\" }}>\r\n        {listOfSongs.length === 0 ? displayIfEmpty : null}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { ColorExtractor } from \"react-color-extractor\";\r\nimport { FiXCircle } from \"react-icons/fi\";\r\nimport { PersonTiny } from \"../../../../components/Basic/PersonTiny\";\r\nimport { SongList } from \"../../../../components/Lists/SongList\";\r\nimport { LoadingCircle } from \"../../../../components/Loading/LoadingCircle\";\r\nimport { RadioBtn } from \"../../../../components/SignIn-Up/RadioBtn\";\r\nimport { useAuth } from \"../../../../contexts/AuthContext\";\r\nimport { firestore } from \"../../../../firebase\";\r\nimport getUID from \"../../../../functions/other/getUID\";\r\nimport DownloadButton from \"../../../../shared/ui/atoms/download-button\";\r\nimport Input from \"../../../../shared/ui/atoms/input\";\r\nimport SubmitButton from \"../../../../shared/ui/atoms/submit-button\";\r\nimport SearchBar from \"../../../../shared/ui/organisms/search-bar\";\r\nexport const CustomizeAlbum = ({ playlist }) => {\r\n  const { currentUser } = useAuth();\r\n  const [playlistName, setPlaylistName] = useState(playlist.name);\r\n  const [playlistCover, setPlaylistCover] = useState(playlist.image);\r\n  const [authorsInputValue, setAuthorsInputValue] = useState(\"\");\r\n  const [allAuthors, setAllAuthors] = useState([]);\r\n  const [chosenAuthors, setChosenAuthors] = useState(playlist.authors);\r\n  const [releaseDate, setReleaseDate] = useState(playlist.creationDate);\r\n  const [songsSearch, setSongsSearch] = useState(\"\");\r\n  const [allSongs, setAllSongs] = useState([]);\r\n  const [chosenSongs, setChosenSongs] = useState(playlist.songs);\r\n  const [playlistStatus, setPlaylistStatus] = useState(\r\n    playlist.isAlbum ? 1 : 0\r\n  );\r\n  const [isPlaylistPrivate, setIsPlaylistPrivate] = useState(\r\n    playlist.isPrivate ? 1 : 0\r\n  );\r\n  const [loadingAuthors, setLoadingAuthors] = useState(false);\r\n  const [loadingSongs, setLoadingSongs] = useState(false);\r\n  const [imageLocalPath, setImageLocalPath] = useState(\"\");\r\n  const [imageColors, setImageColors] = useState(playlist.imageColors);\r\n  const [loading, setLoading] = useState(false);\r\n  const [completed, setCompleted] = useState(false);\r\n\r\n  useEffect(() => {\r\n    setPlaylistName(playlist.name);\r\n    setPlaylistCover(playlist.image);\r\n    setChosenAuthors(playlist.authors);\r\n  }, [playlist.id]);\r\n\r\n  useEffect(() => {\r\n    if (songsSearch.length === 0) {\r\n      playlist.songs.map(async (songId) => {\r\n        const songData = (\r\n          await firestore.collection(\"songs\").doc(songId).get()\r\n        ).data();\r\n        setLoadingSongs(false);\r\n        setAllSongs((prev) => [...prev, songData]);\r\n      });\r\n    }\r\n  }, [songsSearch]);\r\n\r\n  function removeAuthorFromList(data) {\r\n    const filtered = chosenAuthors.filter((people) => people.uid !== data.uid);\r\n    return setChosenAuthors(filtered);\r\n  }\r\n\r\n  function addAuthor(data) {\r\n    if (!chosenAuthors.some((person) => person.uid === data.uid)) {\r\n      return setChosenAuthors((prev) => [\r\n        ...prev,\r\n        {\r\n          uid: data.uid,\r\n          displayName: data.displayName,\r\n          photoURL: data.photoURL,\r\n        },\r\n      ]);\r\n    }\r\n\r\n    removeAuthorFromList(data);\r\n  }\r\n\r\n  async function addPlaylistToFirebase(e) {\r\n    e.preventDefault();\r\n    const uid = getUID();\r\n    if (chosenAuthors.length > playlist.authors.length) {\r\n      const newAuthors = chosenAuthors.filter((author) => {\r\n        return !playlist.authors.find((a) => a.uid === author.uid);\r\n      });\r\n      newAuthors.forEach(async (author) => {\r\n        const authorRef = await firestore\r\n          .collection(\"users\")\r\n          .doc(author.uid)\r\n          .get();\r\n        const authorData = authorRef.data();\r\n        const authorPlaylists = authorData.ownPlaylists;\r\n        authorPlaylists.push(playlist.id);\r\n        firestore.collection(\"users\").doc(author.uid).update({\r\n          ownPlaylists: authorPlaylists,\r\n        });\r\n      });\r\n    } else if (chosenAuthors.length < playlist.authors.length) {\r\n      const newAuthors = playlist.authors.filter((author) => {\r\n        return !chosenAuthors.find((a) => a.uid === author.uid);\r\n      });\r\n      newAuthors.forEach(async (author) => {\r\n        const authorRef = await firestore\r\n          .collection(\"users\")\r\n          .doc(author.uid)\r\n          .get();\r\n        const authorData = authorRef.data();\r\n        const authorPlaylists = authorData.ownPlaylists;\r\n        const filteredPlaylists = authorPlaylists.filter(\r\n          (playlistId) => playlistId !== playlist.id\r\n        );\r\n        firestore.collection(\"users\").doc(author.uid).update({\r\n          ownPlaylists: filteredPlaylists,\r\n        });\r\n      });\r\n    }\r\n\r\n    firestore\r\n      .collection(\"playlists\")\r\n      .doc(playlist.id)\r\n      .update({\r\n        id: playlist.id,\r\n        name: playlistName,\r\n        songs: chosenSongs,\r\n        authors: chosenAuthors,\r\n        image: playlistCover,\r\n        listens: playlist.listens,\r\n        creationDate: releaseDate,\r\n        subscribers: playlist.subscribers,\r\n        isAlbum: playlistStatus === 1,\r\n        imageColors: imageColors,\r\n        isPrivate: isPlaylistPrivate === 1,\r\n      })\r\n      .then(() => {\r\n        setLoading(false);\r\n        setCompleted(true);\r\n      });\r\n  }\r\n\r\n  return (\r\n    <div className=\"AddSong\">\r\n      <ColorExtractor\r\n        src={imageLocalPath}\r\n        getColors={(colors) => setImageColors(colors)}\r\n      />\r\n      <Input\r\n        title={\"Playlist name\"}\r\n        value={playlistName}\r\n        setValue={setPlaylistName}\r\n        placeholder=\"Enter playlist name\"\r\n      />\r\n      <label>\r\n        <h3>Playlist authors</h3>\r\n        <SearchBar\r\n          value={authorsInputValue}\r\n          setValue={setAuthorsInputValue}\r\n          setResultAuthorList={setAllAuthors}\r\n          defaultSearchMode={\"authors\"}\r\n          inputText={\"Search for authors\"}\r\n        />\r\n        <div className=\"chosenAuthorsList\">\r\n          {chosenAuthors.map((author) => {\r\n            return (\r\n              <div className=\"chosenAuthorItem\">\r\n                <span>{author.displayName}</span>\r\n                <FiXCircle\r\n                  onClick={() =>\r\n                    author.uid === currentUser.uid\r\n                      ? null\r\n                      : removeAuthorFromList(author)\r\n                  }\r\n                />\r\n              </div>\r\n            );\r\n          })}\r\n        </div>\r\n        <div className=\"authorsResult\">\r\n          {loadingAuthors ? (\r\n            <div\r\n              style={{ position: \"relative\", width: \"100%\", height: \"50px\" }}\r\n            >\r\n              <LoadingCircle />\r\n            </div>\r\n          ) : (\r\n            allAuthors.map((data, index) => {\r\n              return (\r\n                <PersonTiny\r\n                  data={data}\r\n                  onClick={() => addAuthor(data)}\r\n                  style={\r\n                    chosenAuthors.includes(data.uid)\r\n                      ? { background: \"var(--green)\" }\r\n                      : {}\r\n                  }\r\n                  key={index}\r\n                />\r\n              );\r\n            })\r\n          )}\r\n        </div>\r\n      </label>\r\n\r\n      <label>\r\n        <h3>Search for songs</h3>\r\n        <SearchBar\r\n          value={songsSearch}\r\n          setValue={setSongsSearch}\r\n          setAllFoundSongs={setAllSongs}\r\n          defaultSearchMode={\"songs\"}\r\n          inputText={\"Search for songs\"}\r\n        />\r\n        {/* <div className=\"chosenAuthorsList\">\r\n            {chosenSongs.map((songId) => {\r\n              return (\r\n                <div className=\"chosenAuthorItem\">\r\n                  <span>{songId}</span>\r\n                  <FiXCircle onClick={() => removeSongFromList(songId)} />\r\n                </div>\r\n              );\r\n            })}\r\n          </div> */}\r\n        <div className=\"authorsResult\">\r\n          {loadingSongs ? (\r\n            <div\r\n              style={{ position: \"relative\", width: \"100%\", height: \"50px\" }}\r\n            >\r\n              <LoadingCircle />\r\n            </div>\r\n          ) : (\r\n            <SongList\r\n              listOfSongs={allSongs}\r\n              source={\"no\"}\r\n              listOfChosenSongs={chosenSongs}\r\n              setListOfSongs={setChosenSongs}\r\n            />\r\n          )}\r\n        </div>\r\n      </label>\r\n\r\n      {currentUser.isAdmin || currentUser.isAuthor ? (\r\n        <div\r\n          style={{\r\n            display: \"flex\",\r\n            justifyContent: \"flex-start\",\r\n            margin: \"15px 0\",\r\n          }}\r\n        >\r\n          <RadioBtn\r\n            label=\"Playlist\"\r\n            onClick={() => setPlaylistStatus(0)}\r\n            currentActive={playlistStatus}\r\n            id={0}\r\n          />\r\n          <RadioBtn\r\n            label=\"Album\"\r\n            onClick={() => setPlaylistStatus(1)}\r\n            currentActive={playlistStatus}\r\n            id={1}\r\n          />\r\n        </div>\r\n      ) : null}\r\n\r\n      <div\r\n        style={{\r\n          display: \"flex\",\r\n          justifyContent: \"flex-start\",\r\n          margin: \"15px 0\",\r\n        }}\r\n      >\r\n        <RadioBtn\r\n          label=\"Not Private\"\r\n          onClick={() => setIsPlaylistPrivate(0)}\r\n          currentActive={isPlaylistPrivate}\r\n          id={0}\r\n        />\r\n        <RadioBtn\r\n          label=\"Private\"\r\n          onClick={() => setIsPlaylistPrivate(1)}\r\n          currentActive={isPlaylistPrivate}\r\n          id={1}\r\n        />\r\n      </div>\r\n\r\n      {(currentUser.isAdmin || currentUser.isAuthor) && (\r\n        <Input\r\n          title={\"Release Date\"}\r\n          type={\"date\"}\r\n          value={releaseDate}\r\n          setValue={setReleaseDate}\r\n          placeholder={\"Enter release date\"}\r\n        />\r\n      )}\r\n\r\n      <DownloadButton\r\n        text=\"Download playlist cover\"\r\n        place={\"songsImages/\"}\r\n        setItemSrc={setPlaylistCover}\r\n        setImageLocalPath={setImageLocalPath}\r\n      />\r\n\r\n      <SubmitButton\r\n        text={\"Update playlist\"}\r\n        action={addPlaylistToFirebase}\r\n        isLoading={loading}\r\n        completed={completed}\r\n        setCompleted={setCompleted}\r\n        bottomMessage={\"Playlist was updated\"}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n","import { firestore } from \"../../../firebase\"\r\n\r\nexport const addAuthorToLibrary = async (authorData, currentUser) => {\r\n\tconst addedAuthors = (await firestore.collection('users').doc(currentUser.uid).get()).data().addedAuthors\r\n\taddedAuthors.push(authorData.uid)\r\n\tfirestore.collection('users').doc(currentUser.uid).update({\r\n\t\taddedAuthors: addedAuthors\r\n\t})\r\n\tlet subscribers = authorData.subscribers\r\n\tsubscribers++\r\n\tfirestore.collection('users').doc(authorData.uid).update({\r\n\t\tsubscribers: subscribers\r\n\t})\r\n}","import { firestore } from \"../../../firebase\"\r\n\r\nexport default function addFriend(friendData, currentUser) {\r\n\tconst updatedDataForFriend = friendData.friends\r\n\tconst updatedDataForCurrentUser = currentUser.friends\r\n\tupdatedDataForFriend.push({ status: 'requested', uid: currentUser.uid })\r\n\tupdatedDataForCurrentUser.push({ status: 'awaiting', uid: friendData.uid })\r\n\r\n\tfirestore.collection('users').doc(friendData.uid).update({\r\n\t\tfriends: updatedDataForFriend\r\n\t})\r\n\r\n\tfirestore.collection('users').doc(currentUser.uid).update({\r\n\t\tfriends: updatedDataForCurrentUser\r\n\t})\r\n\r\n}","const deleteAuthorFromLibrary = (authorData, currentUser) => {\r\n\r\n}\r\n\r\nexport default deleteAuthorFromLibrary","import React, { useEffect, useState } from \"react\";\r\nimport { FiMessageCircle } from \"react-icons/fi\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { useAuth } from \"../../../../contexts/AuthContext\";\r\nimport { createChat } from \"../../../../shared/lib/create-—Åhat\";\r\nimport { findChatURL } from \"../../../../shared/lib/find-chat-url\";\r\n\r\nexport const ChatWithFriendButton = ({ data, color }) => {\r\n  const { currentUser } = useAuth();\r\n  const [shouldCreate, setShouldCreate] = useState(false);\r\n  const [friendChatId, setFriendChatId] = useState(0);\r\n\r\n  useEffect(() => {\r\n    findChatURL([data.uid], currentUser, setShouldCreate, setFriendChatId);\r\n  }, [data.uid]);\r\n\r\n  return (\r\n    <Link\r\n      to={`/chat/${friendChatId}`}\r\n      style={{ display: \"block\", width: \"fit-content\", textDecoration: \"none\" }}\r\n    >\r\n      <button\r\n        onClick={() => {\r\n          if (shouldCreate)\r\n            createChat([currentUser.uid, data.uid], friendChatId);\r\n        }}\r\n        style={{ background: color }}\r\n        className=\"ChatWithFriendButton\"\r\n      >\r\n        <FiMessageCircle /> Messages\r\n      </button>\r\n    </Link>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport { IoPlayCircleOutline } from \"react-icons/io5\";\r\nimport useLastSongListened from \"../../lib/hooks/use-last-song-listened\";\r\nexport const LastSongListened = ({ data, loading }) => {\r\n  const [songData, chooseSongItem] = useLastSongListened(data, loading);\r\n  return songData !== undefined ? (\r\n    <div className=\"LastSongListened\" onClick={chooseSongItem}>\r\n      <IoPlayCircleOutline />\r\n      <span>{songData.name}</span>\r\n    </div>\r\n  ) : null;\r\n};\r\n","import React, { useState } from \"react\";\r\nimport { ColorExtractor } from \"react-color-extractor\";\r\nimport { MdModeEdit } from \"react-icons/md\";\r\nimport { firestore, storage } from \"../../../../firebase\";\r\nexport const CustomizeAuthor = ({ author }) => {\r\n  const [authorName, setPlaylistName] = useState(author.displayName);\r\n  const [authorCover, setAuthorCover] = useState(author.photoURL);\r\n  const [imageLocalPath, setImageLocalPath] = useState(\"\");\r\n  const [imageColors, setImageColors] = useState(author.imageColors);\r\n\r\n  async function onFileChange(e, place, setFunc) {\r\n    const file = e.target.files[0];\r\n    setImageLocalPath(URL.createObjectURL(file));\r\n    const storageRef = storage.ref();\r\n    const fileRef = storageRef.child(place + file.name);\r\n    await fileRef.put(file);\r\n    setFunc(await fileRef.getDownloadURL());\r\n  }\r\n\r\n  function updateAuthorInFirebase(e) {\r\n    e.preventDefault();\r\n    firestore.collection(\"users\").doc(author.uid).update({\r\n      displayName: authorName,\r\n      photoURL: authorCover,\r\n      imageColors: imageColors,\r\n    });\r\n  }\r\n\r\n  return (\r\n    <div className=\"AddSong\">\r\n      <ColorExtractor\r\n        src={imageLocalPath}\r\n        getColors={(colors) => setImageColors(colors)}\r\n      />\r\n      <form onSubmit={(e) => e.preventDefault()}>\r\n        <div\r\n          style={{ width: \"100%\", display: \"flex\", justifyContent: \"center\" }}\r\n        >\r\n          <div\r\n            className=\"chatInfoImage\"\r\n            style={{ backgroundImage: `url(${authorCover})` }}\r\n          >\r\n            <label className=\"changePhoto\">\r\n              <MdModeEdit />\r\n              Change photo\r\n              <input\r\n                type=\"file\"\r\n                style={{ display: \"none\" }}\r\n                onChange={(e) => onFileChange(e, \"chatCovers/\", setAuthorCover)}\r\n              />\r\n            </label>\r\n          </div>\r\n        </div>\r\n        <label>\r\n          <h3>Your name</h3>\r\n          <input\r\n            type=\"text\"\r\n            placeholder=\"Enter your name\"\r\n            value={authorName}\r\n            onChange={(e) => setPlaylistName(e.target.value)}\r\n            required\r\n          />\r\n        </label>\r\n        <button\r\n          type=\"button\"\r\n          className=\"addSongBtn\"\r\n          onClick={updateAuthorInFirebase}\r\n        >\r\n          Update author\r\n        </button>\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n","import { firestore } from \"../../firebase\"\r\n\r\nexport const  addPlaylistToLibrary = async(playlistData, currentUser) => {\r\n\tconst addedPlaylists = (await firestore.collection('users').doc(currentUser.uid).get()).data().addedPlaylists\r\n\taddedPlaylists.push(playlistData.id)\r\n\tfirestore.collection('users').doc(currentUser.uid).update({\r\n\t\taddedPlaylists: addedPlaylists\r\n\t})\r\n\r\n\tfirestore.collection('playlists').doc(playlistData.id).update({\r\n\t\tsubscribers:++playlistData.subscribers\r\n\t})\r\n}","import { firestore } from \"../../firebase\"\r\n\r\nexport const removePlaylistFromLibrary = async (playlistData, currentUser) =>{\r\n\tconst filteredPlaylists = currentUser.addedPlaylists.filter(id=>id !== playlistData.id)\r\n\tfirestore.collection('users').doc(currentUser.uid).update({\r\n\t\taddedPlaylists:filteredPlaylists\r\n\t})\r\n\tfirestore.collection('playlists').doc(playlistData.id).update({\r\n\t\tsubscribers:--playlistData.subscribers\r\n\t})\r\n}","import React, { useEffect, useState } from 'react'\r\nimport { firestore } from '../firebase'\r\n\r\nexport const useAlbumAuthors = (data) => {\r\n\tconst [albumAuthors, setAlbumAuthors] = useState([])\r\n\tconst [authorsImages, setAuthorsImages] = useState([])\r\n\tasync function fetchAuthorsData() {\r\n\t\tif (data?.authors !== undefined) {\r\n\t\t\tconst ids = data.authors.map(author => author.uid)\r\n\t\t\tconst authrorsData = await firestore.collection(\"users\").where(\"uid\", \"in\", ids).get()\r\n\t\t\tconst tempArrayAuthors = []\r\n\t\t\tconst tempArrayImages = []\r\n\t\t\tauthrorsData.docs.forEach((a) => {\r\n\t\t\t\ttempArrayAuthors.push(a.data())\r\n\t\t\t\ttempArrayImages.push(a.data().photoURL)\r\n\t\t\t})\r\n\t\t\tsetAlbumAuthors(tempArrayAuthors)\r\n\t\t\tsetAuthorsImages(tempArrayImages)\r\n\t\t}\r\n\t}\r\n\tuseEffect(() => {\r\n\t\tfetchAuthorsData()\r\n\t}, [data?.id])\r\n\r\n\treturn [albumAuthors, authorsImages]\r\n}\r\n","import React from \"react\";\r\nimport { FiArrowLeft } from \"react-icons/fi\";\r\nimport { useHistory } from \"react-router\";\r\nimport { Hint } from \"../../../components/Basic/Hint\";\r\nexport const GoBackBtn = ({ color = \"\" }) => {\r\n  const history = useHistory();\r\n  return (\r\n    <div className=\"GoBackBtn\">\r\n      <button\r\n        onClick={() => history.goBack()}\r\n        style={color.length ? { color: color } : {}}\r\n      >\r\n        <Hint text={\"go back\"} direction={\"bottom\"} />\r\n        <FiArrowLeft />\r\n      </button>\r\n    </div>\r\n  );\r\n};\r\n","import React, { useEffect, useState } from 'react'\r\nimport { useSong } from '../../contexts/SongContext'\r\nimport displayDate from '../../functions/display/displayDate'\r\nimport { PersonTinyVerticalItem } from '../AuthorPage/PersonTinyVerticalItem'\r\nimport { useModal } from '../../contexts/ModalContext'\r\nimport { FriendsListToShareWith } from '../Lists/FriendsListToShareWith'\r\nimport { LoadingCircle } from '../Loading/LoadingCircle'\r\nimport { FiHeadphones, FiUserPlus } from 'react-icons/fi'\r\nimport { ImCheckmark } from 'react-icons/im'\r\nimport { SeeMoreRoundButton } from '../Buttons/SeeMoreRoundButton'\r\nimport { TinyPersonsList } from '../Lists/TinyPersonsList'\r\nexport const AlbumInfo = ({ album }) => {\r\n\tconst { setContent } = useModal()\r\n\tconst { yourFriends } = useSong()\r\n\tconst [friendsThatHaveThisAlbum, setFriendsThatHaveThisAlbum] = useState([])\r\n\tconst [loading, setLoading] = useState(true)\r\n\tasync function findFriendsThatHaveThisAlbum() {\r\n\t\tsetLoading(true)\r\n\t\tsetFriendsThatHaveThisAlbum([])\r\n\t\tyourFriends.forEach(friend => {\r\n\t\t\tif (friend.addedPlaylists.includes(album.id)) setFriendsThatHaveThisAlbum(prev => [...prev, friend])\r\n\t\t})\r\n\t\tsetLoading(false)\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tfindFriendsThatHaveThisAlbum()\r\n\t}, [album.uid])\r\n\r\n\treturn (\r\n\t\t<div className='SongInfo'>\r\n\t\t\t<div className=\"songImage\" style={{ backgroundImage: `url(${album.image})` }}></div>\r\n\t\t\t<div className=\"songInfoContent\">\r\n\t\t\t\t<div style={{ display: 'flex', flexDirection: 'column' }}>\r\n\t\t\t\t\t<span style={{ opacity: \".5\", fontWeight: 500, fontSize: '.7em' }}>{album.isAlbum ? \"Album\" : \"Playlist\"}</span>\r\n\t\t\t\t\t<h3 style={{ color: album.imageColors[1] }}>{album.name}</h3>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div style={{ display: 'flex', opacity: '0.6', fontSize: '.9em', position: \"relative\" }} className=\"listensAndDate\">\r\n\t\t\t\t\t<p className=\"infoListens\" style={{ marginRight: '20px', position: 'relative' }}>{album.listens}<FiHeadphones /></p>\r\n\t\t\t\t\t<p className=\"infoListens\" style={{ marginRight: '20px', position: 'relative' }}>{album.subscribers} <FiUserPlus /></p>\r\n\t\t\t\t\t<span>{displayDate(album.creationDate)}</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t<h4 style={{ margin: '10px 0' }}>{friendsThatHaveThisAlbum.length > 0 ? 'Friends subscribed' : 'None of your friends subscribed'}</h4>\r\n\t\t\t\t{!loading ? <div style={{ display: 'flex' }}>\r\n\t\t\t\t\t{friendsThatHaveThisAlbum.length > 0 ?\r\n\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t{friendsThatHaveThisAlbum.map((person, index) => {\r\n\t\t\t\t\t\t\t\tif (index < 2) return <PersonTinyVerticalItem person={person} key={person.uid} />\r\n\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t{friendsThatHaveThisAlbum.length > 2 ? <SeeMoreRoundButton onClick={() => setContent(<TinyPersonsList listOfPeople={friendsThatHaveThisAlbum} title={`Friends subscribed to ${album.name}`} />)} /> : null}\r\n\t\t\t\t\t\t</> :\r\n\t\t\t\t\t\t<button className=\"shareBtn\" style={{ minHeight: '35px', background: album.imageColors[0] }} onClick={() => { setContent(<FriendsListToShareWith item={album} whatToShare={'playlist'} />) }}>Share</button>}\r\n\t\t\t\t</div> :\r\n\t\t\t\t\t<div style={{ position: 'relative', height: '50px' }}><LoadingCircle top={\"50%\"} /></div>}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\n","import React, { useEffect, useState } from 'react'\r\nimport { useSong } from '../../contexts/SongContext'\r\nimport displayDate from '../../functions/display/displayDate'\r\nimport { PersonTinyVerticalItem } from '../AuthorPage/PersonTinyVerticalItem'\r\nimport { useModal } from '../../contexts/ModalContext'\r\nimport { FriendsListToShareWith } from '../Lists/FriendsListToShareWith'\r\nimport { LoadingCircle } from '../Loading/LoadingCircle'\r\nimport { FiHeadphones, FiUserPlus } from 'react-icons/fi'\r\nimport { ImCheckmark } from 'react-icons/im'\r\nimport { SeeMoreRoundButton } from '../Buttons/SeeMoreRoundButton'\r\nimport { TinyPersonsList } from '../Lists/TinyPersonsList'\r\nexport const AuthorInfo = ({ author }) => {\r\n\tconst { setContent } = useModal()\r\n\tconst { yourFriends } = useSong()\r\n\tconst [friendsThatHaveThisSong, setFriendsThatHaveThisAuthor] = useState([])\r\n\tconst [loading, setLoading] = useState(true)\r\n\tasync function findFriendsThatHaveThisAuthor() {\r\n\t\tsetLoading(true)\r\n\t\tsetFriendsThatHaveThisAuthor([])\r\n\t\tyourFriends.forEach(friend => {\r\n\t\t\tif (author.isAuthor) {\r\n\t\t\t\tif (friend.addedAuthors.includes(author.uid)) setFriendsThatHaveThisAuthor(prev => [...prev, friend])\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tif (friend.friends.find(person=>person.uid === author.uid)) setFriendsThatHaveThisAuthor(prev => [...prev, friend])\r\n\t\t\t}\r\n\r\n\t\t})\r\n\t\tsetLoading(false)\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tfindFriendsThatHaveThisAuthor()\r\n\t}, [author.uid])\r\n\r\n\treturn (\r\n\t\t<div className='SongInfo'>\r\n\t\t\t<div className=\"songImage\" style={{ backgroundImage: `url(${author.photoURL})` }}></div>\r\n\t\t\t<div className=\"songInfoContent\">\r\n\t\t\t\t<div style={{ display: 'flex', flexDirection: 'column-reverse' }}>\r\n\t\t\t\t\t<h3 style={{ color: author.imageColors[1] }}>{author.displayName}{author.isVerified ? <ImCheckmark style={{ color: author.imageColors[0], width: '15px', height: \"15px\", marginLeft: '5px' }} /> : null}</h3>\r\n\t\t\t\t\t<span style={{ opacity: \".5\", fontWeight: 500, fontSize: '.7em' }}>{author.isAuthor ? \"Author\" : \"User\"}</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div style={{ display: 'flex', opacity: '0.6', fontSize: '.9em', position: \"relative\" }} className=\"listensAndDate\">\r\n\t\t\t\t\t<p className=\"infoListens\" style={{ marginRight: '20px', position: 'relative' }}>{author.numberOfListenersPerMonth}<FiHeadphones /></p>\r\n\t\t\t\t\t<p className=\"infoListens\" style={{ marginRight: '20px', position: 'relative' }}>{author.subscribers} <FiUserPlus /></p>\r\n\t\t\t\t\t<span>{displayDate(author.regDate)}</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t<h4 style={{ margin: '10px 0' }}>{friendsThatHaveThisSong.length > 0 ? 'Friends subscribed' : 'None of your friends subscribed'}</h4>\r\n\t\t\t\t{!loading ? <div style={{ display: 'flex' }}>\r\n\t\t\t\t\t{friendsThatHaveThisSong.length > 0 ?\r\n\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t{friendsThatHaveThisSong.map((person, index) => {\r\n\t\t\t\t\t\t\t\tif (index < 2) return <PersonTinyVerticalItem person={person} key={person.uid} />\r\n\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t{friendsThatHaveThisSong.length > 2 ? <SeeMoreRoundButton onClick={() => setContent(<TinyPersonsList listOfPeople={friendsThatHaveThisSong} title={`Friends subscribed to ${author.displayName}`} />)} /> : null}\r\n\t\t\t\t\t\t</> :\r\n\t\t\t\t\t\t<button className=\"shareBtn\" style={{ minHeight: '35px', background: author.imageColors[0] }} onClick={() => { setContent(<FriendsListToShareWith item={author} whatToShare={'author'} />) }}>Share</button>}\r\n\t\t\t\t</div> :\r\n\t\t\t\t\t<div style={{ position: 'relative', height: '50px' }}><LoadingCircle top={\"50%\"} /></div>}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t)\r\n}\r\n","import React from 'react'\r\nimport { useModal } from '../../contexts/ModalContext';\r\nimport { FiFlag, FiInfo, FiShare } from 'react-icons/fi'\r\nimport {FriendsListToShareWith} from '../Lists/FriendsListToShareWith'\r\nimport { AlbumInfo } from '../Info/AlbumInfo';\r\nimport { AuthorInfo } from '../Info/AuthorInfo';\r\nexport const AuthorMoreWindow = ({data}) => {\r\n\tconst {setContent} = useModal()\r\n\treturn (\r\n\t\t<div className=\"AuthorMoreWindow\" style={{ top: '110%', bottom: 'auto' }} onClick={e => e.stopPropagation()} >\r\n\t\t\t<div className=\"songItemMenuWindowItem\" onClick={() => {setContent(<FriendsListToShareWith item={data} whatToShare={data.authors !== undefined ? 'playlist' : 'author'} />) }}>\r\n\t\t\t\t<FiShare />Share\r\n\t\t\t</div>\r\n\t\t\t<div className=\"songItemMenuWindowItem\" onClick={() => { setContent(data.authors !== undefined ? <AlbumInfo album={data} /> : <AuthorInfo author={data} />) }}><FiInfo />Info</div>\r\n\t\t</div>\r\n\t)\r\n}\r\n","import React, {useEffect} from 'react'\r\n\r\nexport const SmallImages = ({imagesList, borderColor = \"#fff\"}) => {\r\n\treturn (\r\n\t\t<div className = \"SmallImages\" style = {{marginRight:-7*(imagesList.length-1)}}>\r\n\t\t\t{imagesList.map((image, index)=>{\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<div className = \"smallImgContainer\" style = {{border:`3px solid ${borderColor}`, transform:`translateX(${-15*index}px)`}} key = {index}>\r\n\t\t\t\t\t\t<img loading = \"lazy\" src={image} alt=\"\"/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)\r\n\t\t\t})}\r\n\t\t</div>\r\n\t)\r\n}\r\n","import React, { useRef, useState } from \"react\";\r\nimport { BiAlbum, BiDoorOpen, BiLoaderAlt } from \"react-icons/bi\";\r\nimport { CgCheckO, CgLock } from \"react-icons/cg\";\r\nimport {\r\n  FiEdit2,\r\n  FiHeadphones,\r\n  FiInfo,\r\n  FiMoreVertical,\r\n  FiPlusCircle,\r\n  FiSettings,\r\n  FiShare,\r\n  FiTrash,\r\n  FiUserCheck,\r\n  FiUserPlus,\r\n} from \"react-icons/fi\";\r\nimport { ImCheckmark } from \"react-icons/im\";\r\nimport { IoMdExit } from \"react-icons/io\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { useAuth } from \"../../contexts/AuthContext\";\r\nimport { useModal } from \"../../contexts/ModalContext\";\r\nimport { useScreen } from \"../../contexts/ScreenContext\";\r\nimport { useSong } from \"../../contexts/SongContext\";\r\nimport { CustomizeAlbum } from \"../../features/album/ui/organisms/customize-album\";\r\nimport { addAuthorToLibrary } from \"../../features/author/lib/add-author-to-library\";\r\nimport addFriend from \"../../features/author/lib/add-friend\";\r\nimport deleteAuthorFromLibrary from \"../../features/author/lib/delete-author-from-library\";\r\nimport { deleteFriend } from \"../../features/author/lib/delete-friend\";\r\nimport { ChatWithFriendButton } from \"../../features/author/ui/molecules/chat-with-friend-button\";\r\nimport { LastSongListened } from \"../../features/author/ui/molecules/last-song-listened\";\r\nimport { CustomizeAuthor } from \"../../features/author/ui/organisms/customize-author\";\r\nimport { addPlaylistToLibrary } from \"../../functions/add/addPlaylistToLibrary\";\r\nimport { deletePlaylist } from \"../../functions/delete/deletePlaylist\";\r\nimport displayDate from \"../../functions/display/displayDate\";\r\nimport { quitPlaylist } from \"../../functions/other/quitPlaylist\";\r\nimport { removePlaylistFromLibrary } from \"../../functions/other/removePlaylistFromLibrary\";\r\nimport rightFormanForBigNumber from \"../../functions/other/rightFormatForBigNumber\";\r\nimport { useAlbumAuthors } from \"../../hooks/useAlbumAuthors\";\r\nimport useOutsideClick from \"../../shared/lib/hooks/use-outside-click\";\r\nimport { GoBackBtn } from \"../../shared/ui/atoms/go-back-button\";\r\nimport { Hint } from \"../Basic/Hint\";\r\nimport { LastSeen } from \"../Basic/LastSeen\";\r\nimport { AlbumInfo } from \"../Info/AlbumInfo\";\r\nimport { AuthorInfo } from \"../Info/AuthorInfo\";\r\nimport { FriendsListToShareWith } from \"../Lists/FriendsListToShareWith\";\r\nimport { AuthorMoreWindow } from \"../Windows/AuthorMoreWindow\";\r\nimport { SmallImages } from \"./SmallImages\";\r\nexport const Header = ({ data, headerColors }) => {\r\n  const { isMobile } = useScreen();\r\n  const { displayAuthors } = useSong();\r\n  const [albumAuthors, authorsImages] = useAlbumAuthors(data);\r\n  const { currentUser, logout } = useAuth();\r\n  const [openMoreWindow, setOpenMoreWindow] = useState(false);\r\n  const {\r\n    toggleModal,\r\n    setContent,\r\n    openConfirm,\r\n    closeConfirm,\r\n    openBottomMessage,\r\n  } = useModal();\r\n  const isFriend = currentUser.friends.find(\r\n    (friend) => friend.uid === data.uid && friend.status === \"added\"\r\n  );\r\n  const moreWindowRef = useRef(null);\r\n  useOutsideClick(moreWindowRef, setOpenMoreWindow);\r\n\r\n  function displayCreationDateIfExists() {\r\n    return data.creationDate !== undefined ? (\r\n      <div className=\"headerListenersAndSubsItem\">\r\n        <Hint text={\"creation date\"} style={{ fontSize: \"0.8em\" }} />\r\n        <span>{displayDate(data.creationDate)}</span>\r\n      </div>\r\n    ) : null;\r\n  }\r\n\r\n  function isAlbumOrIsAuthor() {\r\n    return data.authors !== undefined ? (\r\n      data.isAlbum ? (\r\n        <h5>Album</h5>\r\n      ) : (\r\n        <h5>Playlist</h5>\r\n      )\r\n    ) : data.isAuthor ? (\r\n      <h5>Author</h5>\r\n    ) : (\r\n      <h5>\r\n        User{\" \"}\r\n        {data.authors === undefined && isFriend ? (\r\n          <LastSeen userUID={data.uid} />\r\n        ) : null}\r\n      </h5>\r\n    );\r\n  }\r\n\r\n  function showCreatorsIfExist() {\r\n    return data.authors !== undefined ? (\r\n      <div className=\"headerAuthorsImagesAndNames\">\r\n        <SmallImages imagesList={authorsImages} borderColor={headerColors[2]} />\r\n        <div className=\"headerAuthors\">\r\n          {displayAuthors(albumAuthors, \", \")}\r\n        </div>\r\n      </div>\r\n    ) : null;\r\n  }\r\n\r\n  function findIfIsVerified() {\r\n    return data.isVerified ? (\r\n      <ImCheckmark style={{ color: headerColors[0] }} />\r\n    ) : null;\r\n  }\r\n\r\n  function whatButtonToRender() {\r\n    if (data.authors) {\r\n      if (\r\n        currentUser.ownPlaylists.includes(data.id) &&\r\n        data.authors.length === 1\r\n      )\r\n        return (\r\n          <button\r\n            onClick={() =>\r\n              openConfirm(\r\n                \"Are you sure you want to DELETE this playlist forever?!\",\r\n                \"Yes, pretty sure\",\r\n                \"No, I Don't!\",\r\n                () => {\r\n                  deletePlaylist(data.id);\r\n                  closeConfirm();\r\n                  openBottomMessage(`Playlist ${data.name} was deleted`);\r\n                }\r\n              )\r\n            }\r\n          >\r\n            <Hint text={\"delete playlist\"} direction={\"bottom\"} />\r\n            <FiTrash />\r\n          </button>\r\n        );\r\n      else if (currentUser.ownPlaylists.includes(data.id))\r\n        return (\r\n          <button\r\n            onClick={() =>\r\n              openConfirm(\r\n                \"Are you sure you want to quit this playlist?\",\r\n                \"Yes, pretty sure\",\r\n                \"No, I Don't!\",\r\n                () => {\r\n                  quitPlaylist(data, currentUser);\r\n                  closeConfirm();\r\n                  openBottomMessage(`You left ${data.name}`);\r\n                }\r\n              )\r\n            }\r\n          >\r\n            <Hint text={\"quit playlist\"} direction={\"bottom\"} />\r\n            <BiDoorOpen />\r\n          </button>\r\n        );\r\n      else if (currentUser.addedPlaylists.includes(data.id))\r\n        return (\r\n          <button\r\n            onClick={() =>\r\n              openConfirm(\r\n                \"Are you sure you want to remove this playlist from library?\",\r\n                \"Yes, pretty sure\",\r\n                \"No-no-no, go away\",\r\n                () => {\r\n                  removePlaylistFromLibrary(data, currentUser);\r\n                  closeConfirm();\r\n                  openBottomMessage(\"Playlist was removed from library\");\r\n                }\r\n              )\r\n            }\r\n          >\r\n            <Hint text={\"remove playlist from library\"} direction={\"bottom\"} />\r\n            <CgCheckO />\r\n          </button>\r\n        );\r\n      else\r\n        return (\r\n          <button\r\n            onClick={() => {\r\n              addPlaylistToLibrary(data, currentUser);\r\n              openBottomMessage(`Playlist ${data.name} was added to library`);\r\n            }}\r\n          >\r\n            <Hint text={\"add playlist\"} direction={\"bottom\"} />\r\n            <FiPlusCircle />\r\n          </button>\r\n        );\r\n    } else {\r\n      if (currentUser.addedAuthors.includes(data.uid))\r\n        return (\r\n          <button onClick={() => deleteAuthorFromLibrary(data, currentUser)}>\r\n            <Hint text={\"delete author from library\"} direction={\"bottom\"} />\r\n            <CgCheckO />\r\n          </button>\r\n        );\r\n      else if (currentUser.uid === data.uid)\r\n        return (\r\n          <Link to={\"/settings\"}>\r\n            <button>\r\n              <Hint text={\"settings\"} direction={\"bottom\"} />\r\n              <FiSettings />\r\n            </button>\r\n          </Link>\r\n        );\r\n      else if (\r\n        !data.isAuthor &&\r\n        currentUser.friends.find(\r\n          (friend) => friend.uid === data.uid && friend.status === \"added\"\r\n        )\r\n      )\r\n        return (\r\n          <button\r\n            onClick={() =>\r\n              openConfirm(\r\n                `Are you sure you want to unfriend ${data.displayName}?`,\r\n                \"Yes, pretty sure\",\r\n                \"No-no-no, go away\",\r\n                () => {\r\n                  deleteFriend(currentUser, data);\r\n                  closeConfirm();\r\n                  openBottomMessage(`${data.displayName} was unfriended`);\r\n                }\r\n              )\r\n            }\r\n          >\r\n            <Hint text={\"remove from friend list\"} direction={\"bottom\"} />\r\n            <FiUserCheck />\r\n          </button>\r\n        );\r\n      else if (\r\n        !data.isAuthor &&\r\n        currentUser.friends.find(\r\n          (friend) => friend.uid === data.uid && friend.status === \"awaiting\"\r\n        )\r\n      )\r\n        return (\r\n          <button onClick={addFriend}>\r\n            <Hint text={\"waiting for response\"} direction={\"bottom\"} />\r\n            <BiLoaderAlt style={{ animation: \"loading 1s infinite linear\" }} />\r\n          </button>\r\n        );\r\n      else if (!data.isAuthor)\r\n        return (\r\n          <button\r\n            onClick={() => {\r\n              addFriend(data, currentUser);\r\n              openBottomMessage(\r\n                `Friend request was sent to ${data.displayName}`\r\n              );\r\n            }}\r\n          >\r\n            <Hint text={\"add friend\"} direction={\"bottom\"} />\r\n            <FiUserPlus />\r\n          </button>\r\n        );\r\n      else\r\n        return (\r\n          <button\r\n            onClick={() => {\r\n              addAuthorToLibrary(data, currentUser);\r\n              openBottomMessage(\r\n                `${data.displayName} was added to your library`\r\n              );\r\n            }}\r\n          >\r\n            <Hint text={\"subscribe\"} direction={\"bottom\"} />\r\n            <FiPlusCircle />\r\n          </button>\r\n        );\r\n    }\r\n  }\r\n\r\n  function findIfIsPrivate() {\r\n    return data.isPrivate ? <CgLock /> : null;\r\n  }\r\n\r\n  return (\r\n    <div\r\n      className=\"Header\"\r\n      style={\r\n        headerColors.length\r\n          ? {\r\n              background: `linear-gradient(45deg, ${headerColors[2]}, ${headerColors[0]})`,\r\n            }\r\n          : { background: \"var(--yellowAndPinkGrad)\" }\r\n      }\r\n    >\r\n      <div className=\"headerBtns\" style={{ background: headerColors[2] }}>\r\n        <GoBackBtn />\r\n        <div style={{ display: \"flex\" }}>\r\n          <div className=\"headerBackBtn\">{whatButtonToRender()}</div>\r\n          <div className=\"headerMoreBtn\" ref={moreWindowRef}>\r\n            <button\r\n              onClick={\r\n                !isMobile\r\n                  ? () => setOpenMoreWindow(!openMoreWindow)\r\n                  : () => {\r\n                      toggleModal();\r\n                      setContent(<AuthorMoreWindow data={data} />);\r\n                    }\r\n              }\r\n            >\r\n              <Hint text={\"more\"} direction={\"bottom\"} />\r\n              <FiMoreVertical />\r\n            </button>\r\n            {openMoreWindow ? (\r\n              <div\r\n                className=\"songItemMenuWindow\"\r\n                style={{ top: \"110%\", bottom: \"auto\" }}\r\n                onClick={(e) => e.stopPropagation()}\r\n              >\r\n                {(data.authors &&\r\n                  data.authors.find(\r\n                    (person) => person.uid === currentUser.uid\r\n                  )) ||\r\n                (data.authors && currentUser.isAdmin) ? (\r\n                  <div\r\n                    className=\"songItemMenuWindowItem\"\r\n                    onClick={() => {\r\n                      toggleModal();\r\n                      setContent(<CustomizeAlbum playlist={data} />);\r\n                    }}\r\n                  >\r\n                    <FiEdit2 />\r\n                    Edit\r\n                  </div>\r\n                ) : data.uid === currentUser.uid && !data.isAuthor ? (\r\n                  <div\r\n                    className=\"songItemMenuWindowItem\"\r\n                    onClick={() => {\r\n                      toggleModal();\r\n                      setContent(<CustomizeAuthor author={data} />);\r\n                    }}\r\n                  >\r\n                    <FiEdit2 />\r\n                    Edit\r\n                  </div>\r\n                ) : null}\r\n                <div\r\n                  className=\"songItemMenuWindowItem\"\r\n                  onClick={() => {\r\n                    toggleModal();\r\n                    setContent(\r\n                      <FriendsListToShareWith\r\n                        item={data}\r\n                        whatToShare={\r\n                          data.authors !== undefined ? \"playlist\" : \"author\"\r\n                        }\r\n                      />\r\n                    );\r\n                  }}\r\n                >\r\n                  <FiShare />\r\n                  Share\r\n                </div>\r\n                <div\r\n                  className=\"songItemMenuWindowItem\"\r\n                  onClick={() => {\r\n                    toggleModal();\r\n                    setContent(\r\n                      data.authors !== undefined ? (\r\n                        <AlbumInfo album={data} />\r\n                      ) : (\r\n                        <AuthorInfo author={data} />\r\n                      )\r\n                    );\r\n                  }}\r\n                >\r\n                  <FiInfo />\r\n                  Info\r\n                </div>\r\n              </div>\r\n            ) : null}\r\n          </div>\r\n        </div>\r\n        {currentUser.uid === data.uid ? (\r\n          <button\r\n            onClick={() =>\r\n              openConfirm(\r\n                \"Are you sure you want to quit?\",\r\n                \"Yes, pretty sure\",\r\n                \"No, I Don't!\",\r\n                () => {\r\n                  logout();\r\n                  closeConfirm();\r\n                }\r\n              )\r\n            }\r\n          >\r\n            <Hint text={\"quit\"} direction={\"bottom\"} />\r\n            <IoMdExit />\r\n          </button>\r\n        ) : null}\r\n      </div>\r\n      <div\r\n        className=\"headerAuthorsImage\"\r\n        style={\r\n          data.authors === undefined\r\n            ? {\r\n                animation: \"floatingBorderRadius 10s infinite ease-in-out\",\r\n                backgroundImage: `url(${data.photoURL})`,\r\n                position: \"relative\",\r\n              }\r\n            : {\r\n                backgroundImage: `url(${data.image})`,\r\n                position: \"relative\",\r\n                backgroundColor: \"var(--red)\",\r\n              }\r\n        }\r\n      >\r\n        {data.authors !== undefined && !data.image ? (\r\n          <BiAlbum\r\n            style={{\r\n              position: \"absolute\",\r\n              left: \"50%\",\r\n              top: \"50%\",\r\n              transform: \"translate(-50%, -50%)\",\r\n              width: \"60px\",\r\n              height: \"60px\",\r\n            }}\r\n          />\r\n        ) : null}\r\n      </div>\r\n      <div className=\"headerAuthorInfo\">\r\n        <div className=\"headerAuthorsName\">\r\n          {isAlbumOrIsAuthor()}\r\n          <div\r\n            style={{\r\n              display: \"flex\",\r\n              alignItems: \"center\",\r\n              margin: \"2px 0 10px 0\",\r\n            }}\r\n          >\r\n            <>\r\n              <h1>{data.displayName || data.name}</h1>\r\n            </>\r\n            {findIfIsVerified()}\r\n            {findIfIsPrivate()}\r\n            {!!data.displayName && isFriend && (\r\n              <LastSongListened data={data} loading={false} />\r\n            )}\r\n            {/* <LastSongListened data = {data} loading = {loading}/> */}\r\n          </div>\r\n        </div>\r\n        {showCreatorsIfExist()}\r\n\r\n        <div className=\"headerListenersAndSubs\">\r\n          <div className=\"headerListenersAndSubsItem\">\r\n            <Hint\r\n              text={\r\n                (data.listens ?? data.numberOfListenersPerMonth) + \" listens\"\r\n              }\r\n              style={{ fontSize: \"0.8em\" }}\r\n            />\r\n            <span>\r\n              {rightFormanForBigNumber(\r\n                data.listens ?? data.numberOfListenersPerMonth\r\n              )}\r\n            </span>\r\n            <FiHeadphones />\r\n          </div>\r\n          <div className=\"headerListenersAndSubsItem\">\r\n            <Hint\r\n              text={data.subscribers + \" subscribers\"}\r\n              style={{ fontSize: \"0.8em\" }}\r\n            />\r\n            <span>{rightFormanForBigNumber(data.subscribers)}</span>\r\n            <FiUserPlus />\r\n          </div>\r\n          {displayCreationDateIfExists()}\r\n        </div>\r\n        {isFriend ? (\r\n          <ChatWithFriendButton data={data} color={headerColors[3]} />\r\n        ) : null}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import { firestore } from \"../../firebase\"\r\n\r\nexport const deletePlaylist = (playlistId) => {\r\n\tfirestore.collection(\"users\").where(\"addedPlaylists\", \"array-contains\", playlistId).get().then((listOfPeople)=>{\r\n\t\tlistOfPeople.docs.forEach(person=>{\r\n\t\t\tconst personFilteredPlaylists = person.data().addedPlaylists.filter(pId => pId !== playlistId)\r\n\t\t\tfirestore.collection('users').doc(person.data().uid).update({\r\n\t\t\t\taddedPlaylists:personFilteredPlaylists\r\n\t\t\t})\r\n\t\t})\r\n\t})\r\n\tfirestore.collection(\"users\").where(\"ownPlaylists\", \"array-contains\", playlistId).get().then((listOfPeople)=>{\r\n\t\tlistOfPeople.docs.forEach(person=>{\r\n\t\t\tconst personFilteredPlaylists = person.data().addedPlaylists.filter(pId => pId !== playlistId)\r\n\t\t\tfirestore.collection('users').doc(person.data().uid).update({\r\n\t\t\t\townPlaylists:personFilteredPlaylists\r\n\t\t\t})\r\n\t\t})\r\n\t})\r\n\tfirestore.collection('search').doc(playlistId).delete().then(()=>{\r\n\t\tfirestore.collection('playlists').doc(playlistId).delete()\r\n\t})\r\n}","import { firestore } from \"../../firebase\"\r\n\r\nexport const quitPlaylist = (playlist, currentUser) => {\r\n\t//logic for quiting playlist where it has more than one participant\r\n\tfirestore.collection('users').doc(currentUser.uid).update({\r\n\t\townPlaylists:currentUser.ownPlaylists.filter(id => id !== playlist.id)\r\n\t})\r\n\tfirestore.collection('playlists').doc(playlist.id).update({\r\n\t\tauthors:playlist.authors.filter(author=>author.uid !== currentUser.uid)\r\n\t})\r\n}","import { firestore } from \"../../../firebase\"\r\n\r\nexport const deleteFriend = (currentUser, data) => {\r\n\tlet filteredUserFriends = currentUser.friends.filter(friend => friend.uid !== data.uid)\r\n\tlet filteredOtherUserFriends = data.friends.filter(friend => friend.uid !== currentUser.uid)\r\n\r\n\tfirestore.collection('users').doc(currentUser.uid).update({\r\n\t\tfriends: filteredUserFriends\r\n\t})\r\n\r\n\tfirestore.collection('users').doc(data.uid).update({\r\n\t\tfriends: filteredOtherUserFriends\r\n\t})\r\n}","import React from \"react\";\r\n\r\nexport const ContentContainer = ({ children, ...props }) => {\r\n  return (\r\n    <div className=\"content-container\" {...props}>\r\n      {children}\r\n    </div>\r\n  );\r\n};\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { useRouteMatch } from \"react-router\";\r\nimport { Header } from \"../../components/AuthorPage/Header\";\r\nimport { firestore } from \"../../firebase\";\r\nimport { LoadingCircle } from \"../../components/Loading/LoadingCircle\";\r\nimport { SongList } from \"../../components/Lists/SongList\";\r\nimport { useHistory } from \"react-router-dom\";\r\n\r\nimport { ContentContainer } from \"../../components/Containers/ContentContainer\";\r\nimport { fetchItemList } from \"../../shared/lib/fetch-item-list\";\r\nconst AlbumPage = () => {\r\n  const match = useRouteMatch(\"/albums/:albumId\");\r\n  const [playlistSongs, setPlaylistSongs] = useState([]);\r\n  const [headerColors, setHeaderColors] = useState([]);\r\n  const { albumId } = match.params;\r\n  const [albumData, setAlbumData] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const history = useHistory();\r\n  async function fetchAlbumsData() {\r\n    firestore\r\n      .collection(\"playlists\")\r\n      .doc(albumId)\r\n      .onSnapshot((doc) => {\r\n        if (doc.exists) {\r\n          setAlbumData(doc.data());\r\n          setHeaderColors(doc.data().imageColors);\r\n        } else {\r\n          history.push(\"/not-found\");\r\n        }\r\n      });\r\n  }\r\n\r\n  function fetchSongsInAlbum() {\r\n    if (albumData.songs?.length)\r\n      fetchItemList(\r\n        albumData.songs,\r\n        \"songs\",\r\n        setPlaylistSongs,\r\n        (res) => res,\r\n        () => setLoading(false)\r\n      );\r\n    else setLoading(false);\r\n  }\r\n\r\n  useEffect(() => {\r\n    fetchAlbumsData();\r\n  }, [albumId, firestore]);\r\n\r\n  useEffect(() => {\r\n    fetchSongsInAlbum();\r\n  }, [albumData]);\r\n\r\n  return (\r\n    <div className=\"AlbumPage\" style={{ animation: \"zoomIn .2s forwards\" }}>\r\n      {loading ? (\r\n        <LoadingCircle top={\"50%\"} />\r\n      ) : (\r\n        <>\r\n          <Header\r\n            data={albumData}\r\n            headerColors={headerColors}\r\n            setHeaderColors={setHeaderColors}\r\n          />\r\n          <ContentContainer\r\n            style={{\r\n              display: \"flex\",\r\n              flexDirection: \"column\",\r\n              minHeight: \"100%\",\r\n              borderRadius: \"25px 25px 0 0\",\r\n              flex: \"1 1 auto\",\r\n              position: \"relative\",\r\n              overflow: \"hidden\",\r\n              boxShadow: \"0px 0px 100px #060606\",\r\n            }}\r\n          >\r\n            <div\r\n              className=\"content-background\"\r\n              style={{\r\n                background: `linear-gradient(360deg, black, ${headerColors[0]})`,\r\n              }}\r\n            ></div>\r\n            <SongList\r\n              listOfSongs={playlistSongs}\r\n              source={{\r\n                source: `/albums/${albumData.id}`,\r\n                name: albumData.name,\r\n                image: albumData.image,\r\n                songsList: playlistSongs,\r\n              }}\r\n              showSearch\r\n              defaultSearchMode={\"songs\"}\r\n            />\r\n          </ContentContainer>\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AlbumPage;\r\n","import React, { useState } from \"react\";\r\nimport { ColorExtractor } from \"react-color-extractor\";\r\nimport { FiXCircle } from \"react-icons/fi\";\r\nimport { useAuth } from \"../../contexts/AuthContext\";\r\nimport { firestore } from \"../../firebase\";\r\nimport { findVariantsOfName } from \"../../functions/find/findVariantsOfName\";\r\nimport getUID from \"../../functions/other/getUID\";\r\nimport { transformLyricsToArrayOfObjects } from \"../../functions/other/transformLyricsToArrayOfObject\";\r\nimport DownloadButton from \"../../shared/ui/atoms/download-button\";\r\nimport Input from \"../../shared/ui/atoms/input\";\r\nimport SubmitButton from \"../../shared/ui/atoms/submit-button\";\r\nimport SearchBar from \"../../shared/ui/organisms/search-bar\";\r\nimport { PersonTiny } from \"../Basic/PersonTiny\";\r\nimport { FullScreenLoading } from \"../Loading/FullScreenLoading\";\r\nexport const AddSong = () => {\r\n  const { currentUser } = useAuth();\r\n  const [songName, setSongName] = useState(\"\");\r\n  const [songCover, setSongCover] = useState(\"\");\r\n  const [songSrc, setSongSrc] = useState(\"\");\r\n  const [authorsInputValue, setAuthorsInputValue] = useState(\"\");\r\n  const [allAuthors, setAllAuthors] = useState([]);\r\n  const [chosenAuthors, setChosenAuthors] = useState(\r\n    !currentUser.isAdmin\r\n      ? [\r\n          {\r\n            uid: currentUser.uid,\r\n            photoURL: currentUser.photoURL,\r\n            displayName: currentUser.displayName,\r\n          },\r\n        ]\r\n      : []\r\n  );\r\n  const [releaseDate, setReleaseDate] = useState(\"\");\r\n  const [lyrics, setLyrics] = useState(\"\");\r\n  const [imageLocalPath, setImageLocalPath] = useState(\"\");\r\n  const [imageColors, setImageColors] = useState([]);\r\n  const [loadingAuthors, setLoadingAuthors] = useState(false);\r\n  const [errorMessage, setErrorMessage] = useState(\"\");\r\n  const [completed, setCompleted] = useState(false);\r\n  const [loadingSong, setLoadingSong] = useState(false);\r\n\r\n  function removeAuthorFromList(data) {\r\n    const filtered = chosenAuthors.filter((people) => people.uid !== data.uid);\r\n    return setChosenAuthors(filtered);\r\n  }\r\n\r\n  function addAuthor(data) {\r\n    if (!chosenAuthors.some((person) => person.uid === data.uid)) {\r\n      return setChosenAuthors((prev) => [\r\n        ...prev,\r\n        {\r\n          uid: data.uid,\r\n          displayName: data.displayName,\r\n          photoURL: data.photoURL,\r\n        },\r\n      ]);\r\n    }\r\n\r\n    removeAuthorFromList(data);\r\n  }\r\n\r\n  async function addSongToFirebase(e) {\r\n    e.preventDefault();\r\n\r\n    let uid = getUID();\r\n    setErrorMessage(\"\");\r\n    if (songName.length === 0) setErrorMessage(\"Song has to have some name\");\r\n    else if (chosenAuthors.length === 0)\r\n      setErrorMessage(\"Song has to have at least 1 author\");\r\n    else if (songCover.length === 0)\r\n      setErrorMessage(\"You didn't load song cover\");\r\n    else if (songSrc.length === 0) setErrorMessage(\"You didn't load song file\");\r\n    else if (releaseDate.length === 0)\r\n      setErrorMessage(\"You have to set release date for a song\");\r\n    else {\r\n      setLoadingSong(true);\r\n      firestore\r\n        .collection(\"songs\")\r\n        .doc(uid)\r\n        .set({\r\n          id: uid,\r\n          name: songName,\r\n          songSrc: songSrc,\r\n          authors: chosenAuthors,\r\n          cover: songCover,\r\n          listens: 0,\r\n          releaseDate: releaseDate,\r\n          lyrics: transformLyricsToArrayOfObjects(lyrics),\r\n          imageColors: imageColors,\r\n        })\r\n        .then(() => {\r\n          setAllAuthors([]);\r\n          setAuthorsInputValue(\"\");\r\n          setChosenAuthors([]);\r\n          setLyrics([]);\r\n          setSongCover(\"\");\r\n          setSongName(\"\");\r\n          setSongSrc(\"\");\r\n          setReleaseDate(\"\");\r\n          setLyrics([]);\r\n          setCompleted(true);\r\n          setImageColors([]);\r\n          setLoadingSong(false);\r\n        })\r\n        .catch((err) => {\r\n          setErrorMessage(err);\r\n          setLoadingSong(false);\r\n        });\r\n\r\n      chosenAuthors.forEach(async (author) => {\r\n        const authorRef = await firestore\r\n          .collection(\"users\")\r\n          .doc(author.uid)\r\n          .get();\r\n        const authorData = authorRef.data();\r\n        const authorSongs = authorData.ownSongs;\r\n        authorSongs.push(uid);\r\n        firestore.collection(\"users\").doc(author.uid).update({\r\n          ownSongs: authorSongs,\r\n        });\r\n      });\r\n\r\n      firestore\r\n        .collection(\"search\")\r\n        .doc(uid)\r\n        .set({\r\n          place: \"songs\",\r\n          uid: uid,\r\n          rank: 0,\r\n          variantsOfName: findVariantsOfName(songName),\r\n        });\r\n    }\r\n  }\r\n\r\n  function manuallyChangeColor(e, i) {\r\n    imageColors[i] = e.target.value;\r\n    setImageColors([...imageColors]);\r\n  }\r\n\r\n  return (\r\n    <div className=\"AddSong\">\r\n      <FullScreenLoading loading={loadingSong} />\r\n      <ColorExtractor\r\n        src={imageLocalPath}\r\n        getColors={(colors) => setImageColors(colors)}\r\n      />\r\n      <div>\r\n        <Input\r\n          title={\"Song name\"}\r\n          value={songName}\r\n          setValue={setSongName}\r\n          placeholder={\"Enter song name\"}\r\n        />\r\n        <label>\r\n          <h3>Song authors</h3>\r\n          <SearchBar\r\n            value={authorsInputValue}\r\n            setValue={setAuthorsInputValue}\r\n            setResultAuthorList={setAllAuthors}\r\n            defaultSearchMode={\"authors\"}\r\n            inputText={\"Search for authors\"}\r\n          />\r\n          <div className=\"chosenAuthorsList\">\r\n            {chosenAuthors.map((author) => {\r\n              return (\r\n                <div className=\"chosenAuthorItem\">\r\n                  <span>{author.displayName}</span>\r\n                  <FiXCircle\r\n                    onClick={() => {\r\n                      if (currentUser.isAdmin) removeAuthorFromList(author);\r\n                      else if (author.uid !== currentUser.uid)\r\n                        removeAuthorFromList(author);\r\n                    }}\r\n                  />\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n          <div className=\"authorsResult\">\r\n            {allAuthors.map((data, index) => {\r\n              return (\r\n                <PersonTiny\r\n                  data={data}\r\n                  onClick={() => addAuthor(data)}\r\n                  style={\r\n                    chosenAuthors.includes(data.uid)\r\n                      ? { background: \"var(--green)\" }\r\n                      : {}\r\n                  }\r\n                  key={index}\r\n                />\r\n              );\r\n            })}\r\n          </div>\r\n        </label>\r\n\r\n        <Input\r\n          title={\"Release Date\"}\r\n          type={\"date\"}\r\n          value={releaseDate}\r\n          setValue={setReleaseDate}\r\n          placeholder={\"Enter release date\"}\r\n        />\r\n\r\n        <div style={{ width: \"100%\", display: \"flex\" }}>\r\n          {imageColors.map((color, index) => {\r\n            return (\r\n              <input\r\n                type=\"color\"\r\n                value={color}\r\n                style={{\r\n                  width: \"100%\",\r\n                  height: \"60px\",\r\n                  padding: \"0\",\r\n                  borderRadius: \"0px\",\r\n                }}\r\n                onChange={(e) => {\r\n                  manuallyChangeColor(e, index);\r\n                }}\r\n              />\r\n            );\r\n          })}\r\n        </div>\r\n        <DownloadButton\r\n          text={\"Download song cover\"}\r\n          place={\"songsImages/\"}\r\n          setItemSrc={setSongCover}\r\n          setImageLocalPath={setImageLocalPath}\r\n        />\r\n        <DownloadButton\r\n          text={\"Download song file\"}\r\n          place={\"songs/\"}\r\n          setItemSrc={setSongSrc}\r\n        />\r\n        <label>\r\n          <textarea\r\n            name=\"\"\r\n            id=\"\"\r\n            placeholder={\"Add song lyrics\"}\r\n            value={lyrics}\r\n            onChange={(e) => setLyrics(e.target.value)}\r\n          ></textarea>\r\n        </label>\r\n        <SubmitButton\r\n          text={\"Add song\"}\r\n          action={addSongToFirebase}\r\n          isLoading={loadingSong}\r\n          completed={completed}\r\n          setCompleted={setCompleted}\r\n          bottomMessage={\"Song was uploaded to database\"}\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import React, { useState } from \"react\";\r\nimport { FiPlus } from \"react-icons/fi\";\r\nimport { useAuth } from \"../../contexts/AuthContext\";\r\nimport { Slider } from \"../../shared/ui/molecules/slider\";\r\nimport { AddPlaylist } from \"../AddWindow/AddPlaylist\";\r\nimport { AddSong } from \"../AddWindow/AddSong\";\r\n\r\nexport const AddWindow = ({ data }) => {\r\n  const { currentUser } = useAuth();\r\n  const [openAddSongWindow, setOpenAddSongWindow] = useState(false);\r\n  const [currentSliderPage, setCurrentSliderPage] = useState(0);\r\n  const sliderPages = [<AddSong />, <AddPlaylist />];\r\n  return (currentUser.isAdmin || data.isAuthor) &&\r\n    data.uid === currentUser.uid ? (\r\n    <div className=\"AddSong\">\r\n      <button\r\n        onClick={() => setOpenAddSongWindow(!openAddSongWindow)}\r\n        style={openAddSongWindow ? { background: \"var(--red)\" } : {}}\r\n        className=\"openAddSongWindowBtn\"\r\n      >\r\n        <FiPlus\r\n          style={openAddSongWindow ? { transform: \"rotate(45deg)\" } : {}}\r\n        />\r\n      </button>\r\n      <div\r\n        className=\"addSongWindow\"\r\n        style={openAddSongWindow ? { display: \"flex\" } : {}}\r\n      >\r\n        <Slider\r\n          pages={[\"Song\", \"Playlist\"]}\r\n          currentPage={currentSliderPage}\r\n          setCurrentPage={setCurrentSliderPage}\r\n        />\r\n        {sliderPages[currentSliderPage]}\r\n      </div>\r\n    </div>\r\n  ) : null;\r\n};\r\n","import React, { useEffect, useRef, useState } from 'react'\r\nimport { FiChevronLeft, FiChevronRight } from 'react-icons/fi';\r\nimport { firestore } from '../../firebase';\r\nimport { PersonTinyVerticalItem } from './PersonTinyVerticalItem'\r\n\r\nexport const PersonTinyList = ({data, title}) => {\r\n\tconst [listOfPeople, setListOfPeople] = useState([])\r\n\tconst [scrollLeft, setScrollLeft] = useState(0)\r\n\tconst wrapperRef = useRef(null)\r\n\tconst [shouldRenderRightArrow, setShouldRenderRightArrow] = useState(false)\r\n\tfunction scrollToLeft() {\r\n\t\tconst prev = wrapperRef.current.scrollLeft\r\n\t\twrapperRef.current.scrollLeft = prev - 200\r\n\t\tsetScrollLeft(prev - 200)\r\n\t}\r\n\tfunction scrollToRight() {\r\n\t\tconst prev = wrapperRef.current.scrollLeft\r\n\t\twrapperRef.current.scrollLeft = prev + 200\r\n\t\tsetScrollLeft(prev + 200)\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tif(listOfPeople.length > 0){\r\n\t\t\tconst scrollBiggerThanScreen = wrapperRef.current.scrollWidth > wrapperRef.current.offsetWidth\r\n\t\t\tif (scrollBiggerThanScreen) setShouldRenderRightArrow(true)\r\n\t\t}\r\n\t}, [listOfPeople])\r\n\r\n\tfunction fetchFriends(){\r\n\t\tsetListOfPeople([])\r\n\t\tdata.friends.forEach(async personObj => {\r\n\t\t\tif(personObj.status === 'added'){\r\n\t\t\t\tconst personData = (await firestore.collection('users').doc(personObj.uid).get()).data()\r\n\t\t\t\tsetListOfPeople(prev=>[...prev, personData])\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\tuseEffect(() => {\r\n\t\tsetListOfPeople([])\r\n\t\tfetchFriends()\r\n\t}, [data.uid])\r\n\treturn listOfPeople.length > 0? (\r\n\t\t<div className = 'PersonTinyList'>\r\n\t\t\t{title && <h2>{title}</h2>}\r\n\t\t\t<div style = {{position:'relative'}}>\t\r\n\t\t\t\t<div className=\"personTinyListWrapper\" ref = {wrapperRef} onScroll={e => setScrollLeft(e.target.scrollLeft)}>\r\n\t\t\t\t\t{listOfPeople.map((person, index)=>{\r\n\t\t\t\t\t\treturn <PersonTinyVerticalItem person = {person} key = {person.uid}/>\r\n\t\t\t\t\t})}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"authorsShiftButtons\">\r\n\t\t\t\t\t<button onClick={scrollToLeft} style={scrollLeft <= 0 ? { visibility: 'hidden', opacity: '0' } : {}}><FiChevronLeft /></button>\r\n\t\t\t\t\t<button onClick={scrollToRight} style={shouldRenderRightArrow && wrapperRef.current && (wrapperRef.current.scrollWidth - wrapperRef.current.offsetWidth !== scrollLeft)? {} : { visibility: 'hidden', opacity: '0' }}><FiChevronRight /></button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t):null\r\n}\r\n","import { firestore } from \"../../firebase\";\r\n\r\nexport const findAuthorsAlbums = async (authorsData, setAuthorsPlaylists, currentUserUID, setLoading) => {\r\n\tsetAuthorsPlaylists([])\r\n\tconst tempArray = []\r\n\tif (authorsData.ownPlaylists !== undefined && authorsData.ownPlaylists.length !== 0) {\r\n\t\tauthorsData.ownPlaylists.forEach(async (playlistId, index) => {\r\n\t\t\tconst playlistData = (await firestore.collection(\"playlists\").doc(playlistId).get()).data()\r\n\t\t\tif (playlistData && (!playlistData.isPrivate || (authorsData.uid === currentUserUID && playlistData.isPrivate))) tempArray.push(playlistData)\r\n\t\t\tif (index === authorsData.ownPlaylists.length-1) {\r\n\t\t\t\ttempArray.sort((a, b) => new Date(b.creationDate).getTime() - new Date(a.creationDate).getTime())\r\n\t\t\t\tsetLoading(false)\r\n\t\t\t\tsetAuthorsPlaylists(tempArray)\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t}\r\n}","import React from 'react'\r\nimport Logo from '../../images/Logo3.svg'\r\nexport const DeletedPlaylist = () => {\r\n\treturn (\r\n\t\t<div style={{ textDecoration: 'none' }} className=\"playlistWrapper\">\r\n\t\t\t<div className=\"playlistItem\" style={{ background: `var(--playlistsColor)`, display:'flex', justifyContent:'center', alignItems:'center' }}>\r\n\t\t\t\t<img loading = \"lazy\" src={Logo} alt=\"\" style = {{width:'70px', height:'70px', filter:'grayscale(80%)'}}/>\r\n\t\t\t</div>\r\n\t\t\t<h4 style={{ display: 'flex', alignItems: 'center', margin: '5px 0' }}>\r\n\t\t\t\tPlaylist was deleted\r\n\t\t\t</h4>\r\n\t\t</div>\r\n\t)\r\n}\r\n","import React, { useState } from \"react\";\r\nimport { BiAlbum } from \"react-icons/bi\";\r\nimport { BsPauseFill, BsPlayFill } from \"react-icons/bs\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { useAuth } from \"../../contexts/AuthContext\";\r\nimport { useScreen } from \"../../contexts/ScreenContext\";\r\nimport { useSong } from \"../../contexts/SongContext\";\r\nimport getShortString from \"../../shared/lib/get-short-string\";\r\nimport { usePlaylistSongs } from \"../../hooks/usePlaylistSongs\";\r\nimport { DeletedPlaylist } from \"../Playlist/DeletedPlaylist\";\r\nimport { AddToListCircle } from \"../../shared/ui/molecules/add-to-list-circle\";\r\nimport saveSearchHistory from \"../../features/search/lib/save-search-history\";\r\nexport const PlaylistItem = ({\r\n  playlist = null,\r\n  listOfChosenAlbums,\r\n  setListOfChosenAlbums,\r\n  shouldSaveSearchHistory,\r\n}) => {\r\n  const playlistDate = new Date(playlist?.creationDate);\r\n  const { isMobile } = useScreen();\r\n  const { currentUser } = useAuth();\r\n  const { currentSongPlaylistSource, play } = useSong();\r\n  const [playlistSongs, setPlaylistSongs] = useState([]);\r\n  const playSongsInPlaylist = usePlaylistSongs(\r\n    playlist,\r\n    playlistSongs,\r\n    setPlaylistSongs\r\n  );\r\n\r\n  const handleSaveSearchHistory = () => {\r\n    if (shouldSaveSearchHistory)\r\n      saveSearchHistory(currentUser.uid, playlist.id, \"playlists\");\r\n  };\r\n\r\n  return playlist !== null ? (\r\n    <Link\r\n      to={`/albums/${playlist.id}`}\r\n      style={{ textDecoration: \"none\" }}\r\n      className=\"playlistWrapper\"\r\n      onClick={handleSaveSearchHistory}\r\n    >\r\n      <AddToListCircle\r\n        listOfChosenItems={listOfChosenAlbums}\r\n        setListOfChosenItems={setListOfChosenAlbums}\r\n        itemId={playlist.id}\r\n      />\r\n      <div\r\n        className=\"playlistItem\"\r\n        style={\r\n          playlist.image\r\n            ? { backgroundImage: `url(${playlist.image})` }\r\n            : { background: \"var(--yellowAndPinkGrad)\" }\r\n        }\r\n      >\r\n        {!playlist.image ? (\r\n          <BiAlbum\r\n            style={{\r\n              position: \"absolute\",\r\n              left: \"50%\",\r\n              top: \"50%\",\r\n              transform: \"translate(-50%, -50%)\",\r\n              width: \"60px\",\r\n              height: \"60px\",\r\n            }}\r\n          />\r\n        ) : null}\r\n        {!isMobile ? (\r\n          <button onClick={playSongsInPlaylist}>\r\n            {currentSongPlaylistSource.name === playlist.name && play ? (\r\n              <BsPauseFill />\r\n            ) : (\r\n              <BsPlayFill />\r\n            )}\r\n          </button>\r\n        ) : null}\r\n      </div>\r\n      <h4 style={{ display: \"flex\", alignItems: \"center\", margin: \"5px 0\" }}>\r\n        {getShortString(playlist.name, isMobile ? 10 : 15)}\r\n        <span\r\n          style={{\r\n            fontSize: \".6em\",\r\n            opacity: 0.6,\r\n            fontWeight: \"500\",\r\n            marginLeft: \"7px\",\r\n          }}\r\n        >\r\n          {playlist.isAlbum\r\n            ? playlist.songs.length === 1\r\n              ? \"single\"\r\n              : \"album\"\r\n            : \"playlist\"}\r\n        </span>\r\n      </h4>\r\n      <h5 style={{ margin: \"5px 0\" }}>{playlistDate.getFullYear()}</h5>\r\n    </Link>\r\n  ) : (\r\n    <DeletedPlaylist />\r\n  );\r\n};\r\n","import React, { useEffect, useRef, useState } from \"react\";\r\nimport { FiChevronLeft, FiChevronRight } from \"react-icons/fi\";\r\nimport { PlaylistItem } from \"../AuthorPage/PlaylistItem\";\r\nimport { LoadingCircle } from \"../Loading/LoadingCircle\";\r\n\r\nexport const AlbumList = ({\r\n  listOfAlbums,\r\n  title = \"\",\r\n  loading = true,\r\n  listOfChosenAlbums,\r\n  setListOfChosenAlbums,\r\n  saveSearchHistory,\r\n}) => {\r\n  const [scrollLeft, setScrollLeft] = useState(0);\r\n  const wrapperRef = useRef(null);\r\n  const [shouldRenderRightArrow, setShouldRenderRightArrow] = useState(false);\r\n  function scrollToLeft() {\r\n    const prev = wrapperRef.current.scrollLeft;\r\n    wrapperRef.current.scrollLeft = prev - 220;\r\n    setScrollLeft(prev - 220);\r\n  }\r\n  function scrollToRight() {\r\n    const prev = wrapperRef.current.scrollLeft;\r\n    wrapperRef.current.scrollLeft = prev + 220;\r\n    setScrollLeft(prev + 220);\r\n  }\r\n  useEffect(() => {\r\n    if (listOfAlbums.length > 0 && !loading) {\r\n      const scrollBiggerThanScreen =\r\n        wrapperRef.current.scrollWidth > wrapperRef.current.offsetWidth;\r\n      if (scrollBiggerThanScreen) setShouldRenderRightArrow(true);\r\n    }\r\n  }, [listOfAlbums]);\r\n  return listOfAlbums.length > 0 ? (\r\n    loading ? (\r\n      <LoadingCircle />\r\n    ) : (\r\n      <div className=\"AuthorsList\">\r\n        {title.length !== 0 ? <h2>{title}</h2> : null}\r\n        <div\r\n          className=\"authorsWrapper\"\r\n          ref={wrapperRef}\r\n          onScroll={(e) => setScrollLeft(e.target.scrollLeft)}\r\n        >\r\n          {listOfAlbums.map((playlist, index) => {\r\n            return (\r\n              <PlaylistItem\r\n                playlist={playlist}\r\n                key={index}\r\n                listOfChosenAlbums={listOfChosenAlbums}\r\n                setListOfChosenAlbums={setListOfChosenAlbums}\r\n                shouldSaveSearchHistory={saveSearchHistory}\r\n              />\r\n            );\r\n          })}\r\n        </div>\r\n        <div className=\"authorsShiftButtons\">\r\n          <button\r\n            onClick={scrollToLeft}\r\n            style={\r\n              scrollLeft <= 0 ? { visibility: \"hidden\", opacity: \"0\" } : {}\r\n            }\r\n          >\r\n            <FiChevronLeft />\r\n          </button>\r\n          <button\r\n            onClick={scrollToRight}\r\n            style={\r\n              shouldRenderRightArrow &&\r\n              wrapperRef.current &&\r\n              wrapperRef.current.scrollWidth -\r\n                wrapperRef.current.offsetWidth !==\r\n                scrollLeft\r\n                ? {}\r\n                : { visibility: \"hidden\", opacity: \"0\" }\r\n            }\r\n          >\r\n            <FiChevronRight />\r\n          </button>\r\n        </div>\r\n      </div>\r\n    )\r\n  ) : null;\r\n};\r\n","import React, { useEffect, useState } from 'react'\r\nimport { useAuth } from '../../contexts/AuthContext'\r\nimport { findAuthorsAlbums } from '../../functions/find/findAuthorsAlbums'\r\nimport { AlbumList } from '../Lists/AlbumList'\r\n\r\nexport const Playlists = ({ authorsData }) => {\r\n\tconst {currentUser} = useAuth()\r\n\tconst [authorsPlaylists, setAuthorsPlaylists] = useState([])\r\n\tconst [loading, setLoading] = useState(true)\r\n\r\n\tuseEffect(() => {\r\n\t\tfindAuthorsAlbums(authorsData, setAuthorsPlaylists, currentUser.uid, setLoading)\r\n\t}, [authorsData.ownPlaylists])\r\n\r\n\treturn <AlbumList listOfAlbums = {authorsPlaylists} title = {currentUser.isAuthor?\"Albums\":\"Playlists\"} loading = {loading}/>\r\n}\r\n","import React from 'react'\r\nimport { FiCheck, FiX } from 'react-icons/fi'\r\nimport { Link } from 'react-router-dom'\r\n\r\nexport const FriendRequestItem = ({person, addFriend, rejectFriend}) => {\r\n\treturn (\r\n\t\t<div className = 'FriendRequestItem'>\r\n\t\t\t<Link to = {`/authors/${person.uid}`}>\r\n\t\t\t\t<div className = \"friendRequestImageAndName\">  \r\n\t\t\t\t\t<div className=\"requestImage\">\r\n\t\t\t\t\t\t<img loading = \"lazy\" src={person.photoURL} alt=\"\" />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<h3>{person.displayName}</h3>\r\n\t\t\t\t</div>\r\n\t\t\t</Link>\r\n\t\t\t<div className=\"requestButtons\">\r\n\t\t\t\t<button style = {{color:'var(--green)'}} onClick = {()=>addFriend(person.uid)}>\r\n\t\t\t\t\t<FiCheck/>\r\n\t\t\t\t\t<span>Add</span> \r\n\t\t\t\t</button>\r\n\t\t\t\t<button style = {{color:'var( --lightRed)'}} onClick = {()=>rejectFriend(person.uid)}>\r\n\t\t\t\t\t<FiX/>\r\n\t\t\t\t\t<span>Reject</span> \r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t)\r\n}\r\n","import { useEffect, useState } from \"react\";\r\nimport { useAuth } from \"../../../../contexts/AuthContext\";\r\nimport { firestore } from \"../../../../firebase\";\r\n\r\nconst useFriendRequest = () => {\r\n  const { currentUser } = useAuth();\r\n  const [friendRequests, setFriendRequests] = useState([]);\r\n  function fetchFriendRequests() {\r\n    const tempArray = [];\r\n    currentUser.friends.forEach(async (friendObj, i) => {\r\n      if (friendObj.status === \"requested\") {\r\n        const personData = (\r\n          await firestore.collection(\"users\").doc(friendObj.uid).get()\r\n        ).data();\r\n        tempArray.push(personData);\r\n        if (i === currentUser.friends.length - 1) setFriendRequests(tempArray);\r\n      }\r\n    });\r\n  }\r\n\r\n  useEffect(() => {\r\n    fetchFriendRequests();\r\n  }, [JSON.stringify(currentUser.friends)]);\r\n\r\n  function addFriend(uid) {\r\n    const friendsList = currentUser.friends;\r\n    const otherUserFriendList = friendRequests.find(\r\n      (person) => person.uid === uid\r\n    ).friends;\r\n    friendsList.find((obj) => obj.uid === uid).status = \"added\";\r\n    otherUserFriendList.find((obj) => obj.uid === currentUser.uid).status =\r\n      \"added\";\r\n\r\n    firestore.collection(\"users\").doc(currentUser.uid).update({\r\n      friends: friendsList,\r\n    });\r\n    firestore.collection(\"users\").doc(uid).update({\r\n      friends: otherUserFriendList,\r\n    });\r\n\r\n    setFriendRequests((arrOfReqs) => arrOfReqs.filter((el) => el.uid !== uid));\r\n  }\r\n\r\n  function rejectFriend(uid) {\r\n    const friendsList = currentUser.friends.filter((obj) => obj.uid !== uid);\r\n    firestore\r\n      .collection(\"users\")\r\n      .doc(uid)\r\n      .get()\r\n      .then((res) => {\r\n        const otherUserFriendList = res\r\n          .data()\r\n          .friends.filter((obj) => obj.uid !== currentUser.uid);\r\n        firestore.collection(\"users\").doc(currentUser.uid).update({\r\n          friends: friendsList,\r\n        });\r\n        firestore.collection(\"users\").doc(uid).update({\r\n          friends: otherUserFriendList,\r\n        });\r\n        setFriendRequests((arrOfReqs) =>\r\n          arrOfReqs.filter((el) => el.uid !== uid)\r\n        );\r\n      });\r\n  }\r\n\r\n  return [friendRequests, addFriend, rejectFriend];\r\n};\r\n\r\nexport default useFriendRequest;\r\n","import React from \"react\";\r\nimport { FriendRequestItem } from \"../atoms/friend-request-item\";\r\nimport useFriendRequest from \"../../lib/hooks/use-friend-request\";\r\n\r\nexport const FriendRequest = () => {\r\n  const [friendRequests, addFriend, rejectFriend] = useFriendRequest();\r\n\r\n  return (\r\n    <>\r\n      {friendRequests.map((person, index) => {\r\n        return (\r\n          <FriendRequestItem\r\n            person={person}\r\n            key={index}\r\n            addFriend={addFriend}\r\n            rejectFriend={rejectFriend}\r\n          />\r\n        );\r\n      })}\r\n    </>\r\n  );\r\n};\r\n","export default function findIfSongIsNew(song){\r\n\tconst songReleaseDate = new Date(song.releaseDate)\r\n\t//1 814 400 000 - 3 weeks\r\n\tif((new Date().getTime() - songReleaseDate.getTime()) < 1814400000) return true\r\n\r\n\treturn false\r\n}","import React, { useEffect, useState } from \"react\";\r\nimport { SongList } from \"../../../../components/Lists/SongList\";\r\nimport findIfSongIsNew from \"../../../../functions/find/findIfSongIsNew\";\r\nimport { fetchItemList } from \"../../../../shared/lib/fetch-item-list\";\r\n\r\nexport const TopSongs = ({ authorId, authorsData, headerColors }) => {\r\n  const [popularSongs, setPopularSongs] = useState([]);\r\n  const [newSongs, setNewSongs] = useState([]);\r\n\r\n  async function findAuthorsSongs() {\r\n    if (authorsData.isAuthor) {\r\n      fetchItemList(authorsData.ownSongs, \"songs\", setPopularSongs, (res) => {\r\n        res.forEach((songData) => {\r\n          if (findIfSongIsNew(songData) && !newSongs.includes(songData))\r\n            setNewSongs((prevSongs) => [...prevSongs, songData]);\r\n        });\r\n        return res.sort((a, b) => b.listens - a.listens);\r\n      });\r\n    } else {\r\n      fetchItemList(\r\n        authorsData.addedSongs.slice(0).reverse(),\r\n        \"songs\",\r\n        setPopularSongs\r\n      );\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    findAuthorsSongs();\r\n    setNewSongs([]);\r\n  }, [authorsData.ownSongs]);\r\n\r\n  return authorsData.isAuthor ? (\r\n    <div className=\"TopSongs\">\r\n      <SongList\r\n        listOfSongs={newSongs}\r\n        source={{\r\n          source: `/authors/${authorsData.uid}`,\r\n          name: authorsData.displayName,\r\n          image: authorsData.photoURL,\r\n          songsList: newSongs,\r\n        }}\r\n        isNewSong\r\n      />\r\n      <SongList\r\n        listOfSongs={popularSongs}\r\n        source={{\r\n          source: `/authors/${authorsData.uid}`,\r\n          name: authorsData.displayName,\r\n          image: authorsData.photoURL,\r\n          songsList: popularSongs,\r\n        }}\r\n        title={\"Popular Songs\"}\r\n        showListens\r\n        showCount\r\n        isHorizontal\r\n      />\r\n    </div>\r\n  ) : (\r\n    <SongList\r\n      listOfSongs={popularSongs}\r\n      source={{\r\n        source: `/authors/${authorsData.uid}`,\r\n        name: authorsData.displayName + \"'s Library\",\r\n        image: authorsData.photoURL,\r\n        songsList: popularSongs,\r\n      }}\r\n      title={authorsData.displayName + \"'s Library\"}\r\n      showListens\r\n      showCount\r\n      isHorizontal\r\n    />\r\n  );\r\n};\r\n","import { firestore } from \"../../firebase\"\r\n\r\nfunction findSimilarArtistsNames(authorsSongsArr, authorsData, setSimilarAuthors) {\r\n\tlet peopleArray = []\r\n\tauthorsSongsArr.forEach((song) => {\r\n\t\tlet newAuthors = song.authors\r\n\t\tif (newAuthors.length !== 0) {\r\n\t\t\tpeopleArray.push(newAuthors)\r\n\t\t}\r\n\t})\r\n\tpeopleArray = peopleArray.flat()\r\n\tconst uniqueAuthorsSet = new Set(peopleArray.map(people=>people.uid).filter(id=>id!==authorsData.uid))\r\n\tconst uniqueAuthorsIdsArray = Array.from(uniqueAuthorsSet)\r\n\tconst uniqueAuthorsDataArray = []\r\n\tfor (let i = 0; i < uniqueAuthorsIdsArray.length; i++) {\r\n\t\tfor (let j = 0; j < peopleArray.length; j++) {\r\n\t\t\tif(uniqueAuthorsIdsArray[i] === peopleArray[j].uid){\r\n\t\t\t\tuniqueAuthorsDataArray.push(peopleArray[j])\r\n\t\t\t\tbreak\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\r\n\t}\r\n\tsetSimilarAuthors(uniqueAuthorsDataArray)\r\n\treturn uniqueAuthorsDataArray\r\n}\r\n\r\nexport default async function findSimilarArtists(authorsData, setSimilarAuthors) {\r\n\tif (authorsData !== undefined && authorsData.ownSongs !== undefined && authorsData.ownSongs.length !== 0) {\r\n\t\tconst authorsSongsArray = []\r\n\t\tauthorsData.ownSongs.forEach(async (songId, index)=>{\r\n\t\t\tconst songData = (await firestore.collection('songs').doc(songId).get()).data()\r\n\t\t\tauthorsSongsArray.push(songData)\r\n\t\t\tif(index === authorsData.ownSongs.length - 1){\r\n\t\t\t\treturn findSimilarArtistsNames(authorsSongsArray, authorsData, setSimilarAuthors)\r\n\t\t\t}\r\n\t\t})\r\n\r\n\r\n\t}\r\n}\r\n\r\n\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { AuthorsList } from \"../../../../components/Lists/AuthorsList\";\r\nimport findSimilarArtists from \"../../../../shared/lib/find-similar-artists\";\r\n\r\nexport const SimilarArtists = ({ data }) => {\r\n  const [similarArtists, setSimilarArtists] = useState([]);\r\n\r\n  useEffect(() => {\r\n    findSimilarArtists(data, setSimilarArtists);\r\n  }, [data]);\r\n  return (\r\n    <AuthorsList listOfAuthors={similarArtists} title={\"Similar Authors\"} />\r\n  );\r\n};\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { useRouteMatch } from \"react-router\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport { AddWindow } from \"../../components/AdminAndAuthor/AddWindow\";\r\nimport { Header } from \"../../components/AuthorPage/Header\";\r\nimport { PersonTinyList } from \"../../components/AuthorPage/PersonTinyList\";\r\nimport { Playlists } from \"../../components/AuthorPage/Playlists\";\r\nimport { ContentContainer } from \"../../components/Containers/ContentContainer\";\r\nimport { LoadingCircle } from \"../../components/Loading/LoadingCircle\";\r\nimport { useAuth } from \"../../contexts/AuthContext\";\r\nimport { useModal } from \"../../contexts/ModalContext\";\r\nimport { FriendRequest } from \"../../features/author/ui/molecules/friend-request\";\r\nimport { TopSongs } from \"../../features/author/ui/molecules/top-songs\";\r\nimport { SimilarArtists } from \"../../features/author/ui/organisms/similar-artists\";\r\nimport { firestore } from \"../../firebase\";\r\nimport \"../../styles/AuthorPage.css\";\r\n\r\nconst AuthorPage = () => {\r\n  const match = useRouteMatch(\"/authors/:authorId\");\r\n  const { currentUser } = useAuth();\r\n  const [headerColors, setHeaderColors] = useState([]);\r\n  const { authorId } = match.params;\r\n  const [authorsData, setAuthorsData] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const history = useHistory();\r\n  const { openBottomMessage } = useModal();\r\n  async function fetchAuthorsData() {\r\n    const response = firestore.collection(\"users\").doc(authorId);\r\n    response\r\n      .get()\r\n      .then((doc) => {\r\n        if (doc.exists) {\r\n          setAuthorsData(doc.data());\r\n          setHeaderColors(doc.data().imageColors);\r\n          setLoading(false);\r\n        } else {\r\n          history.push(\"/not-found\");\r\n        }\r\n      })\r\n      .catch((error) => {\r\n        openBottomMessage(\"Failed to load author's data\", \"failure\");\r\n      });\r\n  }\r\n\r\n  useEffect(() => {\r\n    fetchAuthorsData();\r\n  }, [authorId]);\r\n  return (\r\n    <>\r\n      <div className=\"AuthorPage\" style={{ animation: \"zoomIn .2s forwards\" }}>\r\n        {loading ? (\r\n          <LoadingCircle />\r\n        ) : (\r\n          <>\r\n            <Header\r\n              data={authorsData}\r\n              headerColors={headerColors}\r\n              setHeaderColors={setHeaderColors}\r\n            />\r\n            <ContentContainer\r\n              style={{\r\n                display: \"flex\",\r\n                flexDirection: \"column\",\r\n                minHeight: \"100%\",\r\n                borderRadius: \"25px 25px 0 0\",\r\n                flex: \"auto\",\r\n                position: \"relative\",\r\n                overflow: \"hidden\",\r\n                boxShadow: \"0px 0px 100px #060606\",\r\n              }}\r\n            >\r\n              <div\r\n                className=\"content-background\"\r\n                style={{\r\n                  background: `linear-gradient(360deg, black, ${headerColors[0]})`,\r\n                }}\r\n              ></div>\r\n              {currentUser.uid === authorsData.uid ? <FriendRequest /> : null}\r\n              <AddWindow data={authorsData} />\r\n              <TopSongs\r\n                author={authorId}\r\n                authorsData={authorsData}\r\n                headerColors={headerColors}\r\n              />\r\n              {authorsData.friends && !authorsData.isAuthor && (\r\n                <PersonTinyList data={authorsData} title={\"Friends\"} />\r\n              )}\r\n              <Playlists\r\n                authorsData={authorsData}\r\n                headerColors={headerColors}\r\n              />\r\n              {authorsData.isAuthor ? (\r\n                <SimilarArtists data={authorsData} />\r\n              ) : null}\r\n            </ContentContainer>\r\n          </>\r\n        )}\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default AuthorPage;\r\n","import React from \"react\";\r\nexport const AmountOfUnseenMessages = ({ amountOfUnseen }) => {\r\n  return (\r\n    amountOfUnseen !== 0 && (\r\n      <div className=\"AmountOfUnseenMessages\">{amountOfUnseen}</div>\r\n    )\r\n  );\r\n};\r\n","import React from 'react'\r\n\r\nexport const SeenByCircle = ({listOfSeen}) => {\r\n\treturn (\r\n\t\t<div className = \"SeenByCircle\" style = {listOfSeen !== undefined? listOfSeen.length <= 1?{opacity:'1', visibility:'visible'}:{}:null}></div>\r\n\t)\r\n}\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { firestore } from \"../../../../firebase\";\r\nimport { useAuth } from \"../../../../contexts/AuthContext\";\r\nimport { SmallImages } from \"../../../../components/AuthorPage/SmallImages\";\r\nexport const TypingAnimation = ({ typingPeople }) => {\r\n  const [typingPeopleData, setTypingPeopleData] = useState([]);\r\n  const { currentUser } = useAuth();\r\n  useEffect(() => {\r\n    setTypingPeopleData([]);\r\n    typingPeople.map(async (personId) => {\r\n      const personData = (\r\n        await firestore.collection(\"users\").doc(personId).get()\r\n      ).data();\r\n      if (personData.uid !== currentUser.uid)\r\n        setTypingPeopleData((prev) => [...prev, personData]);\r\n    });\r\n  }, [typingPeople]);\r\n  return typingPeopleData.length > 0 ? (\r\n    <div className=\"typingWrapper\">\r\n      <SmallImages\r\n        imagesList={typingPeopleData.map((person) => person.photoURL)}\r\n        borderColor={\"var(--navItemColor)\"}\r\n      />\r\n      <div className=\"TypingAnimation\">\r\n        <span className=\"typingCircle\"></span>\r\n        <span className=\"typingCircle\"></span>\r\n        <span className=\"typingCircle\"></span>\r\n      </div>\r\n    </div>\r\n  ) : null;\r\n};\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { BiAlbum } from \"react-icons/bi\";\r\nimport { BsDot } from \"react-icons/bs\";\r\nimport { FiMusic, FiUser } from \"react-icons/fi\";\r\nimport { useAuth } from \"../../../../contexts/AuthContext\";\r\nimport { SeenByCircle } from \"../../../dialogue/ui/atoms/seen-by-circle\";\r\nimport { firestore } from \"../../../../firebase\";\r\nimport { TypingAnimation } from \"../../../dialogue/ui/atoms/typing-animation\";\r\nimport getShortString from \"../../../../shared/lib/get-short-string\";\r\n\r\nexport const LastSentMessage = ({\r\n  sender,\r\n  isGroup,\r\n  message,\r\n  showUnseenCircle = false,\r\n  messageLen = 30,\r\n  chatId,\r\n  typing = false,\r\n}) => {\r\n  const { currentUser } = useAuth();\r\n  const [lastAttachedItem, setLastAttachedItem] = useState(\"\");\r\n  const [shouldPutDot, setShouldPutDot] = useState(false);\r\n  const [lastMessage, setLastMessage] = useState(\"\");\r\n  const messageIcons = [null, <FiMusic />, <BiAlbum />, <FiUser />];\r\n  const [lastIcon, setLastIcon] = useState(0);\r\n\r\n  async function findWhatToWriteUnderName() {\r\n    setLastMessage(\"\");\r\n    if (message !== undefined) {\r\n      const lastAttachedItem = message;\r\n      setLastMessage((str) => (str += lastAttachedItem.message));\r\n      setShouldPutDot(lastAttachedItem.message.length !== 0);\r\n      if (lastAttachedItem.attachedSongs.length) {\r\n        const songName = (\r\n          await firestore\r\n            .collection(\"songs\")\r\n            .doc(lastAttachedItem.attachedSongs[0])\r\n            .get()\r\n        ).data().name;\r\n        setLastIcon(1);\r\n        setLastAttachedItem((str) => (str += songName));\r\n      }\r\n      if (lastAttachedItem.attachedAlbums.length) {\r\n        const playlistName = await firestore\r\n          .collection(\"playlists\")\r\n          .doc(lastAttachedItem.attachedAlbums[0])\r\n          .get();\r\n        if (playlistName.exists)\r\n          setLastAttachedItem((str) => (str += playlistName.data().name));\r\n        else setLastAttachedItem((str) => (str += \"Deleted Album \"));\r\n        setLastIcon(2);\r\n      }\r\n      if (lastAttachedItem.attachedAuthors.length) {\r\n        const authorName = (\r\n          await firestore\r\n            .collection(\"users\")\r\n            .doc(lastAttachedItem.attachedAuthors[0])\r\n            .get()\r\n        ).data().displayName;\r\n        setLastIcon(3);\r\n        setLastAttachedItem((str) => (str += authorName));\r\n      }\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    findWhatToWriteUnderName();\r\n  }, [message.id]);\r\n  return !typing ? (\r\n    <div className=\"messageShowOutside\">\r\n      <span\r\n        style={\r\n          message.sender === currentUser.uid || (!!sender && isGroup)\r\n            ? { marginRight: \"5px\" }\r\n            : {}\r\n        }\r\n      >\r\n        {\" \"}\r\n        {`${\r\n          message.sender === currentUser.uid\r\n            ? \"You: \"\r\n            : isGroup\r\n            ? sender\r\n              ? sender.displayName + \": \"\r\n              : \"\"\r\n            : \"\"\r\n        }`}\r\n      </span>\r\n      {getShortString(lastMessage, messageLen)}\r\n      {shouldPutDot && lastAttachedItem.length ? <BsDot /> : null}\r\n      {messageIcons[lastIcon]}\r\n      {lastAttachedItem}\r\n      {showUnseenCircle && <SeenByCircle listOfSeen={message.seenBy} />}\r\n    </div>\r\n  ) : (\r\n    <TypingAnimation typingPeople={[sender.uid]} />\r\n  );\r\n};\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { useAuth } from \"../../../../contexts/AuthContext\";\r\nimport { AmountOfUnseenMessages } from \"../atoms/amount-of-unseen-messages\";\r\nimport { firestore } from \"../../../../firebase\";\r\nimport displayDate from \"../../../../functions/display/displayDate\";\r\nimport { IsUserOnlineCircle } from \"../../../../components/Basic/IsUserOnlineCircle\";\r\nimport { LastSentMessage } from \"../molecules/last-sent-message\";\r\nimport { amountOfUnseenMessages } from \"../../lib/amount-of-unseen-messages\";\r\n\r\nexport const ChatItem = ({ chatData }) => {\r\n  const { currentUser } = useAuth();\r\n  const { chatName, chatImage, participants } = chatData;\r\n  const [otherPerson, setOtherPerson] = useState({});\r\n  const [amountOfUnseen, setAmountOfUnseen] = useState(0);\r\n  const [messages, setMessages] = useState(chatData.messages);\r\n  const [typing, setTyping] = useState(false);\r\n\r\n  useEffect(() => {\r\n    firestore\r\n      .collection(\"chats\")\r\n      .doc(chatData.id)\r\n      .onSnapshot((snapshot) => {\r\n        setMessages(snapshot.data().messages);\r\n        setTyping(!!snapshot.data().typing.length);\r\n      });\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    setAmountOfUnseen(amountOfUnseenMessages(messages, currentUser));\r\n  }, []);\r\n\r\n  async function fetchOtherPerson() {\r\n    if (!chatName) {\r\n      const otherPersonId = participants.find(\r\n        (personId) => personId !== currentUser.uid\r\n      );\r\n      const person = (\r\n        await firestore.collection(\"users\").doc(otherPersonId).get()\r\n      ).data();\r\n      setOtherPerson(person);\r\n    } else {\r\n      const otherPersonId = messages[messages.length - 1]?.sender;\r\n      const person = (\r\n        await firestore.collection(\"users\").doc(otherPersonId).get()\r\n      ).data();\r\n      setOtherPerson(person);\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    fetchOtherPerson();\r\n  }, []);\r\n  return chatData ? (\r\n    <Link to={`/chat/${chatData.id}`}>\r\n      <div className={\"ChatItem \" + (amountOfUnseen > 0 ? \"unseen\" : \"\")}>\r\n        <div className=\"chatItemImage\">\r\n          <img loading=\"lazy\" src={chatImage || otherPerson.photoURL} alt=\"\" />\r\n        </div>\r\n        {!chatName && <IsUserOnlineCircle userUID={otherPerson.uid} />}\r\n        <div style={{ width: \"100%\" }}>\r\n          <h4\r\n            style={{\r\n              display: \"flex\",\r\n              justifyContent: \"space-between\",\r\n              width: \"100%\",\r\n            }}\r\n          >\r\n            <span>{chatName || otherPerson.displayName}</span>\r\n            <div>\r\n              {messages.length ? (\r\n                <span\r\n                  style={{ opacity: \".6\", fontWeight: \"500\", fontSize: \".8em\" }}\r\n                >\r\n                  {displayDate(\r\n                    messages[messages.length - 1].sentTime,\r\n                    chatData &&\r\n                      Date.now() -\r\n                        new Date(\r\n                          messages[messages.length - 1].sentTime\r\n                        ).getTime() >\r\n                        86000000\r\n                      ? 0\r\n                      : 2\r\n                  )}\r\n                </span>\r\n              ) : null}\r\n              <AmountOfUnseenMessages amountOfUnseen={amountOfUnseen} />\r\n            </div>\r\n          </h4>\r\n          {messages.length ? (\r\n            <p\r\n              style={\r\n                messages[messages.length - 1].sender !== currentUser.uid\r\n                  ? { color: \"#fff\" }\r\n                  : {}\r\n              }\r\n            >\r\n              {\r\n                <LastSentMessage\r\n                  sender={otherPerson}\r\n                  isGroup={chatName.length}\r\n                  message={messages[messages.length - 1]}\r\n                  showUnseenCircle\r\n                  typing={typing}\r\n                />\r\n              }\r\n            </p>\r\n          ) : null}\r\n        </div>\r\n      </div>\r\n    </Link>\r\n  ) : null;\r\n};\r\n","import { useEffect, useState } from \"react\";\r\nimport { useHistory } from \"react-router\";\r\nimport { useAuth } from \"../../../../contexts/AuthContext\";\r\nimport { useModal } from \"../../../../contexts/ModalContext\";\r\nimport { useSong } from \"../../../../contexts/SongContext\";\r\nimport getUID from \"../../../../functions/other/getUID\";\r\nimport { createChat } from \"../../../../shared/lib/create-—Åhat\";\r\nimport { findChatURL } from \"../../../../shared/lib/find-chat-url\";\r\n\r\nconst useCreateChat = () => {\r\n  const { currentUser } = useAuth();\r\n  const { toggleModal } = useModal();\r\n  const { yourFriends } = useSong();\r\n  const [searchValue, setSearchValue] = useState(\"\");\r\n  const [foundFriends, setFoundFriends] = useState(yourFriends);\r\n  const [chosenFriends, setChosenFriends] = useState([]);\r\n  const [chatCover, setChatCover] = useState(\"\");\r\n  const [chatName, setChatName] = useState(\"\");\r\n  const [errorMessage, setErrorMessage] = useState(\"\");\r\n  const chatId = getUID();\r\n  const history = useHistory();\r\n  const [shouldCreate, setShouldCreate] = useState(false);\r\n  const [friendChatId, setFriendChatId] = useState(0);\r\n  const [allowedToCreate, setAllowedToCreate] = useState(false);\r\n  useEffect(() => {\r\n    if (chosenFriends.length >= 1) {\r\n      findChatURL(chosenFriends, currentUser, setShouldCreate, setFriendChatId);\r\n    }\r\n  }, [chosenFriends]);\r\n\r\n  useEffect(() => {\r\n    if (chatName.length === 0 || chosenFriends.length === 0) {\r\n      setAllowedToCreate(false);\r\n    } else setAllowedToCreate(true);\r\n    setErrorMessage(\"\");\r\n  }, [chosenFriends.length, chatName]);\r\n\r\n  const handleCreateChat = () => {\r\n    if (shouldCreate) {\r\n      if (allowedToCreate) {\r\n        createChat(\r\n          [currentUser.uid, ...chosenFriends],\r\n          chatId,\r\n          chatName,\r\n          chatCover,\r\n          [currentUser.uid]\r\n        ).then(() => {\r\n          history.push(`/chat/${chatId}`);\r\n          toggleModal();\r\n        });\r\n      } else setErrorMessage(\"Chat has to have a name\");\r\n    } else {\r\n      history.push(`/chat/${friendChatId}`);\r\n      toggleModal();\r\n    }\r\n  };\r\n\r\n  return {\r\n    searchValue,\r\n    setSearchValue,\r\n    foundFriends,\r\n    setFoundFriends,\r\n    chosenFriends,\r\n    setChosenFriends,\r\n    chatName,\r\n    setChatName,\r\n    setChatCover,\r\n    handleCreateChat,\r\n    shouldCreate,\r\n    allowedToCreate,\r\n  };\r\n};\r\n\r\nexport default useCreateChat;\r\n","import React from \"react\";\r\nimport { TinyPersonsList } from \"../../../../components/Lists/TinyPersonsList\";\r\nimport DownloadButton from \"../../../../shared/ui/atoms/download-button\";\r\nimport Input from \"../../../../shared/ui/atoms/input\";\r\nimport SubmitButton from \"../../../../shared/ui/atoms/submit-button\";\r\nimport SearchBar from \"../../../../shared/ui/organisms/search-bar\";\r\nimport useCreateChat from \"../../lib/hooks/use-create-chat\";\r\n\r\nexport const CreateChat = () => {\r\n  const {\r\n    searchValue,\r\n    setSearchValue,\r\n    foundFriends,\r\n    setFoundFriends,\r\n    chosenFriends,\r\n    setChosenFriends,\r\n    chatName,\r\n    setChatName,\r\n    setChatCover,\r\n    handleCreateChat,\r\n    shouldCreate,\r\n    allowedToCreate,\r\n  } = useCreateChat();\r\n\r\n  return (\r\n    <div className=\"CreateChat\">\r\n      <SearchBar\r\n        value={searchValue}\r\n        setValue={setSearchValue}\r\n        setResultAuthorList={setFoundFriends}\r\n        focus\r\n        inputText={\"Search for friends\"}\r\n        defaultSearchMode={\"authors\"}\r\n      />\r\n      <TinyPersonsList\r\n        listOfPeople={foundFriends}\r\n        chosenArray={chosenFriends}\r\n        setChosenArray={setChosenFriends}\r\n        lastSeen\r\n      />\r\n      {chosenFriends.length > 1 && shouldCreate && (\r\n        <>\r\n          <Input\r\n            title=\"Chat name\"\r\n            value={chatName}\r\n            setValue={setChatName}\r\n            placeholder=\"Enter chat name\"\r\n          />\r\n          <DownloadButton\r\n            title={\"Chat image\"}\r\n            text={\"Download chat image\"}\r\n            place={\"chatCovers/\"}\r\n            setItemSrc={setChatCover}\r\n            setImageLocalPath={() => null}\r\n          />\r\n        </>\r\n      )}\r\n      <SubmitButton\r\n        text={shouldCreate ? \"Create Chat\" : \"Go to chat\"}\r\n        action={handleCreateChat}\r\n        isActive={\r\n          chosenFriends.length > 0 &&\r\n          ((shouldCreate && allowedToCreate) || !shouldCreate)\r\n        }\r\n      />\r\n    </div>\r\n  );\r\n};\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { FiPlus } from \"react-icons/fi\";\r\nimport { ContentContainer } from \"../../components/Containers/ContentContainer\";\r\nimport { LoadingCircle } from \"../../components/Loading/LoadingCircle\";\r\nimport { useAuth } from \"../../contexts/AuthContext\";\r\nimport { useModal } from \"../../contexts/ModalContext\";\r\nimport { ChatItem } from \"../../features/chats/ui/organisms/chat-item\";\r\nimport { CreateChat } from \"../../features/chats/ui/organisms/create-chat\";\r\nimport { fetchItemList } from \"../../shared/lib/fetch-item-list\";\r\nimport \"../../styles/ChatPage.css\";\r\n\r\nconst ChatPage = () => {\r\n  const [yourChats, setYourChats] = useState([]);\r\n  const { toggleModal, setContent } = useModal();\r\n  const { currentUser } = useAuth();\r\n  const [loading, setLoading] = useState(true);\r\n  useEffect(() => {\r\n    fetchItemList(\r\n      currentUser.chats,\r\n      \"chats\",\r\n      setYourChats,\r\n      (res) =>\r\n        res.sort((a, b) => {\r\n          if (a.messages.length && b.messages.length) {\r\n            return (\r\n              new Date(b.messages[b.messages.length - 1].sentTime).getTime() -\r\n              new Date(a.messages[a.messages.length - 1].sentTime).getTime()\r\n            );\r\n          }\r\n        }),\r\n      () => setLoading(false)\r\n    );\r\n  }, []);\r\n\r\n  return (\r\n    <div style={{ animation: \"zoomIn .2s forwards\", minHeight: \"100%\" }}>\r\n      <ContentContainer>\r\n        <div\r\n          style={{\r\n            marginBottom: \"10px\",\r\n            display: \"flex\",\r\n            alignItems: \"start\",\r\n            width: \"100%\",\r\n          }}\r\n        >\r\n          <button\r\n            className=\"standartButton\"\r\n            onClick={() => {\r\n              toggleModal();\r\n              setContent(<CreateChat />);\r\n            }}\r\n          >\r\n            <FiPlus />\r\n            Create chat\r\n          </button>\r\n        </div>\r\n        {loading ? (\r\n          <LoadingCircle />\r\n        ) : (\r\n          <div className=\"chatsWrapper\">\r\n            {yourChats.length ? (\r\n              yourChats.map((chat, index) => {\r\n                return <ChatItem chatData={chat} key={index} />;\r\n              })\r\n            ) : (\r\n              <h3>No chats</h3>\r\n            )}\r\n          </div>\r\n        )}\r\n      </ContentContainer>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ChatPage;\r\n","import React from \"react\";\r\nimport displayDate from \"../../../../functions/display/displayDate\";\r\n\r\nexport const DateOnTop = ({ date }) => {\r\n  return <div className=\"DateOnTop\">{displayDate(date)}</div>;\r\n};\r\n","import React, { useEffect, useState } from 'react'\r\nimport { useAuth } from '../../../../contexts/AuthContext';\r\nimport { useModal } from '../../../../contexts/ModalContext';\r\nimport { firestore } from '../../../../firebase';\r\n\r\nconst useChatHeader = (data) => {\r\n\tconst { currentUser } = useAuth();\r\n\r\n\tconst [otherPerson, setOtherPerson] = useState({});\r\n\tconst [headerColors, setHeaderColors] = useState(\r\n\t\t!!data.chatName ? [] : data.imageColors\r\n\t);\r\n\tasync function fetchOtherPerson() {\r\n\t\tconst otherPersonId = data.participants.find(\r\n\t\t\t(personId) => personId !== currentUser.uid\r\n\t\t);\r\n\t\tconst person = (\r\n\t\t\tawait firestore.collection(\"users\").doc(otherPersonId).get()\r\n\t\t).data();\r\n\t\tsetOtherPerson(person);\r\n\t\tsetHeaderColors(person.imageColors);\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!data.chatName.length) {\r\n\t\t\tfetchOtherPerson();\r\n\t\t}\r\n\t}, [data.id]);\r\n\r\n\treturn [otherPerson, headerColors]\r\n}\r\n\r\nexport default useChatHeader\r\n","import { firestore } from \"../../../firebase\"\r\nimport { sendMessage } from \"../../../functions/other/sendMessage\"\r\n\r\nconst leaveChat = async (chatId, user) => {\r\n\tconst chatData = (await firestore.collection('chats').doc(chatId).get()).data()\r\n\r\n\tconst newParticipants = chatData.participants.filter((participantId) => participantId !== user.uid)\r\n\tsendMessage(chatId, chatData, \"soundbubble\", `${user.displayName} left the chat`)\r\n\tfirestore.collection('chats').doc(chatId).update({\r\n\t\tparticipants: newParticipants\r\n\t})\r\n}\r\n\r\nexport default leaveChat","import React from \"react\";\r\nimport { FiLogOut, FiX } from \"react-icons/fi\";\r\nimport { Hint } from \"../../../../components/Basic/Hint\";\r\nimport { useAuth } from \"../../../../contexts/AuthContext\";\r\nimport { useModal } from \"../../../../contexts/ModalContext\";\r\nimport Button from \"../../../../shared/ui/atoms/button\";\r\nimport leaveChat from \"../../lib/leave-chat\";\r\nimport { ChatInfo } from \"../organisms/chat-info\";\r\n\r\nconst LeaveChatButton = ({ chat, user }) => {\r\n  const { currentUser } = useAuth();\r\n  const { openConfirm, closeConfirm, setContent } = useModal();\r\n  const isCurrentUserLeaving = currentUser.uid === user.uid;\r\n  return (\r\n    <>\r\n      <Hint text={isCurrentUserLeaving ? \"quit chat\" : \"kick\"} />\r\n      <Button\r\n        onClick={() =>\r\n          openConfirm(\r\n            `Are you sure you want to ${\r\n              isCurrentUserLeaving ? \"leave\" : `kick ${user.displayName} `\r\n            } from this chat?`,\r\n            \"Yes\",\r\n            \"No\",\r\n            () => {\r\n              leaveChat(chat.id, user);\r\n              closeConfirm();\r\n              setContent(<ChatInfo data={chat} />);\r\n            }\r\n          )\r\n        }\r\n        icon={isCurrentUserLeaving ? <FiLogOut /> : <FiX />}\r\n      />\r\n    </>\r\n  );\r\n};\r\n\r\nexport default LeaveChatButton;\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { AlbumList } from \"../../../../components/Lists/AlbumList\";\r\nimport { AuthorsList } from \"../../../../components/Lists/AuthorsList\";\r\nimport { SongList } from \"../../../../components/Lists/SongList\";\r\nimport { LoadingCircle } from \"../../../../components/Loading/LoadingCircle\";\r\nimport { firestore } from \"../../../../firebase\";\r\nimport { fetchItemList } from \"../../../../shared/lib/fetch-item-list\";\r\nimport { Slider } from \"../../../../shared/ui/molecules/slider\";\r\nexport const AttachmentList = ({ chatId }) => {\r\n  const [attachmentList, setAttachmentList] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [sliderCurrentPage, setSliderCurrentPage] = useState(0);\r\n  const attachmentContent = [\r\n    <SongList\r\n      listOfSongs={attachmentList}\r\n      source={{\r\n        source: `/chat/${chatId}`,\r\n        name: `Chat with ${chatId}`,\r\n        image: \"\",\r\n        songsList: attachmentList,\r\n      }}\r\n    />,\r\n    <AuthorsList listOfAuthors={attachmentList} />,\r\n    <AlbumList listOfAlbums={attachmentList} loading={loading} />,\r\n  ];\r\n  async function fetchAttachedData(attachedType, firebaseCollection) {\r\n    const chatData = await firestore.collection(\"chats\").doc(chatId).get();\r\n    chatData.data().messages.forEach((message) => {\r\n      if (message[attachedType].length > 0) {\r\n        fetchItemList(\r\n          message[attachedType],\r\n          firebaseCollection,\r\n          setAttachmentList,\r\n          (res) => res,\r\n          () => setLoading(false),\r\n          undefined,\r\n          1\r\n        );\r\n      }\r\n    });\r\n  }\r\n\r\n  useEffect(() => {\r\n    switch (sliderCurrentPage) {\r\n      case 0:\r\n        fetchAttachedData(\"attachedSongs\", \"songs\").then(() =>\r\n          setLoading(false)\r\n        );\r\n        break;\r\n      case 1:\r\n        fetchAttachedData(\"attachedAuthors\", \"users\").then(() =>\r\n          setLoading(false)\r\n        );\r\n        break;\r\n      case 2:\r\n        fetchAttachedData(\"attachedAlbums\", \"playlists\").then(() =>\r\n          setLoading(false)\r\n        );\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n  }, [sliderCurrentPage]);\r\n\r\n  useEffect(() => {\r\n    setAttachmentList([]);\r\n  }, [chatId]);\r\n\r\n  return (\r\n    <div className=\"AttachmentList\">\r\n      <Slider\r\n        pages={[\"Songs\", \"Authors\", \"Playlists\"]}\r\n        currentPage={sliderCurrentPage}\r\n        setCurrentPage={(page) => {\r\n          setSliderCurrentPage(page);\r\n          setLoading(true);\r\n          setAttachmentList([]);\r\n        }}\r\n      />\r\n      {loading ? (\r\n        <LoadingCircle />\r\n      ) : attachmentList.length > 0 ? (\r\n        attachmentContent[sliderCurrentPage]\r\n      ) : (\r\n        <h2>Nothing here</h2>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n","const filterArrayOfObjectsWithArray = (whatToFilter, withWhatToFilter, filterParametr = 'uid', isInverted = true) => {\r\n\treturn isInverted ? whatToFilter.filter(\r\n\t\t(item) => !withWhatToFilter.includes(item[filterParametr])\r\n\t) : whatToFilter.filter(\r\n\t\t(item) => withWhatToFilter.includes(item[filterParametr])\r\n\t)\r\n}\r\n\r\nexport default filterArrayOfObjectsWithArray;","import { firestore } from \"../../../firebase\"\r\nimport { sendMessage } from \"../../../functions/other/sendMessage\"\r\n\r\nconst addPeopleToChat = async (chatId, people, setLoading, setCompleted) => {\r\n\tsetLoading(true)\r\n\tsetCompleted(false)\r\n\tconst chatData = (await firestore.collection('chats').doc(chatId).get()).data()\r\n\tconst newParticipants = chatData.participants\r\n\tpeople.forEach(person => newParticipants.push(person.uid));\r\n\r\n\tfirestore.collection('chats').doc(chatId).update({\r\n\t\tparticipants: newParticipants\r\n\t})\r\n\r\n\tpeople.forEach(({ uid, chats }) => {\r\n\t\tfirestore.collection('users').doc(uid).update({\r\n\t\t\tchats: [...chats, chatId]\r\n\t\t})\r\n\t})\r\n\r\n\tsendMessage(chatId, chatData, \"soundbubble\", `${people.map(({ displayName }) => displayName)} entered the chat`)\r\n\tsetLoading(false)\r\n\tsetCompleted(true)\r\n}\r\n\r\nexport default addPeopleToChat","import React, { useState } from \"react\";\r\nimport { TinyPersonsList } from \"../../../../components/Lists/TinyPersonsList\";\r\nimport { useSong } from \"../../../../contexts/SongContext\";\r\nimport filterArrayWithArray from \"../../../../functions/other/filterArrayWithArray\";\r\nimport filterArrayOfObjectsWithArray from \"../../../../shared/lib/filter-array-of-objects-with-array\";\r\nimport SubmitButton from \"../../../../shared/ui/atoms/submit-button\";\r\nimport SearchBar from \"../../../../shared/ui/organisms/search-bar\";\r\nimport addPeopleToChat from \"../../lib/add-people-to-chat\";\r\n\r\nconst AddPeopleToChat = ({ chat }) => {\r\n  const { yourFriends } = useSong();\r\n  const [searchValue, setSearchValue] = useState(\"\");\r\n  const [foundFriends, setFoundFriends] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [completed, setCompleted] = useState(false);\r\n  const filteredFriends = filterArrayOfObjectsWithArray(\r\n    yourFriends,\r\n    chat.participants\r\n  );\r\n  const [chosenFriends, setChosenFriends] = useState([]);\r\n  return (\r\n    <div>\r\n      <SearchBar\r\n        value={searchValue}\r\n        setValue={setSearchValue}\r\n        setResultAuthorList={setFoundFriends}\r\n        defaultSearchMode=\"authors\"\r\n        defaultAuthorsListValue={filteredFriends}\r\n      />\r\n      <TinyPersonsList\r\n        listOfPeople={foundFriends}\r\n        chosenArray={chosenFriends}\r\n        setChosenArray={setChosenFriends}\r\n        lastSeen\r\n      />\r\n      {!!chosenFriends.length && (\r\n        <SubmitButton\r\n          text={`Add ${chosenFriends.length} friends`}\r\n          action={() =>\r\n            addPeopleToChat(\r\n              chat.id,\r\n              filterArrayOfObjectsWithArray(\r\n                yourFriends,\r\n                chosenFriends,\r\n                \"uid\",\r\n                false\r\n              ),\r\n              setLoading,\r\n              setCompleted\r\n            )\r\n          }\r\n          isLoading={loading}\r\n          completed={completed}\r\n          setCompleted={setCompleted}\r\n          bottomMessage={`${chosenFriends.length} friends have been added to ${chat.chatName}`}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AddPeopleToChat;\r\n","import { useEffect, useState } from \"react\";\r\nimport { ColorExtractor } from \"react-color-extractor\";\r\nimport { FiSettings, FiUserPlus } from \"react-icons/fi\";\r\nimport { ImAttachment } from \"react-icons/im\";\r\nimport { MdModeEdit } from \"react-icons/md\";\r\nimport { RiVolumeUpLine } from \"react-icons/ri\";\r\nimport { PersonTiny } from \"../../../../components/Basic/PersonTiny\";\r\nimport { LoadingCircle } from \"../../../../components/Loading/LoadingCircle\";\r\nimport { useAuth } from \"../../../../contexts/AuthContext\";\r\nimport { useModal } from \"../../../../contexts/ModalContext\";\r\nimport { firestore, storage } from \"../../../../firebase\";\r\nimport { fetchItemList } from \"../../../../shared/lib/fetch-item-list\";\r\nimport getShortString from \"../../../../shared/lib/get-short-string\";\r\nimport Button from \"../../../../shared/ui/atoms/button\";\r\nimport Input from \"../../../../shared/ui/atoms/input\";\r\nimport { Slider } from \"../../../../shared/ui/molecules/slider\";\r\nimport LeaveChatButton from \"../atoms/leave-chat-button\";\r\nimport { AttachmentList } from \"../molecules/attachment-list\";\r\nimport AddPeopleToChat from \"./add-people-to-chat\";\r\n\r\nexport const ChatInfo = ({ data }) => {\r\n  const { currentUser } = useAuth();\r\n  const [participants, setParticipants] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [chatNameValue, setChatNameValue] = useState(data.chatName);\r\n  const [newChatPhoto, setNewChatPhoto] = useState(data.chatImage);\r\n  const [newImageLocalPath, setNewImageLocalPath] = useState(\"\");\r\n  const [newImageColors, setNewImageColors] = useState(data.imageColors || []);\r\n  const { setContent } = useModal();\r\n  const [participantsPage, setParticipantsPage] = useState(0);\r\n  const [showUpdateBtn, setShowUpdateBtn] = useState(false);\r\n\r\n  useEffect(() => {\r\n    setLoading(true);\r\n    fetchItemList(\r\n      data.participants,\r\n      \"users\",\r\n      setParticipants,\r\n      (res) => res,\r\n      () => setLoading(false)\r\n    );\r\n  }, [data.id]);\r\n  useEffect(() => {\r\n    if (\r\n      chatNameValue.trim() !== data.chatName.trim() ||\r\n      newChatPhoto !== data.chatImage\r\n    ) {\r\n      setShowUpdateBtn(true);\r\n    } else setShowUpdateBtn(false);\r\n  }, [chatNameValue, newChatPhoto]);\r\n\r\n  useEffect(() => {\r\n    setChatNameValue(data.chatName);\r\n  }, [data.id]);\r\n\r\n  useEffect(() => {\r\n    setChatNameValue(data.chatName);\r\n    setNewChatPhoto(data.chatImage);\r\n  }, [data.chatName, data.chatImage]);\r\n\r\n  function updateChatInfo() {\r\n    firestore.collection(\"chats\").doc(data.id).update({\r\n      chatName: chatNameValue,\r\n      chatImage: newChatPhoto,\r\n      imageColors: newImageColors,\r\n    });\r\n  }\r\n\r\n  async function onFileChange(e, place, setFunc) {\r\n    const file = e.target.files[0];\r\n    setNewImageLocalPath(URL.createObjectURL(file));\r\n    const storageRef = storage.ref();\r\n    const fileRef = storageRef.child(place + file.name);\r\n    await fileRef.put(file);\r\n    setFunc(await fileRef.getDownloadURL());\r\n  }\r\n  return (\r\n    <div className=\"ChatInfo\">\r\n      <ColorExtractor\r\n        src={newImageLocalPath}\r\n        getColors={(colors) => setNewImageColors(colors)}\r\n      />\r\n      <div className=\"chatInfoImageAndName\">\r\n        <div className=\"chatInfoImage\">\r\n          <label className=\"changePhoto\">\r\n            <MdModeEdit />\r\n            Change photo\r\n            <input\r\n              type=\"file\"\r\n              style={{ display: \"none\" }}\r\n              onChange={(e) => onFileChange(e, \"chatCovers/\", setNewChatPhoto)}\r\n            />\r\n          </label>\r\n          <img loading=\"lazy\" src={newChatPhoto} alt=\"\" />\r\n        </div>\r\n        <div>\r\n          <Input\r\n            value={chatNameValue}\r\n            setValue={setChatNameValue}\r\n            placeholder={\"Enter chat name\"}\r\n            required\r\n          />\r\n          <div className=\"chatInfoButtons\">\r\n            <button className=\"chatInfoButton\">\r\n              <FiSettings />\r\n              Settings\r\n            </button>\r\n            <button\r\n              className=\"chatInfoButton\"\r\n              onClick={() => setContent(<AttachmentList chatId={data.id} />)}\r\n            >\r\n              <ImAttachment />\r\n              {getShortString(\"Attachments\", 7)}\r\n            </button>\r\n            <button className=\"chatInfoButton\">\r\n              <RiVolumeUpLine />\r\n              Sound\r\n            </button>\r\n          </div>\r\n        </div>\r\n        {showUpdateBtn ? (\r\n          <button className=\"standartButton\" onClick={updateChatInfo}>\r\n            Update Chat\r\n          </button>\r\n        ) : null}\r\n      </div>\r\n      <div\r\n        style={{\r\n          display: \"flex\",\r\n          alignItems: \"center\",\r\n          justifyContent: \"space-between\",\r\n        }}\r\n      >\r\n        <h4>Chat participants</h4>\r\n        <Button\r\n          text={\"Add\"}\r\n          icon={<FiUserPlus />}\r\n          onClick={() => setContent(<AddPeopleToChat chat={data} />)}\r\n        />\r\n      </div>\r\n      <Slider\r\n        pages={[\"All participants\", \"Administrators\"]}\r\n        currentPage={participantsPage}\r\n        setCurrentPage={setParticipantsPage}\r\n      />\r\n      {!loading ? (\r\n        participants.map((person) => {\r\n          if (participantsPage === 1) {\r\n            if (data.admins.includes(person.uid))\r\n              return <PersonTiny data={person} key={person.uid} lastSeen />;\r\n          } else\r\n            return (\r\n              <PersonTiny\r\n                data={person}\r\n                key={person.uid}\r\n                lastSeen\r\n                rightButton={\r\n                  person.uid === currentUser.uid ? (\r\n                    <LeaveChatButton chat={data} user={currentUser} />\r\n                  ) : data.admins.includes(currentUser.uid) ? (\r\n                    <LeaveChatButton chat={data} user={person} />\r\n                  ) : null\r\n                }\r\n              />\r\n            );\r\n        })\r\n      ) : (\r\n        <LoadingCircle />\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport { firestore } from \"../../../../firebase\";\r\n\r\nexport const WallpaperItem = ({ chatId, image, currentWallpaper }) => {\r\n  function changeChatWallpaper() {\r\n    firestore.collection(\"chats\").doc(chatId).update({\r\n      wallpaper: image,\r\n    });\r\n  }\r\n\r\n  return (\r\n    <div\r\n      className={\r\n        \"WallpaperItem \" + (image === currentWallpaper ? \"active\" : \"\")\r\n      }\r\n      onClick={changeChatWallpaper}\r\n      style={\r\n        image === \"undefined\" ? { background: \"var(--playlistsColor)\" } : {}\r\n      }\r\n    >\r\n      {image !== \"undefined\" ? <img loading=\"lazy\" src={image} alt=\"\" /> : null}\r\n    </div>\r\n  );\r\n};\r\n","import React, { useState } from \"react\";\r\nimport { LoadingCircle } from \"../../../../components/Loading/LoadingCircle\";\r\nimport { useFetchFirebaseData } from \"../../../../hooks/fetchFirebaseData\";\r\nimport { WallpaperItem } from \"../atoms/wallpaper-item\";\r\n\r\nexport const Wallpapers = ({ chatId, currentWallpaper }) => {\r\n  const [wallpaperList, setWallpaperList] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  useFetchFirebaseData(\r\n    setLoading,\r\n    \"chatWallpapers\",\r\n    undefined,\r\n    setWallpaperList\r\n  );\r\n  return !loading ? (\r\n    <div className=\"Wallpapers\">\r\n      <h2>Wallpapers</h2>\r\n      <div className=\"wallpapreWrapper\">\r\n        <WallpaperItem chatId={chatId} image={\"undefined\"} />\r\n        {wallpaperList.map((wallpaper, index) => {\r\n          return (\r\n            <WallpaperItem\r\n              chatId={chatId}\r\n              image={wallpaper.image}\r\n              key={wallpaper.id}\r\n              currentWallpaper={currentWallpaper}\r\n            />\r\n          );\r\n        })}\r\n      </div>\r\n    </div>\r\n  ) : (\r\n    <LoadingCircle />\r\n  );\r\n};\r\n","import { useEffect } from 'react'\r\nimport { firestore } from '../firebase'\r\n\r\nexport const useFetchFirebaseData = (setLoading, collection, list, setState, sortCondition, whereCondFP, whereCondSP, whereCondTP, deps = []) => {\r\n\r\n\tasync function fetchData() {\r\n\t\tconst tempArray = []\r\n\t\tif (list === undefined) {\r\n\t\t\tif (whereCondFP !== undefined) {\r\n\t\t\t\tconst items = await firestore.collection(collection).where(whereCondFP, whereCondSP, whereCondTP).get()\r\n\t\t\t\titems.docs.forEach(itemData => {\r\n\t\t\t\t\ttempArray.push(itemData.data())\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\t\r\n\t\t\t\tconst items = await firestore.collection(collection).get()\r\n\t\t\t\titems.docs.forEach(itemData => {\r\n\t\t\t\t\ttempArray.push(itemData.data())\r\n\t\t\t\t\t\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tawait list.forEach(async (itemId, index) => {\r\n\t\t\t\tconst itemData = (await firestore.collection(collection).doc(itemId).get()).data()\r\n\t\t\t\ttempArray.push(itemData)\r\n\t\t\t\tif(index === list.length - 1){\r\n\t\t\t\t\tif(sortCondition !== undefined){\r\n\t\t\t\t\t\ttempArray.sort(sortCondition)\r\n\t\t\t\t\t\tsetState(tempArray)\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tsetState(tempArray)\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t})\r\n\t\t\tsetLoading(false)\r\n\t\t}\r\n\t\treturn tempArray\r\n\t}\r\n\tuseEffect(() => {\r\n\t\tsetLoading(true)\r\n\t\tsetState([])\r\n\t\tfetchData().then((res)=>{\r\n\t\t\tif(list === undefined) {\r\n\t\t\t\tsetState(res)\r\n\t\t\t\tsetLoading(false)\r\n\t\t\t}\r\n\t\t})\r\n\t}, deps)\r\n}\r\n","import React, { useRef, useState } from \"react\";\r\nimport { FiFolder, FiImage, FiInfo, FiMoreHorizontal } from \"react-icons/fi\";\r\nimport { useModal } from \"../../../../contexts/ModalContext\";\r\nimport useOutsideClick from \"../../../../shared/lib/hooks/use-outside-click\";\r\nimport { ChatInfo } from \"../organisms/chat-info\";\r\nimport { AttachmentList } from \"./attachment-list\";\r\nimport { Wallpapers } from \"./wallpapers\";\r\n\r\nexport const ChatMoreBtn = ({ chatId, currentWallpaper, data }) => {\r\n  const [openMoreWindow, setOpenMoreWindow] = useState();\r\n  const { toggleModal, setContent } = useModal();\r\n  const chatMoreBtnRef = useRef(null);\r\n  useOutsideClick(chatMoreBtnRef, setOpenMoreWindow);\r\n  return (\r\n    <div className=\"ChatMoreBtn\" ref={chatMoreBtnRef}>\r\n      <button onClick={() => setOpenMoreWindow(!openMoreWindow)}>\r\n        <FiMoreHorizontal />\r\n      </button>\r\n      <div\r\n        className=\"chatHeaderMenuWindow\"\r\n        style={!openMoreWindow ? { display: \"none\" } : {}}\r\n      >\r\n        {data.participants.length > 2 ? (\r\n          <div\r\n            className=\"chatHeaderMenuWindowItem\"\r\n            onClick={() => {\r\n              toggleModal();\r\n              setContent(<ChatInfo data={data} />);\r\n            }}\r\n          >\r\n            <FiInfo />\r\n            <span>Info</span>\r\n          </div>\r\n        ) : null}\r\n        {/* <div className=\"chatHeaderMenuWindowItem\">\r\n\t\t\t\t\t<FiSearch/>\r\n\t\t\t\t\t<span>Search messages</span>\r\n\t\t\t\t</div> */}\r\n        <div\r\n          className=\"chatHeaderMenuWindowItem\"\r\n          onClick={() => {\r\n            toggleModal();\r\n            setContent(<AttachmentList chatId={chatId} />);\r\n          }}\r\n        >\r\n          <FiFolder />\r\n          <span>Attachments</span>\r\n        </div>\r\n        <div\r\n          className=\"chatHeaderMenuWindowItem\"\r\n          onClick={() => {\r\n            toggleModal();\r\n            setContent(\r\n              <Wallpapers chatId={chatId} currentWallpaper={currentWallpaper} />\r\n            );\r\n          }}\r\n        >\r\n          <FiImage />\r\n          <span>Change wallpaper</span>\r\n        </div>\r\n        {/* <div className=\"chatHeaderMenuWindowItem\">\r\n\t\t\t\t\t<FiTrash/>\r\n\t\t\t\t\t<span>Delete chat</span>\r\n\t\t\t\t</div> */}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { LastSeen } from \"../../../../components/Basic/LastSeen\";\r\nimport { useModal } from \"../../../../contexts/ModalContext\";\r\nimport { GoBackBtn } from \"../../../../shared/ui/atoms/go-back-button\";\r\nimport useChatHeader from \"../../lib/hooks/use-chat-header\";\r\nimport { ChatMoreBtn } from \"../molecules/chat-more-button\";\r\nimport { ChatInfo } from \"./chat-info\";\r\n\r\nexport const ChatHeader = ({ data }) => {\r\n  const { toggleModal, setContent } = useModal();\r\n  const [otherPerson, headerColors] = useChatHeader(data);\r\n\r\n  return (\r\n    <div\r\n      className=\"ChatHeader\"\r\n      style={\r\n        headerColors?.length\r\n          ? {\r\n              background: `linear-gradient(45deg, ${headerColors[0]}, ${headerColors[1]})`,\r\n            }\r\n          : {}\r\n      }\r\n    >\r\n      <GoBackBtn />\r\n      {data.chatName.length === 0 ? (\r\n        <Link\r\n          className=\"chatHeaderImageAndName\"\r\n          to={`/authors/${otherPerson.uid}`}\r\n        >\r\n          <div\r\n            className=\"chatHeaderImage\"\r\n            style={{\r\n              backgroundImage: `url(${otherPerson.photoURL || data.chatImage})`,\r\n            }}\r\n          />\r\n          <div\r\n            style={{\r\n              display: \"flex\",\r\n              flexDirection: \"column\",\r\n              justifyContent: \"center\",\r\n            }}\r\n          >\r\n            <h4>{otherPerson.displayName || data.chatName}</h4>\r\n            <LastSeen userUID={otherPerson.uid} />\r\n          </div>\r\n        </Link>\r\n      ) : (\r\n        <div\r\n          className=\"chatHeaderImageAndName\"\r\n          onClick={() => {\r\n            toggleModal();\r\n            setContent(<ChatInfo data={data} />);\r\n          }}\r\n        >\r\n          <div\r\n            className=\"chatHeaderImage\"\r\n            style={{\r\n              backgroundImage: `url(${otherPerson.photoURL || data.chatImage})`,\r\n            }}\r\n          />\r\n          <div\r\n            style={{\r\n              display: \"flex\",\r\n              flexDirection: \"column\",\r\n              justifyContent: \"center\",\r\n            }}\r\n          >\r\n            <h4>{otherPerson.displayName || data.chatName}</h4>\r\n            <LastSeen userUID={otherPerson.uid} />\r\n          </div>\r\n        </div>\r\n      )}\r\n      <ChatMoreBtn\r\n        chatId={data.id}\r\n        data={data}\r\n        currentWallpaper={data.wallpaper}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n","export function whatToWriteInResponseToItem(referedMessage) {\r\n\treturn referedMessage.attachedSongs.length ? \"Audio\" :\r\n\t\treferedMessage.attachedAlbums.length ? \"Album\" :\r\n\t\t\treferedMessage.attachedAuthors.length ? \"Author\" :\r\n\t\t\t\treferedMessage.inResponseToMessage && referedMessage.inResponseToMessage.length ? \"Forwarded message\" : \"\"\r\n}","import React from \"react\";\r\nimport { FiX } from \"react-icons/fi\";\r\nexport const AttachedItemsInChatInput = ({\r\n  attachedItems,\r\n  setAttachedItems,\r\n  icon,\r\n}) => {\r\n  function removeItemFromAttached(attachedItems, setItems, itemId) {\r\n    setItems(attachedItems.filter((id) => id !== itemId));\r\n  }\r\n  return (\r\n    <div className=\"AttachedItemsInChatInput\">\r\n      {attachedItems.map((itemId, index) => {\r\n        return (\r\n          <div className=\"attachedSongItem\" key={itemId}>\r\n            {icon}\r\n            <span>{itemId}</span>\r\n            <button\r\n              className=\"removeMessageFromResponse\"\r\n              onClick={() =>\r\n                removeItemFromAttached(attachedItems, setAttachedItems, itemId)\r\n              }\r\n            >\r\n              <FiX />\r\n            </button>\r\n          </div>\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n};\r\n","import React, { useEffect, useRef, useState } from \"react\";\r\nimport { BiAlbum } from \"react-icons/bi\";\r\nimport { CgMusicNote } from \"react-icons/cg\";\r\nimport { FiUser, FiX } from \"react-icons/fi\";\r\nimport { ImAttachment } from \"react-icons/im\";\r\nimport { MdSend } from \"react-icons/md\";\r\nimport { useAuth } from \"../../../../contexts/AuthContext\";\r\nimport { useSong } from \"../../../../contexts/SongContext\";\r\nimport { firestore } from \"../../../../firebase\";\r\nimport { whatToWriteInResponseToItem } from \"../../lib/what-to-write-in-response-item\";\r\nimport { sendMessage } from \"../../../../functions/other/sendMessage\";\r\nimport useOutsideClick from \"../../../../shared/lib/hooks/use-outside-click\";\r\nimport SearchBar from \"../../../../shared/ui/organisms/search-bar\";\r\nimport { AlbumList } from \"../../../../components/Lists/AlbumList\";\r\nimport { AuthorsList } from \"../../../../components/Lists/AuthorsList\";\r\nimport { SongList } from \"../../../../components/Lists/SongList\";\r\nimport { AttachedItemsInChatInput } from \"../molecules/attached-items-in-chat-input\";\r\nimport getShortString from \"../../../../shared/lib/get-short-string\";\r\n\r\nexport const ChatInput = ({\r\n  chatId,\r\n  chatData,\r\n  messageText,\r\n  setMessageText,\r\n  inResponseToMessage,\r\n  setInResponseToMessage,\r\n  otherMessages,\r\n}) => {\r\n  const { currentUser } = useAuth();\r\n  const [openAttachWindow, setOpenAttachWindow] = useState(false);\r\n  const { yourSongs, yourAuthors, yourPlaylists } = useSong();\r\n  const [searchValue, setSearchValue] = useState(\"\");\r\n  const [allFoundSongs, setAllFoundSongs] = useState(yourSongs);\r\n  const [attachedSongs, setAttachedSongs] = useState([]);\r\n  const [attachedAlbums, setAttachedAlbums] = useState([]);\r\n  const [attachedAuthors, setAttachedAuthors] = useState([]);\r\n  const [resultPlaylists, setResultPlaylists] = useState(yourPlaylists);\r\n  const [resultAuthorList, setResultAuthorList] = useState(yourAuthors);\r\n  const [inResponseNames, setInResponseNames] = useState([]);\r\n  const [attachedSongsNames, setAttachedSongsNames] = useState([]);\r\n  const attachWindowRef = useRef(null);\r\n  useOutsideClick(attachWindowRef, setOpenAttachWindow);\r\n\r\n  function sendMessageFull() {\r\n    sendMessage(\r\n      chatId,\r\n      chatData,\r\n      currentUser.uid,\r\n      messageText,\r\n      attachedSongs,\r\n      attachedAlbums,\r\n      attachedAuthors,\r\n      inResponseToMessage\r\n    );\r\n    setMessageText(\"\");\r\n    setAttachedSongs([]);\r\n    setAttachedAuthors([]);\r\n    setAttachedAlbums([]);\r\n    setInResponseToMessage([]);\r\n    setOpenAttachWindow(false);\r\n  }\r\n  useEffect(() => {\r\n    if (searchValue.length === 0) {\r\n      setAllFoundSongs(yourSongs);\r\n    }\r\n  }, [searchValue]);\r\n\r\n  function removeMessageFromResponseList(messageId) {\r\n    setInResponseToMessage(\r\n      inResponseToMessage.filter((id) => id !== messageId)\r\n    );\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (messageText.length === 0) {\r\n      firestore\r\n        .collection(\"chats\")\r\n        .doc(chatId)\r\n        .update({\r\n          typing: chatData.typing.filter((id) => id !== currentUser.uid),\r\n        });\r\n    } else {\r\n      if (!chatData.typing.includes(currentUser.uid)) {\r\n        const tempArray = chatData.typing;\r\n        tempArray.push(currentUser.uid);\r\n        firestore.collection(\"chats\").doc(chatId).update({\r\n          typing: tempArray,\r\n        });\r\n      }\r\n    }\r\n  }, [messageText]);\r\n\r\n  useEffect(() => {\r\n    setInResponseNames([]);\r\n    inResponseToMessage.forEach(async (id) => {\r\n      const name = (\r\n        await firestore.collection(\"users\").doc(otherMessages[id].sender).get()\r\n      ).data().displayName;\r\n      setInResponseNames((prev) => [...prev, name]);\r\n    });\r\n  }, [inResponseToMessage.length]);\r\n\r\n  useEffect(() => {\r\n    setAttachedSongsNames([]);\r\n    attachedSongs.forEach(async (id) => {\r\n      const name = (await firestore.collection(\"songs\").doc(id).get()).data()\r\n        .name;\r\n      setAttachedSongsNames((prev) => [...prev, name]);\r\n    });\r\n  }, [attachedSongs.length]);\r\n\r\n  return (\r\n    <div\r\n      className=\"chatInput\"\r\n      style={\r\n        openAttachWindow\r\n          ? {\r\n              borderRadius:\r\n                \"0 0 var(--standartBorderRadius) var(--standartBorderRadius)\",\r\n              transition: \".2s\",\r\n            }\r\n          : {}\r\n      }\r\n      ref={attachWindowRef}\r\n    >\r\n      <div\r\n        className=\"attachWindow\"\r\n        style={openAttachWindow ? { height: \"400px\", opacity: \"1\" } : {}}\r\n      >\r\n        {openAttachWindow ? (\r\n          <div\r\n            style={\r\n              openAttachWindow\r\n                ? {\r\n                    maxHeight: \"100%\",\r\n                    overflow: \"hidden\",\r\n                    display: \"flex\",\r\n                    flexDirection: \"column\",\r\n                  }\r\n                : { display: \"none\" }\r\n            }\r\n          >\r\n            <SearchBar\r\n              value={searchValue}\r\n              setValue={setSearchValue}\r\n              setAllFoundSongs={setAllFoundSongs}\r\n              setResultPlaylists={setResultPlaylists}\r\n              setResultAuthorList={setResultAuthorList}\r\n            />\r\n            <div style={{ height: \"100%\", overflowY: \"auto\" }}>\r\n              <SongList\r\n                listOfSongs={allFoundSongs}\r\n                source={\"no\"}\r\n                listOfChosenSongs={attachedSongs}\r\n                setListOfSongs={setAttachedSongs}\r\n              />\r\n              <AuthorsList\r\n                listOfAuthors={resultAuthorList}\r\n                listOfChosenAuthors={attachedAuthors}\r\n                setListOfChosenAuthors={setAttachedAuthors}\r\n              />\r\n              <AlbumList\r\n                listOfAlbums={resultPlaylists}\r\n                loading={false}\r\n                listOfChosenAlbums={attachedAlbums}\r\n                setListOfChosenAlbums={setAttachedAlbums}\r\n              />\r\n            </div>\r\n          </div>\r\n        ) : null}\r\n      </div>\r\n      <div\r\n        className=\"inResponseArea\"\r\n        style={\r\n          inResponseToMessage.length ||\r\n          attachedSongsNames.length ||\r\n          attachedAuthors.length ||\r\n          attachedAlbums.length\r\n            ? {}\r\n            : {\r\n                height: \"0\",\r\n                padding: \"0\",\r\n                opacity: \"0\",\r\n                top: \"0\",\r\n                visibility: \"hidden\",\r\n              }\r\n        }\r\n      >\r\n        <div className=\"responseMessages\">\r\n          {inResponseToMessage.map((id, index) => {\r\n            return (\r\n              <div className=\"responseItem\" key={id}>\r\n                <h5\r\n                  style={\r\n                    otherMessages[id].sender === currentUser.uid\r\n                      ? { color: \"var(--lightPurple)\" }\r\n                      : {}\r\n                  }\r\n                >\r\n                  {inResponseNames[index]}\r\n                </h5>\r\n                <p>\r\n                  {getShortString(otherMessages[id].message, 35)}\r\n                  <span\r\n                    style={{\r\n                      marginLeft: \"5px\",\r\n                      color: \"var(--reallyLightBlue)\",\r\n                    }}\r\n                  >\r\n                    {whatToWriteInResponseToItem(otherMessages[id])}\r\n                  </span>\r\n                </p>\r\n                <button\r\n                  onClick={() => removeMessageFromResponseList(id)}\r\n                  className=\"removeMessageFromResponse\"\r\n                >\r\n                  <FiX />\r\n                </button>\r\n              </div>\r\n            );\r\n          })}\r\n        </div>\r\n        <AttachedItemsInChatInput\r\n          attachedItems={attachedSongs}\r\n          setAttachedItems={setAttachedSongs}\r\n          icon={<CgMusicNote />}\r\n        />\r\n        <AttachedItemsInChatInput\r\n          attachedItems={attachedAuthors}\r\n          setAttachedItems={setAttachedAuthors}\r\n          icon={<FiUser />}\r\n        />\r\n        <AttachedItemsInChatInput\r\n          attachedItems={attachedAlbums}\r\n          setAttachedItems={setAttachedAlbums}\r\n          icon={<BiAlbum />}\r\n        />\r\n      </div>\r\n      <div className=\"attachAndEmojis\">\r\n        <div className=\"attachBtn\">\r\n          <button\r\n            onClick={() => {\r\n              setOpenAttachWindow(!openAttachWindow);\r\n            }}\r\n          >\r\n            <ImAttachment />\r\n          </button>\r\n        </div>\r\n        <input\r\n          type=\"text\"\r\n          style={{\r\n            background: \"var(--lightGrey)\",\r\n            border: \"none\",\r\n            outline: \"none\",\r\n            minHeight: \"100%\",\r\n          }}\r\n          value={messageText}\r\n          onChange={(e) => {\r\n            setMessageText(e.target.value);\r\n          }}\r\n          onKeyDown={(e) => {\r\n            if (e.key === \"Enter\") {\r\n              sendMessageFull();\r\n            }\r\n          }}\r\n        />\r\n        {/* <div className=\"emojis\">\r\n\t\t\t\t\t<div className=\"emojiItem\">\r\n\t\t\t\t\t\t<FcLike />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"emojiItem\" style={{ color: 'var(--red)' }}>\r\n\t\t\t\t\t\t<AiFillFire />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"emojiItem\" style={{ color: 'var(--lightBlue)' }}>\r\n\t\t\t\t\t\t<AiFillLike />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div> */}\r\n      </div>\r\n      <button\r\n        className=\"sendBtn\"\r\n        onClick={() => {\r\n          sendMessageFull();\r\n        }}\r\n      >\r\n        <MdSend />\r\n      </button>\r\n    </div>\r\n  );\r\n};\r\n","import { useEffect, useRef } from 'react'\r\nimport { useAuth } from '../../../../contexts/AuthContext'\r\nimport { firestore } from '../../../../firebase'\r\nimport useOnScreen from '../../../../hooks/useOnScreen'\r\n\r\nconst useMarkMessageRead = (chatId, messageData, otherMessages) => {\r\n\tconst messageRef = useRef()\r\n\tconst isVisible = useOnScreen(messageRef)\r\n\tconst { currentUser } = useAuth()\r\n\r\n\tuseEffect(() => {\r\n\t\tif (messageData.seenBy !== undefined) {\r\n\t\t\tif (currentUser.uid !== messageData.sender && isVisible) {\r\n\t\t\t\tif (!messageData.seenBy.includes(currentUser.uid)) {\r\n\t\t\t\t\tconst tempMessages = otherMessages\r\n\t\t\t\t\ttempMessages[messageData.id].seenBy.push(currentUser.uid)\r\n\t\t\t\t\tfirestore.collection('chats').doc(chatId).update({\r\n\t\t\t\t\t\tmessages: tempMessages\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}, [isVisible])\r\n\r\n\treturn [messageRef, isVisible]\r\n}\r\n\r\nexport default useMarkMessageRead\r\n","import React from 'react'\r\n\r\nexport const SongItemLoading = () => {\r\n\treturn (\r\n\t\t<div className = \"SongItem SongItemLoading\">\r\n\t\t\t<div className=\"songItemImageAndName\">\r\n\t\t\t\t<div className=\"songItemImage\"></div>\r\n\t\t\t\t<div className=\"songItemNameAndAuthor\">\r\n\t\t\t\t\t<div className=\"songItemName\"></div>\r\n\t\t\t\t\t<div className=\"songItemAuthor\"></div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t)\r\n}\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { BiShare } from \"react-icons/bi\";\r\nimport { useSwipeable } from \"react-swipeable\";\r\nimport { useAuth } from \"../../../../contexts/AuthContext\";\r\nimport { useScreen } from \"../../../../contexts/ScreenContext\";\r\nimport { AuthorItemBig } from \"../../../author/ui/molecules/author-item-big\";\r\nimport { SeenByCircle } from \"../atoms/seen-by-circle\";\r\nimport useMarkMessageRead from \"../../lib/hooks/use-mark-message-read\";\r\nimport { SongItem } from \"../../../song/ui/organisms/song-item\";\r\nimport { firestore } from \"../../../../firebase\";\r\nimport displayDate from \"../../../../functions/display/displayDate\";\r\nimport { PlaylistItem } from \"../../../../components/AuthorPage/PlaylistItem\";\r\nimport { SongItemLoading } from \"../../../../components/Loading/SongItemLoading\";\r\nimport { whatToWriteInResponseToItem } from \"../../lib/what-to-write-in-response-item\";\r\n\r\nexport const MessageItem = ({\r\n  messageData,\r\n  chatId,\r\n  scrollToMessageRef,\r\n  setScrollToMessageId,\r\n  scrollToMessageId,\r\n  showPhoto = true,\r\n  otherMessages,\r\n  inResponseToMessageArr,\r\n  setInResponseToMessageArr,\r\n}) => {\r\n  const { currentUser } = useAuth();\r\n  const { isMobile, screenHeight } = useScreen();\r\n  const {\r\n    message,\r\n    attachedAlbums,\r\n    attachedSongs,\r\n    attachedAuthors,\r\n    sender,\r\n    inResponseToMessage,\r\n    id,\r\n    sentTime,\r\n  } = messageData;\r\n  const [userThatSentMessage, setUserThatSentMessage] = useState({});\r\n  const messageSentTime = displayDate(sentTime, 2);\r\n  const [attachedSongsData, setAttachedSongsData] = useState([]);\r\n  const [attachedAuthorsData, setAttachedAuthorsData] = useState([]);\r\n  const [attachedPlaylistsData, setAttachedPlaylistsData] = useState([]);\r\n  const [inResponseToMessagesData, setInResponseToMessagesData] = useState([]);\r\n  const [inResponseNames, setInResponseNames] = useState([]);\r\n  const [messageRef, isVisible] = useMarkMessageRead(\r\n    chatId,\r\n    messageData,\r\n    otherMessages\r\n  );\r\n  const [swipeDeltaX, setSwipeDeltaX] = useState(0);\r\n  const [transformTransition, setTransformTransition] = useState(0);\r\n  const handlers = useSwipeable({\r\n    onSwiping: (event) => {\r\n      if (event.deltaX < 0) setSwipeDeltaX(event.deltaX);\r\n    },\r\n  });\r\n  const refPassthrough = (el) => {\r\n    // call useSwipeable ref prop with el\r\n    handlers.ref(el);\r\n\r\n    // set myRef el so you can access it yourself\r\n    messageRef.current = el;\r\n  };\r\n\r\n  async function fetchSentMessageUser() {\r\n    const user = (\r\n      await firestore.collection(\"users\").doc(messageData.sender).get()\r\n    ).data();\r\n    setUserThatSentMessage(user);\r\n  }\r\n\r\n  function fetchAttachedData(list, place, setFunc) {\r\n    return list.forEach(async (itemId) => {\r\n      let itemData = await firestore.collection(place).doc(itemId).get();\r\n      if (itemData.exists) setFunc((prev) => [...prev, itemData.data()]);\r\n      else setFunc((prev) => [...prev, null]);\r\n    });\r\n  }\r\n\r\n  function inResponseMessagesFetch() {\r\n    if (inResponseToMessage !== null) {\r\n      inResponseToMessage.forEach(async (messageId) => {\r\n        setInResponseToMessagesData((prev) => [\r\n          ...prev,\r\n          otherMessages[messageId],\r\n        ]);\r\n        const name = (\r\n          await firestore\r\n            .collection(\"users\")\r\n            .doc(otherMessages[messageId].sender)\r\n            .get()\r\n        ).data().displayName;\r\n        setInResponseNames((prev) => [name, ...prev]);\r\n      });\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    fetchSentMessageUser();\r\n    fetchAttachedData(attachedSongs, \"songs\", setAttachedSongsData);\r\n    fetchAttachedData(attachedAuthors, \"users\", setAttachedAuthorsData);\r\n    fetchAttachedData(attachedAlbums, \"playlists\", setAttachedPlaylistsData);\r\n    inResponseMessagesFetch();\r\n  }, []);\r\n\r\n  function addMessageToResponseList() {\r\n    if (!inResponseToMessageArr.includes(id)) {\r\n      setInResponseToMessageArr((prev) => [...prev, id]);\r\n    }\r\n  }\r\n\r\n  function returnToInitial() {\r\n    let dropDelta;\r\n    clearTimeout(dropDelta);\r\n    setTransformTransition(0.2);\r\n    dropDelta = setTimeout(() => {\r\n      setSwipeDeltaX(0);\r\n      setTransformTransition(0);\r\n    }, 200);\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (swipeDeltaX < -160) {\r\n      returnToInitial();\r\n      addMessageToResponseList();\r\n    }\r\n  }, [swipeDeltaX]);\r\n\r\n  return (\r\n    <div\r\n      className={\"MessageItem \" + (sender === currentUser.uid ? \"your\" : \"\")}\r\n      ref={id === scrollToMessageId ? scrollToMessageRef : refPassthrough}\r\n      style={\r\n        showPhoto\r\n          ? {\r\n              paddingBottom: \"15px\",\r\n              transform: `translateX(${swipeDeltaX}px)`,\r\n              transition: transformTransition,\r\n            }\r\n          : {\r\n              transform: `translateX(${swipeDeltaX}px)`,\r\n              transition: transformTransition,\r\n            }\r\n      }\r\n      onTouchEnd={returnToInitial}\r\n    >\r\n      <div className=\"messageItemImage\">\r\n        {showPhoto ? (\r\n          <img loading=\"lazy\" src={userThatSentMessage.photoURL} alt=\"\" />\r\n        ) : null}\r\n      </div>\r\n      <div\r\n        className=\"messageItemBody\"\r\n        style={\r\n          id === scrollToMessageId\r\n            ? { animation: \"showResponseMessage .5s forwards\" }\r\n            : showPhoto\r\n            ? {\r\n                borderRadius:\r\n                  \"var(--standartBorderRadius2) var(--standartBorderRadius) var(--standartBorderRadius) 5px\",\r\n              }\r\n            : {}\r\n        }\r\n      >\r\n        <div\r\n          style={{ display: \"flex\", alignItems: \"center\", marginBottom: \"5px\" }}\r\n        >\r\n          <h5 className=\"messageUserName\">{userThatSentMessage.displayName}</h5>\r\n          <div style={{ fontSize: \".7em\", opacity: \".8\", marginLeft: \"10px\" }}>\r\n            {messageSentTime}\r\n          </div>\r\n        </div>\r\n        {inResponseToMessage !== null\r\n          ? inResponseToMessagesData.map((messageData, index) => {\r\n              return (\r\n                <div\r\n                  className=\"responseItem\"\r\n                  onClick={() => setScrollToMessageId(messageData.id)}\r\n                >\r\n                  <span style={{ display: \"flex\", alignItems: \"center\" }}>\r\n                    <h5\r\n                      style={\r\n                        messageData.sender === currentUser.uid\r\n                          ? { color: \"var(--lightPurple)\" }\r\n                          : {}\r\n                      }\r\n                    >\r\n                      {inResponseNames[index]}\r\n                    </h5>\r\n                    <div\r\n                      style={{\r\n                        fontSize: \".7em\",\r\n                        opacity: \".8\",\r\n                        marginLeft: \"10px\",\r\n                      }}\r\n                    >\r\n                      {displayDate(messageData.sentTime, 2)}\r\n                    </div>\r\n                  </span>\r\n                  <p>\r\n                    {messageData.message}\r\n                    <span\r\n                      style={{\r\n                        marginLeft: \"5px\",\r\n                        color: \"var(--reallyLightBlue)\",\r\n                      }}\r\n                    >\r\n                      {whatToWriteInResponseToItem(messageData)}\r\n                    </span>\r\n                  </p>\r\n                </div>\r\n              );\r\n            })\r\n          : null}\r\n        <div>\r\n          <p>{message}</p>\r\n          {attachedSongsData.map((song, key) => {\r\n            return isVisible ? (\r\n              <SongItem\r\n                song={song}\r\n                localIndex={key}\r\n                key={key}\r\n                position={screenHeight}\r\n              />\r\n            ) : (\r\n              <SongItemLoading />\r\n            );\r\n          })}\r\n          {attachedPlaylistsData.map((album, index) => {\r\n            return <PlaylistItem playlist={album} key={index} />;\r\n          })}\r\n          {attachedAuthorsData.map((author, index) => {\r\n            return <AuthorItemBig data={author} key={index} />;\r\n          })}\r\n        </div>\r\n      </div>\r\n      <SeenByCircle listOfSeen={messageData.seenBy} />\r\n      <button\r\n        className=\"respondToMessageBtn\"\r\n        onClick={addMessageToResponseList}\r\n        style={isMobile ? { opacity: -swipeDeltaX / 80 } : {}}\r\n      >\r\n        <BiShare />\r\n      </button>\r\n    </div>\r\n  );\r\n};\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { useRef } from \"react\";\r\nimport displayDate from \"../../../../functions/display/displayDate\";\r\nimport { MessageItem } from \"../molecules/message-item\";\r\n\r\nexport const MessageField = ({\r\n  message,\r\n  index,\r\n  messageList,\r\n  chatId,\r\n  inResponseToMessage,\r\n  setInResponseToMessage,\r\n  scrollToMessageRef,\r\n  scrollToMessageId,\r\n  setScrollToMessageId,\r\n  setDateRefsArray,\r\n}) => {\r\n  const [showPhoto, setShowPhoto] = useState(false);\r\n  const [showDate, setShowDate] = useState(false);\r\n  const dateRef = useRef(null);\r\n  useEffect(() => {\r\n    if (index === messageList.length - 1) setShowPhoto(true);\r\n    else if (messageList[index + 1].sender !== messageList[index].sender)\r\n      setShowPhoto(true);\r\n    else if (\r\n      displayDate(messageList[index + 1].sentTime) !==\r\n      displayDate(messageList[index].sentTime)\r\n    )\r\n      setShowPhoto(true);\r\n\r\n    if (index === 0) setShowDate(true);\r\n    else if (\r\n      displayDate(messageList[index].sentTime) !==\r\n      displayDate(messageList[index - 1].sentTime)\r\n    ) {\r\n      setShowDate(true);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (dateRef.current !== null) {\r\n      setDateRefsArray((prev) => [...prev, dateRef]);\r\n    }\r\n  }, [showDate]);\r\n\r\n  return (\r\n    <>\r\n      {showDate ? (\r\n        <div\r\n          ref={dateRef}\r\n          style={{\r\n            width: \"100%\",\r\n            display: \"flex\",\r\n            justifyContent: \"center\",\r\n            alignItems: \"center\",\r\n            padding: \"10px 0\",\r\n          }}\r\n        >\r\n          {displayDate(message.sentTime)}\r\n        </div>\r\n      ) : null}\r\n      <MessageItem\r\n        messageData={message}\r\n        chatId={chatId}\r\n        key={message.id}\r\n        scrollToMessageRef={scrollToMessageRef}\r\n        scrollToMessageId={scrollToMessageId}\r\n        setScrollToMessageId={setScrollToMessageId}\r\n        showPhoto={showPhoto}\r\n        otherMessages={messageList}\r\n        inResponseToMessageArr={inResponseToMessage}\r\n        setInResponseToMessageArr={setInResponseToMessage}\r\n      />\r\n    </>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport styled from \"styled-components\";\r\nimport useMarkMessageRead from \"../../lib/hooks/use-mark-message-read\";\r\n\r\nconst SystemMessageWrapper = styled.div`\r\n  width: 100%;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  opacity: 0.5;\r\n`;\r\n\r\nconst SystemMessage = ({ chatId, message, messageList }) => {\r\n  const [messageRef, isVisible] = useMarkMessageRead(\r\n    chatId,\r\n    message,\r\n    messageList\r\n  );\r\n  return (\r\n    <SystemMessageWrapper ref={messageRef}>\r\n      {message.message}\r\n    </SystemMessageWrapper>\r\n  );\r\n};\r\n\r\nexport default SystemMessage;\r\n","import React, { useEffect, useRef, useState } from \"react\";\r\nimport { MessageField } from \"../organisms/message-field\";\r\nimport SystemMessage from \"./system-message\";\r\n\r\nexport const DisplayChatMessages = ({\r\n  chatId,\r\n  messageList,\r\n  inResponseToMessage,\r\n  setInResponseToMessage,\r\n  messagesWindowRef,\r\n  setDateRefsArray,\r\n}) => {\r\n  const scrollToMessageRef = useRef(null);\r\n  const [scrollToMessageId, setScrollToMessageId] = useState(-1);\r\n  useEffect(() => {\r\n    if (scrollToMessageId !== -1) {\r\n      messagesWindowRef.current.scrollTo(\r\n        0,\r\n        scrollToMessageRef.current.offsetTop - 65 < 0\r\n          ? 0\r\n          : scrollToMessageRef.current.offsetTop - 65\r\n      );\r\n      setTimeout(() => {\r\n        setScrollToMessageId(-1);\r\n      }, 500);\r\n    }\r\n  }, [scrollToMessageId]);\r\n\r\n  return messageList.length ? (\r\n    <>\r\n      {messageList.map((message, index) => {\r\n        if (message.sender !== \"soundbubble\") {\r\n          return (\r\n            <MessageField\r\n              message={message}\r\n              index={index}\r\n              key={message.id}\r\n              messageList={messageList}\r\n              chatId={chatId}\r\n              inResponseToMessage={inResponseToMessage}\r\n              setInResponseToMessage={setInResponseToMessage}\r\n              scrollToMessageRef={scrollToMessageRef}\r\n              scrollToMessageId={scrollToMessageId}\r\n              setScrollToMessageId={setScrollToMessageId}\r\n              setDateRefsArray={setDateRefsArray}\r\n            />\r\n          );\r\n        } else {\r\n          return (\r\n            <SystemMessage\r\n              chatId={chatId}\r\n              message={message}\r\n              messageList={messageList}\r\n            />\r\n          );\r\n        }\r\n      })}\r\n    </>\r\n  ) : null;\r\n};\r\n","import React, { useEffect, useRef } from \"react\";\r\nimport { useScreen } from \"../../../../contexts/ScreenContext\";\r\nimport { TypingAnimation } from \"../atoms/typing-animation\";\r\nimport { DisplayChatMessages } from \"../molecules/display-chat-messages\";\r\n\r\nexport const ChatMessagesWindow = ({\r\n  chatId,\r\n  chatData,\r\n  messageList,\r\n  findTopDate,\r\n  inResponseToMessage,\r\n  setInResponseToMessage,\r\n  setDateRefsArray,\r\n}) => {\r\n  const { screenHeight, isMobile } = useScreen();\r\n  const messagesWindowRef = useRef(null);\r\n\r\n  const scrollToBottom = () => {\r\n    const scroll =\r\n      messagesWindowRef.current?.scrollHeight -\r\n      messagesWindowRef.current?.clientHeight;\r\n    messagesWindowRef.current?.scrollTo(0, scroll);\r\n  };\r\n\r\n  useEffect(() => {\r\n    setTimeout(() => {\r\n      scrollToBottom();\r\n    }, 200);\r\n  }, [messageList]);\r\n  return (\r\n    <div\r\n      className=\"chatMessagesWindow\"\r\n      ref={messagesWindowRef}\r\n      onScroll={findTopDate}\r\n      style={{\r\n        height: !isMobile\r\n          ? screenHeight - 105 + \"px\"\r\n          : screenHeight - 125 + \"px\",\r\n      }}\r\n    >\r\n      <DisplayChatMessages\r\n        chatId={chatId}\r\n        messageList={messageList}\r\n        inResponseToMessage={inResponseToMessage}\r\n        setInResponseToMessage={setInResponseToMessage}\r\n        messagesWindowRef={messagesWindowRef}\r\n        setDateRefsArray={setDateRefsArray}\r\n      />\r\n      <TypingAnimation typingPeople={chatData.typing} />\r\n    </div>\r\n  );\r\n};\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { useHistory, useRouteMatch } from \"react-router\";\r\nimport { LoadingCircle } from \"../../components/Loading/LoadingCircle\";\r\nimport { useAuth } from \"../../contexts/AuthContext\";\r\nimport { DateOnTop } from \"../../features/dialogue/ui/atoms/date-on-top\";\r\nimport { ChatHeader } from \"../../features/dialogue/ui/organisms/chat-header\";\r\nimport { ChatInput } from \"../../features/dialogue/ui/organisms/chat-input\";\r\nimport { ChatMessagesWindow } from \"../../features/dialogue/ui/organisms/chat-messages-window\";\r\nimport { useRealTimeMessages } from \"../../hooks/useRealTimeMessages\";\r\n\r\nconst DialoguePage = () => {\r\n  const match = useRouteMatch(\"/chat/:chatId\");\r\n  const { currentUser } = useAuth();\r\n  const { chatId } = match.params;\r\n  const [messageText, setMessageText] = useState(\"\");\r\n  const [inResponseToMessage, setInResponseToMessage] = useState([]);\r\n  const [dateRefsArray, setDateRefsArray] = useState([]);\r\n  const history = useHistory();\r\n  const [chatData, messageList, loading, currentDateOnTop, findTopDate] =\r\n    useRealTimeMessages(chatId, dateRefsArray);\r\n\r\n  useEffect(() => {\r\n    if (chatData === undefined) {\r\n      history.push(\"/not-found\");\r\n    } else if (chatData?.participants !== undefined) {\r\n      if (!chatData.participants.includes(currentUser.uid))\r\n        history.push(\"/chat\");\r\n    }\r\n  }, [chatData]);\r\n\r\n  return chatData !== null && chatData !== undefined ? (\r\n    <div className=\"DialoguePage\" style={{ height: \"100%\" }}>\r\n      {loading ? (\r\n        <LoadingCircle top={\"50%\"} />\r\n      ) : (\r\n        <>\r\n          <ChatHeader data={chatData} />\r\n          <DateOnTop date={currentDateOnTop} />\r\n          <ChatMessagesWindow\r\n            chatId={chatId}\r\n            chatData={chatData}\r\n            messageList={messageList}\r\n            findTopDate={findTopDate}\r\n            setDateRefsArray={setDateRefsArray}\r\n            inResponseToMessage={inResponseToMessage}\r\n            setInResponseToMessage={setInResponseToMessage}\r\n          />\r\n          <ChatInput\r\n            chatId={chatId}\r\n            chatData={chatData}\r\n            messageText={messageText}\r\n            setMessageText={setMessageText}\r\n            inResponseToMessage={inResponseToMessage}\r\n            setInResponseToMessage={setInResponseToMessage}\r\n            otherMessages={messageList}\r\n          />\r\n        </>\r\n      )}\r\n      {chatData?.wallpaper !== \"undefined\" ? (\r\n        <img\r\n          loading=\"lazy\"\r\n          src={chatData.wallpaper}\r\n          className=\"chatWallpaper\"\r\n          alt=\"\"\r\n        />\r\n      ) : null}\r\n    </div>\r\n  ) : null;\r\n};\r\n\r\nexport default DialoguePage;\r\n","import React, { useEffect, useState } from 'react'\r\nimport { firestore } from '../firebase'\r\n\r\n/**\r\n \t* Returns [chatData, messageList, loading, currentDateOnTop, findTopDate]\r\n*/\r\nexport const useRealTimeMessages = (chatId, dateRefsArray) => {\r\n\tconst [chatData, setChatData] = useState(null)\r\n\tconst [messageList, setMessageList] = useState([])\r\n\tconst [loading, setLoading] = useState(true)\r\n\tconst [currentDateOnTop, setCurrentDateOnTop] = useState(\"\")\r\n\tfunction findTopDate(e){\r\n\t\tdateRefsArray.forEach(ref=>{\r\n\t\t\tif(ref.current !== null) {\r\n\t\t\t\tif(ref.current.offsetTop - 70 <= e.target.scrollTop) setCurrentDateOnTop(ref.current.innerHTML)\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\t\r\n\tuseEffect(() => {\r\n\t\tconst unsubscribe = firestore.collection('chats').doc(chatId)\r\n\t\t\t.onSnapshot(snapshot => {\r\n\t\t\t\tsetChatData(snapshot.data())\r\n\t\t\t\tsetMessageList(snapshot.data()?.messages)\r\n\t\t\t\tsetCurrentDateOnTop(snapshot.data()?.messages.length ? snapshot.data().messages[0].sentTime : new Date().toString())\r\n\t\t\t\tsetLoading(false)\r\n\t\t\t})\r\n\t\treturn () => {\r\n\t\t\tunsubscribe()\r\n\t\t}\r\n\t}, [firestore, chatId])\r\n\r\n\r\n\treturn [chatData, messageList, loading, currentDateOnTop, findTopDate]\r\n}\r\n","import React, { useState } from \"react\";\r\nimport { useEffect } from \"react\";\r\nimport { ContentContainer } from \"../../components/Containers/ContentContainer\";\r\nimport { SongList } from \"../../components/Lists/SongList\";\r\nimport { useAuth } from \"../../contexts/AuthContext\";\r\nimport { firestore } from \"../../firebase\";\r\nimport { fetchItemList } from \"../../shared/lib/fetch-item-list\";\r\nimport { GoBackBtn } from \"../../shared/ui/atoms/go-back-button\";\r\n\r\nconst HistoryPage = () => {\r\n  const [historySongsIds, setHistorySongsIds] = useState([]);\r\n  const [historySongs, setHistorySongs] = useState([]);\r\n  const { currentUser } = useAuth();\r\n  useEffect(() => {\r\n    firestore\r\n      .collection(\"history\")\r\n      .doc(currentUser.uid)\r\n      .onSnapshot((res) => {\r\n        setHistorySongsIds(res.data().history);\r\n      });\r\n  }, [firestore]);\r\n\r\n  useEffect(() => {\r\n    fetchItemList(historySongsIds, \"songs\", setHistorySongs);\r\n  }, [historySongsIds]);\r\n  return (\r\n    <div className=\"HistoryPage\" style={{ animation: \"zoomIn .2s forwards\" }}>\r\n      <ContentContainer>\r\n        <div style={{ display: \"flex\", alignItems: \"center\" }}>\r\n          <GoBackBtn />\r\n          <h2 style={{ margin: \"0px\", marginLeft: \"8px\" }}>History</h2>\r\n        </div>\r\n        <SongList\r\n          listOfSongs={historySongs}\r\n          source={{\r\n            source: `/history`,\r\n            name: \"History\",\r\n            image:\r\n              \"https://www.seekpng.com/png/full/781-7815113_history-icon-white-png.png\",\r\n            songsList: historySongs,\r\n          }}\r\n          showCount\r\n          showSearch\r\n          displayIfEmpty={\"Nothing here\"}\r\n        />\r\n      </ContentContainer>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default HistoryPage;\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { BiChevronLeft, BiChevronRight } from \"react-icons/bi\";\r\nimport { firestore } from \"../../../../firebase\";\r\nimport checkNumber from \"../../../../shared/lib/check-number\";\r\nimport { AuthorItemBig } from \"../../../author/ui/molecules/author-item-big\";\r\nimport { PlaylistItem } from \"../../../../components/AuthorPage/PlaylistItem\";\r\nimport { LoadingCircle } from \"../../../../components/Loading/LoadingCircle\";\r\nimport { SongItem } from \"../../../song/ui/organisms/song-item\";\r\nexport const MainBanner = () => {\r\n  const [bannerColors, setBannerColors] = useState([]);\r\n  const [currentSliderPage, setcurrentSliderPage] = useState(0);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  const [topAuthor, setTopAuthor] = useState({});\r\n  const [topSong, setTopSong] = useState({});\r\n  const [topAlbum, setTopAlbum] = useState({});\r\n\r\n  async function findTop(setFunc, list, criterion) {\r\n    const response = (\r\n      await firestore.collection(list).orderBy(criterion, \"desc\").limit(1).get()\r\n    ).docs[0].data();\r\n    setFunc(response);\r\n    setBannerColors((prev) => [...prev, response.imageColors[0]]);\r\n    if (list === \"playlists\") setLoading(false);\r\n  }\r\n\r\n  useEffect(() => {\r\n    findTop(setTopAuthor, \"users\", \"subscribers\");\r\n    findTop(setTopSong, \"songs\", \"listens\");\r\n    findTop(setTopAlbum, \"playlists\", \"listens\");\r\n  }, []);\r\n  return (\r\n    <div\r\n      className=\"MainBanner\"\r\n      style={{ background: bannerColors[currentSliderPage] }}\r\n    >\r\n      {loading ? (\r\n        <LoadingCircle />\r\n      ) : (\r\n        <>\r\n          <div className=\"slider\">\r\n            <div\r\n              className={\r\n                \"sliderItem \" + (currentSliderPage === 0 ? \"current\" : \"\")\r\n              }\r\n              style={{ transform: `translateX(-${currentSliderPage * 100}%)` }}\r\n            >\r\n              <h3>Most popular artist on platform</h3>\r\n              <AuthorItemBig data={topAuthor} />\r\n            </div>\r\n            <div\r\n              className={\r\n                \"sliderItem \" + (currentSliderPage === 1 ? \"current\" : \"\")\r\n              }\r\n              style={{ transform: `translateX(-${currentSliderPage * 100}%)` }}\r\n            >\r\n              <h3>Most popular song on platform</h3>\r\n              <SongItem song={topSong} localIndex={0} showListens />\r\n            </div>\r\n            <div\r\n              className={\r\n                \"sliderItem \" + (currentSliderPage === 2 ? \"current\" : \"\")\r\n              }\r\n              style={{ transform: `translateX(-${currentSliderPage * 100}%)` }}\r\n            >\r\n              <h3>Most popular album on platform</h3>\r\n              <PlaylistItem playlist={topAlbum} />\r\n            </div>\r\n          </div>\r\n          <div className=\"sliderBtns\">\r\n            <button\r\n              onClick={() =>\r\n                setcurrentSliderPage(checkNumber(currentSliderPage - 1, 2, 0))\r\n              }\r\n            >\r\n              <BiChevronLeft />\r\n            </button>\r\n            <button\r\n              onClick={() =>\r\n                setcurrentSliderPage(checkNumber(currentSliderPage + 1, 2, 0))\r\n              }\r\n            >\r\n              <BiChevronRight />\r\n            </button>\r\n          </div>\r\n          {/* <BlurredBg circleColor = \"#fff\"/> */}\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { SongList } from \"../../../../components/Lists/SongList\";\r\nimport { useSong } from \"../../../../contexts/SongContext\";\r\nimport { firestore } from \"../../../../firebase\";\r\nimport findIfSongIsNew from \"../../../../functions/find/findIfSongIsNew\";\r\n\r\nexport const RecentSongs = () => {\r\n  const { yourAuthors } = useSong();\r\n  const [recentSongs, setRecentSongs] = useState([]);\r\n  function findRecentSongs() {\r\n    const tempSongsIds = [];\r\n    yourAuthors.forEach((author, i) => {\r\n      author.ownSongs.forEach(async (songId) => {\r\n        let songData = (\r\n          await firestore.collection(\"songs\").doc(songId).get()\r\n        ).data();\r\n        if (findIfSongIsNew(songData) && !tempSongsIds.includes(songData.id)) {\r\n          setRecentSongs((prev) => [...prev, songData]);\r\n          tempSongsIds.push(songData.id);\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (\r\n      yourAuthors !== undefined &&\r\n      yourAuthors.length !== 0 &&\r\n      recentSongs.length === 0\r\n    )\r\n      findRecentSongs();\r\n  }, []);\r\n  return (\r\n    <div>\r\n      <SongList\r\n        listOfSongs={recentSongs}\r\n        source={{\r\n          source: `/home`,\r\n          name: \"New Songs\",\r\n          image: \"\",\r\n          songsList: recentSongs,\r\n        }}\r\n        title={\"New Songs\"}\r\n        isNewSong\r\n      />\r\n    </div>\r\n  );\r\n};\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { AuthorsList } from \"../../../../components/Lists/AuthorsList\";\r\nimport { useAuth } from \"../../../../contexts/AuthContext\";\r\nimport { useSong } from \"../../../../contexts/SongContext\";\r\nimport findSimilarArtists from \"../../../../shared/lib/find-similar-artists\";\r\n\r\nexport const RecommendedAuthors = () => {\r\n  const { yourAuthors } = useSong();\r\n  const [recommendationAuthors, setRecommendationAuthors] = useState([]);\r\n\r\n  const [uniqueAuthors, setUniqueAuthors] = useState([]);\r\n  const { currentUser } = useAuth();\r\n  useEffect(() => {\r\n    if (yourAuthors !== undefined) {\r\n      yourAuthors.forEach((author) => {\r\n        findSimilarArtists(author, setRecommendationAuthors);\r\n      });\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    recommendationAuthors.forEach((author) => {\r\n      const uniqueAuthorsUIDSArray = uniqueAuthors.map((author) => author.uid);\r\n      if (\r\n        !currentUser.addedAuthors.includes(author.uid) &&\r\n        !uniqueAuthorsUIDSArray.includes(author.uid)\r\n      ) {\r\n        setUniqueAuthors((prev) => [...prev, author]);\r\n      }\r\n    });\r\n  }, [recommendationAuthors]);\r\n  return (\r\n    <div className=\"RecommendedAuthors\">\r\n      <AuthorsList\r\n        listOfAuthors={uniqueAuthors}\r\n        title={\"Recommended Authors\"}\r\n      />\r\n      {/* <h2>Recommended Authors</h2>\r\n\t\t\t<div className=\"artistsWrapper\">\r\n\t\t\t\t{uniqueAuthors.map((author, index) => {\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<AuthorItemBig data={author} key={index} />\r\n\t\t\t\t\t)\r\n\t\t\t\t})}\r\n\t\t\t</div> */}\r\n    </div>\r\n  );\r\n};\r\n","import React from 'react'\r\n\r\nexport const ImportantMessage = ({message, image, button}) => {\r\n\treturn (\r\n\t\t<div className = \"importantMessage\">\r\n\t\t\t<div>\r\n\t\t\t\t{image?<img loading = \"lazy\" src={image} alt=\"\" />:null}\r\n\t\t\t\t<h3>{message}</h3>\r\n\t\t\t\t{button?button:null}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t)\r\n}\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { SongList } from \"../../../../components/Lists/SongList\";\r\nimport { ImportantMessage } from \"../../../../components/MessagePlates/ImportantMessage\";\r\nimport { useAuth } from \"../../../../contexts/AuthContext\";\r\nimport { useSong } from \"../../../../contexts/SongContext\";\r\nimport { firestore } from \"../../../../firebase\";\r\n\r\nexport const RecommendedSongs = () => {\r\n  const { yourAuthors } = useSong();\r\n  const { currentUser } = useAuth();\r\n  const [recommendedSongs, setRecommendedSongs] = useState([]);\r\n  function fetchRecommendedSongs() {\r\n    const tempSongsIds = [];\r\n    yourAuthors.forEach((author, i) => {\r\n      author.ownSongs.forEach(async (songId, index) => {\r\n        let songData = (\r\n          await firestore.collection(\"songs\").doc(songId).get()\r\n        ).data();\r\n        if (\r\n          !currentUser.addedSongs.includes(songId) &&\r\n          !tempSongsIds.includes(songData.id) &&\r\n          index <= 3\r\n        ) {\r\n          setRecommendedSongs((prev) => [...prev, songData]);\r\n          tempSongsIds.push(songData.id);\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  useEffect(() => {\r\n    fetchRecommendedSongs();\r\n  }, []);\r\n  return (\r\n    <div className=\"RecommendedSongs\">\r\n      <SongList\r\n        listOfSongs={recommendedSongs}\r\n        source={{\r\n          source: `/home`,\r\n          name: \"Recommended Songs\",\r\n          image: \"\",\r\n          songsList: recommendedSongs,\r\n        }}\r\n        title={\"Recommended Songs\"}\r\n        displayIfEmpty={\r\n          <ImportantMessage\r\n            message={\r\n              \"No songs recommended. Add favorite authors so we could know what to recommend\"\r\n            }\r\n            image={\r\n              \"https://i.pinimg.com/originals/b2/3d/f6/b23df649311586e74a8455c92eb3d76b.png\"\r\n            }\r\n          />\r\n        }\r\n      />\r\n    </div>\r\n  );\r\n};\r\n","import React, { useEffect } from \"react\";\r\nimport { useState } from \"react\";\r\nimport { SongList } from \"../../../../components/Lists/SongList\";\r\nimport { LoadingCircle } from \"../../../../components/Loading/LoadingCircle\";\r\nimport { firestore } from \"../../../../firebase\";\r\n\r\nexport const Top15Songs = () => {\r\n  const [topSongs, setTopSongs] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  function fetchTopSongs() {\r\n    firestore\r\n      .collection(\"songs\")\r\n      .orderBy(\"listens\", \"desc\")\r\n      .limit(15)\r\n      .get()\r\n      .then((res) => {\r\n        res.docs.forEach((song) => {\r\n          setTopSongs((prev) => [...prev, song.data()]);\r\n        });\r\n        setLoading(false);\r\n      });\r\n  }\r\n\r\n  useEffect(() => {\r\n    setLoading(true);\r\n    fetchTopSongs();\r\n  }, []);\r\n  return !loading ? (\r\n    <SongList\r\n      listOfSongs={topSongs}\r\n      source={{\r\n        source: `/home`,\r\n        name: \"Top 15 Songs\",\r\n        image:\r\n          \"https://media.istockphoto.com/vectors/fire-icon-illustration-for-design-stock-vector-vector-id931601050?k=6&m=931601050&s=170667a&w=0&h=fhRQfwwsW6aXK9OSDM-yj842SFFl2Q9ll6ch-xCK5es=\",\r\n        songsList: topSongs,\r\n      }}\r\n      title={\"Top 15 Songs\"}\r\n      showListens\r\n      showCount\r\n    />\r\n  ) : (\r\n    <LoadingCircle />\r\n  );\r\n};\r\n","import { ContentContainer } from \"../../components/Containers/ContentContainer\";\r\nimport { MainBanner } from \"../../features/home/ui/organisms/main-banner\";\r\nimport { RecentSongs } from \"../../features/home/ui/organisms/recent-songs\";\r\nimport { RecommendedAuthors } from \"../../features/home/ui/organisms/recommended-authors\";\r\nimport { RecommendedSongs } from \"../../features/home/ui/organisms/recommended-songs\";\r\nimport { Top15Songs } from \"../../features/home/ui/organisms/top-15-Songs\";\r\nimport \"../../styles/HomePage.css\";\r\n\r\nconst HomePage = () => {\r\n  return (\r\n    <div style={{ animation: \"zoomIn .2s forwards\" }} className=\"HomePage\">\r\n      <MainBanner />\r\n      <ContentContainer>\r\n        <RecentSongs />\r\n        <Top15Songs />\r\n        <RecommendedSongs />\r\n        <RecommendedAuthors />\r\n      </ContentContainer>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default HomePage;\r\n","export const findVisiblePlaylists = (screenWidth) => {\r\n\tif(screenWidth < 1990 && screenWidth >= 1780) return 7\r\n\telse if(screenWidth < 1780 && screenWidth >= 1570) return 6\r\n\telse if(screenWidth < 1570 && screenWidth >= 1360) return 5\r\n\telse if(screenWidth < 1360 && screenWidth >= 1150) return 4\r\n\telse if(screenWidth < 1150 && screenWidth >= 1000) return 3\r\n\telse if(screenWidth < 1000 && screenWidth >= 892) return 6\r\n\telse if(screenWidth < 892 && screenWidth >= 754) return 5\r\n\telse if(screenWidth < 754 && screenWidth >= 614) return 4\r\n\telse if(screenWidth < 614 && screenWidth >= 464) return 3\r\n\telse return 2\r\n}","export default __webpack_public_path__ + \"static/media/wave2.f62cb572.svg\";","import React, { useState } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport getShortString from \"../../shared/lib/get-short-string\";\r\nimport { HiPause, HiPlay } from \"react-icons/hi\";\r\nimport { useSong } from \"../../contexts/SongContext\";\r\nimport { usePlaylistSongs } from \"../../hooks/usePlaylistSongs\";\r\nimport { useScreen } from \"../../contexts/ScreenContext\";\r\nimport { BiAlbum } from \"react-icons/bi\";\r\nexport const LibraryPlaylistItem = ({ playlist }) => {\r\n  const { currentSongPlaylistSource, play } = useSong();\r\n  const { isMobile } = useScreen();\r\n  const [playlistSongs, setPlaylistSongs] = useState([]);\r\n  const playSongsInPlaylist = usePlaylistSongs(\r\n    playlist,\r\n    playlistSongs,\r\n    setPlaylistSongs\r\n  );\r\n\r\n  return (\r\n    <Link to={`/albums/${playlist.id}`} className=\"playlistWrapper\">\r\n      <div\r\n        className=\"library playlistItem\"\r\n        style={{ backgroundImage: `url(${playlist.image})` }}\r\n      >\r\n        <h2 style={{ background: playlist.imageColors[2] }}>\r\n          {getShortString(playlist.name, 10)}\r\n        </h2>\r\n        {!playlist.image ? (\r\n          <BiAlbum\r\n            style={{\r\n              position: \"absolute\",\r\n              left: \"50%\",\r\n              top: \"50%\",\r\n              transform: \"translate(-50%, -50%)\",\r\n              width: \"60px\",\r\n              height: \"60px\",\r\n            }}\r\n          />\r\n        ) : null}\r\n        {!isMobile ? (\r\n          <button onClick={playSongsInPlaylist}>\r\n            {currentSongPlaylistSource.name === playlist.name && play ? (\r\n              <HiPause />\r\n            ) : (\r\n              <HiPlay />\r\n            )}\r\n          </button>\r\n        ) : null}\r\n      </div>\r\n    </Link>\r\n  );\r\n};\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { useAuth } from \"../../contexts/AuthContext\";\r\nimport { useScreen } from \"../../contexts/ScreenContext\";\r\nimport { useSong } from \"../../contexts/SongContext\";\r\nimport { findVisiblePlaylists } from \"../../functions/find/findVisiblePlaylists\";\r\nimport wave from \"../../images/wave2.svg\";\r\nimport { SongList } from \"../Lists/SongList\";\r\nimport { LibraryPlaylistItem } from \"./LibraryPlaylistItem\";\r\nexport const SongsPage = () => {\r\n  const { yourSongs, yourPlaylists } = useSong();\r\n  const { currentUser } = useAuth();\r\n  const { screenWidth } = useScreen();\r\n  const [playlistsVisible, setPlaylistsVisible] = useState(\r\n    findVisiblePlaylists(screenWidth)\r\n  );\r\n  useEffect(() => {\r\n    setPlaylistsVisible(findVisiblePlaylists(screenWidth));\r\n  }, [screenWidth]);\r\n  return (\r\n    <div className=\"SongsPage\">\r\n      <div className=\"playLists\">\r\n        <div className=\"playlistContent\">\r\n          {yourPlaylists.length ? (\r\n            yourPlaylists.map((p, index) => {\r\n              if (index < playlistsVisible) {\r\n                return <LibraryPlaylistItem playlist={p} key={index} />;\r\n              }\r\n            })\r\n          ) : (\r\n            <h3\r\n              style={{\r\n                position: \"absolute\",\r\n                left: \"50%\",\r\n                top: \"40%\",\r\n                transform: \"translate(-50%, -50%)\",\r\n              }}\r\n            >\r\n              You don't have playlists\r\n            </h3>\r\n          )}\r\n        </div>\r\n        <div className=\"playlistsBackground\">\r\n          <img loading=\"lazy\" src={wave} alt=\"wave\" />\r\n        </div>\r\n      </div>\r\n      <div className=\"yourSongsList\">\r\n        <SongList\r\n          listOfSongs={yourSongs}\r\n          source={{\r\n            source: \"/library\",\r\n            name: \"Your Library\",\r\n            image: currentUser.photoURL,\r\n            songsList: yourSongs,\r\n          }}\r\n          showSearch\r\n          showhistory\r\n          displayIfEmpty={<h3>Your library is empty</h3>}\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import React, { useState } from \"react\";\r\nimport { BiFolderPlus } from \"react-icons/bi\";\r\nimport { useModal } from \"../../contexts/ModalContext\";\r\nimport { useSong } from \"../../contexts/SongContext\";\r\nimport SearchBar from \"../../shared/ui/organisms/search-bar\";\r\nimport { PlaylistItem } from \"../AuthorPage/PlaylistItem\";\r\nimport { ContentContainer } from \"../Containers/ContentContainer\";\r\nimport { CreatePlaylistPage } from \"./CreatePlaylistPage\";\r\nexport const PlaylistsPage = () => {\r\n  const { yourPlaylists } = useSong();\r\n  const [playlistsDisplay, setPlaylistsDisplay] = useState(yourPlaylists);\r\n  const { toggleModal, setContent } = useModal();\r\n  const [searchValue, setSearchValue] = useState(\"\");\r\n  return (\r\n    <div className=\"PlaylistsPage\">\r\n      <ContentContainer>\r\n        <div style={{ display: \"flex\" }} className=\"searchAndCreatePlaylist\">\r\n          <SearchBar\r\n            value={searchValue}\r\n            setValue={setSearchValue}\r\n            setResultPlaylists={setPlaylistsDisplay}\r\n            defaultSearchMode={\"playlists\"}\r\n            defaultPlaylistsListValue={yourPlaylists}\r\n          />\r\n          <button\r\n            className=\"createPlaylistBtn\"\r\n            onClick={() => {\r\n              toggleModal();\r\n              setContent(<CreatePlaylistPage />);\r\n            }}\r\n          >\r\n            <BiFolderPlus />\r\n            Create Playlist\r\n          </button>\r\n        </div>\r\n        <div className=\"playlistsContainer\">\r\n          {playlistsDisplay &&\r\n            playlistsDisplay.map((playlist, index) => {\r\n              return <PlaylistItem playlist={playlist} key={playlist.id} />;\r\n            })}\r\n        </div>\r\n      </ContentContainer>\r\n    </div>\r\n  );\r\n};\r\n","import React, { useState } from \"react\";\r\nimport { useSong } from \"../../contexts/SongContext\";\r\nimport { AuthorItemBig } from \"../../features/author/ui/molecules/author-item-big\";\r\nimport SearchBar from \"../../shared/ui/organisms/search-bar\";\r\nimport { ContentContainer } from \"../Containers/ContentContainer\";\r\nexport const AuthorsPage = () => {\r\n  const { yourAuthors } = useSong();\r\n  const [searchValue, setSearchValue] = useState(\"\");\r\n  const [displayAuthors, setDisplayAuthors] = useState(yourAuthors);\r\n  return (\r\n    <div className=\"AuthorsPage\">\r\n      <ContentContainer>\r\n        <SearchBar\r\n          value={searchValue}\r\n          setValue={setSearchValue}\r\n          setResultAuthorList={setDisplayAuthors}\r\n          defaultSearchMode={\"authors\"}\r\n          defaultAuthorsListValue={yourAuthors}\r\n        />\r\n        <div className=\"authorsContainer\">\r\n          {displayAuthors.map((authorData) => {\r\n            return <AuthorItemBig data={authorData} key={authorData.uid} />;\r\n          })}\r\n        </div>\r\n      </ContentContainer>\r\n    </div>\r\n  );\r\n};\r\n","import React, { useState } from \"react\";\r\nimport \"../../styles/LibraryPage.css\";\r\nimport { SongsPage } from \"../../components/LibraryPage/SongsPage\";\r\nimport { PlaylistsPage } from \"../../components/LibraryPage/PlaylistsPage\";\r\nimport { AuthorsPage } from \"../../components/LibraryPage/AuthorsPage\";\r\nimport { Slider } from \"../../shared/ui/molecules/slider\";\r\n\r\nconst LibraryPage = () => {\r\n  const [currentPage, setCurrentPage] = useState(0);\r\n  const libraryPages = [<SongsPage />, <PlaylistsPage />, <AuthorsPage />];\r\n  return (\r\n    <div className=\"LibraryPage\" style={{ animation: \"zoomIn .2s forwards\" }}>\r\n      <Slider\r\n        pages={[\"Songs\", \"Playlists\", \"Authors\"]}\r\n        currentPage={currentPage}\r\n        setCurrentPage={setCurrentPage}\r\n      />\r\n      {libraryPages[currentPage]}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default LibraryPage;\r\n","import React from 'react'\r\n\r\nexport const BlurredBg = () => {\r\n\treturn (\r\n\t\t<div className = \"BlurredBg\">\r\n\t\t\t<div className=\"circle circle1\"></div>\r\n\t\t\t<div className=\"circle circle2\"></div>\r\n\t\t\t<div className=\"circle circle3\"></div>\r\n\t\t\t<div className=\"circle circle4\"></div>\r\n\t\t\t<div className=\"circle circle5\"></div>\r\n\t\t</div>\r\n\t)\r\n}\r\n","import React from 'react'\r\nimport Logo from \"../../images/Logo3.svg\"\r\nexport const TitleAndLogo = ({title}) => {\r\n\treturn (\r\n\t\t<div className=\"titleAndLogo\">\r\n\t\t\t\t<div className=\"title\">\r\n\t\t\t\t\t<h1>{title}</h1>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"logo\">\r\n\t\t\t\t\t<img loading = \"lazy\" src={Logo} alt=\"\" />\r\n\t\t\t\t</div>\r\n\t\t</div>\r\n\t)\r\n}\r\n","import React, { useState } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { ErrorPlate } from \"../../components/MessagePlates/ErrorPlate\";\r\nimport { FullScreenLoading } from \"../../components/Loading/FullScreenLoading\";\r\nimport { BlurredBg } from \"../../components/SignIn-Up/BlurredBg\";\r\nimport { TitleAndLogo } from \"../../components/SignIn-Up/TitleAndLogo\";\r\nimport { useAuth } from \"../../contexts/AuthContext\";\r\nimport { SIGNUP_ROUTE } from \"../../utils/route-consts\";\r\nimport Input from \"../../shared/ui/atoms/input\";\r\n\r\nconst LogInPage = () => {\r\n  const { login } = useAuth();\r\n  const [email, setEmail] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [errorMessage, setErrorMessage] = useState(\"\");\r\n  const [loading, setLoading] = useState(false);\r\n  const isValid = email.length !== 0 && password.length !== 0;\r\n  async function handleSubmit(e) {\r\n    e.preventDefault();\r\n    if (!isValid) {\r\n      return setErrorMessage(\"One of your fields is totaly empty\");\r\n    }\r\n    await login(email, password, setErrorMessage, setLoading);\r\n  }\r\n  return (\r\n    <div className=\"In-Up-Container\">\r\n      <div className=\"CentralPlate\">\r\n        <FullScreenLoading loading={loading} />\r\n        <TitleAndLogo title=\"Log In\" />\r\n        <ErrorPlate errorMessage={errorMessage} />\r\n        <div className=\"inner-plate-content\">\r\n          <Input\r\n            type=\"email\"\r\n            placeholder=\"Enter your email\"\r\n            value={email}\r\n            setValue={setEmail}\r\n            margin\r\n          />\r\n          <Input\r\n            type=\"password\"\r\n            placeholder=\"Enter your password\"\r\n            value={password}\r\n            setValue={setPassword}\r\n            margin\r\n          />\r\n          <div className=\"inAndUpBtns\">\r\n            <button className=\"upBtn\" disabled={loading} onClick={handleSubmit}>\r\n              Log In\r\n            </button>\r\n            <Link to={SIGNUP_ROUTE}>\r\n              <button className=\"inBtn\">Create new account</button>\r\n            </Link>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <BlurredBg />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default LogInPage;\r\n","import React from \"react\";\r\nimport styled from \"styled-components\";\r\n\r\nconst LyricsWrapper = styled.div`\r\n  max-height: 500px;\r\n  width: 1000px;\r\n  overflow-y: auto;\r\n\r\n  .lyricsBlock {\r\n    padding: 10px;\r\n    box-sizing: border-box;\r\n    font-size: 1.8em;\r\n    font-weight: 700;\r\n    margin: 10px 0;\r\n    user-select: none;\r\n    cursor: pointer;\r\n    border-radius: var(--standartBorderRadius2);\r\n\r\n    &:hover {\r\n      background: #ffffff5c;\r\n    }\r\n  }\r\n`;\r\n\r\nconst Lyrics = ({ song }) => {\r\n  return (\r\n    <LyricsWrapper>\r\n      {song.lyrics.map((lyricItem, i) => {\r\n        return <div className=\"lyricsBlock\">{lyricItem.text}</div>;\r\n      })}\r\n    </LyricsWrapper>\r\n  );\r\n};\r\n\r\nexport default Lyrics;\r\n","import React from \"react\";\r\nimport styled from \"styled-components\";\r\n\r\nconst SongImageAndNameWrapper = styled.div`\r\n  width: 100%;\r\n  max-width: 800px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  align-items: center;\r\n\r\n  .song-image {\r\n    width: 300px;\r\n    height: 300px;\r\n    background-size: cover;\r\n    background-position: center center;\r\n    border-radius: var(--standartBorderRadius);\r\n  }\r\n`;\r\n\r\nconst SongImageAndName = ({ song }) => {\r\n  return (\r\n    <SongImageAndNameWrapper>\r\n      <div\r\n        className=\"song-image\"\r\n        style={{ backgroundImage: `url(${song.cover})` }}\r\n      />\r\n      <h3>{song.name}</h3>\r\n    </SongImageAndNameWrapper>\r\n  );\r\n};\r\n\r\nexport default SongImageAndName;\r\n","import React, { useEffect, useState } from \"react\";\r\nimport styled from \"styled-components\";\r\nimport { ContentContainer } from \"../../components/Containers/ContentContainer\";\r\nimport Lyrics from \"../../features/lyrics-editing/ui/molecules/lyrics\";\r\nimport SongImageAndName from \"../../features/lyrics-editing/ui/molecules/song-image-and-name\";\r\nimport { firestore } from \"../../firebase\";\r\n\r\nconst LyricsEditingWrapper = styled(ContentContainer)`\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  height: 100%;\r\n  background: ${({ colors }) =>\r\n    `linear-gradient(45deg, ${colors[2]}, ${colors[3]});`};\r\n\r\n  h2 {\r\n    margin: 0;\r\n  }\r\n\r\n  .image-and-lyrics {\r\n    display: flex;\r\n    align-items: center;\r\n  }\r\n`;\r\n\r\nconst LyricsEditingPage = () => {\r\n  const [songId, setSongId] = useState(\"3e35c47f-2186-4dea-a415-55616c525874\");\r\n  const [songData, setSongData] = useState(null);\r\n\r\n  useEffect(() => {\r\n    firestore\r\n      .collection(\"songs\")\r\n      .doc(songId)\r\n      .get()\r\n      .then((res) => {\r\n        setSongData(res.data());\r\n      });\r\n  }, []);\r\n\r\n  //TODO: Wave visualizer?\r\n  return (\r\n    !!songData && (\r\n      <LyricsEditingWrapper colors={songData.imageColors}>\r\n        <div>\r\n          <div className=\"image-and-lyrics\">\r\n            <SongImageAndName song={songData} />\r\n            <Lyrics song={songData} />\r\n          </div>\r\n          <div></div>\r\n        </div>\r\n      </LyricsEditingWrapper>\r\n    )\r\n  );\r\n};\r\n\r\nexport default LyricsEditingPage;\r\n","import React from \"react\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport \"../../styles/PageNotFound.css\";\r\n\r\nconst PageNotFound = () => {\r\n  const history = useHistory();\r\n  return (\r\n    <div className=\"PageNotFound\">\r\n      <img\r\n        loading=\"lazy\"\r\n        src=\"https://i.pinimg.com/originals/b2/3d/f6/b23df649311586e74a8455c92eb3d76b.png\"\r\n        alt=\"\"\r\n      />\r\n      <h2>Page not found</h2>\r\n      <button\r\n        className=\"standartButton\"\r\n        onClick={() => history.push(\"/library\")}\r\n      >\r\n        Back to library\r\n      </button>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PageNotFound;\r\n","import { useEffect, useState } from 'react';\r\nimport { useAuth } from '../../../../contexts/AuthContext';\r\nimport { firestore } from '../../../../firebase';\r\n\r\nconst useSearchHistory = () => {\r\n\tconst [historySongs, setHistorySongs] = useState([]);\r\n\tconst [historyPlaylists, setHistoryPlaylists] = useState([]);\r\n\tconst [historyAuthors, setHistoryAuthors] = useState([]);\r\n\tconst { currentUser } = useAuth();\r\n\tuseEffect(() => {\r\n\t\tfirestore\r\n\t\t\t.collection(\"searchHistory\")\r\n\t\t\t.doc(currentUser.uid)\r\n\t\t\t.get()\r\n\t\t\t.then((res) => {\r\n\t\t\t\tif (res.data()?.history) {\r\n\t\t\t\t\tres.data().history.forEach(async ({ id, type }) => {\r\n\t\t\t\t\t\tconst itemData = (\r\n\t\t\t\t\t\t\tawait firestore.collection(type).doc(id).get()\r\n\t\t\t\t\t\t).data();\r\n\t\t\t\t\t\tswitch (type) {\r\n\t\t\t\t\t\t\tcase \"songs\":\r\n\t\t\t\t\t\t\t\tsetHistorySongs((prev) => [...prev, itemData]);\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase \"playlists\":\r\n\t\t\t\t\t\t\t\tsetHistoryPlaylists((prev) => [...prev, itemData]);\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase \"users\":\r\n\t\t\t\t\t\t\t\tsetHistoryAuthors((prev) => [...prev, itemData]);\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t}, []);\r\n\r\n\treturn [historySongs, historyPlaylists, historyAuthors]\r\n}\r\n\r\nexport default useSearchHistory\r\n","import React from \"react\";\r\nimport { AlbumList } from \"../../../../components/Lists/AlbumList\";\r\nimport { AuthorsList } from \"../../../../components/Lists/AuthorsList\";\r\nimport { SongList } from \"../../../../components/Lists/SongList\";\r\nimport { useAuth } from \"../../../../contexts/AuthContext\";\r\nimport useSearchHistory from \"../../lib/hooks/use-search-history.jsx\";\r\n\r\nconst SearchHistory = () => {\r\n  const { searchValue } = useAuth();\r\n  const [historySongs, historyPlaylists, historyAuthors] = useSearchHistory();\r\n  return !searchValue ? (\r\n    <div\r\n      className=\"search-history\"\r\n      style={{ animation: \"zoomIn .2s forwards\" }}\r\n    >\r\n      <SongList\r\n        listOfSongs={historySongs}\r\n        source={{\r\n          source: \"/search\",\r\n          name: \"Search\",\r\n          image:\r\n            \"https://www.pngkey.com/png/full/87-872187_lupa-search-icon-white-png.png\",\r\n          songsList: historySongs,\r\n        }}\r\n        title={\"Search history\"}\r\n        showListens\r\n        displayIfEmpty={\"\"}\r\n        isHorizontal\r\n      />\r\n      <AuthorsList listOfAuthors={historyAuthors} />\r\n      <AlbumList listOfAlbums={historyPlaylists} loading={false} />\r\n    </div>\r\n  ) : null;\r\n};\r\n\r\nexport default SearchHistory;\r\n","import React, { useEffect, useState } from \"react\";\r\nimport SearchBar from \"../../shared/ui/organisms/search-bar\";\r\nimport { ContentContainer } from \"../../components/Containers/ContentContainer\";\r\nimport { AlbumList } from \"../../components/Lists/AlbumList\";\r\nimport { AuthorsList } from \"../../components/Lists/AuthorsList\";\r\nimport { SongList } from \"../../components/Lists/SongList\";\r\nimport { useAuth } from \"../../contexts/AuthContext\";\r\nimport SearchHistory from \"../../features/search/ui/organisms/search-history\";\r\nimport \"../../styles/SearchPage.css\";\r\n\r\nconst SearchPage = () => {\r\n  const { searchValue, setSearchValue } = useAuth();\r\n  const [resultSongList, setResultSongList] = useState([]);\r\n  const [resultAuthorList, setResultAuthorList] = useState([]);\r\n  const [resultAlbumList, setResultAlbumList] = useState([]);\r\n  const [shadowColor, setShadowColor] = useState(\"\");\r\n  useEffect(() => {\r\n    setResultSongList([]);\r\n    setResultAuthorList([]);\r\n    setResultAlbumList([]);\r\n  }, [searchValue]);\r\n\r\n  useEffect(() => {\r\n    if (resultSongList.length !== 0)\r\n      setShadowColor(resultSongList[0].imageColors[0] + \"a6\");\r\n    else if (resultAuthorList.length !== 0)\r\n      setShadowColor(resultAuthorList[0].imageColors[0] + \"a6\");\r\n    else if (resultAlbumList.length !== 0)\r\n      setShadowColor(resultAlbumList[0].imageColors[0] + \"a6\");\r\n    else setShadowColor(\"\");\r\n  }, [resultSongList, resultAuthorList, resultAlbumList]);\r\n\r\n  return (\r\n    <div\r\n      className=\"SearchPage\"\r\n      style={{\r\n        animation: \"zoomIn .2s forwards\",\r\n      }}\r\n    >\r\n      <ContentContainer>\r\n        <SearchBar\r\n          value={searchValue}\r\n          setValue={setSearchValue}\r\n          allFoundSongs={resultSongList}\r\n          setAllFoundSongs={setResultSongList}\r\n          setResultPlaylists={setResultAlbumList}\r\n          setResultAuthorList={setResultAuthorList}\r\n          focus\r\n        />\r\n        <SearchHistory />\r\n        <SongList\r\n          listOfSongs={resultSongList}\r\n          source={{\r\n            source: \"/search\",\r\n            name: \"Search\",\r\n            image:\r\n              \"https://www.pngkey.com/png/full/87-872187_lupa-search-icon-white-png.png\",\r\n            songsList: resultSongList,\r\n          }}\r\n          title={\"Songs\"}\r\n          showListens\r\n          saveSearchHistory\r\n          displayIfEmpty={\"\"}\r\n          isHorizontal\r\n        />\r\n        <AuthorsList\r\n          listOfAuthors={resultAuthorList}\r\n          title={\"Authors\"}\r\n          saveSearchHistory\r\n        />\r\n        <AlbumList\r\n          listOfAlbums={resultAlbumList}\r\n          title={\"Albums and Playlists\"}\r\n          loading={false}\r\n          saveSearchHistory\r\n        />\r\n        <div\r\n          className=\"colorfullShadow\"\r\n          style={{ background: shadowColor }}\r\n        ></div>\r\n      </ContentContainer>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SearchPage;\r\n","import React from \"react\";\r\n\r\nconst AccountSettings = () => {\r\n  return <div>Account</div>;\r\n};\r\n\r\nexport default AccountSettings;\r\n","import React from 'react'\r\n\r\nexport const SwitchToggle = ({boolValue, setBoolValue}) => {\r\n\treturn (\r\n\t\t<div className = \"SwitchToggle\" onClick = {()=>setBoolValue(!boolValue)}>\r\n\t\t\t<div className=\"switchInnerCircle\" style = {boolValue?{transform:'translateX(100%)', background:'var(--green)'}:{}}></div>\r\n\t\t</div>\r\n\t)\r\n}\r\n","import { useState } from \"react\";\r\nimport styled from \"styled-components\";\r\nimport { SwitchToggle } from \"../molecules/switch-toggle\";\r\n\r\nconst SettingsItemWrapper = styled.div`\r\n  width: 100%;\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  cursor: pointer;\r\n  transition: 0.2s;\r\n  padding: 20px 50px;\r\n  box-sizing: border-box;\r\n  position: relative;\r\n\r\n  &::after {\r\n    content: \"\";\r\n    position: absolute;\r\n    width: 100%;\r\n    height: 2px;\r\n    bottom: 0;\r\n    left: 0%;\r\n    /* transform: translateX(-50%); */\r\n    background: #313131;\r\n  }\r\n\r\n  .icon-and-text {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: flex-start;\r\n    user-select: none;\r\n\r\n    svg {\r\n      margin-right: 7px;\r\n      width: 20px;\r\n      height: 20px;\r\n    }\r\n  }\r\n\r\n  &:hover {\r\n    background: var(--leftSideBarColor);\r\n  }\r\n`;\r\n\r\nconst SettingsItem = ({ icon, text, action }) => {\r\n  const [boolValue, setBoolValue] = useState(false);\r\n\r\n  const handleChangeToggle = (val) => {\r\n    setBoolValue(val);\r\n    if (val && !!action) action();\r\n  };\r\n\r\n  return (\r\n    <SettingsItemWrapper onClick={() => handleChangeToggle(!boolValue)}>\r\n      <div className=\"icon-and-text\">\r\n        {icon}\r\n        {text}\r\n      </div>\r\n      <SwitchToggle boolValue={boolValue} setBoolValue={handleChangeToggle} />\r\n    </SettingsItemWrapper>\r\n  );\r\n};\r\n\r\nexport default SettingsItem;\r\n","import React from \"react\";\r\nimport { FiBell } from \"react-icons/fi\";\r\nimport SettingsItem from \"../atoms/settings-item\";\r\n\r\nconst ChatSettings = () => {\r\n  return (\r\n    <>\r\n      <SettingsItem icon={<FiBell />} text={\"–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è\"} />\r\n      <SettingsItem icon={<FiBell />} text={\"–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è\"} />\r\n      <SettingsItem icon={<FiBell />} text={\"–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è\"} />\r\n      <SettingsItem icon={<FiBell />} text={\"–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è\"} />\r\n      <SettingsItem icon={<FiBell />} text={\"–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è\"} />\r\n    </>\r\n  );\r\n};\r\n\r\nexport default ChatSettings;\r\n","import React from \"react\";\r\n\r\nconst MusicSettings = () => {\r\n  return <div>Music</div>;\r\n};\r\n\r\nexport default MusicSettings;\r\n","import React from \"react\";\r\nimport styled from \"styled-components\";\r\nimport AccountSettings from \"../orgamisms/account-settings\";\r\nimport ChatSettings from \"../orgamisms/chat-settings\";\r\nimport MusicSettings from \"../orgamisms/music-settings\";\r\n\r\nconst SettingsListWrapper = styled.div`\r\n  width: 85%;\r\n  height: 100px;\r\n  border-radius: 5px;\r\n`;\r\n\r\nconst SettingsList = ({ currentPage }) => {\r\n  const settingsPages = [\r\n    <AccountSettings />,\r\n    <MusicSettings />,\r\n    <ChatSettings />,\r\n  ];\r\n  return (\r\n    <SettingsListWrapper>{settingsPages[currentPage]}</SettingsListWrapper>\r\n  );\r\n};\r\n\r\nexport default SettingsList;\r\n","import styled from \"styled-components\";\r\n\r\nconst SettingsSectionItemWrapper = styled.button`\r\n  width: 100%;\r\n  display: flex;\r\n  align-items: center;\r\n  cursor: pointer;\r\n  /* transition: 0.1s; */\r\n  padding: 10px;\r\n  box-sizing: border-box;\r\n  background: ${({ isActive }) =>\r\n    isActive ? \"var(--lightBlue)\" : \"transparent\"};\r\n  color: #fff;\r\n  font-weight: 600;\r\n\r\n  svg {\r\n    margin-right: 7px;\r\n    width: 16px;\r\n    height: 16px;\r\n  }\r\n  /* \r\n  &:hover {\r\n    background: var(--leftSideBarColor);\r\n  } */\r\n`;\r\n\r\nconst SettingsSectionItem = ({ icon, text, onClick, isActive }) => {\r\n  return (\r\n    <SettingsSectionItemWrapper onClick={onClick} isActive={isActive}>\r\n      {icon}\r\n      {text}\r\n    </SettingsSectionItemWrapper>\r\n  );\r\n};\r\n\r\nexport default SettingsSectionItem;\r\n","import React from \"react\";\r\nimport styled from \"styled-components\";\r\nimport SettingsSectionItem from \"../atoms/settings-section-item\";\r\nimport { BiMusic } from \"react-icons/bi\";\r\nimport { FiMessageCircle, FiUser } from \"react-icons/fi\";\r\n\r\nconst SettingsSectionsWrapper = styled.div`\r\n  width: 15%;\r\n  border-radius: 5px;\r\n  overflow: hidden;\r\n  background: var(--leftSideBarColor);\r\n`;\r\n\r\nconst SettingsSections = ({ currentPage, setCurrentPage }) => {\r\n  return (\r\n    <SettingsSectionsWrapper>\r\n      <SettingsSectionItem\r\n        icon={<FiUser />}\r\n        text={\"Account\"}\r\n        onClick={() => setCurrentPage(0)}\r\n        isActive={currentPage === 0}\r\n      />\r\n      <SettingsSectionItem\r\n        icon={<BiMusic />}\r\n        text={\"Music\"}\r\n        onClick={() => setCurrentPage(1)}\r\n        isActive={currentPage === 1}\r\n      />\r\n      <SettingsSectionItem\r\n        icon={<FiMessageCircle />}\r\n        text={\"Chat\"}\r\n        onClick={() => setCurrentPage(2)}\r\n        isActive={currentPage === 2}\r\n      />\r\n      <SettingsSectionItem\r\n        icon={<BiMusic />}\r\n        text={\"Music\"}\r\n        onClick={() => setCurrentPage(3)}\r\n        isActive={currentPage === 3}\r\n      />\r\n    </SettingsSectionsWrapper>\r\n  );\r\n};\r\n\r\nexport default SettingsSections;\r\n","import React, { useState } from \"react\";\r\nimport styled from \"styled-components\";\r\nimport { ContentContainer } from \"../../components/Containers/ContentContainer\";\r\nimport SettingsList from \"./ui/molecules/settings-list\";\r\nimport SettingsSections from \"./ui/molecules/settings-sections\";\r\n\r\nconst SettingsPageWrapper = styled.div`\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: flex-start;\r\n`;\r\n\r\nconst SettingsPage = () => {\r\n  const [currentPage, setCurrentPage] = useState(0);\r\n  return (\r\n    <ContentContainer>\r\n      <h2>Settings</h2>\r\n      <SettingsPageWrapper>\r\n        <SettingsSections\r\n          setCurrentPage={setCurrentPage}\r\n          currentPage={currentPage}\r\n        />\r\n        <SettingsList currentPage={currentPage} />\r\n      </SettingsPageWrapper>\r\n    </ContentContainer>\r\n  );\r\n};\r\n\r\nexport default SettingsPage;\r\n","import { CHAT_ROUTE, HISTORY_ROUTE, HOME_ROUTE, LIBRARY_ROUTE, LOGIN_ROUTE, NOTFOUND_ROUTE, SEARCH_ROUTE, SIGNUP_ROUTE, TEMPLATE_ALBUM, TEMPLATE_AUTHOR, TEMPLATE_CHAT, SETTINGS_ROUTE, LYRICS_EDITING_ROUTE } from \"./utils/route-consts\";\r\nimport { LibraryPage, ChatPage, PageNotFound, AlbumPage, DialoguePage, AuthorPage, LogInPage, HomePage, SearchPage, HistoryPage, SettingsPage, SignUpPage, LyricsEditingPage } from \"./pages\";\r\nexport const publicRoutes = [\r\n\t{\r\n\t\tpath: LOGIN_ROUTE,\r\n\t\tComponent: LogInPage,\r\n\t},\r\n\t{\r\n\t\tpath: SIGNUP_ROUTE,\r\n\t\tComponent: SignUpPage,\r\n\t}\r\n]\r\n\r\nexport const privateRoutes = [\r\n\t{\r\n\t\tpath: HOME_ROUTE,\r\n\t\tComponent: HomePage,\r\n\t},\r\n\t{\r\n\t\tpath: LIBRARY_ROUTE,\r\n\t\tComponent: LibraryPage,\r\n\t},\r\n\t{\r\n\t\tpath: SEARCH_ROUTE,\r\n\t\tComponent: SearchPage,\r\n\t},\r\n\t{\r\n\t\tpath: CHAT_ROUTE,\r\n\t\tComponent: ChatPage,\r\n\t},\r\n\t{\r\n\t\tpath: NOTFOUND_ROUTE,\r\n\t\tComponent: PageNotFound\r\n\t},\r\n\t{\r\n\t\tpath: TEMPLATE_CHAT,\r\n\t\tComponent: DialoguePage\r\n\t},\r\n\t{\r\n\t\tpath: TEMPLATE_ALBUM,\r\n\t\tComponent: AlbumPage\r\n\t},\r\n\t{\r\n\t\tpath: TEMPLATE_AUTHOR,\r\n\t\tComponent: AuthorPage\r\n\t},\r\n\t{\r\n\t\tpath: HISTORY_ROUTE,\r\n\t\tComponent: HistoryPage\r\n\t},\r\n\t{\r\n\t\tpath: SETTINGS_ROUTE,\r\n\t\tComponent: SettingsPage\r\n\t},\r\n\t{\r\n\t\tpath: LYRICS_EDITING_ROUTE,\r\n\t\tComponent: LyricsEditingPage\r\n\t}\r\n]","import React, { useState } from \"react\";\r\nimport { ColorExtractor } from \"react-color-extractor\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { FullScreenLoading } from \"../../components/Loading/FullScreenLoading\";\r\nimport { BlurredBg } from \"../../components/SignIn-Up/BlurredBg\";\r\nimport { RadioBtn } from \"../../components/SignIn-Up/RadioBtn\";\r\nimport { TitleAndLogo } from \"../../components/SignIn-Up/TitleAndLogo\";\r\nimport { useAuth } from \"../../contexts/AuthContext\";\r\nimport DownloadButton from \"../../shared/ui/atoms/download-button\";\r\nimport Input from \"../../shared/ui/atoms/input\";\r\nimport \"../../styles/SignIn-Up.css\";\r\nimport { LOGIN_ROUTE } from \"../../utils/route-consts\";\r\n\r\nconst SignUpPage = () => {\r\n  const [currentRoleChoice, setCurrentRoleChoice] = useState(1);\r\n  const [email, setEmail] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [name, setName] = useState(\"\");\r\n  const [errorMessage, setErrorMessage] = useState(\"\");\r\n  const [loading, setLoading] = useState(false);\r\n  const { signup } = useAuth();\r\n  const [photoURL, setPhotoURL] = useState(\"\");\r\n  const isValid =\r\n    email.length !== 0 && password.length !== 0 && name.length !== 0;\r\n  const [imageLocalPath, setImageLocalPath] = useState(\"\");\r\n  const [imageColors, setImageColors] = useState([]);\r\n\r\n  async function handleSubmit(e) {\r\n    e.preventDefault();\r\n    if (!isValid) {\r\n      return setErrorMessage(\"One of your fields is totaly empty\");\r\n    }\r\n\r\n    await signup(\r\n      email,\r\n      name,\r\n      password,\r\n      currentRoleChoice,\r\n      photoURL,\r\n      imageColors,\r\n      setErrorMessage,\r\n      setLoading\r\n    );\r\n  }\r\n  return (\r\n    <div className=\"In-Up-Container\">\r\n      <ColorExtractor\r\n        src={imageLocalPath}\r\n        getColors={(colors) => setImageColors(colors)}\r\n      />\r\n      <div className=\"CentralPlate\">\r\n        <FullScreenLoading loading={loading} />\r\n        <TitleAndLogo title=\"Sign Up\" />\r\n\r\n        {errorMessage && <div className=\"Alert\">{errorMessage}</div>}\r\n\r\n        <div className=\"inner-plate-content\">\r\n          <Input\r\n            type=\"email\"\r\n            placeholder=\"Enter your email\"\r\n            value={email}\r\n            setValue={setEmail}\r\n            margin\r\n          />\r\n          <Input\r\n            type=\"text\"\r\n            placeholder=\"Enter your name\"\r\n            value={name}\r\n            setValue={setName}\r\n            margin\r\n          />\r\n          <Input\r\n            type=\"password\"\r\n            placeholder=\"Create password\"\r\n            value={password}\r\n            setValue={setPassword}\r\n            margin\r\n          />\r\n          <div\r\n            style={{\r\n              display: \"flex\",\r\n              width: \"100%\",\r\n              justifyContent: \"center\",\r\n              margin: \"5px 0 15px 0\",\r\n            }}\r\n          >\r\n            <RadioBtn\r\n              label=\"User\"\r\n              onClick={() => setCurrentRoleChoice(0)}\r\n              currentActive={currentRoleChoice}\r\n              id={0}\r\n            />\r\n            <RadioBtn\r\n              label=\"Author\"\r\n              onClick={() => setCurrentRoleChoice(1)}\r\n              currentActive={currentRoleChoice}\r\n              id={1}\r\n            />\r\n          </div>\r\n          <DownloadButton\r\n            text=\"Download photo\"\r\n            place={\"usersImages/\"}\r\n            setItemSrc={setPhotoURL}\r\n            setImageLocalPath={setImageLocalPath}\r\n          />\r\n          <div className=\"inAndUpBtns\">\r\n            <button\r\n              className=\"upBtn\"\r\n              type=\"submit\"\r\n              disabled={loading}\r\n              onClick={handleSubmit}\r\n            >\r\n              Sign Up\r\n            </button>\r\n            <Link to={LOGIN_ROUTE}>\r\n              <button className=\"inBtn\">Already registered</button>\r\n            </Link>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <BlurredBg />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SignUpPage;\r\n","import React from 'react'\r\nimport { Route, Switch, Redirect } from 'react-router-dom'\r\nimport { privateRoutes } from '../routes'\r\nimport { HOME_ROUTE } from '../utils/route-consts'\r\n\r\nexport const ContentRouter = () => {\r\n\treturn (\r\n\t\t<Switch>\r\n\t\t\t{privateRoutes.map(({ path, Component }, i) => {\r\n\t\t\t\treturn <Route path={path} component={Component} exact key={path} />\r\n\t\t\t})}\r\n\t\t\t<Redirect to={HOME_ROUTE} />\r\n\t\t</Switch>\r\n\t)\r\n}\r\n","import { useEffect, useState } from 'react';\r\nimport { useRouteMatch } from 'react-router';\r\nimport { useAuth } from '../../../contexts/AuthContext';\r\nimport { firestore } from '../../../firebase';\r\n\r\nconst useChatNotifications = () => {\r\n\tconst [notifications, setNotifications] = useState([]);\r\n\tconst { currentUser } = useAuth()\r\n\tconst match = useRouteMatch(\"/chat/:chatId\");\r\n\tconst chatId = match?.params?.chatId\r\n\r\n\tuseEffect(() => {\r\n\t\tconst tempObj = {}\r\n\t\tconst unsubscribe = firestore\r\n\t\t\t.collection(\"chats\")\r\n\t\t\t.where(\"participants\", \"array-contains\", currentUser.uid)\r\n\t\t\t.onSnapshot((snapshot) => {\r\n\t\t\t\tsetNotifications((prev) => {\r\n\t\t\t\t\tconst temp = [...prev];\r\n\t\t\t\t\tsnapshot.docChanges().map(async (doc) => {\r\n\t\t\t\t\t\tconst chatData = doc.doc.data()\r\n\t\t\t\t\t\tif (chatId !== chatData.id) {\r\n\t\t\t\t\t\t\tif (doc.type === 'added') tempObj[chatData.id] = chatData.messages.length\r\n\t\t\t\t\t\t\telse if (doc.type === \"modified\" && chatData.messages.length && !!tempObj[chatData.id] && chatData.messages.length !== tempObj[chatData.id]) {\r\n\t\t\t\t\t\t\t\tconst { id, chatName, chatImage, messages } = chatData;\r\n\t\t\t\t\t\t\t\tconst lastMessage = messages[messages.length - 1];\r\n\t\t\t\t\t\t\t\tconst shouldPushNotif =\r\n\t\t\t\t\t\t\t\t\tlastMessage.sender !== currentUser.uid &&\r\n\t\t\t\t\t\t\t\t\t!lastMessage.seenBy.includes(currentUser.uid)\r\n\r\n\t\t\t\t\t\t\t\tif (shouldPushNotif) {\r\n\t\t\t\t\t\t\t\t\ttemp.push({\r\n\t\t\t\t\t\t\t\t\t\tchatId: id,\r\n\t\t\t\t\t\t\t\t\t\tchatName,\r\n\t\t\t\t\t\t\t\t\t\tchatImage,\r\n\t\t\t\t\t\t\t\t\t\tmessage: messages[messages.length - 1],\r\n\t\t\t\t\t\t\t\t\t\tuserId: messages[messages.length - 1].sender,\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\ttempObj[id] += 1\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn temp;\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\treturn () => {\r\n\t\t\tunsubscribe();\r\n\t\t};\r\n\t}, [chatId]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (notifications.length) {\r\n\t\t\tlet timeout;\r\n\t\t\ttimeout = setTimeout(() => {\r\n\t\t\t\tsetNotifications((prev) => prev.slice(1, prev.length));\r\n\t\t\t}, 4700);\r\n\t\t}\r\n\t}, [notifications.length]);\r\n\r\n\treturn [notifications, setNotifications]\r\n}\r\n\r\nexport default useChatNotifications\r\n","import React from 'react'\r\nimport { Link } from 'react-router-dom'\r\n\r\nexport const MobileControlBarItem = ({element, currentPage, setCurrentPage}) => {\r\n\treturn (\r\n\t\t<Link to = {element.link} className = 'MobileControlBarItem' onClick = {()=>setCurrentPage(element.id)} style = {element.id === currentPage?{color:'var(--blue)'}:{}}>\t\r\n\t\t\t{element.icon}\r\n\t\t</Link>\r\n\t)\r\n}\r\n","import React, { useState } from \"react\";\r\nimport { BiUserCircle } from \"react-icons/bi\";\r\nimport { useAuth } from \"../../contexts/AuthContext\";\r\nimport normalizeString from \"../../functions/other/normalizeString\";\r\nimport { leftSideBar } from \"../../shared/data/left-side-bar\";\r\nimport \"../../styles/BottomControlBar.css\";\r\nimport { MobileControlBarItem } from \"../BottomControlBar/MobileControlBarItem\";\r\nexport const BottomControlBar = () => {\r\n  const { currentUser } = useAuth();\r\n  const userElement = {\r\n    icon: <BiUserCircle />,\r\n    link: `/authors/${currentUser.uid}`,\r\n  };\r\n  const [currentPage, setCurrentPage] = useState(() => {\r\n    let page = leftSideBar.find((el, i) => {\r\n      if (window.location.hash.includes(normalizeString(el.title))) {\r\n        return true;\r\n      }\r\n\r\n      return false;\r\n    });\r\n    return page === undefined ? 0 : page.id;\r\n  });\r\n\r\n  return (\r\n    <div className=\"BottomControlBar\">\r\n      {leftSideBar.map((el, i) => {\r\n        return (\r\n          <MobileControlBarItem\r\n            element={el}\r\n            key={i}\r\n            currentPage={currentPage}\r\n            setCurrentPage={setCurrentPage}\r\n          />\r\n        );\r\n      })}\r\n      <MobileControlBarItem\r\n        element={userElement}\r\n        currentPage={currentPage}\r\n        setCurrentPage={setCurrentPage}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport { useSong } from \"../../contexts/SongContext\";\r\nimport { Player } from \"../../features/full-screen-player/ui/organisms/player\";\r\n\r\nimport { BottomControlBar } from \"./BottomControlBar\";\r\n\r\nexport const FullBottomSide = () => {\r\n  const { setOpenFullScreenPlayer, inputRange } = useSong();\r\n  return (\r\n    <div className=\"FullBottomSide\">\r\n      <span\r\n        onClick={() => setOpenFullScreenPlayer(true)}\r\n        style={{\r\n          display: \"block\",\r\n          position: \"relative\",\r\n        }}\r\n      >\r\n        <Player textLimit={25} linkToAuthors={false} />\r\n        <span\r\n          className=\"mobileSongRange\"\r\n          style={{ width: inputRange + \"%\" }}\r\n        ></span>\r\n      </span>\r\n      <BottomControlBar />\r\n    </div>\r\n  );\r\n};\r\n","export default __webpack_public_path__ + \"static/media/notification.cdade1f4.mp3\";","import React, { useEffect, useState } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport styled from \"styled-components\";\r\nimport { LastSentMessage } from \"../../features/chats/ui/molecules/last-sent-message\";\r\nimport { firestore } from \"../../firebase\";\r\nimport notifSound from \"../../music/notification.mp3\";\r\n\r\nconst ChatNotificationWindowWrapper = styled.div`\r\n  color: #fff;\r\n  padding: 20px;\r\n  box-sizing: border-box;\r\n  border-radius: var(--standartBorderRadius2);\r\n  background: #000000b9;\r\n  position: absolute;\r\n  bottom: 20px;\r\n  right: 20px;\r\n  transition: 0.2s;\r\n  transform: translateY(\r\n    ${({ show, index }) => (!show ? \"90px\" : `-${index * 90 + index * 10}px`)}\r\n  );\r\n  opacity: ${({ show }) => (show ? \"1\" : \"0\")};\r\n  width: 250px;\r\n  height: 90px;\r\n\r\n  a {\r\n    text-decoration: none;\r\n  }\r\n\r\n  &:hover {\r\n    background: #1f1f1fb3;\r\n  }\r\n\r\n  .image-and-name {\r\n    display: flex;\r\n    justify-content: flex-start;\r\n    align-items: center;\r\n    font-weight: bold;\r\n\r\n    img {\r\n      width: 25px;\r\n      height: 25px;\r\n      border-radius: 100%;\r\n      margin-right: 7px;\r\n    }\r\n  }\r\n\r\n  .message {\r\n    margin-top: 10px;\r\n    display: flex;\r\n    white-space: nowrap;\r\n    overflow: hidden;\r\n  }\r\n`;\r\n\r\nconst ChatNotificationWindow = ({\r\n  chatId,\r\n  chatName,\r\n  chatImage,\r\n  message,\r\n  userId,\r\n  index,\r\n  notifsLen = 0,\r\n}) => {\r\n  const [userData, setUserData] = useState(null);\r\n  const [show, setShow] = useState(false);\r\n\r\n  useEffect(() => {\r\n    firestore\r\n      .collection(\"users\")\r\n      .doc(userId)\r\n      .get()\r\n      .then((res) => {\r\n        setShow(true);\r\n        const notificationSound = new Audio(notifSound);\r\n        notificationSound.play();\r\n        setUserData(res.data());\r\n        setTimeout(() => {\r\n          setShow(false);\r\n        }, 4500);\r\n      });\r\n  }, []);\r\n\r\n  // TODO: –¥–æ–±–∞–≤–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤–∫–ª—é—á–∏—Ç—å —Ç—Ä–µ–∫ –ø–æ –Ω–∞–∂–∞—Ç–∏—é –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ, –µ—Å–ª–∏ –≤ –Ω–µ–º –µ—Å—Ç—å —Ç—Ä–µ–∫\r\n\r\n  return (\r\n    <ChatNotificationWindowWrapper show={show} index={index}>\r\n      <Link to={`/chat/${chatId}`}>\r\n        <div className=\"image-and-name\">\r\n          <img\r\n            src={chatImage?.length ? chatImage : userData?.photoURL}\r\n            alt=\"\"\r\n          />\r\n          {chatName.length ? chatName : userData?.displayName}\r\n        </div>\r\n        <div className=\"message\">\r\n          <LastSentMessage\r\n            sender={userData}\r\n            isGroup={chatName.length}\r\n            message={message}\r\n            messageLen={20}\r\n          />\r\n        </div>\r\n      </Link>\r\n    </ChatNotificationWindowWrapper>\r\n  );\r\n};\r\n\r\nexport default ChatNotificationWindow;\r\n","import React, { useRef } from \"react\";\r\nimport { useModal } from \"../../contexts/ModalContext\";\r\nimport useOutsideClick from \"../../shared/lib/hooks/use-outside-click\";\r\n\r\nexport const ConfirmWindow = () => {\r\n  const { isOpenConfirm, confirmContent, setIsOpenConfirm, closeConfirm } =\r\n    useModal();\r\n  const confirmRef = useRef(null);\r\n  useOutsideClick(confirmRef, setIsOpenConfirm);\r\n  return (\r\n    <div\r\n      className=\"modal_darkBg confirm\"\r\n      style={!isOpenConfirm ? { opacity: 0, visibility: \"hidden\" } : {}}\r\n    >\r\n      <div\r\n        className=\"ConfirmWindow\"\r\n        ref={confirmRef}\r\n        style={!isOpenConfirm ? { transform: \"translateY(40px)\" } : {}}\r\n      >\r\n        <h3>{confirmContent.question}</h3>\r\n        <div className=\"confirmButtons\">\r\n          <button onClick={confirmContent.onConfirm} className=\"standartButton\">\r\n            {confirmContent.confirmText}\r\n          </button>\r\n          <button onClick={confirmContent.onReject} className=\"standartButton\">\r\n            {confirmContent.rejectText}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport { FaRegCheckCircle, FaRegTimesCircle } from \"react-icons/fa\";\r\nimport { useModal } from \"../../contexts/ModalContext\";\r\n\r\nexport const MessageWindow = () => {\r\n  const { bottomMessage } = useModal();\r\n\r\n  const findIcon = () => {\r\n    switch (bottomMessage.type) {\r\n      case \"success\":\r\n        return <FaRegCheckCircle />;\r\n      case \"failure\":\r\n        return <FaRegTimesCircle />;\r\n      default:\r\n        return <FaRegCheckCircle />;\r\n    }\r\n  };\r\n\r\n  const findColor = () => {\r\n    switch (bottomMessage.type) {\r\n      case \"success\":\r\n        return { light: \"#69e985\", dark: \"#12321ce6\" };\r\n      case \"failure\":\r\n        return { light: \"#f4546a\", dark: \"#581921d8\" };\r\n      default:\r\n        return { light: \"#69e985\", dark: \"#12321ce6\" };\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div\r\n      className={`bottom-message ${bottomMessage.isOpenned ? \"openned\" : \"\"}`}\r\n      style={{ background: findColor().dark, color: findColor().light }}\r\n    >\r\n      {findIcon()}\r\n      <span>{bottomMessage.message}</span>\r\n    </div>\r\n  );\r\n};\r\n","import React, { useState } from \"react\";\r\nimport { useRef } from \"react\";\r\nimport { useModal } from \"../../contexts/ModalContext\";\r\nimport useOutsideClick from \"../../shared/lib/hooks/use-outside-click\";\r\nimport { useScreen } from \"../../contexts/ScreenContext\";\r\nexport const ModalWindow = ({ ...restProps }) => {\r\n  const { openModal, setOpenModal, content } = useModal();\r\n  const modalRef = useRef(null);\r\n  const { screenHeight } = useScreen();\r\n  useOutsideClick(modalRef, setOpenModal);\r\n  return (\r\n    <div\r\n      className=\"modal_darkBg\"\r\n      style={\r\n        !openModal\r\n          ? { opacity: 0, visibility: \"hidden\" }\r\n          : { height: screenHeight }\r\n      }\r\n    >\r\n      <div\r\n        className=\"ModalWindow\"\r\n        {...restProps}\r\n        ref={modalRef}\r\n        style={\r\n          !openModal\r\n            ? {\r\n                opacity: 0,\r\n                visibility: \"hidden\",\r\n                transform: \"translateY(40px)\",\r\n              }\r\n            : {}\r\n        }\r\n      >\r\n        {content}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { useAuth } from \"../../contexts/AuthContext\";\r\nimport { useScreen } from \"../../contexts/ScreenContext\";\r\nimport { useSong } from \"../../contexts/SongContext\";\r\nimport FullScreenPlayer from \"../../features/full-screen-player/ui/full-screen-player\";\r\n\r\nimport { LeftsideBar } from \"../../features/leftside-bar/ui/organisms/leftside-bar\";\r\nimport { firestore } from \"../../firebase\";\r\nimport { useMediaMetadata } from \"../../hooks/useMediaMetadata\";\r\nimport { useUpdateListenCount } from \"../../hooks/useUpdateListenCount\";\r\nimport { ContentRouter } from \"../../routers/ContentRouter\";\r\nimport useChatNotifications from \"../../shared/lib/hooks/use-chat-notifications\";\r\nimport \"../../styles/FullScreenPlayer.css\";\r\nimport { FullBottomSide } from \"../Mobile/FullBottomSide\";\r\nimport ChatNotificationWindow from \"../Windows/chat-notification-window\";\r\nimport { ConfirmWindow } from \"../Windows/ConfirmWindow\";\r\nimport { MessageWindow } from \"../Windows/MessageWindow\";\r\nimport { ModalWindow } from \"../Windows/ModalWindow\";\r\n\r\nexport const ContentWrapper = () => {\r\n  const {\r\n    songRef,\r\n    loadSongData,\r\n    playing,\r\n    songSrc,\r\n    openFullScreenPlayer,\r\n    repeatMode,\r\n    setPlay,\r\n    prevSong,\r\n    currentSongQueue,\r\n    nextSong,\r\n  } = useSong();\r\n  const { isMobile, screenHeight } = useScreen();\r\n  const { currentUser } = useAuth();\r\n  const fiveMinutes = 300000; // 10min\r\n  const [intervalExciter, setIntervalExciter] = useState(true);\r\n  const [notifications, setNotifications] = useChatNotifications();\r\n\r\n  useMediaMetadata();\r\n  const updateListenCount = useUpdateListenCount();\r\n  useEffect(() => {\r\n    const interval = setInterval(() => {\r\n      firestore\r\n        .collection(\"users\")\r\n        .doc(currentUser.uid)\r\n        .update({ online: new Date().getTime() });\r\n      setIntervalExciter(!intervalExciter);\r\n    }, fiveMinutes);\r\n    return () => clearInterval(interval);\r\n  }, [intervalExciter]);\r\n\r\n  useEffect(() => {\r\n    firestore\r\n      .collection(\"users\")\r\n      .doc(currentUser.uid)\r\n      .update({ online: new Date().getTime() });\r\n  }, []);\r\n\r\n  function audioEnded() {\r\n    if (repeatMode === 0) {\r\n      songRef.current.pause();\r\n      setPlay(false);\r\n      return prevSong();\r\n    } else if (repeatMode === 1) {\r\n      if (currentSongQueue.length === 1) {\r\n        prevSong();\r\n        updateListenCount();\r\n        return songRef.current.play();\r\n      }\r\n      return nextSong();\r\n    }\r\n    prevSong();\r\n    updateListenCount();\r\n    songRef.current.play();\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <audio\r\n        src={songSrc}\r\n        ref={songRef}\r\n        onLoadedData={loadSongData}\r\n        onTimeUpdate={playing}\r\n        onEnded={audioEnded}\r\n      ></audio>\r\n      <div\r\n        className={\"Wrapper \" + (openFullScreenPlayer ? \"turnedOff\" : \"\")}\r\n        style={isMobile ? { height: screenHeight } : { height: \"100vh\" }}\r\n      >\r\n        {!isMobile ? (\r\n          <LeftsideBar />\r\n        ) : window.location.hash.substr(2, 4) === \"chat\" &&\r\n          window.location.hash.length > 6 ? null : (\r\n          <FullBottomSide />\r\n        )}\r\n        <div className=\"Content\">\r\n          <ContentRouter />\r\n        </div>\r\n        <MessageWindow />\r\n        <ModalWindow />\r\n        <ConfirmWindow />\r\n        {notifications.map((notif, index) => {\r\n          return (\r\n            <ChatNotificationWindow\r\n              {...notif}\r\n              index={index}\r\n              notifsLen={notifications.length}\r\n              setNotifications={setNotifications}\r\n            />\r\n          );\r\n        })}\r\n      </div>\r\n      <FullScreenPlayer />\r\n    </>\r\n  );\r\n};\r\n","import React, { useEffect, useRef } from 'react'\r\nimport { useSong } from '../contexts/SongContext'\r\nimport { firestore } from '../firebase'\r\n\r\nexport const useUpdateListenCount = () => {\r\n\tlet listenCountTimeOut = useRef()\r\n\tconst { currentSongData, currentSongPlaylistSource, songDuration, play } = useSong()\r\n\tfunction updateListenCount() {\r\n\t\tif (currentSongData.id !== -1) {\r\n\t\t\tlistenCountTimeOut.current = setTimeout(async () => {\r\n\t\t\t\tlet listens = (await firestore.collection('songs').doc(currentSongData.id).get()).data().listens\r\n\t\t\t\t++listens\r\n\t\t\t\tfirestore.collection('songs').doc(currentSongData.id).update({\r\n\t\t\t\t\tlistens: listens\r\n\t\t\t\t})\r\n\r\n\t\t\t\t//update playlist listens\r\n\t\t\t\tif (currentSongPlaylistSource.source.substr(1, 6) === 'albums') {\r\n\t\t\t\t\tconst sourceId = currentSongPlaylistSource.source.substr(8, currentSongPlaylistSource.source.length - 8)\r\n\t\t\t\t\tfirestore.collection('playlists').doc(sourceId).get().then((res) => {\r\n\t\t\t\t\t\tlet listedData = res.data().listens\r\n\t\t\t\t\t\tlistedData++\r\n\t\t\t\t\t\tfirestore.collection('playlists').doc(sourceId).update({\r\n\t\t\t\t\t\t\tlistens: listedData\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//update authors' listens\r\n\t\t\t\tcurrentSongData.authors.forEach(async author => {\r\n\t\t\t\t\tlet authorNumberOfListenersPerMonth = (await firestore.collection('users').doc(author.uid).get()).data().numberOfListenersPerMonth\r\n\t\t\t\t\t++authorNumberOfListenersPerMonth\r\n\t\t\t\t\tfirestore.collection('users').doc(author.uid).update({\r\n\t\t\t\t\t\tnumberOfListenersPerMonth: authorNumberOfListenersPerMonth\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t}, songDuration * 1000 * 0.5)\r\n\t\t}\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tclearTimeout(listenCountTimeOut.current)\r\n\t\tif (play) {\r\n\t\t\tupdateListenCount()\r\n\t\t}\r\n\t}, [play, currentSongData.id])\r\n\r\n\treturn updateListenCount\r\n}\r\n","import React from 'react'\r\nimport { Route, Switch, Redirect } from 'react-router-dom'\r\nimport { ContentWrapper } from '../components/Basic/ContentWrapper'\r\nimport { useAuth } from '../contexts/AuthContext'\r\nimport { publicRoutes } from '../routes'\r\nimport { LOGIN_ROUTE } from '../utils/route-consts'\r\n\r\nexport const AppRouter = () => {\r\n\tconst { currentUser } = useAuth()\r\n\treturn currentUser.uid ?\r\n\t\t(\r\n\t\t\t<Switch>\r\n\t\t\t\t<Route path='/' component={ContentWrapper} />\r\n\t\t\t</Switch>\r\n\t\t) :\r\n\t\t(\r\n\t\t\t<Switch>\r\n\t\t\t\t{publicRoutes.map(({ path, Component }, i) => {\r\n\t\t\t\t\treturn <Route path={path} component={Component} exact={true} key={i} />\r\n\t\t\t\t})}\r\n\t\t\t\t<Redirect to={LOGIN_ROUTE} />\r\n\t\t\t</Switch>\r\n\t\t)\r\n}\r\n","import './index.css';\r\nimport React from 'react'\r\nimport { HashRouter } from 'react-router-dom';\r\nimport { AppRouter } from '../routers/AppRouter';\r\nexport default function App() {\r\n  return (\r\n    <HashRouter basename=\"/\">\r\n      <AppRouter />\r\n    </HashRouter>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './app';\r\nimport { AuthProvider } from './contexts/AuthContext';\r\nimport { ModalClassProvider } from './contexts/ModalContext';\r\nimport { ScreenProvider } from './contexts/ScreenContext';\r\nimport { SongProvider } from './contexts/SongContext';\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <ScreenProvider>\r\n      <AuthProvider>\r\n        <ModalClassProvider>\r\n          <SongProvider>\r\n            <App />\r\n          </SongProvider>\r\n        </ModalClassProvider>\r\n      </AuthProvider>\r\n    </ScreenProvider>\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n"],"sourceRoot":""}