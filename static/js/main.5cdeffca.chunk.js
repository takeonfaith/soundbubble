(this.webpackJsonpsoundbubble=this.webpackJsonpsoundbubble||[]).push([[0],{269:function(e,t,n){},270:function(e,t,n){},271:function(e,t,n){},272:function(e,t,n){},273:function(e,t,n){},274:function(e,t,n){},275:function(e,t,n){},276:function(e,t,n){},277:function(e,t,n){},278:function(e,t,n){},279:function(e,t,n){"use strict";n.r(t);var s=n(2),a=n.n(s),c=n(123),r=n.n(c),i=(n(92),n(13)),o=n(17),l=n(6),u=n.n(l),d=n(8),j=n(3),b=n(129),h=n(88);n(138),n(139),n(140),n(141);var f=h.a.initializeApp({apiKey:"AIzaSyBuDoETyUrO2RCDAlFMsW2uV-QmtCT8t6Y",authDomain:"soundbubble-27737.firebaseapp.com",projectId:"soundbubble-27737",storageBucket:"soundbubble-27737.appspot.com",messagingSenderId:"527274299416",appId:"1:527274299416:web:64b1ac2d05f4262df0736d",measurementId:"G-9TP9PEEV11"});h.a.analytics();var O=f.auth(),p=f.storage(),m=f.firestore();function g(e){return e.replace(/\s/g,"").replace(/\$/g,"s").replace(/[,'._/]/g,"").replace(/-/g,"").toLowerCase()}var x=function(e){for(var t=[],n=g(e),s=1;s<n.length+1;s++)t.push(n.substr(0,s));return t},v=n(1),y=a.a.createContext(),S=function(){return Object(s.useContext)(y)},w=function(e){var t=e.children,n=Object(s.useState)({}),a=Object(j.a)(n,2),c=a[0],r=a[1],i=Object(s.useState)(null),o=Object(j.a)(i,2),l=o[0],h=o[1],f=Object(s.useState)(!0),p=Object(j.a)(f,2),g=p[0],S=p[1],w=Object(s.useState)(""),C=Object(j.a)(w,2),N=C[0],k=C[1];Object(s.useEffect)((function(){if(null!==l)return m.collection("users").doc(l).onSnapshot((function(e){e.data()&&void 0===c.uid&&r(e.data())}))}),[m,l]),Object(s.useEffect)((function(){return O.onAuthStateChanged(function(){var e=Object(d.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t?h(t.uid):(h(null),r({}),S(!1));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]);var I={currentUser:c,setCurrentUser:r,login:function(e,t,n,s){return s(!0),O.signInWithEmailAndPassword(e,t).then().catch((function(e){n(e.message),s(!1)}))},signup:function(e,t,n,s,a,c,r,i){return i(!0),O.createUserWithEmailAndPassword(e,n).then((function(e){m.collection("users").doc(e.user.uid).set({uid:e.user.uid,displayName:t,photoURL:a||"https://images.fineartamerica.com/images/artworkimages/mediumlarge/1/music-icon-mohammed-jabir-ap.jpg",isAuthor:1===parseInt(s),isVerified:1===parseInt(s),numberOfListenersPerMonth:0,ownSongs:[],ownPlaylists:[],addedSongs:[],addedPlaylists:[],addedAuthors:[],lastSongPlayed:"",chats:[],friends:[],subscribers:0,regDate:b.a.firestore.FieldValue.serverTimestamp(),imageColors:c}),m.collection("search").doc(e.user.uid).set({place:"users",uid:e.user.uid,rank:0,variantsOfName:x(t)}),m.collection("searchHistory").doc(e.user.uid).set({history:[]}),m.collection("history").doc(e.user.uid).set({history:[]}),i(!1)})).catch((function(e){r(e.message)}))},logout:function(){return O.signOut()},loading:g,setLoading:S,searchValue:N,setSearchValue:k};return Object(v.jsx)(y.Provider,{value:I,children:t})},C="/login",N="/signup",k="/home",I="/library",A="/search",P="/chat",L="/history",M=function(e){var t=e.top,n=void 0===t?"20%":t;return Object(v.jsx)("div",{className:"LoadingCircle",style:{top:n},children:Object(v.jsx)("img",{loading:"lazy",src:"https://icon-library.com/images/spinner-icon-gif/spinner-icon-gif-28.jpg",alt:""})})},T=n(22),E=n.p+"static/media/Logo3.fc53f4ac.svg",R=function(){return Object(v.jsx)("div",{className:"LoadingData",children:Object(v.jsx)("img",{loading:"lazy",src:E,alt:""})})},D=function(e,t){m.collection("history").doc(t.uid).get().then((function(n){var s=n.data().history;s[0]!==e&&s.unshift(e),s.length>30&&(s.length=30),m.collection("history").doc(t.uid).update({history:s})}))},B=n(16),F=n(33),U=n(14),W=n(9),V=n(49),z=function(e){var t=e.listOfChosenItems,n=e.setListOfChosenItems,s=e.itemId;return void 0!==t?Object(v.jsx)("div",{onClick:function(e){return e.preventDefault()},style:{width:"35px"},children:t.includes(s)?Object(v.jsx)("button",{type:"button",onClick:function(e){var a=t.filter((function(e){return e!==s}));n(a)},className:"addToListBtn",children:Object(v.jsx)(V.a,{style:{color:"var(--lightBlue)"}})}):Object(v.jsx)("button",{type:"button",onClick:function(){return n((function(e){return[].concat(Object(W.a)(e),[s])}))},className:"addToListBtn",children:Object(v.jsx)(V.b,{})})}):null},H=n(15);function Y(e){return e%10===e?"0"+e:e}function q(e){var t=new Date(1970,0,1);return t.setSeconds(e),t}function Q(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=["January","February","March","April","May","June","July","August","September","October","November","December"],s=isNaN(e)?new Date(e):e.seconds?q(e.seconds+10800):q(e/1e3+10800);return 0===t?n[s.getMonth()]+" "+s.getDate()+", "+s.getFullYear():1===t?n[s.getMonth()]+" "+s.getDate():2===t?Y(s.getHours())+":"+Y(s.getMinutes()):3===t?n[s.getMonth()]+" "+s.getDate()+", "+s.getFullYear()+" at "+Y(s.getHours())+":"+Y(s.getMinutes()):void 0}var G,X=function(e){var t=e.userUID,n=(Object(F.a)(e,["userUID"]),Object(s.useState)("")),a=Object(j.a)(n,2),c=a[0],r=a[1],i=Object(s.useState)(!1),o=Object(j.a)(i,2),l=o[0],u=o[1];return Object(s.useEffect)((function(){var e=m.collection("users").doc(t).onSnapshot((function(e){if(void 0!==t){var n=(new Date).getTime()-3e5,s=e.data().online>n;u(s),void 0===e.data().online?r("offline"):s||r("last seen "+Q(e.data().online,3))}}));return function(){e()}}),[m,t]),l?Object(v.jsx)("span",{className:"is-online",children:"Online"}):Object(v.jsx)("span",{className:"is-not-online",children:c})},J=H.a.div(G||(G=Object(U.a)(["\n  position: absolute;\n  top: 50%;\n  right: 8px;\n  transform: translateY(-50%);\n"]))),K=function(e){var t=e.data,n=e.chosenArray,s=e.setChosenArray,a=e.lastSeen,c=void 0!==a&&a,r=e.rightButton,i=Object(F.a)(e,["data","chosenArray","setChosenArray","lastSeen","rightButton"]);return Object(v.jsxs)("div",Object(B.a)(Object(B.a)({className:"person"},i),{},{children:[Object(v.jsx)(z,{listOfChosenItems:n,setListOfChosenItems:s,itemId:t.uid}),Object(v.jsx)("div",{className:"personImg",children:Object(v.jsx)("img",{loading:"lazy",src:t.photoURL,alt:""})}),Object(v.jsx)("div",{className:"personName",children:t.displayName}),c&&Object(v.jsx)(X,{userUID:t.uid,className:"is-online"}),Object(v.jsx)(J,{children:r})]}))};function _(e){for(var t=[],n=new Array(e.length),s=0;s<e.length;){var a=Math.floor(Math.random()*e.length);t.includes(a)||(t.push(a),n[a]=e[s],s++)}return n}function $(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e>t?n:e<n?t:e}var Z,ee,te,ne,se=function(e,t,n){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(e){return e},a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){return null},c=arguments.length>5?arguments[5]:void 0,r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;if(null===e||void 0===e?void 0:e.length){var i=e.map(function(){var e=Object(d.a)(u.a.mark((function e(n,s){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection(t).doc(n).get();case 2:return e.abrupt("return",e.sent.data());case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());Promise.all(i).then((function(e){var t=s(e);(null===t||void 0===t?void 0:t.length)>c&&(t.length=c),n(0===r?t:function(e){var n=[];return t.forEach((function(t){t&&(e.find((function(e){return e.id===t.id}))||n.push(t))})),[].concat(Object(W.a)(e),n)}),a()}))}},ae=function(e,t,n,a){Object(s.useEffect)((function(){e.uid&&n&&t()}),[JSON.stringify(a)])},ce=a.a.createContext(),re=function(){return Object(s.useContext)(ce)},ie=function(e){var t=e.children,n=Object(s.useState)(!1),a=Object(j.a)(n,2),c=a[0],r=a[1],i=Object(s.useState)(Object(v.jsx)("h1",{children:"Test"})),o=Object(j.a)(i,2),l=o[0],u=o[1],d=Object(s.useState)({isOpenned:!1,type:"success",message:"Action is successfully done!"}),b=Object(j.a)(d,2),h=b[0],f=b[1],O=Object(s.useState)(!1),p=Object(j.a)(O,2),m=p[0],g=p[1],x=Object(s.useState)({confirmText:"Confirm Action",rejectText:"Cancel",onConfirmL:function(){return null},onReject:function(){return null}}),y=Object(j.a)(x,2),S=y[0],w=y[1];function C(){g(!1)}var N={openModal:c,setOpenModal:r,toggleModal:function(){r(!c)},setContent:u,content:l,isOpenConfirm:m,setIsOpenConfirm:g,openConfirm:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Cancel",s=arguments.length>3?arguments[3]:void 0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:C;g(!0),w({question:e,confirmText:t,rejectText:n,onConfirm:s,onReject:a})},closeConfirm:C,confirmContent:S,bottomMessage:h,openBottomMessage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Success",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e3;f({isOpenned:!0,type:t,message:e}),setTimeout((function(){f({isOpenned:!1,type:t,message:e})}),n)}};return Object(v.jsx)(ce.Provider,{value:N,children:t})},oe=Object(s.createContext)(null),le=function(){return Object(s.useContext)(oe)},ue=function(e){var t=e.children,n=S(),a=n.currentUser,c=n.loading,r=n.setLoading,o=re().setOpenModal,l=Object(s.useState)([]),b=Object(j.a)(l,2),h=b[0],f=b[1],O=Object(s.useState)([]),p=Object(j.a)(O,2),g=p[0],x=p[1],y=Object(s.useState)([]),w=Object(j.a)(y,2),C=w[0],N=w[1],k=Object(s.useState)([]),I=Object(j.a)(k,2),A=I[0],P=I[1],L=Object(s.useState)([]),M=Object(j.a)(L,2),T=M[0],E=M[1],B=Object(s.useState)(-1),F=Object(j.a)(B,2),U=F[0],W=F[1],V=Object(s.useState)(0),z=Object(j.a)(V,2),H=z[0],Y=z[1],q=Object(s.useState)({}),Q=Object(j.a)(q,2),G=Q[0],X=Q[1],J=Object(s.useState)(0),Z=Object(j.a)(J,2),ee=Z[0],te=Z[1],ne=Object(s.useState)({id:-1}),ce=Object(j.a)(ne,2),ie=ce[0],le=ce[1],ue=Object(s.useState)([]),de=Object(j.a)(ue,2),je=de[0],be=de[1],he=Object(s.useState)(!1),fe=Object(j.a)(he,2),Oe=fe[0],pe=fe[1],me=Object(s.useState)(0),ge=Object(j.a)(me,2),xe=ge[0],ve=ge[1],ye=Object(s.useState)(0),Se=Object(j.a)(ye,2),we=Se[0],Ce=Se[1],Ne=Object(s.useState)(1),ke=Object(j.a)(Ne,2),Ie=ke[0],Ae=ke[1],Pe=Object(s.useState)(0),Le=Object(j.a)(Pe,2),Me=Le[0],Te=Le[1],Ee=Object(s.useState)(0),Re=Object(j.a)(Ee,2),De=Re[0],Be=Re[1],Fe=Object(s.useState)(!1),Ue=Object(j.a)(Fe,2),We=Ue[0],Ve=Ue[1],ze=Object(s.useState)(!1),He=Object(j.a)(ze,2),Ye=He[0],qe=He[1],Qe=Object(s.useRef)(null),Ge=Object(s.useRef)(null),Xe=Object(s.useRef)(null),Je=Object(s.useRef)(null),Ke=Object(s.useState)(0),_e=Object(j.a)(Ke,2),$e=_e[0],Ze=_e[1],et=Object(s.useState)(!1),tt=Object(j.a)(et,2),nt=tt[0],st=tt[1];function at(){var e;se(null===a||void 0===a||null===(e=a.lastQueue)||void 0===e?void 0:e.songsList,"songs",E,(function(e){return e}),(function(){return Y(a.lastQueue.songsList.findIndex((function(e){return e===a.lastSongPlayed})))}))}function ct(){se(a.addedSongs.slice(0).reverse(),"songs",f,(function(e){return e}),at)}function rt(){return it.apply(this,arguments)}function it(){return(it=Object(d.a)(u.a.mark((function e(){var t,n,s,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0!==a.uid&&(t={id:-1,name:"",songSrc:"",authors:[],cover:"",listens:0,releaseDate:"",lyrics:[],imageColors:[]},n=a.lastSongPlayed||a.addedSongs[0]||t.id,s=a.lastQueue||{source:"/library",name:"Your Library",image:a.photoURL,songsList:h}||[],W(n),X(s),-1!==n?(c=m.collection("songs").doc(n),c.get().then((function(e){if(e.exists){var t=e.data();le(t),be(t.imageColors||[]),r(!1)}})).catch((function(e){console.log("Error getting document:",e),r(!1)}))):(le(t),be([]),r(!1)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ot(){return(ot=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:-1!==U?m.collection("songs").doc(U).get().then((function(e){if(e.exists){var t=e.data();be(t.imageColors||[]),le(t)}})):rt();case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function lt(){for(var e=0,t=ie.lyrics.length-1,n=parseFloat(parseFloat(Qe.current.currentTime).toFixed(1));e<=t;){var s=Math.floor((e+t)/2),a=parseFloat(parseFloat(ie.lyrics[s].startTime).toFixed(1)),c=s!==ie.lyrics.length-1?parseFloat(parseFloat(ie.lyrics[s+1].startTime).toFixed(1)):t;if("undefined"===ie.lyrics[s].startTime)return;if(n>=a&&n<=c){Be(s);break}a<n?e=s+1:t=s-1}}function ut(){return(ut=Object(d.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=$(H+1,T.length-1),e.next=3,m.collection("songs").doc(T[t].id).get();case 3:return e.next=5,e.sent.data().id;case 5:n=e.sent,D(n,a),Be(0),W(n),Y($(t,T.length-1)),m.collection("users").doc(a.uid).update({lastSongPlayed:n});case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function dt(){return(dt=Object(d.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(xe>5)){e.next=5;break}return Qe.current.currentTime=0,ve(0),Be(0),e.abrupt("return");case 5:return t=$(H-1,T.length-1),e.next=8,m.collection("songs").doc(T[t].id).get();case 8:return e.next=10,e.sent.data().id;case 10:n=e.sent,D(n,a),Be(0),W(n),Y($(t,T.length-1)),m.collection("users").doc(a.uid).update({lastSongPlayed:n});case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return ae(a,ct,a.addedSongs&&a.addedSongs.length!==h.length,[a.addedSongs]),ae(a,(function(){var e=[];a.ownPlaylists&&a.ownPlaylists.map((function(t,n){m.collection("playlists").doc(t).get().then((function(t){t.exists?(e.push(t.data()),n===a.ownPlaylists.length-1&&x(e)):console.log("No such document!")})).catch((function(e){console.log("Error getting document:",e)}))})),a.addedPlaylists&&a.addedPlaylists.map((function(t,n){m.collection("playlists").doc(t).get().then((function(t){t.exists?(e.push(t.data()),n===a.addedPlaylists.length-1&&x(e)):console.log("No such document!")})).catch((function(e){console.log("Error getting document:",e)}))}))}),a.ownPlaylists&&String(a.ownPlaylists.concat(a.addedPlaylists))!==String(g),[a.ownPlaylists]),ae(a,(function(){se(a.friends.filter((function(e){return"added"===e.status})).map((function(e){return e.uid})),"users",P)}),a.friends&&String(a.friends.filter((function(e){return"added"===e.status})))!==String(A),[a.friends]),ae(a,(function(){se(a.addedAuthors,"users",N)}),a.addedAuthors&&a.addedAuthors.length!==C.length,[a.addedAuthors]),ae(a,(function(){return ot.apply(this,arguments)}),a&&(-1===ie.id||U||a.lastSongPlayed),[U,a.lastSongPlayed]),Object(s.useEffect)((function(){void 0===a.uid&&(le({id:-1}),W(-1),E([]),N([]),f([]),P([]),x([]))}),[a.uid]),Object(s.useEffect)((function(){var e;Ve((void 0===(e=ie.lyrics)||0!==e.length)&&(void 0===e||"undefined"!==e[0].startTime))}),[ie.lyrics]),Object(s.useEffect)((function(){if(!c)if(Me){var e=_(T);E(e),Y(e.findIndex((function(e){return e.id===U})))}else E(G.songsList),Y(G.songsList.findIndex((function(e){return e.id===U})))}),[Me]),Object(s.useEffect)((function(){Be(0)}),[ie.id]),Object(s.useEffect)((function(){2===$e&&lt()}),[$e]),Object(s.useEffect)((function(){document.title=ie.name?"".concat(ie.name," - Soundbubble"):"Soundbubble"}),[ie.name]),Object(v.jsx)(oe.Provider,{value:{yourSongs:h,setYourSongs:f,yourPlaylists:g,yourFriends:A,currentSongQueue:T,currentSongPlaylistSource:G,setCurrentSongPlaylistSource:X,setCurrentSongQueue:E,setCurrentSongInQueue:Y,play:Oe,setPlay:pe,songSrc:ie.songSrc,currentTime:xe,setCurrentTime:ve,songDuration:we,songRef:Qe,name:ie.name,authors:ie.authors,lyrics:ie.lyrics,cover:ie.cover,imgColors:je,setImgColors:be,currentSong:U,setCurrentSong:W,repeatMode:Ie,setRepeatMode:Ae,shuffleMode:Me,setShuffleMode:Te,inputRef:Xe,leftSideBarInputRef:Je,isThereKaraoke:We,rightSideCurrentPage:$e,currentParagraph:De,currentParagraphRef:Ge,nextSong:function(){return ut.apply(this,arguments)},prevSong:function(){return dt.apply(this,arguments)},playSong:function(){Oe?Qe.current.pause():Qe.current.play(),pe(!Oe)},playing:function(e){ve(e.target.currentTime),We&&2===$e&&Ye&&nt&&function(){if(De!==ie.lyrics.length-1&&parseFloat(ie.lyrics[De+1].startTime)<=Qe.current.currentTime)Be(De+1)}(),te(e.target.currentTime/we*100)},defineCurrentParagraph:lt,setRightSideCurrentPage:Ze,changeCurrentTime:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if("div"===e.target.localName||"p"===e.target.localName){if(void 0!==t)return ve(t),Qe.current.currentTime=t,te(t/we*100),We&&2===$e&&Ye&&Be(parseInt(e.target.id)),Qe.current.play(),void pe(!0)}else ve(e.target.value),Qe.current.currentTime=e.target.value,te(e.target.value/we*100),We&&2===$e&&Ye&&lt()},displayAuthors:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie.authors,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" & ";return e.map((function(n,s){return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(i.b,{to:"/authors/".concat(n.uid),onClick:function(e){e.stopPropagation(),qe(!1)},children:n.displayName},n.uid),s===e.length-1?"":t]})}))},displayAuthorsFull:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie.authors;return e.map((function(e,t){return Object(v.jsx)(v.Fragment,{children:Object(v.jsx)(i.b,{to:"/authors/".concat(e.uid),onClick:function(e){e.stopPropagation(),qe(!1),o(!1)},children:Object(v.jsx)(K,{data:e})},e.uid)})}))},openFullScreenPlayer:Ye,setOpenFullScreenPlayer:qe,loadSongData:function(e){ve(e.target.currentTime),Ce(e.target.duration),Xe.current.max=e.target.duration,window.innerWidth>1e3&&(Je.current.max=e.target.duration),te(0),Oe?e.target.play():e.target.pause()},fetchYourSongs:ct,setOpenMenu:st,openMenu:nt,currentSongData:ie,setCurrentSongData:le,setIsThereKaraoke:Ve,setYourPlaylists:x,yourAuthors:C,setYourAuthors:N,inputRange:ee},children:c?Object(v.jsx)(R,{}):t})},de=n(11),je=n(7),be=n(25),he=H.a.button(Z||(Z=Object(U.a)(["\n  border: none;\n  color: var(--lightBlue);\n  background: var(--lightGrey);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 5px 10px;\n  border-radius: var(--standartBorderRadius3);\n  font-weight: 600;\n\n  svg {\n    margin-right: ",";\n    width: 16px;\n    height: 16px;\n  }\n"])),(function(e){return 0===e.textLen?"0":"5px"})),fe=function(e){var t=e.text,n=void 0===t?"":t,s=e.icon,a=e.onClick,c=e.visible;return(void 0===c||c)&&Object(v.jsxs)(he,{onClick:a,textLen:n.length,children:[s,Object(v.jsx)("span",{children:n})]})},Oe=H.a.div(ee||(ee=Object(U.a)(["\n  width: 100%;\n  position: relative;\n  margin: ",";\n\n  button {\n    position: absolute;\n    right: 8px;\n    top: 50%;\n    transform: translateY(-50%);\n  }\n"])),(function(e){return e.margin?"0 0 10px 0":0})),pe=H.a.input(te||(te=Object(U.a)(["\n  width: 100%;\n  box-sizing: border-box;\n  padding: 12px;\n  border-radius: var(--standartBorderRadius);\n  border: none;\n  background: var(--leftSideBarColor);\n  outline: none;\n  color: #fff;\n  font-weight: 500;\n"]))),me=function(e){var t=e.title,n=e.type,s=void 0===n?"text":n,a=e.value,c=e.setValue,r=e.placeholder,i=void 0===r?"":r,o=e.required,l=void 0!==o&&o;e.margin;return Object(v.jsxs)(v.Fragment,{children:[!!t&&Object(v.jsx)("h3",{children:t}),Object(v.jsxs)(Oe,{margin:!0,children:[Object(v.jsx)(pe,{value:a,onChange:function(e){return c(e.target.value)},placeholder:i,type:s,required:l}),Object(v.jsx)(fe,{icon:Object(v.jsx)(je.J,{}),onClick:function(){return c("")},visible:!!a.length})]})]})},ge=n(24),xe=H.a.button(ne||(ne=Object(U.a)(["\n  width: 100%;\n  padding: 10px;\n  box-sizing: border-box;\n  opacity: ",';\n  background: var(--purpleAndBlueGrad);\n  color: #fff;\n  font-weight: bold;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  height: 40px;\n  border-radius: var(--standartBorderRadius3);\n  position: relative;\n  overflow: hidden;\n\n  @keyframes button-animation-in {\n    0% {\n      opacity: 0;\n      transform: scale(0.95);\n    }\n    50% {\n      opacity: 1;\n      transform: scale(1);\n    }\n    100% {\n      opacity: 0;\n      transform: scale(0.95);\n    }\n  }\n\n  @keyframes button-animation-out {\n    0% {\n      opacity: 0;\n      transform: scale(0.95);\n    }\n    100% {\n      opacity: 1;\n      transform: scale(1);\n    }\n  }\n\n  .inner-button {\n    z-index: 1;\n\n    .inner-button-success {\n      animation: button-animation-in 2s forwards;\n    }\n\n    .inner-button-text {\n      animation: button-animation-out 0.5s forwards;\n    }\n  }\n\n  &::before {\n    content: "";\n    position: absolute;\n    display: block;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    background: var(--green);\n    width: ',";\n    height: ",";\n    border-radius: 100%;\n    transition: 0.6s;\n    z-index: 0;\n  }\n\n  .LoadingCircle {\n    position: relative;\n    transform: none;\n    left: auto;\n    top: auto;\n    width: 30px;\n    height: 30px;\n\n    img {\n      width: 30px;\n      height: 30px;\n    }\n  }\n"])),(function(e){return e.isLoading||!e.isActive?.5:1}),(function(e){return e.completed?"2000px":"0"}),(function(e){return e.completed?"2000px":"0"})),ve=function(e){var t=e.text,n=e.action,a=e.isLoading,c=e.completed,r=void 0!==c&&c,i=e.setCompleted,o=e.bottomMessage,l=e.isActive,u=void 0===l||l,d=e.errorMessage,j=e.setErrorMessage,b=re().openBottomMessage;return Object(s.useEffect)((function(){r&&(b(null!==o&&void 0!==o?o:void 0),setTimeout((function(){i(!1)}),2e3))}),[o,r,b,i]),Object(s.useEffect)((function(){d&&(b(d,"failure"),setTimeout((function(){j("")}),1e3))}),[d,j,b]),Object(v.jsx)(xe,{isLoading:a,className:"submit-button",completed:r,isActive:u,onClick:u?n:function(){return!!d&&b("Nope","failure")},children:Object(v.jsx)("div",{className:"inner-button",children:r?Object(v.jsxs)("div",{className:"inner-button-success",children:[Object(v.jsx)(ge.b,{})," Done"]}):a?Object(v.jsx)(M,{top:0}):Object(v.jsx)("div",{className:"inner-button-text",children:t})})})},ye=function(e,t,n,a,c,r,i,o,l){var b=Object(s.useState)(""),h=Object(j.a)(b,2),f=h[0],O=h[1],p=Object(s.useState)(!1),x=Object(j.a)(p,2),v=x[0],y=x[1],S=Object(s.useState)(!1),w=Object(j.a)(S,2),C=w[0],N=w[1],k=Object(s.useState)(e),I=Object(j.a)(k,2),A=I[0],P=I[1];function L(e,t){return M.apply(this,arguments)}function M(){return(M=Object(d.a)(u.a.mark((function e(s,i){var o,l,j,b,h=arguments;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=h.length>2&&void 0!==h[2]?h[2]:[],l=h.length>3?h[3]:void 0,j=[],b=g(s),e.next=6,m.collection("search").where("variantsOfName","array-contains",b).get();case 6:e.sent.docs.forEach(function(){var e=Object(d.a)(u.a.mark((function e(s){var d,b,h,f,p,g,x,v,S;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((d=s.data()).place!==i){e.next=20;break}return e.next=4,m.collection(d.place).doc(d.uid).get();case 4:if(b=e.sent.data(),o&&o.length?o.map((function(e){return e.id||e.uid})).includes(d.uid)&&j.push(b):b.isPrivate||j.push(b),void 0!==c||"All"!==r||0===j.length){e.next=19;break}l(j),e.t0=d.place,e.next="songs"===e.t0?11:"users"===e.t0?13:"playlists"===e.t0?15:17;break;case 11:for(h=0;h<j.length;h++)f=b.authors,se(f.map((function(e){return e.uid})),"users",n,(function(e){return e.sort((function(e,t){return t.subscribers-e.subscribers}))}),void 0,void 0,1);return e.abrupt("break",19);case 13:for(p=0;p<j.length;p++)g=b.ownSongs,x=b.ownPlaylists,se(g,"songs",t,(function(e){return e.sort((function(e,t){return t.listens-e.listens}))}),(function(){return null}),3,1),se(x,"playlists",a,(function(e){return e.sort((function(e,t){return t.listens-e.listens}))}),(function(){return null}),3,1);return e.abrupt("break",19);case 15:for(v=0;v<j.length;v++)S=b.authors,se(S.map((function(e){return e.uid})),"users",n,(function(e){return e.sort((function(e,t){return t.subscribers-e.subscribers}))}),void 0,void 0,1);return e.abrupt("break",19);case 17:return O("Wrong search mode"),e.abrupt("break",19);case 19:0!==j.length&&(y(!1),N(!0),l(j));case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),y(!1),0===j.length&&(l([]),N(!1));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function T(s){if(0!==e.length){var u=null!==s&&void 0!==s?s:e;if(P(u),y(!0),N(!1),void 0===c)"All"!==r&&"Songs"!==r||(L(u,"songs",i,t),n([]),a([])),"All"!==r&&"Users"!==r||(L(u,"users",o,n),t([]),a([])),"All"!==r&&"Playlists"!==r||(L(u,"playlists",l,a),n([]),t([]));else switch(c){case"songs":L(u,"songs",i,t);break;case"playlists":L(u,"playlists",l,a);break;case"users":L(u,"users",o,n);break;default:L(u,"songs",i,t)}}}return Object(s.useEffect)((function(){0===e.length&&(void 0!==i&&t(i),void 0!==o&&n(o),void 0!==l&&a(l),y(!1))}),[e]),Object(s.useEffect)((function(){T()}),[r]),{findSomething:T,message:f,loading:v,foundAnything:C,inputValue:A,setInputValue:P}},Se=function(e,t){e&&m.collection("search").doc(t).get().then((function(e){var n=e.data().rank?e.data().rank+1:1;m.collection("search").doc(t).update({rank:n})}))},we=function(e){var t=e.length,n=e.setInputValue,s=e.setValue;return Object(v.jsxs)("div",{className:"searchBarElement",children:[Object(v.jsx)(je.A,{}),Object(v.jsx)("span",{onClick:function(){s(""),n("")},style:t?{}:{opacity:0,visibility:"hidden",cursor:"default"},children:Object(v.jsx)(je.J,{})})]})},Ce=function(e){var t=e.text,n=e.searchMode,s=e.setSearchMode;e.index;return Object(v.jsx)("button",{onClick:function(){return s(t)},style:n===t?{background:"var(--lightBlue)"}:{},children:t})},Ne=function(e){var t=e.defaultSearchMode,n=e.searchMode,s=e.setSearchMode,a=e.searchHintsLen;return Object(v.jsx)("div",{className:"searchFilters",style:t?{display:"none"}:a?{background:"var(--leftSideBarColor)"}:{},children:["All","Songs","Users","Playlists"].map((function(e,t){return Object(v.jsx)(Ce,{text:e,searchMode:n,setSearchMode:s,index:t})}))})},ke=function(){var e=Object(d.a)(u.a.mark((function e(t){var n,s,a,c,r,i,o,l,d,j;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=t.data(),a=s.place,c=s.uid,r=s.rank,e.next=3,m.collection(a).doc(c).get();case 3:if(e.t1=n=e.sent.data(),e.t0=null!==e.t1,!e.t0){e.next=7;break}e.t0=void 0!==n;case 7:if(!e.t0){e.next=11;break}e.t2=n,e.next=12;break;case 11:e.t2={};case 12:return i=e.t2,o=i.name,l=i.authors,d=i.displayName,j=i.isVerified,e.abrupt("return",{type:a,name:o||d,author:l?l[0].displayName:null,uid:c,rank:r||0,isVerified:null!==j&&void 0!==j&&j});case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ie=function(){var e=Object(d.a)(u.a.mark((function e(t,n){var s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.length>0)){e.next=13;break}if(!n){e.next=7;break}return e.next=4,m.collection("search").where("variantsOfName","array-contains",t).where("place","==",n).get();case 4:s=e.sent.docs.map(function(){var e=Object(d.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ke(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=10;break;case 7:return e.next=9,m.collection("search").where("variantsOfName","array-contains",t).get();case 9:s=e.sent.docs.map(function(){var e=Object(d.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ke(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 10:return e.abrupt("return",s);case 13:return e.abrupt("return",[]);case 14:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Ae=function(){var e=Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("search").orderBy("rank","desc").limit(10).get();case 2:return t=e.sent.docs.map(function(){var e=Object(d.a)(u.a.mark((function e(t){var n,s,a,c,r,i,o,l,d;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.data(),s=n.place,a=n.uid,c=n.rank,e.next=3,m.collection(s).doc(a).get();case 3:return r=e.sent.data(),i=r.name,o=r.authors,l=r.displayName,d=r.isVerified,e.abrupt("return",{type:s,name:i||l,author:o?o[0].displayName:null,uid:a,rank:c||0,isVerified:null!==d&&void 0!==d&&d});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Pe=function(e){var t={"\u0430":"f","\u0431":",","\u0432":"d","\u0433":"u","\u0434":"l","\u0435":"t","\u0451":"`","\u0436":";","\u0437":"p","\u0438":"b","\u0439":"q","\u043a":"r","\u043b":"k","\u043c":"v","\u043d":"y","\u043e":"j","\u043f":"g","\u0440":"h","\u0441":"c","\u0442":"n","\u0443":"e","\u0444":"a","\u0445":"[","\u0446":"w","\u0447":"x","\u0448":"i","\u0449":"o","\u044a":"]","\u044b":"s","\u044c":"m","\u044d":"'","\u044e":".","\u044f":"z"},n={f:"\u0430",",":"\u0431",d:"\u0432",u:"\u0433",l:"\u0434",t:"\u0435","`":"\u0451",";":"\u0436",p:"\u0437",b:"\u0438",q:"\u0439",r:"\u043a",k:"\u043b",v:"\u043c",y:"\u043d",j:"\u043e",g:"\u043f",h:"\u0440",c:"\u0441",n:"\u0442",e:"\u0443",a:"\u0444","[":"\u0445",w:"\u0446",x:"\u0447",i:"\u0448",o:"\u0449","]":"\u044a",s:"\u044b",m:"\u044c","'":"\u044d",".":"\u044e",z:"\u044f"};return t[e[0]]?e.split("").reduce((function(e,n){return e+t[n]}),""):e.split("").reduce((function(e,t){return e+n[t]}),"")},Le=function(e){var t=e.setCurrentHint,n=e.searchValue,a=e.inputFocused,c=e.setSearchHints,r=e.defaultSearchMode;Object(s.useEffect)((function(){t(-1);var e="All"===r?void 0:r.toLowerCase();0===n.length&&a&&void 0===e?Promise.resolve(Ae()).then((function(e){Promise.all(e).then((function(e){c(e)}))})):0!==n.length&&a?Promise.resolve(Ie(g(n),e)).then((function(t){Promise.all(t).then((function(t){var s=t.sort((function(e,t){return t.rank-e.rank}));s.length?c(s.slice(0,10)):Promise.resolve(Ie(Pe(g(n)),e)).then((function(e){Promise.all(e).then((function(e){var t=e.sort((function(e,t){return t.rank-e.rank}));c(t.slice(0,10))}))}))}))})):c([])}),[n,a,r])},Me=function(e){switch(e){case"songs":return Object(v.jsx)(je.w,{style:{color:"var(--reallyLightBlue)"}});case"playlists":return Object(v.jsx)(de.a,{style:{color:"var(--lightPurple)"}});case"users":return Object(v.jsx)(je.E,{style:{color:"var(--pink)"}});case"search":return Object(v.jsx)(je.A,{});default:return Object(v.jsx)(je.w,{})}},Te=function(e){var t=e.name,n=e.author,s=e.isVerified,a=e.type,c=e.index,r=e.currentHint,i=e.setCurrentHint,o=e.findSomething,l=e.setInputFocused;return Object(v.jsxs)("div",{className:"search-hint-item"+(r===c?" current":""),onClick:function(){i(c),l(!1),o(t)},children:[Me(a),Object(v.jsx)("span",{children:t}),n&&Object(v.jsx)("span",{className:"search-hint-item-author",children:n}),s?Object(v.jsx)(ge.b,{style:{width:"12px",height:"12px",opacity:.5,marginLeft:"10px"}}):null]})},Ee=function(e){var t=e.searchValue,n=e.searchHints,a=e.setSearchHints,c=e.currentHint,r=e.setCurrentHint,i=e.inputFocused,o=e.defaultSearchMode,l=e.findSomething,u=e.setInputFocused;return Le({setCurrentHint:r,searchValue:t,inputFocused:i,setSearchHints:a,defaultSearchMode:o}),Object(v.jsxs)("div",{className:"search-hints",style:n.length?o?{transform:"translateY(0px)"}:{transform:"translateY(-35px)"}:{display:"none"},children:[t||"All"!==o&&void 0!==o?Object(v.jsx)(Te,{name:t,type:"search",index:-1,currentHint:c,setCurrentHint:r,findSomething:l,setInputFocused:u},-1):Object(v.jsx)("h4",{children:"Trending searches"}),n.map((function(e,t){return Object(s.createElement)(Te,Object(B.a)(Object(B.a)({},e),{},{currentHint:c,setCurrentHint:r,index:t,key:e.uid,findSomething:l,setInputFocused:u}))}))]})},Re=function(e,t){Object(s.useEffect)((function(){function n(n){e.current&&!e.current.contains(n.target)&&t(!1)}return document.addEventListener("mousedown",n),function(){document.removeEventListener("mousedown",n)}}),[e])},De=function(e){var t,n,a=e.value,c=e.setValue,r=e.setAllFoundSongs,i=e.setResultPlaylists,o=e.setResultAuthorList,l=(e.focus,e.defaultSearchMode),u=void 0===l?void 0:l,d=e.inputText,b=void 0===d?"Search for songs or for people":d,h=e.defaultSongsListValue,f=e.defaultAuthorsListValue,O=e.defaultPlaylistsListValue,p=e.background,m=Object(s.useState)("All"),g=Object(j.a)(m,2),x=g[0],y=g[1],S=Object(s.useState)(-1),w=Object(j.a)(S,2),C=w[0],N=w[1],k=Object(s.useState)([]),I=Object(j.a)(k,2),A=I[0],P=I[1],L=Object(s.useState)(!1),T=Object(j.a)(L,2),E=T[0],R=T[1],D=Object(s.useRef)(null),B=ye(null!==(t=null===(n=A[C])||void 0===n?void 0:n.name)&&void 0!==t?t:a,r,o,i,u,x,h,f,O),F=B.findSomething,U=B.loading,W=B.foundAnything,V=B.inputValue,z=B.setInputValue;return Re(D,R),Object(v.jsxs)("div",{style:{marginTop:"10px",width:"100%"},className:"searchBarWrapper",children:[Object(v.jsxs)("div",{className:"searchBar",ref:D,children:[Object(v.jsx)(we,{setInputValue:z,length:a.length,setValue:c}),Object(v.jsx)("input",{type:"text",onFocus:function(){return R(!0)},style:A.length?{borderRadius:"var(--standartBorderRadius) var(--standartBorderRadius) 0 0",background:!!p&&p}:{background:!!p&&p},placeholder:b,value:V,onChange:function(e){z(e.target.value),c(e.target.value)},onKeyDown:function(e){var t,n;(function(e){var t,n,s,c;if(E)switch(e.key){case"ArrowDown":N($(C+1,A.length-1,-1)),z(null!==(t=null===(n=A[$(C+1,A.length-1,-1)])||void 0===n?void 0:n.name)&&void 0!==t?t:a);break;case"ArrowUp":N($(C-1,A.length-1,-1)),z(null!==(s=null===(c=A[$(C-1,A.length-1,-1)])||void 0===c?void 0:c.name)&&void 0!==s?s:a)}}(e),"Enter"===e.key)&&(F(),Se(null===(t=A[C])||void 0===t?void 0:t.name,null===(n=A[C])||void 0===n?void 0:n.uid),P([]))}}),Object(v.jsx)(Ne,{defaultSearchMode:u,searchMode:x,setSearchMode:y,searchHintsLen:A.length}),Object(v.jsx)(Ee,{searchValue:a,currentHint:C,searchHints:A,setSearchHints:P,setCurrentHint:N,inputFocused:E,defaultSearchMode:u||x,findSomething:F,setInputFocused:R})]}),Object(v.jsx)("div",{className:"authorsResult",children:U?Object(v.jsx)("div",{style:{position:"relative",width:"100%",height:"50px",marginTop:"40px"},children:Object(v.jsx)(M,{})}):W||0===a.length?null:Object(v.jsx)("h2",{children:"Not found"})})]})};function Be(e){for(var t=[],n=0,s=e+" ",a=0;a<s.length;a++)"\n"!==s[a]&&void 0!==s[a+1]||(t.push({startTime:"undefined",text:s.substr(n,a-n)}),n=a+1);return t}var Fe=function(e){var t=re(),n=t.toggleModal,a=t.openBottomMessage,c=Object(s.useState)(e.name),r=Object(j.a)(c,2),i=r[0],o=r[1],l=Object(s.useState)(e.authors),b=Object(j.a)(l,2),h=b[0],f=b[1],O=Object(s.useState)(e.cover),p=Object(j.a)(O,2),g=p[0],x=p[1],v=Object(s.useState)(e.imageColors),y=Object(j.a)(v,2),S=y[0],w=y[1],C=Object(s.useState)(e.lyrics.map((function(e){return e.text})).join("\n")),N=Object(j.a)(C,2),k=N[0],I=N[1],A=Object(s.useState)([]),P=Object(j.a)(A,2),L=P[0],M=P[1],T=Object(s.useState)(""),E=Object(j.a)(T,2),R=E[0],D=E[1],B=Object(s.useState)(""),F=Object(j.a)(B,2),U=F[0],V=F[1],z=Object(s.useState)(!1),H=Object(j.a)(z,2),Y=H[0],q=H[1],Q=Object(s.useState)(!1),G=Object(j.a)(Q,2),X=G[0],J=G[1];function K(e){var t=h.filter((function(t){return t.uid!==e.uid}));return f(t)}return Object(s.useEffect)((function(){o(e.name),f(e.authors),x(e.cover),w(e.imageColors),I(e.lyrics.map((function(e){return e.text})).join("\n"))}),[e.id]),Object(s.useEffect)((function(){U&&a(U,"failure")}),[U]),{songCover:g,songName:i,setSongName:o,imageColors:S,manuallyChangeColor:function(e,t){S[t]=e.target.value,w(Object(W.a)(S))},searchValue:R,setSearchValue:D,foundAuthors:L,setFoundAuthors:M,songAuthors:h,removeAuthorFromList:K,addAuthor:function(e){if(!h.some((function(t){return t.uid===e.uid})))return f((function(t){return[].concat(Object(W.a)(t),[{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL}])}));K(e)},lyrics:k,setLyrics:I,updateSong:function(){if(0===i.length)V("Name shouldn't be empty");else if(0===h.length)V("Song has to have at least 1 author");else if(0===g.length)V("Song has to have cover");else{if(q(!0),h.length>e.authors.length)h.filter((function(t){return!e.authors.find((function(e){return e.uid===t.uid}))})).forEach(function(){var t=Object(d.a)(u.a.mark((function t(n){var s,a,c;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.collection("users").doc(n.uid).get();case 2:s=t.sent,a=s.data(),(c=a.ownSongs).push(e.id),m.collection("users").doc(n.uid).update({ownSongs:c});case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());else if(h.length<e.authors.length){e.authors.filter((function(e){return!h.find((function(t){return t.uid===e.uid}))})).forEach(function(){var t=Object(d.a)(u.a.mark((function t(n){var s,a,c,r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.collection("users").doc(n.uid).get();case 2:s=t.sent,a=s.data(),c=a.ownSongs,r=c.filter((function(t){return t!==e.id})),m.collection("users").doc(n.uid).update({ownSongs:r});case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}m.collection("songs").doc(e.id).update({name:i,authors:h,image:g,imageColors:S,lyrics:Be(k)}).then((function(){q(!1),J(!0),n()}))}},loading:Y,completed:X,setCompleted:J}},Ue=function(e){var t=e.song,n=S().currentUser,s=Fe(t),a=s.songCover,c=s.songName,r=s.setSongName,i=s.imageColors,o=s.manuallyChangeColor,l=s.searchValue,u=s.setSearchValue,d=s.foundAuthors,j=s.setFoundAuthors,b=s.songAuthors,h=s.removeAuthorFromList,f=s.addAuthor,O=s.lyrics,p=s.setLyrics,m=s.updateSong,g=s.loading,x=s.completed,y=s.setCompleted;return Object(v.jsxs)("div",{children:[Object(v.jsxs)("div",{className:"SongInfo",style:{flexDirection:"column",marginBottom:"10px"},children:[Object(v.jsx)("h3",{children:"Song cover"}),Object(v.jsxs)("div",{style:{display:"flex"},children:[Object(v.jsx)("div",{children:Object(v.jsx)("img",{loading:"lazy",src:a,alt:"",className:"songImage"})}),Object(v.jsx)("div",{style:{background:"linear-gradient(-135deg, ".concat(i[0],", ").concat(i[5]),width:"100%",height:"200px",borderRadius:"var(--standartBorderRadius2)",display:"flex",justifyContent:"center",alignItems:"center"},children:Object(v.jsx)("h4",{style:{color:i[1]},children:c})})]})]}),Object(v.jsx)("div",{style:{width:"100%",display:"flex"},children:i.map((function(e,t){return Object(v.jsx)("input",{type:"color",value:e,style:{width:"100%",height:"60px",padding:"0",borderRadius:"0px"},onChange:function(e){o(e,t)}})}))}),Object(v.jsx)(me,{title:"Song name",value:c,setValue:r,placeholder:"Enter song name",required:!0}),Object(v.jsxs)("div",{children:[Object(v.jsx)("h3",{children:"Authors"}),Object(v.jsx)(De,{value:l,setValue:u,setResultAuthorList:j,defaultSearchMode:"users"}),Object(v.jsx)("div",{className:"songAuthorsList",children:b.map((function(e){return Object(v.jsxs)("div",{className:"chosenAuthorItem",children:[Object(v.jsx)("span",{children:e.displayName}),Object(v.jsx)(je.J,{onClick:function(){(n.isAdmin||e.uid!==n.uid)&&h(e)}})]})}))}),Object(v.jsx)("div",{className:"authorsResult",children:d.map((function(e,t){return Object(v.jsx)(K,{data:e,onClick:function(){return f(e)},style:b.includes(e.uid)?{background:"var(--green)"}:{}},t)}))})]}),Object(v.jsxs)("div",{children:[Object(v.jsx)("h3",{children:"Lyrics"}),Object(v.jsx)("textarea",{type:"text",className:"standartInput",style:{height:"200px",fontWeight:"500"},value:O,onChange:function(e){return p(e.target.value)}})]}),Object(v.jsx)(ve,{text:"Update song",action:m,isLoading:g,completed:x,setCompleted:y,bottomMessage:"Song was updated"})]})},We=function(e,t,n,s){e.stopPropagation();var a=t.authors.map((function(e){return e.uid})),c=[];a.forEach((function(e){n.addedAuthors.includes(e)||c.push(e)}));var r=n.addedSongs;r.push(t.id),m.collection("users").doc(n.uid).update({addedSongs:r,addedAuthors:[].concat(c,Object(W.a)(n.addedAuthors))}),c.forEach(function(){var e=Object(d.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(t).get();case 2:n=e.sent.data().subscribers,n++,m.collection("users").doc(t).update({subscribers:n});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())};function Ve(e,t){return e.filter((function(e){return this.indexOf(e)<0}),t)}var ze=function(e,t,n,s){e.stopPropagation();var a=t.authors.map((function(e){return e.uid})),c=[],r=n.addedSongs.filter((function(e){return e!==t.id}));a.forEach((function(e){s.forEach((function(t){r.includes(t.id)&&t.authors.find((function(t){return t.uid===e}))&&c.push(e)}))}));var i=Ve(a,c),o=Ve(n.addedAuthors,i);m.collection("users").doc(n.uid).update({addedSongs:r,addedAuthors:o}),i.forEach(function(){var e=Object(d.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(t).get();case 2:n=e.sent.data().subscribers,n--,m.collection("users").doc(t).update({subscribers:n});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())};function He(e){var t=e.song,n=S().currentUser,s=le().yourSongs,a=re(),c=a.openConfirm,r=a.setOpenModal;return n.addedSongs.includes(t.id)?Object(v.jsxs)("span",{onClick:function(e){e.stopPropagation(),r(!1),c("You sure you want to delete this song from library?","Yes, delete it","No, just kidding",(function(e){return ze(e,t,n,s)}))},children:[Object(v.jsx)(je.I,{}),"Delete"]}):Object(v.jsxs)("span",{onClick:function(e){return We(e,t,n)},children:[Object(v.jsx)(je.z,{}),"Add"]})}var Ye=function(e,t){var n=[e.id].concat(Object(W.a)(t.ownPlaylists.filter((function(t){return t!==e.id}))));e.isAlbum?t.addedPlaylists.includes(e.id)&&m.collection("users").doc(t.uid).update({addedPlaylists:n}):t.ownPlaylists.includes(e.id)&&m.collection("users").doc(t.uid).update({ownPlaylists:n})},qe=function(e,t){var n=Object(s.useState)([]),a=Object(j.a)(n,2),c=a[0],r=a[1],i=Object(s.useState)(!1),o=Object(j.a)(i,2),l=o[0],u=o[1],d=S().currentUser,b=le().currentSong,h=t||b;return Object(s.useEffect)((function(){var t=m.collection("playlists").doc(e.id).onSnapshot((function(e){e.exists&&r(e.data().songs)}));return function(){return t()}}),[m]),Object(s.useEffect)((function(){u(c.includes(h))}),[c,h]),[function(){if(console.log(c,e),c.length>0&&void 0!==e.id){if(c.includes(h)){var t=c.filter((function(e){return e!==h}));return void m.collection("playlists").doc(e.id).update({songs:t})}var n=c;n.unshift(h),m.collection("playlists").doc(e.id).update({songs:n}),Ye(e,d)}},l]},Qe=a.a.createContext(),Ge=function(){return Object(s.useContext)(Qe)},Xe=function(e){var t=e.children,n=Object(s.useState)(window.innerWidth),a=Object(j.a)(n,2),c=a[0],r=a[1],i=Object(s.useState)(window.innerHeight),o=Object(j.a)(i,2),l=o[0],u=o[1],d=Object(s.useState)(window.innerWidth<1e3),b=Object(j.a)(d,2),h=b[0],f=b[1];function O(){r(window.innerWidth),u(window.innerHeight),f(window.innerWidth<1e3)}Object(s.useEffect)((function(){return window.addEventListener("resize",O),function(){window.removeEventListener("resize",O)}}),[]);var p={screenWidth:c,screenHeight:l,isMobile:h};return Object(v.jsx)(Qe.Provider,{value:p,children:t})},Je=function(e){var t=e.text,n=e.direction,s=void 0===n?"top":n,a=Object(F.a)(e,["text","direction"]);return Ge().isMobile?null:Object(v.jsx)("div",Object(B.a)(Object(B.a)({className:"Hint "+s},a),{},{children:Object(v.jsx)("h5",{children:t})}))},Ke=function(e){var t=e.playlist,n=e.song,s=qe(t,n.id),a=Object(j.a)(s,2),c=a[0],r=a[1];return Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:c,children:[r?Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(Je,{text:"Remove ".concat(n.name," from playlist")}),Object(v.jsx)(je.d,{})]}):Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(Je,{text:'Add "'.concat(n.name,'" to playlist')}),Object(v.jsx)(je.z,{})]}),t.name]})},_e=function(e){var t=e.song,n=le(),a=n.yourPlaylists,c=n.currentSongData,r=S().currentUser,i=Object(s.useState)(t||c),o=Object(j.a)(i,2),l=o[0],u=o[1];return Object(s.useEffect)((function(){(null===t||void 0===t?void 0:t.id)&&u(t)}),[null===t||void 0===t?void 0:t.id]),Object(v.jsx)("div",{className:"AddToPlaylists",children:Object(v.jsx)("div",{style:{display:"flex",flexDirection:"column"},children:a.length?a.map((function(e,t){if(r.ownPlaylists.includes(e.id))return Object(v.jsx)(Ke,{playlist:e,song:l})})):Object(v.jsx)("div",{className:"songItemMenuWindowItem",children:"No playlists created"})})})},$e=n(30),Ze=function(e){var t=e.person,n=re().setOpenModal;return Object(v.jsx)(i.b,{to:"/authors/".concat(t.uid),children:Object(v.jsxs)("div",{className:"PersonTinyVerticalItem",onClick:function(){return n(!1)},children:[Object(v.jsx)("div",{className:"personTinyImage",children:Object(v.jsx)("img",{loading:"lazy",src:t.photoURL,alt:""})}),Object(v.jsx)("div",{className:"personTinyName",children:t.displayName})]})})},et=function(e){var t=e.text,n=void 0===t?"See more":t,s=Object(F.a)(e,["text"]);return Object(v.jsxs)("div",Object(B.a)(Object(B.a)({className:"SeeMoreRoundButton"},s),{},{children:[Object(v.jsx)("button",{children:Object(v.jsx)(je.b,{})}),Object(v.jsx)("span",{children:n})]}))},tt=function(e){var t=e.listOfPeople,n=e.restriction,s=void 0===n?null:n,a=e.title,c=e.chosenArray,r=e.setChosenArray,i=void 0===r?function(){return null}:r,o=e.lastSeen,l=void 0!==o&&o;return Object(v.jsxs)("div",{children:[a?Object(v.jsx)("h2",{style:{marginTop:"0",marginBottom:"7px"},children:a}):null,s?t.slice(0,s).map((function(e){return Object(v.jsx)(K,{data:e,chosenArray:c,setChosenArray:i,lastSeen:l})})):t.map((function(e){return Object(v.jsx)(K,{data:e,chosenArray:c,setChosenArray:i,lastSeen:l})}))]})};function nt(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}var st=function(){var e=Object(d.a)(u.a.mark((function e(t){var n,s,a,c,r,i=arguments;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=i.length>1&&void 0!==i[1]?i[1]:nt(),s=i.length>2&&void 0!==i[2]?i[2]:"",a=i.length>3&&void 0!==i[3]?i[3]:"",c=i.length>4&&void 0!==i[4]?i[4]:[],r=i.length>5&&void 0!==i[5]?i[5]:[],m.collection("chats").doc(n).set({chatImage:a,chatName:s,id:n,messages:[],participants:t,wallpaper:"undefined",admins:t.length>2?c:[],typing:[],imageColors:r}),t.map(function(){var e=Object(d.a)(u.a.mark((function e(t){var s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(t).get();case 2:(s=e.sent.data().chats).push(n),m.collection("users").doc(t).update({chats:s});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),at=function(){var e=Object(d.a)(u.a.mark((function e(t,n,s,a){var c,r,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=!1,r=0,!n.chats){e.next=9;break}return e.next=5,m.collection("chats").where("participants","array-contains",n.uid).get();case 5:return e.sent.docs.forEach((function(e){var n=0;return t.every((function(t){return!!e.data().participants.includes(t)&&(n++,!0)})),n+1!==e.data().participants.length||n!==t.length||(c=!0,s(!1),a(e.data().id),r=e.data().id,!1)})),c||(i=nt(),c=!0,s(!0),a(i),r=i),e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})));return function(t,n,s,a){return e.apply(this,arguments)}}(),ct=function(e,t,n,s){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[],i=arguments.length>7?arguments[7]:void 0;if(0!==s.trim().length||0!==a.length||0!==c.length||0!==r.length){var o=(null===t||void 0===t?void 0:t.messages)||[];o.push({id:o.length,sender:n,message:s,sentTime:(new Date).toString(),inResponseToMessage:i||null,attachedSongs:a,attachedAlbums:c,attachedAuthors:r,seenBy:[n]}),m.collection("chats").doc(e).update({messages:o})}};function rt(e){var t=e.shareList,n=e.currentUser,s=e.itemId,a=e.whatToShare,c=e.messageText,r=void 0===c?"":c,i=e.setShouldCreate,o=void 0===i?function(){return null}:i,l=e.setFriendChatId,j=void 0===l?function(){return null}:l,b=e.setLoading,h=void 0===b?function(){return null}:b,f=e.setCompleted,O=void 0===f?function(){return null}:f;h(!0),O(!1),t.map(function(){var e=Object(d.a)(u.a.mark((function e(t){var c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=[{uid:t,status:"added"}].concat(Object(W.a)(n.friends.filter((function(e){return e.uid!==t})))),m.collection("users").doc(n.uid).update({friends:c}),Promise.resolve(at([t],n,(function(){return null}),j)).then(function(){var e=Object(d.a)(u.a.mark((function e(c){var i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("chats").doc(c).get();case 2:if(void 0===(i=e.sent.data())){e.next=17;break}e.t0=a,e.next="song"===e.t0?7:"playlist"===e.t0?9:"author"===e.t0?11:13;break;case 7:return ct(c,i,n.uid,r,[s]),e.abrupt("break",15);case 9:return ct(c,i,n.uid,r,[],[s]),e.abrupt("break",15);case 11:return ct(c,i,n.uid,r,[],[],[s]),e.abrupt("break",15);case 13:return ct(c,i,n.uid,r,[s]),e.abrupt("break",15);case 15:e.next=18;break;case 17:st([n.uid,t],c).then(Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("chats").doc(c).get();case 2:i=e.sent.data(),o(!1),e.t0=a,e.next="song"===e.t0?7:"playlist"===e.t0?9:"author"===e.t0?11:13;break;case 7:return ct(c,i,n.uid,r,[s]),e.abrupt("break",15);case 9:return ct(c,i,n.uid,r,[],[s]),e.abrupt("break",15);case 11:return ct(c,i,n.uid,r,[],[],[s]),e.abrupt("break",15);case 13:return ct(c,i,n.uid,r,[s]),e.abrupt("break",15);case 15:case"end":return e.stop()}}),e)}))));case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(){h(!1),O(!0)}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}var it=function(e){var t=e.item,n=e.whatToShare,a=void 0===n?"song":n,c=le().yourFriends,r=Object(s.useState)([]),i=Object(j.a)(r,2),o=i[0],l=i[1],u=S().currentUser,d=Object(s.useState)(""),b=Object(j.a)(d,2),h=b[0],f=b[1],O=Object(s.useState)(!1),p=Object(j.a)(O,2),m=p[0],g=p[1],x=Object(s.useState)(!1),y=Object(j.a)(x,2),w=y[0],C=y[1],N=re().toggleModal,k=Object(s.useState)(""),I=Object(j.a)(k,2),A=I[0],P=I[1],L=Object(s.useState)([]),M=Object(j.a)(L,2),T=M[0],E=M[1];return c.length?Object(v.jsxs)("div",{className:"FriendsToShareWith",children:[Object(v.jsxs)("div",{style:{maxHeight:"300px",overflowY:"hidden",display:"flex",flexDirection:"column"},children:[Object(v.jsx)(De,{value:A,setValue:P,setResultAuthorList:E,defaultAuthorsListValue:c,defaultSearchMode:"users",inputText:"Search for friends"}),Object(v.jsx)("div",{style:{overflowY:"auto",maxHeight:"100%"},children:Object(v.jsx)(tt,{listOfPeople:T,chosenArray:o,setChosenArray:l})})]}),Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(me,{value:h,setValue:f,placeholder:"Your message"}),Object(v.jsx)(ve,{text:"Share with ".concat(o.length," ").concat(o.length>1||0===o.length?"friends":"friend"),action:function(){rt({shareList:o,currentUser:u,itemId:"author"===a?t.uid:t.id,whatToShare:a,messageText:h,setLoading:C,setCompleted:g}),N()},isLoading:w,completed:m,setCompleted:g,bottomMessage:"Message was sent",isActive:!!o.length})]})]}):Object(v.jsx)("h3",{style:{margin:0},children:"No friends added"})},ot=function(e){var t=e.song,n=le().currentSongData,a=re().setContent,c=Object(s.useState)(t||n),r=Object(j.a)(c,2),i=r[0],o=r[1],l=le(),b=l.displayAuthors,h=l.yourFriends,f=Object(s.useState)([]),O=Object(j.a)(f,2),p=O[0],m=O[1],g=Object(s.useState)(!0),x=Object(j.a)(g,2),y=x[0],S=x[1];function w(){return(w=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:S(!0),m([]),h.forEach((function(e){e.addedSongs.includes(i.id)&&m((function(t){return[].concat(Object(W.a)(t),[e])}))})),S(!1);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){void 0!==t&&o(t)}),[t&&t.id]),Object(s.useEffect)((function(){!function(){w.apply(this,arguments)}()}),[i.id]),Object(v.jsxs)("div",{className:"SongInfo",children:[Object(v.jsx)("div",{className:"songImage",style:{backgroundImage:"url(".concat(i.cover,")")}}),Object(v.jsxs)("div",{className:"songInfoContent",children:[Object(v.jsx)("h3",{style:{color:null===i||void 0===i?void 0:i.imageColors[0]},children:null===i||void 0===i?void 0:i.name}),Object(v.jsx)("span",{children:b(i.authors,", ")}),Object(v.jsxs)("div",{style:{display:"flex",alignItems:"center",opacity:"0.6",fontSize:".9em",position:"relative",marginTop:"5px"},className:"listensAndDate",children:[Object(v.jsxs)("p",{className:"infoListens",style:{marginRight:"15px",marginBottom:"0",position:"relative"},children:[i.listens," ",Object(v.jsx)($e.c,{})]}),Object(v.jsx)("span",{children:Q(i.releaseDate)})]}),Object(v.jsx)("h4",{style:{margin:"10px 0"},children:p.length>0?"Friends that listen that song":"None of your friends listens this"}),y?Object(v.jsx)("div",{style:{position:"relative",height:"50px"},children:Object(v.jsx)(M,{top:"50%"})}):Object(v.jsxs)("div",{style:{display:"flex"},children:[p.length>0?p.map((function(e,t){if(t<2)return Object(v.jsx)(Ze,{person:e},e.uid)})):Object(v.jsx)("button",{className:"shareBtn",style:{minHeight:"35px",background:i.imageColors[0]},onClick:function(){a(Object(v.jsx)(it,{item:i,whatToShare:"song"}))},children:"Share"}),p.length>2?Object(v.jsx)(et,{onClick:function(){return a(Object(v.jsx)(tt,{listOfPeople:p,title:"Friends listen ".concat(t.name)}))}}):null]})]})]})},lt=function(e){var t=e.openMoreWindow,n=e.song,s=e.moreWindowPosRelativeToViewport,a=re(),c=a.toggleModal,r=a.setContent,i=a.openBottomMessage,o=S().currentUser,l=le().setCurrentSongQueue;return t?Object(v.jsxs)("div",{className:"songItemMenuWindow",style:s>window.innerHeight/2+100?{top:"auto",bottom:"110%"}:{top:"110%",bottom:"auto"},onClick:function(e){return e.stopPropagation()},children:[o.isAdmin||n.authors.find((function(e){return e.uid===o.uid}))?Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){c(),r(Object(v.jsx)(Ue,{song:n}))},children:[Object(v.jsx)(de.h,{}),"Edit"]}):null,Object(v.jsx)("div",{className:"songItemMenuWindowItem",children:Object(v.jsx)(He,{song:n})}),Object(v.jsxs)("div",{className:"songItemMenuWindowItem",children:[Object(v.jsx)("div",{className:"songItemMenuWindow inner",children:Object(v.jsx)(_e,{song:n})}),Object(v.jsx)(be.c,{}),"Add to playlist ",Object(v.jsx)(be.a,{})]}),Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){c(),r(Object(v.jsx)(it,{item:n,whatToShare:"song"}))},children:[Object(v.jsx)(je.C,{}),"Share"]}),Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){c(),r(Object(v.jsx)(ot,{song:n}))},children:[Object(v.jsx)(je.q,{}),"Info"]}),Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){l((function(e){return[].concat(Object(W.a)(e),[n])})),i("Song was added to queue")},children:[Object(v.jsx)(de.k,{}),"Add to queue"]})]}):null},ut=function(e,t,n){var s={id:t,type:n};m.collection("searchHistory").doc(e).get().then((function(n){var a;(null===(a=n.data())||void 0===a?void 0:a.history)?n.data().history.find((function(e){return e.id===t}))||m.collection("searchHistory").doc(e).update({history:[s].concat(Object(W.a)(n.data().history.slice(0,15)))}):m.collection("searchHistory").doc(e).set({history:[s]})}))},dt=function(e){var t=e.song,n=e.position,a=e.localIndex,c=e.shouldSaveSearchHistory,r=le(),i=r.setCurrentSong,o=r.currentSong,l=r.play,u=r.songRef,d=r.setPlay,b=r.setCurrentSongInQueue,h=Object(s.useState)(!1),f=Object(j.a)(h,2),O=f[0],p=f[1],g=Object(s.useState)(0),x=Object(j.a)(g,2),v=x[0],y=x[1],w=Object(s.useRef)(null),C=S().currentUser;return Re(w,p),{openSongItemMoreWindow:function(e){e.stopPropagation(),p(!O),y(n||e.target.getBoundingClientRect().top)},chooseSongItem:function(){if(i(t.id),m.collection("users").doc(C.uid).update({lastSongPlayed:t.id}),b(a),t.id===o&&l)return u.current.pause(),void d(!1);u.current.play(),d(!0),c&&ut(C.uid,t.id,"songs"),D(t.id,C)},moreWindowPosRelativeToViewport:v,openMoreWindow:O,currentItemRef:w}},jt=n(51),bt=function(e){var t=e.play;return Object(v.jsxs)("div",{className:"ColorCircles",style:t?{}:{opacity:0,transform:"scale(.95)"},children:[Object(v.jsx)("span",{className:"colorCircle"}),Object(v.jsx)("span",{className:"colorCircle"}),Object(v.jsx)("span",{className:"colorCircle"}),Object(v.jsx)("span",{className:"colorCircle"})]})};function ht(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;return e.substr(0,t)+(e.length>t?"...":"")}var ft=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" & ",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,s=null===e||void 0===e?void 0:e.map((function(e){return e.displayName})).join(t);return s?ht(s,n):""};function Ot(e){return e<1e3?e:e<1e6?parseFloat(e/1e3).toFixed(1)+"K":e<1e9?parseFloat(e/1e6).toFixed(1)+"M":void 0}var pt,mt=function(e){var t=e.showListens,n=e.isNewSong,s=e.song;return t?Object(v.jsxs)("span",{style:{display:"flex",alignItems:"center",opacity:.7,fontSize:".8em"},className:n?"newSongMarker":"",children:[Ot(s.listens)," ",Object(v.jsx)($e.c,{})]}):n?Object(v.jsx)("span",{style:{display:"flex",alignItems:"center",fontSize:".7em"},className:"newSongMarker",children:"New"}):null},gt=Object(s.memo)((function(e){var t=e.song,n=e.currentSong,s=e.play,a=e.isMobile,c=e.showListens,r=e.displayAuthors,i=e.isNewSong,o=Ge().screenWidth;return Object(v.jsxs)("div",{className:"songItemImageAndName",children:[Object(v.jsxs)("div",{className:"songItemImage",children:[Object(v.jsx)("div",{className:"songItemPlayOrPause",children:t.id===n&&s?null:Object(v.jsx)(jt.c,{})}),Object(v.jsxs)("div",{className:"playingAnimation",style:t.id===n&&s?{opacity:1,visibility:"visible"}:{},children:[Object(v.jsx)(jt.b,{}),Object(v.jsx)(bt,{play:s})]}),Object(v.jsx)("img",{src:t.cover,alt:"",loading:"lazy"})]}),Object(v.jsxs)("div",{className:"songItemNameAndAuthor",children:[Object(v.jsxs)("div",{className:"songItemName",style:{display:"flex",alignItems:"center"},children:[ht(t.name,a?17:30),Object(v.jsx)("span",{style:{marginLeft:"10px",fontWeight:"500"},children:Object(v.jsx)(mt,{showListens:c,isNewSong:i,song:t})})]}),a?Object(v.jsx)("div",{className:"songItemAuthor",style:{maxWidth:o-180},children:ft(t.authors," & ",130)}):Object(v.jsx)("div",{className:"songItemAuthor",children:r(t.authors)})]})]})})),xt=function(e){var t=e.listOfAuthors,n=le().displayAuthorsFull;return Object(v.jsx)("div",{className:"rightSideAuthorsList",children:Object(v.jsx)("div",{className:"rightSideAuthorsListCentralBlock",children:n(t)})})},vt=function(e){var t=e.song,n=re().setContent,s=S().currentUser;return Object(v.jsxs)("div",{className:"SongItemMobileMoreWindow",children:[Object(v.jsxs)("div",{className:"simpleSongElement",style:{background:t.imageColors[0]},children:[Object(v.jsx)("div",{className:"simpleSongElementImage",children:Object(v.jsx)("img",{loading:"lazy",src:t.cover,alt:""})}),Object(v.jsx)("span",{children:t.name})]}),s.isAdmin?Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){n(Object(v.jsx)(Ue,{song:t}))},children:[Object(v.jsx)(de.h,{}),"Edit"]}):null,Object(v.jsx)("div",{className:"songItemMenuWindowItem",children:Object(v.jsx)(He,{song:t})}),Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){return n(Object(v.jsx)(_e,{song:t}))},children:[Object(v.jsx)(be.c,{}),"Add to playlist"]}),Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){n(Object(v.jsx)(it,{item:t,whatToShare:"song"}))},children:[Object(v.jsx)(je.C,{}),"Share"]}),Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){n(Object(v.jsx)(ot,{song:t}))},children:[Object(v.jsx)(je.q,{}),"Info"]}),Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){n(Object(v.jsx)(xt,{listOfAuthors:t.authors,title:"Authors"}))},children:[Object(v.jsx)(je.H,{}),"Authors"]})]})},yt=function(e){var t=S(),n=t.currentUser,s=(t.setCurrentUser,le().yourSongs),a=re(),c=a.openBottomMessage,r=a.openConfirm,i=a.closeConfirm;return[function(t){We(t,e,n),c("".concat(ht(e.name,15)," added to your library"))},function(t){t.stopPropagation(),r('You sure you want to delete "'.concat(e.name,'" from library?'),"Yes, delete it","No, just kidding",(function(t){ze(t,e,n,s),i(),c("".concat(ht(e.name,15)," removed from your library"),"failure")}))}]},St=function(e){var t=e.song,n=S().currentUser,s=yt(t),a=Object(j.a)(s,2),c=a[0],r=a[1];return n.addedSongs.includes(t.id)?Object(v.jsxs)("button",{onClick:r,style:{position:"relative"},children:[Object(v.jsx)(Je,{text:"delete song"}),Object(v.jsx)(je.I,{})]}):Object(v.jsxs)("button",{onClick:c,style:{position:"relative"},children:[Object(v.jsx)(Je,{text:"add song"}),Object(v.jsx)(je.z,{})]})},wt=function(e){var t=e.song,n=e.isMobile,s=e.openSongItemMoreWindow,a=re(),c=a.toggleModal,r=a.setContent;return Object(v.jsxs)("div",{className:"songItemMoreBtn",children:[Object(v.jsx)(St,{song:t}),Object(v.jsxs)("button",{onClick:n?function(e){e.stopPropagation(),c(),r(Object(v.jsx)(vt,{song:t}))}:s,children:[Object(v.jsx)(Je,{text:"more"}),Object(v.jsx)(je.v,{})]})]})},Ct=Object(s.memo)((function(e){var t=e.song,n=e.localIndex,s=e.showListens,a=void 0!==s&&s,c=e.isNewSong,r=void 0!==c&&c,i=e.listOfChosenSongs,o=e.setListOfSongs,l=e.position,u=e.shouldSaveSearchHistory,d=void 0!==u&&u,j=Ge().isMobile,b=le(),h=b.currentSong,f=b.displayAuthors,O=b.play,p=dt({song:t,position:l,localIndex:n,shouldSaveSearchHistory:d}),m=p.openSongItemMoreWindow,g=p.chooseSongItem,x=p.moreWindowPosRelativeToViewport,y=p.openMoreWindow,S=p.currentItemRef;return Object(v.jsxs)("div",{style:{display:"flex",alignItems:"center",width:"100%"},children:[Object(v.jsx)(z,{listOfChosenItems:i,setListOfChosenItems:o,itemId:t.id}),Object(v.jsxs)("div",{className:"SongItem "+(t.id===h&&O?"playingNow":""),onClick:g,ref:y?S:null,style:y?{background:"var(--playlistsColor)"}:{},children:[Object(v.jsx)(gt,{song:t,currentSong:h,play:O,isMobile:j,showListens:a,displayAuthors:f,isNewSong:r}),Object(v.jsx)(wt,{song:t,isMobile:j,openSongItemMoreWindow:m}),Object(v.jsx)(lt,{openMoreWindow:y,song:t,moreWindowPosRelativeToViewport:x})]})]})})),Nt=function(e){var t=e.func,n=e.lenOfList,s=e.maxLen,a=void 0===s?5:s,c=e.boolVal;return Object(v.jsx)("div",{onClick:n>a?t:null,className:"MoreBtn",style:n<=a?{display:"none"}:{},children:Object(v.jsx)("button",{style:c?{background:"var(--pink)",color:"#ff8db2"}:{},children:c?"Close":"More"})})},kt=function(e){var t=e.title,n=e.func,s=e.boolVal,a=e.lenOfList,c=e.maxLen,r=void 0===c?5:c,i=e.marginBottom,o=void 0===i?0:i;return 0!==a?Object(v.jsxs)("div",{className:"topTitle",style:{margin:"10px 0"},children:[Object(v.jsx)("h2",{style:{margin:o},children:t}),Object(v.jsx)(Nt,{func:n,boolVal:s,lenOfList:a,maxLen:r})]}):null},It=function(e){var t=e.listOfSongs,n=e.source,a=e.title,c=void 0===a?"":a,r=e.showListens,o=void 0!==r&&r,l=e.isNewSong,u=void 0!==l&&l,d=e.showCount,b=void 0!==d&&d,h=e.listOfChosenSongs,f=e.setListOfSongs,O=e.showSearch,p=void 0!==O&&O,g=e.displayIfEmpty,x=e.showhistory,y=void 0!==x&&x,w=e.saveSearchHistory,C=void 0!==w&&w,N=e.isHorizontal,k=void 0!==N&&N,I=le(),A=I.setCurrentSongQueue,P=I.setCurrentSongPlaylistSource,M=(I.playSong,I.setCurrentSong,S().currentUser),E=Object(s.useState)(!1),R=Object(j.a)(E,2),D=R[0],B=R[1],F=Object(s.useState)(""),U=Object(j.a)(F,2),W=U[0],V=U[1],z=Object(s.useState)(t),H=Object(j.a)(z,2),Y=H[0],q=H[1];return Object(s.useEffect)((function(){q(t)}),[t]),Object(v.jsxs)("div",{className:"SongList",onClick:function(){if("no"!==n&&0!==t.length){A(t),P(n);var e=t.map((function(e){return e.id}));m.collection("users").doc(M.uid).update({lastQueue:{image:n.image,name:n.name,songsList:e,source:n.source}})}},children:[0!==c.length?Object(v.jsx)(kt,{title:c,func:function(){return B(!D)},boolVal:D,lenOfList:t.length}):null,p?Object(v.jsxs)("div",{style:{display:"flex",alignItems:"flex-start"},children:[Object(v.jsx)(De,{value:W,setValue:V,allFoundSongs:Y,setAllFoundSongs:q,defaultSearchMode:"songs",defaultSongsListValue:t,inputText:"Search for songs",background:"#00000061"}),y?Object(v.jsx)(i.b,{to:L,children:Object(v.jsx)("button",{className:"standartButton",style:{marginTop:"10px",marginBottom:"0",height:"44px",width:"44px",padding:"0",marginLeft:"6px",background:"var(--playlistsColor)"},children:Object(v.jsx)(T.d,{style:{marginRight:"0"}})})}):null]}):null,Object(v.jsx)("div",{className:"list-of-songs"+(k?" horizontal":""),children:Y.map((function(e,t){return 0===c.length||D||t<5?Object(v.jsxs)("span",{className:"topSongItem",children:[b?Object(v.jsx)("h3",{style:{opacity:"0.7"},children:t+1}):null,Object(v.jsx)(Ct,{song:e,localIndex:t,showListens:o,isNewSong:u,listOfChosenSongs:h,setListOfSongs:f,shouldSaveSearchHistory:C},e.id)]}):void 0}))}),0===t.length&&!!g&&Object(v.jsx)("h4",{style:{display:"flex",justifyContent:"center"},children:g})]})},At=function(e){var t=Object(s.useState)([]),n=Object(j.a)(t,2),a=n[0],c=n[1],r=Object(s.useState)([]),i=Object(j.a)(r,2),o=i[0],l=i[1];function b(){return(b=Object(d.a)(u.a.mark((function t(){var n,s,a,r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===(null===e||void 0===e?void 0:e.authors)){t.next=10;break}return n=e.authors.map((function(e){return e.uid})),t.next=4,m.collection("users").where("uid","in",n).get();case 4:s=t.sent,a=[],r=[],s.docs.forEach((function(e){a.push(e.data()),r.push(e.data().photoURL)})),c(a),l(r);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return Object(s.useEffect)((function(){!function(){b.apply(this,arguments)}()}),[null===e||void 0===e?void 0:e.id]),[a,o]},Pt=function(e){var t=e.imagesList,n=e.borderColor,s=void 0===n?"#fff":n;return Object(v.jsx)("div",{className:"SmallImages",style:{marginRight:-7*(t.length-1)},children:t.map((function(e,t){if(e)return Object(v.jsx)("div",{className:"smallImgContainer",style:{border:"3px solid ".concat(s),transform:"translateX(".concat(-15*t,"px)")},children:Object(v.jsx)("img",{loading:"lazy",src:e,alt:""})},t)}))})},Lt=function(e){var t=e.data,n=e.color,a=S().currentUser,c=Object(s.useState)(!1),r=Object(j.a)(c,2),o=r[0],l=r[1],u=Object(s.useState)(0),d=Object(j.a)(u,2),b=d[0],h=d[1];return Object(s.useEffect)((function(){at([t.uid],a,l,h)}),[t.uid]),Object(v.jsx)(i.b,{to:"/chat/".concat(b),style:{display:"block",width:"fit-content",textDecoration:"none"},children:Object(v.jsxs)("button",{onClick:function(){o&&st([a.uid,t.uid],b)},style:{background:n},className:"ChatWithFriendButton",children:[Object(v.jsx)(je.s,{})," Messages"]})})},Mt=n(128),Tt=function(){var e=Object(d.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("songs").doc(t).get();case 2:return n=e.sent.data(),e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Et=function(e){var t=Object(s.useState)(),n=Object(j.a)(t,2),a=n[0],c=n[1],r=le(),i=r.setCurrentSong,o=r.currentSong,l=r.play,u=r.songRef,d=r.setPlay,b=r.setCurrentSongInQueue,h=S().currentUser;return Object(s.useEffect)((function(){(null===e||void 0===e?void 0:e.lastSongPlayed)&&Tt(e.lastSongPlayed).then((function(e){return c(e)}))}),[e.lastSongPlayed]),[a,function(){if(i(a.id),m.collection("users").doc(h.uid).update({lastSongPlayed:a.id}),b(0),a.id===o&&l)return u.current.pause(),void d(!1);u.current.play(),d(!0)}]},Rt=function(e){var t=e.data,n=e.loading,s=Et(t,n),a=Object(j.a)(s,2),c=a[0],r=a[1];return void 0!==c?Object(v.jsxs)("div",{className:"LastSongListened",onClick:r,children:[Object(v.jsx)(Mt.a,{}),Object(v.jsx)("span",{children:c.name})]}):null},Dt=function(){var e=Object(d.a)(u.a.mark((function e(t,n){var s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(n.uid).get();case 2:(s=e.sent.data().addedPlaylists).push(t.id),m.collection("users").doc(n.uid).update({addedPlaylists:s}),m.collection("playlists").doc(t.id).update({subscribers:++t.subscribers});case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Bt=function(){var e=Object(d.a)(u.a.mark((function e(t,n){var s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=n.addedPlaylists.filter((function(e){return e!==t.id})),m.collection("users").doc(n.uid).update({addedPlaylists:s}),m.collection("playlists").doc(t.id).update({subscribers:--t.subscribers});case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Ft=function(e){var t=e.color,n=void 0===t?"":t,s=Object(o.g)();return Object(v.jsx)("div",{className:"GoBackBtn",children:Object(v.jsxs)("button",{onClick:function(){return s.goBack()},style:n.length?{color:n}:{},children:[Object(v.jsx)(Je,{text:"go back",direction:"bottom"}),Object(v.jsx)(je.a,{})]})})},Ut=function(e){var t=e.album,n=re().setContent,a=le().yourFriends,c=Object(s.useState)([]),r=Object(j.a)(c,2),i=r[0],o=r[1],l=Object(s.useState)(!0),b=Object(j.a)(l,2),h=b[0],f=b[1];function O(){return(O=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f(!0),o([]),a.forEach((function(e){e.addedPlaylists.includes(t.id)&&o((function(t){return[].concat(Object(W.a)(t),[e])}))})),f(!1);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){!function(){O.apply(this,arguments)}()}),[t.uid]),Object(v.jsxs)("div",{className:"SongInfo",children:[Object(v.jsx)("div",{className:"songImage",style:{backgroundImage:"url(".concat(t.image,")")}}),Object(v.jsxs)("div",{className:"songInfoContent",children:[Object(v.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[Object(v.jsx)("span",{style:{opacity:".5",fontWeight:500,fontSize:".7em"},children:t.isAlbum?"Album":"Playlist"}),Object(v.jsx)("h3",{style:{color:t.imageColors[1]},children:t.name})]}),Object(v.jsxs)("div",{style:{display:"flex",opacity:"0.6",fontSize:".9em",position:"relative"},className:"listensAndDate",children:[Object(v.jsxs)("p",{className:"infoListens",style:{marginRight:"20px",position:"relative"},children:[t.listens,Object(v.jsx)(je.n,{})]}),Object(v.jsxs)("p",{className:"infoListens",style:{marginRight:"20px",position:"relative"},children:[t.subscribers," ",Object(v.jsx)(je.G,{})]}),Object(v.jsx)("span",{children:Q(t.creationDate)})]}),Object(v.jsx)("h4",{style:{margin:"10px 0"},children:i.length>0?"Friends subscribed":"None of your friends subscribed"}),h?Object(v.jsx)("div",{style:{position:"relative",height:"50px"},children:Object(v.jsx)(M,{top:"50%"})}):Object(v.jsx)("div",{style:{display:"flex"},children:i.length>0?Object(v.jsxs)(v.Fragment,{children:[i.map((function(e,t){if(t<2)return Object(v.jsx)(Ze,{person:e},e.uid)})),i.length>2?Object(v.jsx)(et,{onClick:function(){return n(Object(v.jsx)(tt,{listOfPeople:i,title:"Friends subscribed to ".concat(t.name)}))}}):null]}):Object(v.jsx)("button",{className:"shareBtn",style:{minHeight:"35px",background:t.imageColors[0]},onClick:function(){n(Object(v.jsx)(it,{item:t,whatToShare:"playlist"}))},children:"Share"})})]})]})},Wt=n(28),Vt=n(67),zt=H.a.button(pt||(pt=Object(U.a)(['\n  width: 100%;\n  padding: 0;\n  box-sizing: border-box;\n  background: linear-gradient(45deg, #852de5, #5c38c1);\n  color: #fff;\n  font-weight: bold;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  height: 40px;\n  border-radius: var(--standartBorderRadius3);\n  position: relative;\n  overflow: hidden;\n  z-index: 2;\n  margin: 8px 0;\n\n  @keyframes button-animation-out {\n    0% {\n      opacity: 0;\n      transform: scale(0.9);\n    }\n    100% {\n      opacity: 1;\n      transform: scale(1);\n    }\n  }\n\n  .inner-button {\n    z-index: 1;\n    position: relative;\n    width: 100%;\n    height: 100%;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n\n    .inner-button-content {\n      width: 100%;\n      height: 100%;\n    }\n\n    .inner-button-success {\n      animation: button-animation-out 2s forwards;\n    }\n\n    .inner-button-text {\n      cursor: pointer;\n      width: 100%;\n      height: 100%;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n\n      svg {\n        margin-right: 7px;\n        width: 20px;\n        height: 20px;\n      }\n    }\n\n    .inner-button-download {\n      width: 100%;\n      background: red;\n\n      input[type="file"] {\n        /* display: none; */\n        width: 100%;\n        height: 100%;\n        position: absolute;\n        left: 50%;\n        top: 50%;\n        transform: translate(-50%, -50%);\n        display: none;\n      }\n    }\n  }\n\n  &::before {\n    content: "";\n    position: absolute;\n    display: block;\n    top: 50%;\n    left: 0%;\n    transform: translateY(-50%);\n    background: var(--green);\n    width: ',";\n    height: 100%;\n    transition: 0.6s;\n    z-index: 0;\n  }\n\n  .LoadingCircle {\n    position: relative;\n    transform: none;\n    left: auto;\n    top: auto;\n    width: 30px;\n    height: 30px;\n\n    img {\n      width: 30px;\n      height: 30px;\n    }\n  }\n"])),(function(e){return e.completed?"100%":"0"})),Ht=function(e){var t=e.title,n=void 0===t?"":t,a=e.text,c=e.place,r=e.setItemSrc,i=e.setImageLocalPath,o=re().openBottomMessage,l=Object(s.useState)(""),b=Object(j.a)(l,2),h=b[0],f=b[1],O=Object(s.useState)(!1),m=Object(j.a)(O,2),g=m[0],x=m[1],y=Object(s.useState)(!1),S=Object(j.a)(y,2),w=S[0],C=S[1];function N(){return(N=Object(d.a)(u.a.mark((function e(t,n,s){var a,c,r,o,l,d,j;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),f(""),x(!0),C(!1),a="songsImages/"===n||"usersImages/"===n||"chatCovers/"===n,c=t.target.files[0],r=!1,a?(o=[".jpg",".png",".jpeg"]).find((function(e){return c.name.substr(c.name.length-e.length,e.length)===e}))?r=!0:(f("Format of your file is not valid. Download file with one of these: ".concat(o.map((function(e){return" "+e})))),x(!1)):"songs/"===n&&((l=[".mp3",".mp4a",".flac",".wav",".wma"]).find((function(e){return c.name.substr(c.name.length-e.length,e.length)===e}))?r=!0:(f("Format of your file is not valid. Download file with one of these: ".concat(l.map((function(e){return e})))),x(!1))),!r){e.next=21;break}return a&&i(URL.createObjectURL(c)),d=p.ref(),j=d.child(n+c.name),e.next=14,j.put(c);case 14:return C(!0),x(!1),e.t0=s,e.next=19,j.getDownloadURL();case 19:e.t1=e.sent,(0,e.t0)(e.t1);case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){h.length&&o(h,"failure")}),[h]),Object(v.jsxs)(v.Fragment,{children:[!!n&&Object(v.jsx)("h3",{children:n}),Object(v.jsx)(zt,{completed:w,children:Object(v.jsx)("div",{className:"inner-button",children:w?Object(v.jsxs)("div",{className:"inner-button-success",children:[Object(v.jsx)(ge.b,{})," Done"]}):g?Object(v.jsx)(M,{top:0}):Object(v.jsx)("div",{className:"inner-button-content",children:Object(v.jsxs)("label",{className:"inner-button-download",children:[Object(v.jsxs)("div",{className:"inner-button-text",children:[Object(v.jsx)(Vt.b,{}),a]}),Object(v.jsx)("input",{type:"file",name:"",id:"",onChange:function(e){return function(e,t,n){return N.apply(this,arguments)}(e,c,r)}})]})})})})]})},Yt=function(e){var t=e.currentActive,n=e.id,s=e.label,a=e.onClick;return Object(v.jsxs)("div",{className:"RadioBtn",id:n,onClick:a,children:[Object(v.jsx)("span",{className:"radioLabel",style:t===n?{color:"var(--blue)",opacity:1,fontWeight:"bold"}:{},children:s}),Object(v.jsx)("span",{className:"radioCircle",style:t===n?{background:"var(--blue)"}:{}})]})},qt=function(e){var t=Object(s.useState)(e.name),n=Object(j.a)(t,2),a=n[0],c=n[1],r=Object(s.useState)(""),i=Object(j.a)(r,2),o=i[0],l=i[1],b=Object(s.useState)(e.image),h=Object(j.a)(b,2),f=h[0],O=h[1],p=Object(s.useState)(""),g=Object(j.a)(p,2),x=g[0],v=g[1],y=Object(s.useState)([]),S=Object(j.a)(y,2),w=S[0],C=S[1],N=Object(s.useState)(e.authors),k=Object(j.a)(N,2),I=k[0],A=k[1],P=Object(s.useState)(e.creationDate),L=Object(j.a)(P,2),M=L[0],T=L[1],E=Object(s.useState)(""),R=Object(j.a)(E,2),D=R[0],B=R[1],F=Object(s.useState)([]),U=Object(j.a)(F,2),V=U[0],z=U[1],H=Object(s.useState)(e.songs),Y=Object(j.a)(H,2),q=Y[0],Q=Y[1],G=Object(s.useState)(e.isAlbum?1:0),X=Object(j.a)(G,2),J=X[0],K=X[1],_=Object(s.useState)(e.isPrivate?1:0),$=Object(j.a)(_,2),Z=$[0],ee=$[1],te=Object(s.useState)(!1),ne=Object(j.a)(te,2),se=ne[0],ae=(ne[1],Object(s.useState)(!1)),ce=Object(j.a)(ae,2),re=ce[0],ie=ce[1],oe=Object(s.useState)(""),le=Object(j.a)(oe,2),ue=le[0],de=le[1],je=Object(s.useState)(e.imageColors),be=Object(j.a)(je,2),he=be[0],fe=be[1],Oe=Object(s.useState)(!1),pe=Object(j.a)(Oe,2),me=pe[0],ge=pe[1],xe=Object(s.useState)(!1),ve=Object(j.a)(xe,2),ye=ve[0],Se=ve[1];function we(e){var t=I.filter((function(t){return t.uid!==e.uid}));return A(t)}function Ce(){return(Ce=Object(d.a)(u.a.mark((function t(n){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.preventDefault(),a.length?I.length?(I.length>e.authors.length?I.filter((function(t){return!e.authors.find((function(e){return e.uid===t.uid}))})).forEach(function(){var t=Object(d.a)(u.a.mark((function t(n){var s,a,c;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.collection("users").doc(n.uid).get();case 2:s=t.sent,a=s.data(),(c=a.ownPlaylists).push(e.id),m.collection("users").doc(n.uid).update({ownPlaylists:c});case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()):I.length<e.authors.length&&e.authors.filter((function(e){return!I.find((function(t){return t.uid===e.uid}))})).forEach(function(){var t=Object(d.a)(u.a.mark((function t(n){var s,a,c,r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.collection("users").doc(n.uid).get();case 2:s=t.sent,a=s.data(),c=a.ownPlaylists,r=c.filter((function(t){return t!==e.id})),m.collection("users").doc(n.uid).update({ownPlaylists:r});case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),m.collection("playlists").doc(e.id).update({id:e.id,name:a,songs:q,authors:I,image:f,listens:e.listens,creationDate:M,subscribers:e.subscribers,isAlbum:1===J,imageColors:he,isPrivate:1===Z}).then((function(){ge(!1),Se(!0)}))):l("Playlist has to have at least 1 author"):l("Playlist has to have a name");case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return Object(s.useEffect)((function(){c(e.name),O(e.image),A(e.authors)}),[e.id]),Object(s.useEffect)((function(){0===D.length&&e.songs.map(function(){var e=Object(d.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("songs").doc(t).get();case 2:n=e.sent.data(),ie(!1),z((function(e){return[].concat(Object(W.a)(e),[n])}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[D]),{imageLocalPath:ue,setImageColors:fe,playlistName:a,setPlaylistName:c,authorsInputValue:x,setAuthorsInputValue:v,setAllAuthors:C,chosenAuthors:I,removeAuthorFromList:we,loadingAuthors:se,allAuthors:w,addAuthor:function(e){if(!I.some((function(t){return t.uid===e.uid})))return A((function(t){return[].concat(Object(W.a)(t),[{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL}])}));we(e)},songsSearch:D,setSongsSearch:B,setAllSongs:z,loadingSongs:re,allSongs:V,chosenSongs:q,setChosenSongs:Q,setPlaylistStatus:K,playlistStatus:J,isPlaylistPrivate:Z,setIsPlaylistPrivate:ee,setPlaylistCover:O,releaseDate:M,setReleaseDate:T,setImageLocalPath:de,addPlaylistToFirebase:function(e){return Ce.apply(this,arguments)},loading:me,completed:ye,setCompleted:Se,error:o,setError:l}},Qt=function(e){var t=e.playlist,n=S().currentUser,s=qt(t),a=s.imageLocalPath,c=s.setImageColors,r=s.playlistName,i=s.setPlaylistName,o=s.authorsInputValue,l=s.setAuthorsInputValue,u=s.setAllAuthors,d=s.chosenAuthors,j=s.removeAuthorFromList,b=s.loadingAuthors,h=s.allAuthors,f=s.addAuthor,O=s.songsSearch,p=s.setSongsSearch,m=s.setAllSongs,g=s.loadingSongs,x=s.allSongs,y=s.chosenSongs,w=s.setChosenSongs,C=s.setPlaylistStatus,N=s.playlistStatus,k=s.isPlaylistPrivate,I=s.setIsPlaylistPrivate,A=s.setPlaylistCover,P=s.releaseDate,L=s.setReleaseDate,T=s.setImageLocalPath,E=s.addPlaylistToFirebase,R=s.loading,D=s.completed,B=s.setCompleted,F=s.error,U=s.setError;return Object(v.jsxs)("div",{className:"AddSong",children:[Object(v.jsx)(Wt.a,{src:a,getColors:function(e){return c(e)}}),Object(v.jsx)(me,{title:"Playlist name",value:r,setValue:i,placeholder:"Enter playlist name"}),Object(v.jsxs)("div",{children:[Object(v.jsx)("h3",{children:"Playlist authors"}),Object(v.jsx)(De,{value:o,setValue:l,setResultAuthorList:u,defaultSearchMode:"users",inputText:"Search for authors"}),Object(v.jsx)("div",{className:"chosenAuthorsList",children:d.map((function(e){return Object(v.jsxs)("div",{className:"chosenAuthorItem",children:[Object(v.jsx)("span",{children:e.displayName}),Object(v.jsx)(je.J,{onClick:function(){return e.uid===n.uid?null:j(e)}})]})}))}),Object(v.jsx)("div",{className:"authorsResult",children:b?Object(v.jsx)("div",{style:{position:"relative",width:"100%",height:"50px"},children:Object(v.jsx)(M,{})}):h.map((function(e,t){return Object(v.jsx)(K,{data:e,onClick:function(){return f(e)},style:d.includes(e.uid)?{background:"var(--green)"}:{}},t)}))})]}),Object(v.jsxs)("label",{children:[Object(v.jsx)("h3",{children:"Search for songs"}),Object(v.jsx)(De,{value:O,setValue:p,setAllFoundSongs:m,defaultSearchMode:"songs",inputText:"Search for songs"}),Object(v.jsx)("div",{className:"authorsResult",children:g?Object(v.jsx)("div",{style:{position:"relative",width:"100%",height:"50px"},children:Object(v.jsx)(M,{})}):Object(v.jsx)(It,{listOfSongs:x,source:"no",listOfChosenSongs:y,setListOfSongs:w})})]}),n.isAdmin||n.isAuthor?Object(v.jsxs)("div",{style:{display:"flex",justifyContent:"flex-start",margin:"15px 0"},children:[Object(v.jsx)(Yt,{label:"Playlist",onClick:function(){return C(0)},currentActive:N,id:0}),Object(v.jsx)(Yt,{label:"Album",onClick:function(){return C(1)},currentActive:N,id:1})]}):null,Object(v.jsxs)("div",{style:{display:"flex",justifyContent:"flex-start",margin:"15px 0"},children:[Object(v.jsx)(Yt,{label:"Not Private",onClick:function(){return I(0)},currentActive:k,id:0}),Object(v.jsx)(Yt,{label:"Private",onClick:function(){return I(1)},currentActive:k,id:1})]}),(n.isAdmin||n.isAuthor)&&Object(v.jsx)(me,{title:"Release Date",type:"date",value:P,setValue:L,placeholder:"Enter release date"}),Object(v.jsx)(Ht,{text:"Download playlist cover",place:"songsImages/",setItemSrc:A,setImageLocalPath:T}),Object(v.jsx)(ve,{text:"Update playlist",action:E,isLoading:R,completed:D,setCompleted:B,bottomMessage:"Playlist was updated",errorMessage:F,setErrorMessage:U})]})},Gt=function(){var e=Object(d.a)(u.a.mark((function e(t,n){var s,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(n.uid).get();case 2:(s=e.sent.data().addedAuthors).push(t.uid),m.collection("users").doc(n.uid).update({addedAuthors:s}),a=t.subscribers,a++,m.collection("users").doc(t.uid).update({subscribers:a});case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();function Xt(e,t){var n=e.friends,s=t.friends;n.push({status:"requested",uid:t.uid}),s.push({status:"awaiting",uid:e.uid}),m.collection("users").doc(e.uid).update({friends:n}),m.collection("users").doc(t.uid).update({friends:s})}var Jt=function(){var e=Object(d.a)(u.a.mark((function e(t,n,s){var a,c,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=s.filter((function(e){return!e.authors.find((function(e){return e.uid===t.uid}))||n.addedAuthors.length-Ve(n.addedAuthors,e.authors.map((function(e){return e.uid}))).length>1})),c=n.addedAuthors.filter((function(e){return e!==t.uid})),e.next=4,m.collection("users").doc(t.uid).get();case 4:r=e.sent.data().subscribers,m.collection("users").doc(n.uid).update({addedSongs:a.map((function(e){return e.id})),addedAuthors:c}),m.collection("users").doc(t.uid).update({subscribers:r-1});case 7:case"end":return e.stop()}}),e)})));return function(t,n,s){return e.apply(this,arguments)}}(),Kt=function(e){var t=e.author,n=re().setContent,a=le().yourFriends,c=Object(s.useState)([]),r=Object(j.a)(c,2),i=r[0],o=r[1],l=Object(s.useState)(!0),b=Object(j.a)(l,2),h=b[0],f=b[1];function O(){return(O=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f(!0),o([]),a.forEach((function(e){t.isAuthor?e.addedAuthors.includes(t.uid)&&o((function(t){return[].concat(Object(W.a)(t),[e])})):e.friends.find((function(e){return e.uid===t.uid}))&&o((function(t){return[].concat(Object(W.a)(t),[e])}))})),f(!1);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){!function(){O.apply(this,arguments)}()}),[t.uid]),Object(v.jsxs)("div",{className:"SongInfo",children:[Object(v.jsx)("div",{className:"songImage",style:{backgroundImage:"url(".concat(t.photoURL,")")}}),Object(v.jsxs)("div",{className:"songInfoContent",children:[Object(v.jsxs)("div",{style:{display:"flex",flexDirection:"column-reverse"},children:[Object(v.jsxs)("h3",{style:{color:t.imageColors[1]},children:[t.displayName,t.isVerified?Object(v.jsx)(ge.b,{style:{color:t.imageColors[0],width:"15px",height:"15px",marginLeft:"5px"}}):null]}),Object(v.jsx)("span",{style:{opacity:".5",fontWeight:500,fontSize:".7em"},children:t.isAuthor?"Author":"User"})]}),Object(v.jsxs)("div",{style:{display:"flex",opacity:"0.6",fontSize:".9em",position:"relative"},className:"listensAndDate",children:[Object(v.jsxs)("p",{className:"infoListens",style:{marginRight:"20px",position:"relative"},children:[t.numberOfListenersPerMonth,Object(v.jsx)(je.n,{})]}),Object(v.jsxs)("p",{className:"infoListens",style:{marginRight:"20px",position:"relative"},children:[t.subscribers," ",Object(v.jsx)(je.G,{})]}),Object(v.jsx)("span",{children:Q(t.regDate)})]}),Object(v.jsx)("h4",{style:{margin:"10px 0"},children:i.length>0?"Friends subscribed":"None of your friends subscribed"}),h?Object(v.jsx)("div",{style:{position:"relative",height:"50px"},children:Object(v.jsx)(M,{top:"50%"})}):Object(v.jsx)("div",{style:{display:"flex"},children:i.length>0?Object(v.jsxs)(v.Fragment,{children:[i.map((function(e,t){if(t<2)return Object(v.jsx)(Ze,{person:e},e.uid)})),i.length>2?Object(v.jsx)(et,{onClick:function(){return n(Object(v.jsx)(tt,{listOfPeople:i,title:"Friends subscribed to ".concat(t.displayName)}))}}):null]}):Object(v.jsx)("button",{className:"shareBtn",style:{minHeight:"35px",background:t.imageColors[0]},onClick:function(){n(Object(v.jsx)(it,{item:t,whatToShare:"author"}))},children:"Share"})})]})]})},_t=function(e){var t=e.data,n=re().setContent;return Object(v.jsxs)("div",{className:"AuthorMoreWindow",style:{top:"110%",bottom:"auto"},onClick:function(e){return e.stopPropagation()},children:[Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){n(Object(v.jsx)(it,{item:t,whatToShare:void 0!==t.authors?"playlist":"author"}))},children:[Object(v.jsx)(je.C,{}),"Share"]}),Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){n(void 0!==t.authors?Object(v.jsx)(Ut,{album:t}):Object(v.jsx)(Kt,{author:t}))},children:[Object(v.jsx)(je.q,{}),"Info"]})]})},$t=function(e){var t=e.author,n=Object(s.useState)(t.displayName),a=Object(j.a)(n,2),c=a[0],r=a[1],i=Object(s.useState)(t.photoURL),o=Object(j.a)(i,2),l=o[0],b=o[1],h=Object(s.useState)(""),f=Object(j.a)(h,2),O=f[0],g=f[1],x=Object(s.useState)(t.imageColors),y=Object(j.a)(x,2),S=y[0],w=y[1];function C(){return(C=Object(d.a)(u.a.mark((function e(t,n,s){var a,c,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.target.files[0],g(URL.createObjectURL(a)),c=p.ref(),r=c.child(n+a.name),e.next=6,r.put(a);case 6:return e.t0=s,e.next=9,r.getDownloadURL();case 9:e.t1=e.sent,(0,e.t0)(e.t1);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(v.jsxs)("div",{className:"AddSong",children:[Object(v.jsx)(Wt.a,{src:O,getColors:function(e){return w(e)}}),Object(v.jsxs)("form",{onSubmit:function(e){return e.preventDefault()},children:[Object(v.jsx)("div",{style:{width:"100%",display:"flex",justifyContent:"center"},children:Object(v.jsx)("div",{className:"chatInfoImage",style:{backgroundImage:"url(".concat(l,")")},children:Object(v.jsxs)("label",{className:"changePhoto",children:[Object(v.jsx)(be.b,{}),"Change photo",Object(v.jsx)("input",{type:"file",style:{display:"none"},onChange:function(e){return function(e,t,n){return C.apply(this,arguments)}(e,"chatCovers/",b)}})]})})}),Object(v.jsxs)("label",{children:[Object(v.jsx)("h3",{children:"Your name"}),Object(v.jsx)("input",{type:"text",placeholder:"Enter your name",value:c,onChange:function(e){return r(e.target.value)},required:!0})]}),Object(v.jsx)("button",{type:"button",className:"addSongBtn",onClick:function(e){e.preventDefault(),m.collection("users").doc(t.uid).update({displayName:c,photoURL:l,imageColors:S})},children:"Update author"})]})]})},Zt=function(e){var t=e.data,n=e.headerColors,a=S(),c=a.currentUser,r=a.logout,o=Ge().isMobile,l=le().yourSongs,u=Object(s.useState)(!1),d=Object(j.a)(u,2),b=d[0],h=d[1],f=re(),O=f.toggleModal,p=f.setContent,g=f.openConfirm,x=f.closeConfirm,y=f.openBottomMessage,w=Object(s.useRef)(null);return Re(w,h),Object(v.jsxs)("div",{className:"headerBtns",style:{background:n[2]},children:[Object(v.jsx)(Ft,{}),Object(v.jsxs)("div",{style:{display:"flex"},children:[Object(v.jsx)("div",{className:"headerBackBtn",children:t.authors?c.ownPlaylists.includes(t.id)&&1===t.authors.length?Object(v.jsxs)("button",{onClick:function(){return g("Are you sure you want to DELETE this playlist forever?!","Yes, pretty sure","No, I Don't!",(function(){var e;e=t.id,m.collection("users").where("addedPlaylists","array-contains",e).get().then((function(t){t.docs.forEach((function(t){var n=t.data().addedPlaylists.filter((function(t){return t!==e}));m.collection("users").doc(t.data().uid).update({addedPlaylists:n})}))})),m.collection("users").where("ownPlaylists","array-contains",e).get().then((function(t){t.docs.forEach((function(t){var n=t.data().addedPlaylists.filter((function(t){return t!==e}));m.collection("users").doc(t.data().uid).update({ownPlaylists:n})}))})),m.collection("search").doc(e).delete().then((function(){m.collection("playlists").doc(e).delete()})),x(),y("Playlist ".concat(t.name," was deleted"))}))},children:[Object(v.jsx)(Je,{text:"delete playlist",direction:"bottom"}),Object(v.jsx)(je.D,{})]}):c.ownPlaylists.includes(t.id)?Object(v.jsxs)("button",{onClick:function(){return g("Are you sure you want to quit this playlist?","Yes, pretty sure","No, I Don't!",(function(){!function(e,t){m.collection("users").doc(t.uid).update({ownPlaylists:t.ownPlaylists.filter((function(t){return t!==e.id}))}),m.collection("playlists").doc(e.id).update({authors:e.authors.filter((function(e){return e.uid!==t.uid}))})}(t,c),x(),y("You left ".concat(t.name))}))},children:[Object(v.jsx)(Je,{text:"quit playlist",direction:"bottom"}),Object(v.jsx)(de.e,{})]}):c.addedPlaylists.includes(t.id)?Object(v.jsxs)("button",{onClick:function(){return g("Are you sure you want to remove this playlist from library?","Yes, pretty sure","No-no-no, go away",(function(){Bt(t,c),x(),y("Playlist was removed from library")}))},children:[Object(v.jsx)(Je,{text:"remove playlist from library",direction:"bottom"}),Object(v.jsx)($e.a,{})]}):Object(v.jsxs)("button",{onClick:function(){Dt(t,c),y("Playlist ".concat(t.name," was added to library"))},children:[Object(v.jsx)(Je,{text:"add playlist",direction:"bottom"}),Object(v.jsx)(je.z,{})]}):c.addedAuthors.includes(t.uid)?Object(v.jsxs)("button",{onClick:function(){g("If you unsubscribe from this author, all his tracks will be removed from your library. Are you sure you want to do this?","Yes","No",(function(){Jt(t,c,l),y("You unsubscribed from ".concat(t.displayName)),x()}))},children:[Object(v.jsx)(Je,{text:"delete author from library",direction:"bottom"}),Object(v.jsx)($e.a,{})]}):c.uid===t.uid?Object(v.jsx)(i.b,{to:"/settings",children:Object(v.jsxs)("button",{children:[Object(v.jsx)(Je,{text:"settings",direction:"bottom"}),Object(v.jsx)(je.B,{})]})}):!t.isAuthor&&c.friends.find((function(e){return e.uid===t.uid&&"added"===e.status}))?Object(v.jsxs)("button",{onClick:function(){return g("Are you sure you want to unfriend ".concat(t.displayName,"?"),"Yes, pretty sure","No-no-no, go away",(function(){!function(e,t){var n=e.friends.filter((function(e){return e.uid!==t.uid})),s=t.friends.filter((function(t){return t.uid!==e.uid}));m.collection("users").doc(e.uid).update({friends:n}),m.collection("users").doc(t.uid).update({friends:s})}(c,t),x(),y("".concat(t.displayName," was unfriended"))}))},children:[Object(v.jsx)(Je,{text:"remove from friend list",direction:"bottom"}),Object(v.jsx)(je.F,{})]}):!t.isAuthor&&c.friends.find((function(e){return e.uid===t.uid&&"awaiting"===e.status}))?Object(v.jsxs)("button",{onClick:Xt,children:[Object(v.jsx)(Je,{text:"waiting for response",direction:"bottom"}),Object(v.jsx)(de.l,{style:{animation:"loading 1s infinite linear"}})]}):t.isAuthor?Object(v.jsxs)("button",{onClick:function(){Gt(t,c),y("".concat(t.displayName," was added to your library"))},children:[Object(v.jsx)(Je,{text:"subscribe",direction:"bottom"}),Object(v.jsx)(je.z,{})]}):Object(v.jsxs)("button",{onClick:function(){Xt(t,c),y("Friend request was sent to ".concat(t.displayName))},children:[Object(v.jsx)(Je,{text:"add friend",direction:"bottom"}),Object(v.jsx)(je.G,{})]})}),Object(v.jsxs)("div",{className:"headerMoreBtn",ref:w,children:[Object(v.jsxs)("button",{onClick:o?function(){O(),p(Object(v.jsx)(_t,{data:t}))}:function(){return h(!b)},children:[Object(v.jsx)(Je,{text:"more",direction:"bottom"}),Object(v.jsx)(je.v,{})]}),b?Object(v.jsxs)("div",{className:"songItemMenuWindow",style:{top:"110%",bottom:"auto"},onClick:function(e){return e.stopPropagation()},children:[t.authors&&t.authors.find((function(e){return e.uid===c.uid}))||t.authors&&c.isAdmin?Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){O(),p(Object(v.jsx)(Qt,{playlist:t}))},children:[Object(v.jsx)(je.l,{}),"Edit"]}):t.uid!==c.uid||t.isAuthor?null:Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){O(),p(Object(v.jsx)($t,{author:t}))},children:[Object(v.jsx)(je.l,{}),"Edit"]}),Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){O(),p(Object(v.jsx)(it,{item:t,whatToShare:void 0!==t.authors?"playlist":"author"}))},children:[Object(v.jsx)(je.C,{}),"Share"]}),Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){O(),p(void 0!==t.authors?Object(v.jsx)(Ut,{album:t}):Object(v.jsx)(Kt,{author:t}))},children:[Object(v.jsx)(je.q,{}),"Info"]})]}):null]})]}),c.uid===t.uid?Object(v.jsxs)("button",{onClick:function(){return g("Are you sure you want to quit?","Yes, pretty sure","No, I Don't!",(function(){r(),x()}))},children:[Object(v.jsx)(Je,{text:"quit",direction:"bottom"}),Object(v.jsx)(V.c,{})]}):null]})},en=function(e){var t,n,s=e.data,a=e.headerColors,c=le().displayAuthors,r=At(s),i=Object(j.a)(r,2),o=i[0],l=i[1],u=S().currentUser.friends.find((function(e){return e.uid===s.uid&&"added"===e.status}));return Object(v.jsxs)("div",{className:"Header",style:a.length?{background:"linear-gradient(45deg, ".concat(a[2],", ").concat(a[0],")")}:{background:"var(--yellowAndPinkGrad)"},children:[Object(v.jsx)(Zt,{data:s,headerColors:a}),Object(v.jsx)("div",{className:"headerAuthorsImage",style:void 0===s.authors?{animation:"floatingBorderRadius 10s infinite ease-in-out",backgroundImage:"url(".concat(s.photoURL,")"),position:"relative"}:{backgroundImage:"url(".concat(s.image,")"),position:"relative",backgroundColor:"var(--red)"},children:void 0===s.authors||s.image?null:Object(v.jsx)(de.a,{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",width:"60px",height:"60px"}})}),Object(v.jsxs)("div",{className:"headerAuthorInfo",children:[Object(v.jsxs)("div",{className:"headerAuthorsName",children:[void 0!==s.authors?s.isAlbum?Object(v.jsx)("h5",{children:"Album"}):Object(v.jsx)("h5",{children:"Playlist"}):s.isAuthor?Object(v.jsx)("h5",{children:"Author"}):Object(v.jsxs)("h5",{children:["User"," ",void 0===s.authors&&u?Object(v.jsx)(X,{userUID:s.uid}):null]}),Object(v.jsxs)("div",{style:{display:"flex",alignItems:"center",margin:"2px 0 10px 0"},children:[Object(v.jsx)(v.Fragment,{children:Object(v.jsx)("h1",{children:s.displayName||s.name})}),s.isVerified?Object(v.jsx)(ge.b,{style:{color:a[0]}}):null,s.isPrivate?Object(v.jsx)($e.b,{}):null,!!s.displayName&&u&&Object(v.jsx)(Rt,{data:s,loading:!1})]})]}),void 0!==s.authors?Object(v.jsxs)("div",{className:"headerAuthorsImagesAndNames",children:[Object(v.jsx)(Pt,{imagesList:l,borderColor:a[2]}),Object(v.jsx)("div",{className:"headerAuthors",children:c(o,", ")})]}):null,Object(v.jsxs)("div",{className:"headerListenersAndSubs",children:[Object(v.jsxs)("div",{className:"headerListenersAndSubsItem",children:[Object(v.jsx)(Je,{text:(null!==(t=s.listens)&&void 0!==t?t:s.numberOfListenersPerMonth)+" listens",style:{fontSize:"0.8em"}}),Object(v.jsx)("span",{children:Ot(null!==(n=s.listens)&&void 0!==n?n:s.numberOfListenersPerMonth)}),Object(v.jsx)(je.n,{})]}),Object(v.jsxs)("div",{className:"headerListenersAndSubsItem",children:[Object(v.jsx)(Je,{text:s.subscribers+" subscribers",style:{fontSize:"0.8em"}}),Object(v.jsx)("span",{children:Ot(s.subscribers)}),Object(v.jsx)(je.G,{})]}),void 0!==s.creationDate?Object(v.jsxs)("div",{className:"headerListenersAndSubsItem",children:[Object(v.jsx)(Je,{text:"creation date",style:{fontSize:"0.8em"}}),Object(v.jsx)("span",{children:Q(s.creationDate)})]}):null]}),u?Object(v.jsx)(Lt,{data:s,color:a[3]}):null]})]})},tn=function(e){var t=e.children,n=Object(F.a)(e,["children"]);return Object(v.jsx)("div",Object(B.a)(Object(B.a)({className:"content-container"},n),{},{children:t}))},nn=function(){var e=Object(o.h)("/albums/:albumId"),t=Object(s.useState)([]),n=Object(j.a)(t,2),a=n[0],c=n[1],r=Object(s.useState)([]),i=Object(j.a)(r,2),l=i[0],b=i[1],h=e.params.albumId,f=Object(s.useState)([]),O=Object(j.a)(f,2),p=O[0],g=O[1],x=Object(s.useState)(!0),y=Object(j.a)(x,2),S=y[0],w=y[1],C=Object(o.g)();function N(){return(N=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:m.collection("playlists").doc(h).onSnapshot((function(e){e.exists?(g(e.data()),b(e.data().imageColors)):C.push("/not-found")}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){!function(){N.apply(this,arguments)}()}),[h,m]),Object(s.useEffect)((function(){!function(){var e;(null===(e=p.songs)||void 0===e?void 0:e.length)?se(p.songs,"songs",c,(function(e){return e}),(function(){return w(!1)})):w(!1)}()}),[p]),Object(v.jsx)("div",{className:"AlbumPage",style:{animation:"zoomIn .2s forwards"},children:S?Object(v.jsx)(M,{top:"50%"}):Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(en,{data:p,headerColors:l,setHeaderColors:b}),Object(v.jsxs)(tn,{style:{display:"flex",flexDirection:"column",minHeight:"100%",borderRadius:"25px 25px 0 0",flex:"1 1 auto",position:"relative",overflow:"hidden",boxShadow:"0px 0px 100px #060606"},children:[Object(v.jsx)("div",{className:"content-background",style:{background:"linear-gradient(360deg, black, ".concat(l[0],")")}}),Object(v.jsx)(It,{listOfSongs:a,source:{source:"/albums/".concat(p.id),name:p.name,image:p.image,songsList:a},showSearch:!0,defaultSearchMode:"songs",displayIfEmpty:"No songs"})]})]})})},sn=function(e){var t=e.person,n=e.addFriend,s=e.rejectFriend;return Object(v.jsxs)("div",{className:"FriendRequestItem",children:[Object(v.jsx)(i.b,{to:"/authors/".concat(t.uid),children:Object(v.jsxs)("div",{className:"friendRequestImageAndName",children:[Object(v.jsx)("div",{className:"requestImage",children:Object(v.jsx)("img",{loading:"lazy",src:t.photoURL,alt:""})}),Object(v.jsx)("h3",{children:t.displayName})]})}),Object(v.jsxs)("div",{className:"requestButtons",children:[Object(v.jsxs)("button",{style:{color:"var(--green)"},onClick:function(){return n(t.uid)},children:[Object(v.jsx)(je.d,{}),Object(v.jsx)("span",{children:"Add"})]}),Object(v.jsxs)("button",{style:{color:"var( --lightRed)"},onClick:function(){return s(t.uid)},children:[Object(v.jsx)(je.I,{}),Object(v.jsx)("span",{children:"Reject"})]})]})]})},an=function(){var e=S().currentUser,t=Object(s.useState)([]),n=Object(j.a)(t,2),a=n[0],c=n[1];return Object(s.useEffect)((function(){!function(){var t=[];e.friends.forEach(function(){var n=Object(d.a)(u.a.mark((function n(s,a){var r;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("requested"!==s.status){n.next=6;break}return n.next=3,m.collection("users").doc(s.uid).get();case 3:r=n.sent.data(),t.push(r),a===e.friends.length-1&&c(t);case 6:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())}()}),[JSON.stringify(e.friends)]),[a,function(t){var n=e.friends,s=a.find((function(e){return e.uid===t})).friends;n.find((function(e){return e.uid===t})).status="added",s.find((function(t){return t.uid===e.uid})).status="added",m.collection("users").doc(e.uid).update({friends:n}),m.collection("users").doc(t).update({friends:s}),c((function(e){return e.filter((function(e){return e.uid!==t}))}))},function(t){var n=e.friends.filter((function(e){return e.uid!==t}));m.collection("users").doc(t).get().then((function(s){var a=s.data().friends.filter((function(t){return t.uid!==e.uid}));m.collection("users").doc(e.uid).update({friends:n}),m.collection("users").doc(t).update({friends:a}),c((function(e){return e.filter((function(e){return e.uid!==t}))}))}))}]},cn=function(){var e=an(),t=Object(j.a)(e,3),n=t[0],s=t[1],a=t[2];return Object(v.jsx)(v.Fragment,{children:n.map((function(e,t){return Object(v.jsx)(sn,{person:e,addFriend:s,rejectFriend:a},t)}))})};function rn(e){var t=new Date(e.releaseDate);return(new Date).getTime()-t.getTime()<18144e5}var on=function(e){e.authorId;var t=e.authorsData,n=(e.headerColors,Object(s.useState)([])),a=Object(j.a)(n,2),c=a[0],r=a[1],i=Object(s.useState)([]),o=Object(j.a)(i,2),l=o[0],b=o[1];function h(){return(h=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.isAuthor?se(t.ownSongs,"songs",r,(function(e){return e.forEach((function(e){rn(e)&&!l.includes(e)&&b((function(t){return[].concat(Object(W.a)(t),[e])}))})),e.sort((function(e,t){return t.listens-e.listens}))})):se(t.addedSongs.slice(0).reverse(),"songs",r);case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){!function(){h.apply(this,arguments)}(),b([])}),[t.ownSongs]),t.isAuthor?Object(v.jsxs)("div",{className:"TopSongs",children:[Object(v.jsx)(It,{listOfSongs:l,source:{source:"/authors/".concat(t.uid),name:t.displayName,image:t.photoURL,songsList:l},isNewSong:!0}),Object(v.jsx)(It,{listOfSongs:c,source:{source:"/authors/".concat(t.uid),name:t.displayName,image:t.photoURL,songsList:c},title:"Popular Songs",showListens:!0,showCount:!0,isHorizontal:!0})]}):Object(v.jsx)(It,{listOfSongs:c,source:{source:"/authors/".concat(t.uid),name:t.displayName+"'s Library",image:t.photoURL,songsList:c},title:t.displayName+"'s Library",showListens:!0,showCount:!0,isHorizontal:!0})},ln=function(){var e=Object(d.a)(u.a.mark((function e(t,n,s,a){var c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n([]),c=[],void 0!==t.ownPlaylists&&0!==t.ownPlaylists.length&&t.ownPlaylists.forEach(function(){var e=Object(d.a)(u.a.mark((function e(r,i){var o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("playlists").doc(r).get();case 2:(o=e.sent.data())&&(!o.isPrivate||t.uid===s&&o.isPrivate)&&c.push(o),i===t.ownPlaylists.length-1&&(c.sort((function(e,t){return new Date(t.creationDate).getTime()-new Date(e.creationDate).getTime()})),a(!1),n(c));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e)})));return function(t,n,s,a){return e.apply(this,arguments)}}(),un=n(34),dn=function(){return Object(v.jsxs)("div",{style:{textDecoration:"none"},className:"playlistWrapper",children:[Object(v.jsx)("div",{className:"playlistItem",style:{background:"var(--playlistsColor)",display:"flex",justifyContent:"center",alignItems:"center"},children:Object(v.jsx)("img",{loading:"lazy",src:E,alt:"",style:{width:"70px",height:"70px",filter:"grayscale(80%)"}})}),Object(v.jsx)("h4",{style:{display:"flex",alignItems:"center",margin:"5px 0"},children:"Playlist was deleted"})]})},jn=function(e,t,n){var a=le(),c=a.currentSongPlaylistSource,r=a.playSong,i=a.setCurrentSongQueue,o=a.setCurrentSong,l=a.setPlay,j=a.songRef,b=a.setCurrentSongInQueue,h=a.setCurrentSongPlaylistSource,f=S().currentUser;return Object(s.useEffect)((function(){if(t.length){var n={source:"/albums/".concat(e.id),name:e.name,image:e.image,songsList:t},s=t.map((function(e){return e.id}));i(t),b(0),o(t[0].id),j.current.play(),l(!0),h(n),m.collection("users").doc(f.uid).update({lastSongPlayed:t[0].id,lastQueue:{image:n.image,name:n.name,songsList:s,source:n.source}}),Ye(e,f)}}),[t.length]),function(t){t.preventDefault(),c.name!==e.name?(n([]),0!==e.length&&e.songs.map(function(){var e=Object(d.a)(u.a.mark((function e(t){var s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("songs").doc(t).get();case 2:s=e.sent.data(),n((function(e){return[].concat(Object(W.a)(e),[s])}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())):r()}},bn=Object(s.memo)((function(e){var t=e.playlist,n=void 0===t?null:t,a=e.listOfChosenAlbums,c=e.setListOfChosenAlbums,r=e.shouldSaveSearchHistory,o=new Date(null===n||void 0===n?void 0:n.creationDate),l=Ge().isMobile,u=S().currentUser,d=le(),b=d.currentSongPlaylistSource,h=d.play,f=Object(s.useState)([]),O=Object(j.a)(f,2),p=O[0],m=O[1],g=jn(n,p,m);return null!==n?Object(v.jsxs)(i.b,{to:"/albums/".concat(n.id),style:{textDecoration:"none"},className:"playlistWrapper",onClick:function(){r&&ut(u.uid,n.id,"playlists")},children:[Object(v.jsx)(z,{listOfChosenItems:a,setListOfChosenItems:c,itemId:n.id}),Object(v.jsxs)("div",{className:"playlistItem",style:n.image?{background:n.imageColors[0]}:{background:"var(--yellowAndPinkGrad)"},children:[Object(v.jsx)("img",{src:n.image,alt:"",loading:"lazy"}),!n.image&&Object(v.jsx)(de.a,{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",width:"60px",height:"60px"}}),l?null:Object(v.jsx)("button",{onClick:g,children:b.name===n.name&&h?Object(v.jsx)(un.b,{}):Object(v.jsx)(un.c,{})})]}),Object(v.jsxs)("h4",{style:{display:"flex",alignItems:"center",margin:"5px 0"},children:[ht(n.name,l?10:15),Object(v.jsx)("span",{style:{fontSize:".6em",opacity:.6,fontWeight:"500",marginLeft:"7px"},children:n.isAlbum?1===n.songs.length?"single":"album":"playlist"})]}),Object(v.jsx)("h5",{style:{margin:"5px 0"},children:o.getFullYear()})]}):Object(v.jsx)(dn,{})})),hn=function(e){var t=e.listOfAlbums,n=e.title,a=void 0===n?"":n,c=e.loading,r=void 0===c||c,i=e.listOfChosenAlbums,o=e.setListOfChosenAlbums,l=e.saveSearchHistory,u=Object(s.useState)(0),d=Object(j.a)(u,2),b=d[0],h=d[1],f=Object(s.useRef)(null),O=Object(s.useState)(!1),p=Object(j.a)(O,2),m=p[0],g=p[1];return Object(s.useEffect)((function(){t.length>0&&!r&&(f.current.scrollWidth>f.current.offsetWidth&&g(!0))}),[t]),t.length>0?r?Object(v.jsx)(M,{}):Object(v.jsxs)("div",{className:"AuthorsList",children:[0!==a.length?Object(v.jsx)("h2",{children:a}):null,Object(v.jsx)("div",{className:"authorsWrapper",ref:f,onScroll:function(e){return h(e.target.scrollLeft)},children:t.map((function(e,t){return Object(v.jsx)(bn,{playlist:e,listOfChosenAlbums:i,setListOfChosenAlbums:o,shouldSaveSearchHistory:l},t)}))}),Object(v.jsxs)("div",{className:"authorsShiftButtons",children:[Object(v.jsx)("button",{onClick:function(){var e=f.current.scrollLeft;f.current.scrollLeft=e-220,h(e-220)},style:b<=0?{visibility:"hidden",opacity:"0"}:{},children:Object(v.jsx)(je.f,{})}),Object(v.jsx)("button",{onClick:function(){var e=f.current.scrollLeft;f.current.scrollLeft=e+220,h(e+220)},style:m&&f.current&&f.current.scrollWidth-f.current.offsetWidth!==b?{}:{visibility:"hidden",opacity:"0"},children:Object(v.jsx)(je.g,{})})]})]}):null},fn=function(e){var t=e.authorsData,n=S().currentUser,a=Object(s.useState)([]),c=Object(j.a)(a,2),r=c[0],i=c[1],o=Object(s.useState)(!0),l=Object(j.a)(o,2),u=l[0],d=l[1];return Object(s.useEffect)((function(){ln(t,i,n.uid,d)}),[t.ownPlaylists]),Object(v.jsx)(hn,{listOfAlbums:r,title:n.isAuthor?"Albums":"Playlists",loading:u})};function On(e,t,n){var s=[];e.forEach((function(e){var t=e.authors;0!==t.length&&s.push(t)})),s=s.flat();for(var a=new Set(s.map((function(e){return e.uid})).filter((function(e){return e!==t.uid}))),c=Array.from(a),r=[],i=0;i<c.length;i++)for(var o=0;o<s.length;o++)if(c[i]===s[o].uid){r.push(s[o]);break}return n(r),r}function pn(e,t){return mn.apply(this,arguments)}function mn(){return(mn=Object(d.a)(u.a.mark((function e(t,n){var s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0!==t&&void 0!==t.ownSongs&&0!==t.ownSongs.length&&(s=[],t.ownSongs.forEach(function(){var e=Object(d.a)(u.a.mark((function e(a,c){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("songs").doc(a).get();case 2:if(r=e.sent.data(),s.push(r),c!==t.ownSongs.length-1){e.next=6;break}return e.abrupt("return",On(s,t,n));case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var gn=function(e){var t=e.data,n=e.listOfChosenAuthors,s=e.setListOfChosenAuthors,a=e.shouldSaveSearchHistory,c=void 0!==a&&a,r=S().currentUser;return Object(v.jsxs)(i.b,{to:"/authors/".concat(t.uid),className:"AuthorItemBig",onClick:function(){c&&ut(r.uid,t.uid,"users")},children:[Object(v.jsx)(z,{listOfChosenItems:n,setListOfChosenItems:s,itemId:t.uid}),Object(v.jsxs)("div",{children:[Object(v.jsx)("div",{className:"AuthorItemBigImage",style:{background:t.imageColors&&t.imageColors[0]},children:Object(v.jsx)("img",{src:t.photoURL,alt:"",loading:"lazy"})}),Object(v.jsx)("h3",{children:t.displayName})]})]})},xn=function(e){var t=e.listOfAuthors,n=e.title,a=void 0===n?"":n,c=e.listOfChosenAuthors,r=e.setListOfChosenAuthors,i=e.saveSearchHistory,o=Object(s.useState)(0),l=Object(j.a)(o,2),u=l[0],d=l[1],b=Object(s.useRef)(null),h=Object(s.useState)(!1),f=Object(j.a)(h,2),O=f[0],p=f[1];return Object(s.useEffect)((function(){t.length>0&&(b.current.scrollWidth>b.current.offsetWidth&&p(!0))}),[t]),t.length>0?Object(v.jsxs)("div",{className:"AuthorsList",children:[0!==a.length?Object(v.jsx)("h2",{children:a}):null,Object(v.jsx)("div",{className:"authorsWrapper",ref:b,onScroll:function(e){return d(e.target.scrollLeft)},children:t.map((function(e){return Object(v.jsx)(gn,{data:e,listOfChosenAuthors:c,setListOfChosenAuthors:r,shouldSaveSearchHistory:i},e.uid)}))}),Object(v.jsxs)("div",{className:"authorsShiftButtons",children:[Object(v.jsx)("button",{onClick:function(){var e=b.current.scrollLeft;b.current.scrollLeft=e-200,d(e-200)},style:u<=0?{visibility:"hidden",opacity:"0"}:{},children:Object(v.jsx)(je.f,{})}),Object(v.jsx)("button",{onClick:function(){var e=b.current.scrollLeft;b.current.scrollLeft=e+200,d(e+200)},style:O&&null!==b.current&&b.current.scrollWidth-b.current.offsetWidth!==u?{}:{visibility:"hidden",opacity:"0"},children:Object(v.jsx)(je.g,{})})]})]}):null},vn=function(e){var t=e.data,n=Object(s.useState)([]),a=Object(j.a)(n,2),c=a[0],r=a[1];return Object(s.useEffect)((function(){pn(t,r)}),[t]),Object(v.jsx)(xn,{listOfAuthors:c,title:"Similar Authors"})},yn=function(e){var t=e.loading;return Object(v.jsx)("div",{className:"FullScreenLoading",style:t?{}:{opacity:"0",visibility:"hidden"},children:Object(v.jsx)("img",{loading:"lazy",src:"https://icon-library.com/images/spinner-icon-gif/spinner-icon-gif-28.jpg",alt:""})})},Sn=function(){var e=S().currentUser,t=Object(s.useState)(""),n=Object(j.a)(t,2),a=n[0],c=n[1],r=Object(s.useState)(""),i=Object(j.a)(r,2),o=i[0],l=i[1],b=Object(s.useState)(""),h=Object(j.a)(b,2),f=h[0],O=h[1],p=Object(s.useState)([]),g=Object(j.a)(p,2),v=g[0],y=g[1],w=Object(s.useState)(e.isAdmin?[]:[{uid:e.uid,photoURL:e.photoURL,displayName:e.displayName}]),C=Object(j.a)(w,2),N=C[0],k=C[1],I=Object(s.useState)(e.isAdmin?"":(new Date).toString()),A=Object(j.a)(I,2),P=A[0],L=A[1],M=Object(s.useState)(""),T=Object(j.a)(M,2),E=T[0],R=T[1],D=Object(s.useState)([]),B=Object(j.a)(D,2),F=B[0],U=B[1],V=Object(s.useState)([]),z=Object(j.a)(V,2),H=z[0],Y=z[1],q=Object(s.useState)(0),Q=Object(j.a)(q,2),G=Q[0],X=Q[1],J=Object(s.useState)(0),K=Object(j.a)(J,2),_=K[0],$=K[1],Z=Object(s.useState)(""),ee=Object(j.a)(Z,2),te=ee[0],ne=ee[1],se=Object(s.useState)([]),ae=Object(j.a)(se,2),ce=ae[0],re=ae[1],ie=Object(s.useState)(""),oe=Object(j.a)(ie,2),le=oe[0],ue=oe[1],de=Object(s.useState)(!1),je=Object(j.a)(de,2),be=je[0],he=je[1],fe=Object(s.useState)(!1),Oe=Object(j.a)(fe,2),pe=Oe[0],me=Oe[1];function ge(e){var t=N.filter((function(t){return t.uid!==e.uid}));return k(t)}function xe(){return(xe=Object(d.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),n=nt(),0===a.length?ue("Playlist has to have some name"):0===N.length?ue("Playlist has to have at least 1 author"):0===P.length?ue("You have to set release date for a playlist"):(he(!0),m.collection("playlists").doc(n).set({id:n,name:a,songs:H,authors:N,image:o,listens:0,creationDate:P,subscribers:0,isAlbum:1===G,imageColors:ce,isPrivate:!0===_}).then((function(){y([]),O(""),k([]),l(""),c(""),L(""),R(""),Y([]),$(0),he(!1),me(!0)})).catch((function(e){ue(e),he(!1)})),N.forEach(function(){var e=Object(d.a)(u.a.mark((function e(t){var s,a,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(t.uid).get();case 2:s=e.sent,a=s.data(),(c=a.ownPlaylists).push(n),m.collection("users").doc(t.uid).update({ownPlaylists:c});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),m.collection("search").doc(n).set({place:"playlists",uid:n,rank:0,variantsOfName:x(a)}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return{playlistName:a,setPlaylistName:c,imageLocalPath:te,loadingPlaylist:be,setImageColors:re,authorsInputValue:f,setAuthorsInputValue:O,setAllAuthors:y,chosenAuthors:N,removeAuthorFromList:ge,allAuthors:v,addAuthor:function(e){if(!N.some((function(t){return t.uid===e.uid})))return k((function(t){return[].concat(Object(W.a)(t),[{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL}])}));ge(e)},songsSearch:E,setSongsSearch:R,setAllSongs:U,setPlaylistStatus:X,removeSongFromList:function(e){var t=H.filter((function(t){return t!==e}));return Y(t)},chosenSongs:H,allSongs:F,setChosenSongs:Y,playlistStatus:G,isPlaylistPrivate:_,setIsPlaylistPrivate:$,setPlaylistCover:l,releaseDate:P,setReleaseDate:L,setImageLocalPath:ne,completed:pe,setCompleted:me,addPlaylistToFirebase:function(e){return xe.apply(this,arguments)},setChosenAuthors:k,errorMessage:le,setErrorMessage:ue}},wn=function(e){var t=e.data,n=e.title,a=Object(s.useState)([]),c=Object(j.a)(a,2),r=c[0],i=c[1],o=Object(s.useState)(0),l=Object(j.a)(o,2),b=l[0],h=l[1],f=Object(s.useRef)(null),O=Object(s.useState)(!1),p=Object(j.a)(O,2),g=p[0],x=p[1];return Object(s.useEffect)((function(){r.length>0&&(f.current.scrollWidth>f.current.offsetWidth&&x(!0))}),[r]),Object(s.useEffect)((function(){i([]),i([]),t.friends.forEach(function(){var e=Object(d.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("added"!==t.status){e.next=5;break}return e.next=3,m.collection("users").doc(t.uid).get();case 3:n=e.sent.data(),i((function(e){return[].concat(Object(W.a)(e),[n])}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[t.uid]),r.length>0?Object(v.jsxs)("div",{className:"PersonTinyList",children:[n&&Object(v.jsx)("h2",{children:n}),Object(v.jsxs)("div",{style:{position:"relative"},children:[Object(v.jsx)("div",{className:"personTinyListWrapper",ref:f,onScroll:function(e){return h(e.target.scrollLeft)},children:r.map((function(e,t){return Object(v.jsx)(Ze,{person:e},e.uid)}))}),Object(v.jsxs)("div",{className:"authorsShiftButtons",children:[Object(v.jsx)("button",{onClick:function(){var e=f.current.scrollLeft;f.current.scrollLeft=e-200,h(e-200)},style:b<=0?{visibility:"hidden",opacity:"0"}:{},children:Object(v.jsx)(je.f,{})}),Object(v.jsx)("button",{onClick:function(){var e=f.current.scrollLeft;f.current.scrollLeft=e+200,h(e+200)},style:g&&f.current&&f.current.scrollWidth-f.current.offsetWidth!==b?{}:{visibility:"hidden",opacity:"0"},children:Object(v.jsx)(je.g,{})})]})]})]}):null},Cn=function(){var e=S().currentUser,t=le().yourFriends,n=Sn(),s=n.playlistName,a=n.setPlaylistName,c=n.imageLocalPath,r=n.loadingPlaylist,i=n.setImageColors,o=n.authorsInputValue,l=n.setAuthorsInputValue,u=n.setAllAuthors,d=n.chosenAuthors,j=n.removeAuthorFromList,b=n.allAuthors,h=n.addAuthor,f=n.songsSearch,O=n.setSongsSearch,p=n.setAllSongs,m=n.setPlaylistStatus,g=n.removeSongFromList,x=n.chosenSongs,y=n.allSongs,w=n.setChosenSongs,C=n.playlistStatus,N=n.isPlaylistPrivate,k=n.setIsPlaylistPrivate,I=n.setPlaylistCover,A=n.releaseDate,P=n.setReleaseDate,L=n.setImageLocalPath,M=n.completed,T=n.setCompleted,E=n.addPlaylistToFirebase,R=(n.setChosenAuthors,n.errorMessage),D=n.setErrorMessage;return Object(v.jsxs)("div",{className:"AddSong",children:[Object(v.jsx)(yn,{loading:r}),Object(v.jsx)(Wt.a,{src:c,getColors:function(e){return i(e)}}),Object(v.jsxs)("div",{children:[Object(v.jsx)(me,{title:"Playlist name",value:s,setValue:a,placeholder:"Enter playlist name"}),Object(v.jsxs)("label",{children:[Object(v.jsx)("h3",{children:"Playlist authors"}),Object(v.jsx)(De,{value:o,setValue:l,setResultAuthorList:u,defaultSearchMode:"users",defaultAuthorsListValue:t,inputText:"Search for authors"}),Object(v.jsx)("div",{className:"chosenAuthorsList",children:d.map((function(t){return Object(v.jsxs)("div",{className:"chosenAuthorItem",children:[Object(v.jsx)("span",{children:t.displayName}),Object(v.jsx)(je.J,{onClick:function(){return t.uid===e.uid?null:j(t)}})]})}))}),Object(v.jsx)("div",{className:"authorsResult",children:b.map((function(e,t){return Object(v.jsx)(K,{data:e,onClick:function(){return h(e)},style:d.includes(e.uid)?{background:"var(--green)"}:{}},t)}))})]}),Object(v.jsx)("h3",{children:"Search for songs"}),Object(v.jsx)(De,{value:f,setValue:O,setAllFoundSongs:p,defaultSearchMode:"songs",inputText:"Search for songs"}),Object(v.jsx)("div",{className:"chosenAuthorsList",children:x.map((function(e){var t=y.find((function(t){return t.id===e})).name;return Object(v.jsxs)("div",{className:"chosenAuthorItem",children:[Object(v.jsx)("span",{children:t}),Object(v.jsx)(je.J,{onClick:function(){return g(e)}})]})}))}),Object(v.jsx)("div",{className:"authorsResult",children:y.map((function(e,t){return Object(v.jsx)(Ct,{song:e,localIndex:t,listOfChosenSongs:x,setListOfSongs:w})}))}),e.isAdmin||e.isAuthor?Object(v.jsxs)("div",{style:{display:"flex",justifyContent:"flex-start",margin:"15px 0"},children:[Object(v.jsx)(Yt,{label:"Playlist",onClick:function(){return m(0)},currentActive:C,id:0}),Object(v.jsx)(Yt,{label:"Album",onClick:function(){return m(1)},currentActive:C,id:1})]}):null,Object(v.jsxs)("div",{style:{display:"flex",justifyContent:"flex-start",margin:"15px 0"},children:[Object(v.jsx)(Yt,{label:"Not Private",onClick:function(){return k(0)},currentActive:N,id:0}),Object(v.jsx)(Yt,{label:"Private",onClick:function(){return k(1)},currentActive:N,id:1})]}),(e.isAdmin||e.isAuthor)&&Object(v.jsx)(me,{title:"Release Date",type:"date",value:A,setValue:P,placeholder:"Enter release date"}),Object(v.jsx)(Ht,{text:"Download playlist cover",place:"songsImages/",setItemSrc:I,setImageLocalPath:L}),Object(v.jsx)(ve,{text:"Add playlists",action:E,isLoading:r,completed:M,setCompleted:T,bottomMessage:"Playlist was uploaded to database",errorMessage:R,setErrorMessage:D})]})]})},Nn=function(){re().openBottomMessage;var e=S().currentUser,t=Object(s.useState)(""),n=Object(j.a)(t,2),a=n[0],c=n[1],r=Object(s.useState)(""),i=Object(j.a)(r,2),o=i[0],l=i[1],b=Object(s.useState)(""),h=Object(j.a)(b,2),f=h[0],O=h[1],p=Object(s.useState)(""),g=Object(j.a)(p,2),y=g[0],w=g[1],C=Object(s.useState)([]),N=Object(j.a)(C,2),k=N[0],I=N[1],A=Object(s.useState)(e.isAdmin?[]:[{uid:e.uid,photoURL:e.photoURL,displayName:e.displayName}]),P=Object(j.a)(A,2),L=P[0],M=P[1],T=Object(s.useState)(""),E=Object(j.a)(T,2),R=E[0],D=E[1],B=Object(s.useState)(""),F=Object(j.a)(B,2),U=F[0],V=F[1],z=Object(s.useState)(""),H=Object(j.a)(z,2),Y=H[0],q=H[1],Q=Object(s.useState)([]),G=Object(j.a)(Q,2),X=G[0],J=G[1],_=Object(s.useState)(!1),$=Object(j.a)(_,2),Z=($[0],$[1],Object(s.useState)("")),ee=Object(j.a)(Z,2),te=ee[0],ne=ee[1],se=Object(s.useState)(!1),ae=Object(j.a)(se,2),ce=ae[0],ie=ae[1],oe=Object(s.useState)(!1),le=Object(j.a)(oe,2),ue=le[0],de=le[1];function be(e){var t=L.filter((function(t){return t.uid!==e.uid}));return M(t)}function he(){return(he=Object(d.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),n=nt(),ne(""),0===a.length?ne("Song has to have some name"):0===L.length?ne("Song has to have at least 1 author"):0===R.length?ne("You have to set release date for a song"):0===o.length?ne("You didn't load song cover"):0===f.length?ne("You didn't load song file"):(de(!0),m.collection("songs").doc(n).set({id:n,name:a,songSrc:f,authors:L,cover:o,listens:0,releaseDate:R,lyrics:Be(U),imageColors:X}).then((function(){I([]),w(""),M([]),V([]),l(""),c(""),O(""),D(""),V([]),ie(!0),J([]),de(!1)})).catch((function(e){ne(e),de(!1)})),L.forEach(function(){var e=Object(d.a)(u.a.mark((function e(t){var s,a,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(t.uid).get();case 2:s=e.sent,a=s.data(),(c=a.ownSongs).push(n),m.collection("users").doc(t.uid).update({ownSongs:c});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),m.collection("search").doc(n).set({place:"songs",uid:n,rank:0,variantsOfName:x(a)}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(v.jsxs)("div",{className:"AddSong",children:[Object(v.jsx)(yn,{loading:ue}),Object(v.jsx)(Wt.a,{src:Y,getColors:function(e){return J(e)}}),Object(v.jsxs)("div",{children:[Object(v.jsx)(me,{title:"Song name",value:a,setValue:c,placeholder:"Enter song name"}),Object(v.jsxs)("label",{children:[Object(v.jsx)("h3",{children:"Song authors"}),Object(v.jsx)(De,{value:y,setValue:w,setResultAuthorList:I,defaultSearchMode:"users",inputText:"Search for authors"}),Object(v.jsx)("div",{className:"chosenAuthorsList",children:L.map((function(t){return Object(v.jsxs)("div",{className:"chosenAuthorItem",children:[Object(v.jsx)("span",{children:t.displayName}),Object(v.jsx)(je.J,{onClick:function(){(e.isAdmin||t.uid!==e.uid)&&be(t)}})]})}))}),Object(v.jsx)("div",{className:"authorsResult",children:k.map((function(e,t){return Object(v.jsx)(K,{data:e,onClick:function(){return function(e){if(!L.some((function(t){return t.uid===e.uid})))return M((function(t){return[].concat(Object(W.a)(t),[{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL}])}));be(e)}(e)},style:L.includes(e.uid)?{background:"var(--green)"}:{}},t)}))})]}),Object(v.jsx)(me,{title:"Release Date",type:"date",value:R,setValue:D,placeholder:"Enter release date"}),Object(v.jsx)("div",{style:{width:"100%",display:"flex"},children:X.map((function(e,t){return Object(v.jsx)("input",{type:"color",value:e,style:{width:"100%",height:"60px",padding:"0",borderRadius:"0px"},onChange:function(e){!function(e,t){X[t]=e.target.value,J(Object(W.a)(X))}(e,t)}})}))}),Object(v.jsx)(Ht,{text:"Download song cover",place:"songsImages/",setItemSrc:l,setImageLocalPath:q}),Object(v.jsx)(Ht,{text:"Download song file",place:"songs/",setItemSrc:O}),Object(v.jsx)("label",{children:Object(v.jsx)("textarea",{name:"",id:"",placeholder:"Add song lyrics",value:U,onChange:function(e){return V(e.target.value)}})}),Object(v.jsx)(ve,{text:"Add song",action:function(e){return he.apply(this,arguments)},isLoading:ue,completed:ce,setCompleted:ie,bottomMessage:"Song was uploaded to database",errorMessage:te,setErrorMessage:ne})]})]})},kn=function(e){var t=e.pages,n=e.currentPage,s=e.setCurrentPage;return Object(v.jsx)("div",{className:"Slider",children:t.map((function(e,t){return Object(v.jsx)("div",{className:"sliderItem "+(t===n?"current":""),onClick:function(){return s(t)},children:e},t)}))})},In=function(e){var t=e.data,n=S().currentUser,a=Object(s.useState)(!1),c=Object(j.a)(a,2),r=c[0],i=c[1],o=Object(s.useState)(0),l=Object(j.a)(o,2),u=l[0],d=l[1],b=[Object(v.jsx)(Nn,{}),Object(v.jsx)(Cn,{})];return(n.isAdmin||t.isAuthor)&&t.uid===n.uid?Object(v.jsxs)("div",{className:"AddSong",children:[Object(v.jsx)("button",{onClick:function(){return i(!r)},style:r?{background:"var(--red)"}:{},className:"openAddSongWindowBtn",children:Object(v.jsx)(je.y,{style:r?{transform:"rotate(45deg)"}:{}})}),Object(v.jsxs)("div",{className:"addSongWindow",style:r?{display:"flex"}:{},children:[Object(v.jsx)(kn,{pages:["Song","Playlist"],currentPage:u,setCurrentPage:d}),b[u]]})]}):null},An=(n(269),function(){var e=Object(o.h)("/authors/:authorId"),t=S().currentUser,n=Object(s.useState)([]),a=Object(j.a)(n,2),c=a[0],r=a[1],i=e.params.authorId,l=Object(s.useState)([]),b=Object(j.a)(l,2),h=b[0],f=b[1],O=Object(s.useState)(!0),p=Object(j.a)(O,2),g=p[0],x=p[1],y=Object(o.g)(),w=re().openBottomMessage;function C(){return(C=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:m.collection("users").doc(i).get().then((function(e){e.exists?(f(e.data()),r(e.data().imageColors),x(!1)):y.push("/not-found")})).catch((function(e){w("Failed to load author's data","failure")}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){!function(){C.apply(this,arguments)}()}),[i]),Object(v.jsx)(v.Fragment,{children:Object(v.jsx)("div",{className:"AuthorPage",style:{animation:"zoomIn .2s forwards"},children:g?Object(v.jsx)(M,{}):Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(en,{data:h,headerColors:c,setHeaderColors:r}),Object(v.jsxs)(tn,{style:{display:"flex",flexDirection:"column",minHeight:"100%",borderRadius:"25px 25px 0 0",flex:"auto",position:"relative",overflow:"hidden",boxShadow:"0px 0px 100px #060606"},children:[Object(v.jsx)("div",{className:"content-background",style:{background:"linear-gradient(360deg, black, ".concat(c[0],")")}}),t.uid===h.uid?Object(v.jsx)(cn,{}):null,Object(v.jsx)(In,{data:h}),Object(v.jsx)(on,{author:i,authorsData:h,headerColors:c}),h.friends&&!h.isAuthor&&Object(v.jsx)(wn,{data:h,title:"Friends"}),Object(v.jsx)(fn,{authorsData:h,headerColors:c}),h.isAuthor?Object(v.jsx)(vn,{data:h}):null]})]})})})}),Pn=(n(270),function(e){var t=e.amountOfUnseen;return 0!==t&&Object(v.jsx)("div",{className:"AmountOfUnseenMessages",children:t})}),Ln=function(e){var t=e.listOfSeen;return Object(v.jsx)("div",{className:"SeenByCircle",style:void 0!==t?t.length<=1?{opacity:"1",visibility:"visible"}:{}:null})},Mn=function(e){var t=e.typingPeople,n=Object(s.useState)([]),a=Object(j.a)(n,2),c=a[0],r=a[1],i=S().currentUser;return Object(s.useEffect)((function(){r([]),t.map(function(){var e=Object(d.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(t).get();case 2:(null===(n=e.sent.data())||void 0===n?void 0:n.uid)!==i.uid&&r((function(e){return[].concat(Object(W.a)(e),[n])}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[t]),c.length>0&&Object(v.jsxs)("div",{className:"typingWrapper",children:[Object(v.jsx)(Pt,{imagesList:c.map((function(e){return null===e||void 0===e?void 0:e.photoURL})),borderColor:"var(--navItemColor)"}),Object(v.jsxs)("div",{className:"TypingAnimation",children:[Object(v.jsx)("span",{className:"typingCircle"}),Object(v.jsx)("span",{className:"typingCircle"}),Object(v.jsx)("span",{className:"typingCircle"})]})]})},Tn=function(e){var t=e.sender,n=e.isGroup,a=e.message,c=e.showUnseenCircle,r=void 0!==c&&c,i=e.messageLen,o=void 0===i?30:i,l=(e.chatId,e.typing),b=void 0!==l&&l,h=S().currentUser,f=Object(s.useState)(""),O=Object(j.a)(f,2),p=O[0],g=O[1],x=Object(s.useState)(!1),y=Object(j.a)(x,2),w=y[0],C=y[1],N=Object(s.useState)(""),k=Object(j.a)(N,2),I=k[0],A=k[1],P=[null,Object(v.jsx)(je.w,{}),Object(v.jsx)(de.a,{}),Object(v.jsx)(je.E,{})],L=Object(s.useState)(0),M=Object(j.a)(L,2),T=M[0],E=M[1];function R(){return(R=Object(d.a)(u.a.mark((function e(){var t,n,s,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(A(""),void 0===a){e.next=23;break}if(t=a,A((function(e){return e+t.message})),C(0!==t.message.length),!t.attachedSongs.length){e.next=11;break}return e.next=8,m.collection("songs").doc(t.attachedSongs[0]).get();case 8:n=e.sent.data().name,E(1),g((function(e){return e+n}));case 11:if(!t.attachedAlbums.length){e.next=17;break}return e.next=14,m.collection("playlists").doc(t.attachedAlbums[0]).get();case 14:(s=e.sent).exists?g((function(e){return e+s.data().name})):g((function(e){return e+"Deleted Album "})),E(2);case 17:if(!t.attachedAuthors.length){e.next=23;break}return e.next=20,m.collection("users").doc(t.attachedAuthors[0]).get();case 20:c=e.sent.data().displayName,E(3),g((function(e){return e+c}));case 23:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){!function(){R.apply(this,arguments)}()}),[a.id]),b?Object(v.jsx)(Mn,{typingPeople:[t.uid]}):Object(v.jsxs)("div",{className:"messageShowOutside",children:[Object(v.jsxs)("span",{style:a.sender===h.uid||t&&n?{marginRight:"5px"}:{},children:[" ","".concat(a.sender===h.uid?"You: ":n&&t?t.displayName+": ":"")]}),ht(I,o),w&&p.length?Object(v.jsx)(un.a,{}):null,P[T],p,r&&Object(v.jsx)(Ln,{listOfSeen:a.seenBy})]})};function En(e,t){return e.reduce((function(e,n){return n.sender===t.uid||void 0===n.seenBy||n.seenBy.includes(t.uid)?e:++e}),0)}var Rn=function(e){var t=Object(s.useState)(!1),n=Object(j.a)(t,2),a=n[0],c=n[1];return Object(s.useEffect)((function(){var t=m.collection("users").doc(e).onSnapshot((function(t){if(void 0!==e){var n=(new Date).getTime()-3e5,s=t.data().online>n;c(s)}}));return function(){t()}}),[e]),a},Dn=function(e){var t=e.userUID;return Rn(t)?Object(v.jsx)("div",{className:"onlineCircle"}):null},Bn=function(e){var t=e.chatData,n=S().currentUser,a=t.chatName,c=t.chatImage,r=t.participants,o=Object(s.useState)({}),l=Object(j.a)(o,2),b=l[0],h=l[1],f=Object(s.useState)(0),O=Object(j.a)(f,2),p=O[0],g=O[1],x=Object(s.useState)(t.messages),y=Object(j.a)(x,2),w=y[0],C=y[1],N=Object(s.useState)(!1),k=Object(j.a)(N,2),I=k[0],A=k[1];function P(){return(P=Object(d.a)(u.a.mark((function e(){var t,s,c,i,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=8;break}return t=r.find((function(e){return e!==n.uid})),e.next=4,m.collection("users").doc(t).get();case 4:s=e.sent.data(),h(s),e.next=13;break;case 8:return i=null===(c=w[w.length-1])||void 0===c?void 0:c.sender,e.next=11,m.collection("users").doc(i).get();case 11:o=e.sent.data(),h(o);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){m.collection("chats").doc(t.id).onSnapshot((function(e){C(e.data().messages),A(!!e.data().typing.length)}))}),[]),Object(s.useEffect)((function(){g(En(w,n))}),[]),Object(s.useEffect)((function(){!function(){P.apply(this,arguments)}()}),[]),t?Object(v.jsx)(i.b,{to:"/chat/".concat(t.id),children:Object(v.jsxs)("div",{className:"ChatItem "+(p>0?"unseen":""),children:[Object(v.jsx)("div",{className:"chatItemImage",children:Object(v.jsx)("img",{loading:"lazy",src:c||b.photoURL,alt:""})}),!a&&Object(v.jsx)(Dn,{userUID:b.uid}),Object(v.jsxs)("div",{style:{width:"100%"},children:[Object(v.jsxs)("h4",{style:{display:"flex",justifyContent:"space-between",width:"100%"},children:[Object(v.jsx)("span",{children:a||b.displayName}),Object(v.jsxs)("div",{children:[w.length?Object(v.jsx)("span",{style:{opacity:".6",fontWeight:"500",fontSize:".8em"},children:Q(w[w.length-1].sentTime,t&&Date.now()-new Date(w[w.length-1].sentTime).getTime()>86e6?0:2)}):null,Object(v.jsx)(Pn,{amountOfUnseen:p})]})]}),w.length?Object(v.jsx)("p",{style:w[w.length-1].sender!==n.uid?{color:"#fff"}:{},children:Object(v.jsx)(Tn,{sender:b,isGroup:a.length,message:w[w.length-1],showUnseenCircle:!0,typing:I})}):null]})]})}):null},Fn=function(){var e=S().currentUser,t=re().toggleModal,n=le().yourFriends,a=Object(s.useState)(""),c=Object(j.a)(a,2),r=c[0],i=c[1],l=Object(s.useState)(n),u=Object(j.a)(l,2),d=u[0],b=u[1],h=Object(s.useState)([]),f=Object(j.a)(h,2),O=f[0],p=f[1],m=Object(s.useState)(""),g=Object(j.a)(m,2),x=g[0],v=g[1],y=Object(s.useState)(""),w=Object(j.a)(y,2),C=w[0],N=w[1],k=Object(s.useState)(""),I=Object(j.a)(k,2),A=I[0],P=I[1],L=nt(),M=Object(o.g)(),T=Object(s.useState)(!1),E=Object(j.a)(T,2),R=E[0],D=E[1],B=Object(s.useState)(0),F=Object(j.a)(B,2),U=F[0],V=F[1],z=Object(s.useState)(!1),H=Object(j.a)(z,2),Y=H[0],q=H[1];Object(s.useEffect)((function(){O.length>=1&&at(O,e,D,V)}),[O]),Object(s.useEffect)((function(){O.length?O.length>1?C.length?q(!0):q(!1):q(!0):q(!1)}),[O.length,C]);return{searchValue:r,setSearchValue:i,foundFriends:d,setFoundFriends:b,chosenFriends:O,setChosenFriends:p,chatName:C,setChatName:N,setChatCover:v,handleCreateChat:function(){R?Y?st([e.uid].concat(Object(W.a)(O)),L,C,x,[e.uid]).then((function(){M.push("/chat/".concat(L)),t()})):P("Chat has to have a name"):(M.push("/chat/".concat(U)),t())},shouldCreate:R,allowedToCreate:Y,errorMessage:A,setErrorMessage:P}},Un=function(){var e=Fn(),t=e.searchValue,n=e.setSearchValue,s=e.foundFriends,a=e.setFoundFriends,c=e.chosenFriends,r=e.setChosenFriends,i=e.chatName,o=e.setChatName,l=e.setChatCover,u=e.handleCreateChat,d=e.shouldCreate,j=e.allowedToCreate,b=e.errorMessage,h=e.setErrorMessage;return Object(v.jsxs)("div",{className:"CreateChat",children:[Object(v.jsx)(De,{value:t,setValue:n,setResultAuthorList:a,focus:!0,inputText:"Search for friends",defaultSearchMode:"users"}),Object(v.jsx)(tt,{listOfPeople:s,chosenArray:c,setChosenArray:r,lastSeen:!0}),c.length>1&&d&&Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(me,{title:"Chat name",value:i,setValue:o,placeholder:"Enter chat name"}),Object(v.jsx)(Ht,{title:"Chat image",text:"Download chat image",place:"chatCovers/",setItemSrc:l,setImageLocalPath:function(){return null}})]}),Object(v.jsx)(ve,{text:d?"Create Chat":"Go to chat",action:u,isActive:c.length>0&&(d&&j||!d),errorMessage:b,setErrorMessage:h})]})},Wn=function(){var e=Object(s.useState)([]),t=Object(j.a)(e,2),n=t[0],a=t[1],c=re(),r=c.toggleModal,i=c.setContent,o=S().currentUser,l=Object(s.useState)(!0),u=Object(j.a)(l,2),d=u[0],b=u[1];return Object(s.useEffect)((function(){se(o.chats,"chats",a,(function(e){return e.sort((function(e,t){if(e.messages.length&&t.messages.length)return new Date(t.messages[t.messages.length-1].sentTime).getTime()-new Date(e.messages[e.messages.length-1].sentTime).getTime()}))}),(function(){return b(!1)}))}),[]),Object(v.jsx)("div",{style:{animation:"zoomIn .2s forwards",minHeight:"100%"},children:Object(v.jsxs)(tn,{children:[Object(v.jsx)("div",{style:{marginBottom:"10px",display:"flex",alignItems:"start",width:"100%"},children:Object(v.jsxs)("button",{className:"standartButton",onClick:function(){r(),i(Object(v.jsx)(Un,{}))},children:[Object(v.jsx)(je.y,{}),"Create chat"]})}),d?Object(v.jsx)(M,{}):Object(v.jsx)("div",{className:"chatsWrapper",children:n.length?n.map((function(e,t){return Object(v.jsx)(Bn,{chatData:e},t)})):Object(v.jsx)("h3",{children:"No chats"})})]})})},Vn=function(e){var t=e.date;return Object(v.jsx)("div",{className:"DateOnTop",children:Q(t)})},zn=function(e){var t=S().currentUser,n=Object(s.useState)({}),a=Object(j.a)(n,2),c=a[0],r=a[1],i=Object(s.useState)(e.chatName?[]:e.imageColors),o=Object(j.a)(i,2),l=o[0],b=o[1];function h(){return(h=Object(d.a)(u.a.mark((function n(){var s,a;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s=e.participants.find((function(e){return e!==t.uid})),n.next=3,m.collection("users").doc(s).get();case 3:a=n.sent.data(),r(a),b(a.imageColors);case 6:case"end":return n.stop()}}),n)})))).apply(this,arguments)}return Object(s.useEffect)((function(){e.chatName.length||function(){h.apply(this,arguments)}()}),[e.id]),[c,l]},Hn=n(68),Yn=function(){var e=Object(d.a)(u.a.mark((function e(t,n){var s,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("chats").doc(t).get();case 2:s=e.sent.data(),a=s.participants.filter((function(e){return e!==n.uid})),ct(t,s,"soundbubble","".concat(n.displayName," left the chat")),m.collection("chats").doc(t).update({participants:a});case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),qn=function(e){var t=e.chat,n=e.user,s=S().currentUser,a=re(),c=a.openConfirm,r=a.closeConfirm,i=a.setContent,o=s.uid===n.uid;return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(Je,{text:o?"quit chat":"kick"}),Object(v.jsx)(fe,{onClick:function(){return c("Are you sure you want to ".concat(o?"leave":"kick ".concat(n.displayName," ")," from this chat?"),"Yes","No",(function(){Yn(t.id,n),r(),i(Object(v.jsx)(Kn,{data:t}))}))},icon:o?Object(v.jsx)(je.r,{}):Object(v.jsx)(je.I,{})})]})},Qn=function(e){var t=e.chatId,n=Object(s.useState)([]),a=Object(j.a)(n,2),c=a[0],r=a[1],i=Object(s.useState)(!0),o=Object(j.a)(i,2),l=o[0],b=o[1],h=Object(s.useState)(0),f=Object(j.a)(h,2),O=f[0],p=f[1],g=[Object(v.jsx)(It,{listOfSongs:c,source:{source:"/chat/".concat(t),name:"Chat with ".concat(t),image:"",songsList:c}}),Object(v.jsx)(xn,{listOfAuthors:c}),Object(v.jsx)(hn,{listOfAlbums:c,loading:l})];function x(e,t){return y.apply(this,arguments)}function y(){return(y=Object(d.a)(u.a.mark((function e(n,s){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("chats").doc(t).get();case 2:e.sent.data().messages.forEach((function(e){e[n].length>0&&se(e[n],s,r,(function(e){return e}),(function(){return b(!1)}),void 0,1)}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){switch(O){case 0:x("attachedSongs","songs").then((function(){return b(!1)}));break;case 1:x("attachedAuthors","users").then((function(){return b(!1)}));break;case 2:x("attachedAlbums","playlists").then((function(){return b(!1)}))}}),[O]),Object(s.useEffect)((function(){r([])}),[t]),Object(v.jsxs)("div",{className:"AttachmentList",children:[Object(v.jsx)(kn,{pages:["Songs","Authors","Playlists"],currentPage:O,setCurrentPage:function(e){p(e),b(!0),r([])}}),l?Object(v.jsx)(M,{}):c.length>0?g[O]:Object(v.jsx)("h2",{children:"Nothing here"})]})},Gn=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"uid",s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return s?e.filter((function(e){return!t.includes(e[n])})):e.filter((function(e){return t.includes(e[n])}))},Xn=function(){var e=Object(d.a)(u.a.mark((function e(t,n,s,a){var c,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(!0),a(!1),e.next=4,m.collection("chats").doc(t).get();case 4:c=e.sent.data(),r=c.participants,n.forEach((function(e){return r.push(e.uid)})),m.collection("chats").doc(t).update({participants:r}),n.forEach((function(e){var n=e.uid,s=e.chats;m.collection("users").doc(n).update({chats:[].concat(Object(W.a)(s),[t])})})),ct(t,c,"soundbubble","".concat(n.map((function(e){return e.displayName}))," entered the chat")),s(!1),a(!0);case 12:case"end":return e.stop()}}),e)})));return function(t,n,s,a){return e.apply(this,arguments)}}(),Jn=function(e){var t=e.chat,n=le().yourFriends,a=Object(s.useState)(""),c=Object(j.a)(a,2),r=c[0],i=c[1],o=Object(s.useState)([]),l=Object(j.a)(o,2),u=l[0],d=l[1],b=Object(s.useState)(!1),h=Object(j.a)(b,2),f=h[0],O=h[1],p=Object(s.useState)(!1),m=Object(j.a)(p,2),g=m[0],x=m[1],y=Gn(n,t.participants),S=Object(s.useState)([]),w=Object(j.a)(S,2),C=w[0],N=w[1];return Object(v.jsxs)("div",{children:[Object(v.jsx)(De,{value:r,setValue:i,setResultAuthorList:d,defaultSearchMode:"authors",defaultAuthorsListValue:y}),Object(v.jsx)(tt,{listOfPeople:u,chosenArray:C,setChosenArray:N,lastSeen:!0}),!!C.length&&Object(v.jsx)(ve,{text:"Add ".concat(C.length," friends"),action:function(){return Xn(t.id,Gn(n,C,"uid",!1),O,x)},isLoading:f,completed:g,setCompleted:x,bottomMessage:"".concat(C.length," friends have been added to ").concat(t.chatName)})]})},Kn=function(e){var t=e.data,n=S().currentUser,a=Object(s.useState)([]),c=Object(j.a)(a,2),r=c[0],i=c[1],o=Object(s.useState)(!0),l=Object(j.a)(o,2),b=l[0],h=l[1],f=Object(s.useState)(t.chatName),O=Object(j.a)(f,2),g=O[0],x=O[1],y=Object(s.useState)(t.chatImage),w=Object(j.a)(y,2),C=w[0],N=w[1],k=Object(s.useState)(""),I=Object(j.a)(k,2),A=I[0],P=I[1],L=Object(s.useState)(t.imageColors||[]),T=Object(j.a)(L,2),E=T[0],R=T[1],D=re().setContent,B=Object(s.useState)(0),F=Object(j.a)(B,2),U=F[0],W=F[1],V=Object(s.useState)(!1),z=Object(j.a)(V,2),H=z[0],Y=z[1];function q(){return(q=Object(d.a)(u.a.mark((function e(t,n,s){var a,c,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.target.files[0],P(URL.createObjectURL(a)),c=p.ref(),r=c.child(n+a.name),e.next=6,r.put(a);case 6:return e.t0=s,e.next=9,r.getDownloadURL();case 9:e.t1=e.sent,(0,e.t0)(e.t1);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){h(!0),se(t.participants,"users",i,(function(e){return e}),(function(){return h(!1)}))}),[t.id]),Object(s.useEffect)((function(){g.trim()!==t.chatName.trim()||C!==t.chatImage?Y(!0):Y(!1)}),[g,C]),Object(s.useEffect)((function(){x(t.chatName)}),[t.id]),Object(s.useEffect)((function(){x(t.chatName),N(t.chatImage)}),[t.chatName,t.chatImage]),Object(v.jsxs)("div",{className:"ChatInfo",children:[Object(v.jsx)(Wt.a,{src:A,getColors:function(e){return R(e)}}),Object(v.jsxs)("div",{className:"chatInfoImageAndName",children:[Object(v.jsxs)("div",{className:"chatInfoImage",children:[Object(v.jsxs)("label",{className:"changePhoto",children:[Object(v.jsx)(be.b,{}),"Change photo",Object(v.jsx)("input",{type:"file",style:{display:"none"},onChange:function(e){return function(e,t,n){return q.apply(this,arguments)}(e,"chatCovers/",N)}})]}),Object(v.jsx)("img",{loading:"lazy",src:C,alt:""})]}),Object(v.jsxs)("div",{children:[Object(v.jsx)(me,{value:g,setValue:x,placeholder:"Enter chat name",required:!0}),Object(v.jsxs)("div",{className:"chatInfoButtons",children:[Object(v.jsxs)("button",{className:"chatInfoButton",children:[Object(v.jsx)(je.B,{}),"Settings"]}),Object(v.jsxs)("button",{className:"chatInfoButton",onClick:function(){return D(Object(v.jsx)(Qn,{chatId:t.id}))},children:[Object(v.jsx)(ge.a,{}),ht("Attachments",7)]}),Object(v.jsxs)("button",{className:"chatInfoButton",children:[Object(v.jsx)(Hn.b,{}),"Sound"]})]})]}),H?Object(v.jsx)("button",{className:"standartButton",onClick:function(){m.collection("chats").doc(t.id).update({chatName:g,chatImage:C,imageColors:E})},children:"Update Chat"}):null]}),Object(v.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[Object(v.jsx)("h4",{children:"Chat participants"}),Object(v.jsx)(fe,{text:"Add",icon:Object(v.jsx)(je.G,{}),onClick:function(){return D(Object(v.jsx)(Jn,{chat:t}))}})]}),Object(v.jsx)(kn,{pages:["All participants","Administrators"],currentPage:U,setCurrentPage:W}),b?Object(v.jsx)(M,{}):r.map((function(e){return 1!==U?Object(v.jsx)(K,{data:e,lastSeen:!0,rightButton:e.uid===n.uid?Object(v.jsx)(qn,{chat:t,user:n}):t.admins.includes(n.uid)?Object(v.jsx)(qn,{chat:t,user:e}):null},e.uid):t.admins.includes(e.uid)?Object(v.jsx)(K,{data:e,lastSeen:!0},e.uid):void 0}))]})},_n=function(){var e=Object(d.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection(t).get();case 2:return n=e.sent.docs.map((function(e){return e.data()})),e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$n=function(e){var t=e.chatId,n=e.image,s=e.currentWallpaper;return Object(v.jsx)("div",{className:"WallpaperItem "+(n===s?"active":""),onClick:function(){m.collection("chats").doc(t).update({wallpaper:n})},style:"undefined"===n?{background:"var(--playlistsColor)"}:{},children:"undefined"!==n?Object(v.jsx)("img",{loading:"lazy",src:n,alt:""}):null})},Zn=function(e){var t=e.chatId,n=e.currentWallpaper,a=Object(s.useState)([]),c=Object(j.a)(a,2),r=c[0],i=c[1];return Object(s.useEffect)((function(){_n("chatWallpapers").then((function(e){return i(e)}))}),[]),r?Object(v.jsxs)("div",{className:"Wallpapers",children:[Object(v.jsx)("h2",{children:"Wallpapers"}),Object(v.jsxs)("div",{className:"wallpapreWrapper",children:[Object(v.jsx)($n,{chatId:t,image:"undefined"}),r.map((function(e,s){return Object(v.jsx)($n,{chatId:t,image:e.image,currentWallpaper:n},e.id)}))]})]}):Object(v.jsx)(M,{})},es=function(e){var t=e.chatId,n=e.currentWallpaper,a=e.data,c=Object(s.useState)(),r=Object(j.a)(c,2),i=r[0],o=r[1],l=re(),u=l.toggleModal,d=l.setContent,b=Object(s.useRef)(null);return Re(b,o),Object(v.jsxs)("div",{className:"ChatMoreBtn",ref:b,children:[Object(v.jsx)("button",{onClick:function(){return o(!i)},children:Object(v.jsx)(je.u,{})}),Object(v.jsxs)("div",{className:"chatHeaderMenuWindow",style:i?{}:{display:"none"},children:[a.participants.length>2?Object(v.jsxs)("div",{className:"chatHeaderMenuWindowItem",onClick:function(){u(),d(Object(v.jsx)(Kn,{data:a}))},children:[Object(v.jsx)(je.q,{}),Object(v.jsx)("span",{children:"Info"})]}):null,Object(v.jsxs)("div",{className:"chatHeaderMenuWindowItem",onClick:function(){u(),d(Object(v.jsx)(Qn,{chatId:t}))},children:[Object(v.jsx)(je.m,{}),Object(v.jsx)("span",{children:"Attachments"})]}),Object(v.jsxs)("div",{className:"chatHeaderMenuWindowItem",onClick:function(){u(),d(Object(v.jsx)(Zn,{chatId:t,currentWallpaper:n}))},children:[Object(v.jsx)(je.p,{}),Object(v.jsx)("span",{children:"Change wallpaper"})]})]})]})},ts=function(e){var t=e.data,n=re(),s=n.toggleModal,a=n.setContent,c=zn(t),r=Object(j.a)(c,2),o=r[0],l=r[1];return Object(v.jsxs)("div",{className:"ChatHeader",style:(null===l||void 0===l?void 0:l.length)?{background:"linear-gradient(45deg, ".concat(l[0],", ").concat(l[1],")")}:{},children:[Object(v.jsx)(Ft,{}),0===t.chatName.length?Object(v.jsxs)(i.b,{className:"chatHeaderImageAndName",to:"/authors/".concat(o.uid),children:[Object(v.jsx)("div",{className:"chatHeaderImage",style:{backgroundImage:"url(".concat(o.photoURL||t.chatImage,")")}}),Object(v.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center"},children:[Object(v.jsx)("h4",{children:o.displayName||t.chatName}),Object(v.jsx)(X,{userUID:o.uid})]})]}):Object(v.jsxs)("div",{className:"chatHeaderImageAndName",onClick:function(){s(),a(Object(v.jsx)(Kn,{data:t}))},children:[Object(v.jsx)("div",{className:"chatHeaderImage",style:{backgroundImage:"url(".concat(o.photoURL||t.chatImage,")")}}),Object(v.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center"},children:[Object(v.jsx)("h4",{children:o.displayName||t.chatName}),Object(v.jsx)(X,{userUID:o.uid})]})]}),Object(v.jsx)(es,{chatId:t.id,data:t,currentWallpaper:t.wallpaper})]})};function ns(e){return e.attachedSongs.length?"Audio":e.attachedAlbums.length?"Album":e.attachedAuthors.length?"Author":e.inResponseToMessage&&e.inResponseToMessage.length?"Forwarded message":""}var ss,as=function(e){var t=e.list,n=e.attachedItems,s=e.setAttachedItems,a=e.icon,c=function(e){return t.find((function(t){return t.id===e||t.uid===e}))};return Object(v.jsx)("div",{className:"AttachedItemsInChatInput",children:n.map((function(e,t){return Object(v.jsxs)("div",{className:"attachedSongItem",children:[a,Object(v.jsx)("span",{children:c(e).name||c(e).displayName}),Object(v.jsx)("button",{className:"removeMessageFromResponse",onClick:function(){return function(e,t,n){t(e.filter((function(e){return e!==n})))}(n,s,e)},children:Object(v.jsx)(je.I,{})})]},e)}))})},cs=H.a.div(ss||(ss=Object(U.a)(["\n  background: var(--yellowAndOrangeGrad);\n  width: 100%;\n  height: 50px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-weight: 600;\n  box-sizing: border-box;\n\n  @media (max-width: 800px) {\n    font-size: 0.8em;\n  }\n"]))),rs=function(){return Object(v.jsx)(cs,{children:"You are not allowed to send any messages since this person is not in your friend list"})},is=function(e,t,n,a,c,r,i){var o=S().currentUser,l=Object(s.useState)(!1),b=Object(j.a)(l,2),h=b[0],f=b[1],O=le(),p=O.yourSongs,g=O.yourAuthors,x=O.yourPlaylists,v=Object(s.useState)(""),y=Object(j.a)(v,2),w=y[0],C=y[1],N=Object(s.useState)(p),k=Object(j.a)(N,2),I=k[0],A=k[1],P=Object(s.useState)([]),L=Object(j.a)(P,2),M=L[0],T=L[1],E=Object(s.useState)([]),R=Object(j.a)(E,2),D=R[0],B=R[1],F=Object(s.useState)([]),U=Object(j.a)(F,2),V=U[0],z=U[1],H=Object(s.useState)(x),Y=Object(j.a)(H,2),q=Y[0],Q=Y[1],G=Object(s.useState)(g),X=Object(j.a)(G,2),J=X[0],K=X[1],_=Object(s.useState)([]),$=Object(j.a)(_,2),Z=$[0],ee=$[1],te=Object(s.useState)([]),ne=Object(j.a)(te,2),se=ne[0],ae=ne[1],ce=Object(s.useRef)(null);return Re(ce,f),Object(s.useEffect)((function(){0===w.length&&A(p)}),[w]),Object(s.useEffect)((function(){if(0===c.length)m.collection("chats").doc(e).update({typing:t.typing.filter((function(e){return e!==o.uid}))});else if(!t.typing.includes(o.uid)){var n=t.typing;n.push(o.uid),m.collection("chats").doc(e).update({typing:n})}}),[c]),Object(s.useEffect)((function(){ee([]),n.forEach(function(){var e=Object(d.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(i[t].sender).get();case 2:n=e.sent.data().displayName,ee((function(e){return[].concat(Object(W.a)(e),[n])}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[n.length]),Object(s.useEffect)((function(){ae([]),M.forEach(function(){var e=Object(d.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("songs").doc(t).get();case 2:n=e.sent.data().name,ae((function(e){return[].concat(Object(W.a)(e),[n])}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[M.length]),{openAttachWindow:h,setOpenAttachWindow:f,attachWindowRef:ce,searchValue:w,setSearchValue:C,setAllFoundSongs:A,setResultPlaylists:Q,setResultAuthorList:K,allFoundSongs:I,setAttachedSongs:T,resultAuthorList:J,resultPlaylists:q,attachedAuthors:V,attachedAlbums:D,attachedSongs:M,setAttachedAuthors:z,setAttachedAlbums:B,attachedSongsNames:se,removeMessageFromResponseList:function(e){a(n.filter((function(t){return t!==e})))},inResponseNames:Z,sendMessageFull:function(){ct(e,t,o.uid,c,M,D,V,n),r(""),T([]),z([]),B([]),a([]),f(!1)}}},os=Object(s.memo)((function(e){var t=e.chatId,n=e.chatData,s=e.messageText,a=e.setMessageText,c=e.inResponseToMessage,r=e.setInResponseToMessage,i=e.otherMessages,o=zn(n),l=Object(j.a)(o,2),u=l[0],d=(l[1],le().yourFriends),b=S().currentUser,h=is(t,n,c,r,s,a,i),f=h.openAttachWindow,O=h.setOpenAttachWindow,p=h.attachWindowRef,m=h.searchValue,g=h.setSearchValue,x=h.setAllFoundSongs,y=h.setResultPlaylists,w=h.setResultAuthorList,C=h.allFoundSongs,N=h.setAttachedSongs,k=h.resultAuthorList,I=h.resultPlaylists,A=h.attachedAuthors,P=h.attachedAlbums,L=h.attachedSongs,M=h.setAttachedAuthors,T=h.setAttachedAlbums,E=(h.attachedSongsNames,h.removeMessageFromResponseList),R=h.inResponseNames,D=h.sendMessageFull;return u.uid&&!d.find((function(e){return e.uid===u.uid}))?Object(v.jsx)(rs,{}):Object(v.jsxs)("div",{className:"chatInput",style:f?{borderRadius:"0 0 var(--standartBorderRadius) var(--standartBorderRadius)",transition:".2s"}:{},ref:p,children:[Object(v.jsx)("div",{className:"attachWindow",style:f?{height:"400px",opacity:"1"}:{},children:f?Object(v.jsxs)("div",{style:f?{maxHeight:"100%",overflow:"hidden",display:"flex",flexDirection:"column"}:{display:"none"},children:[Object(v.jsx)(De,{value:m,setValue:g,setAllFoundSongs:x,setResultPlaylists:y,setResultAuthorList:w}),Object(v.jsxs)("div",{style:{height:"100%",overflowY:"auto"},children:[Object(v.jsx)(It,{listOfSongs:C,source:"no",listOfChosenSongs:L,setListOfSongs:N}),Object(v.jsx)(xn,{listOfAuthors:k,listOfChosenAuthors:A,setListOfChosenAuthors:M}),Object(v.jsx)(hn,{listOfAlbums:I,loading:!1,listOfChosenAlbums:P,setListOfChosenAlbums:T})]})]}):null}),Object(v.jsxs)("div",{className:"inResponseArea",style:c.length||L.length||A.length||P.length?{}:{height:"0",padding:"0",opacity:"0",top:"0",visibility:"hidden"},children:[Object(v.jsx)("div",{className:"responseMessages",children:c.map((function(e,t){return Object(v.jsxs)("div",{className:"responseItem",children:[Object(v.jsx)("h5",{style:i[e].sender===b.uid?{color:"var(--lightPurple)"}:{},children:R[t]}),Object(v.jsxs)("p",{children:[ht(i[e].message,35),Object(v.jsx)("span",{style:{marginLeft:"5px",color:"var(--reallyLightBlue)"},children:ns(i[e])})]}),Object(v.jsx)("button",{onClick:function(){return E(e)},className:"removeMessageFromResponse",children:Object(v.jsx)(je.I,{})})]},e)}))}),Object(v.jsx)(as,{list:C,attachedItems:L,setAttachedItems:N,icon:Object(v.jsx)($e.c,{})}),Object(v.jsx)(as,{list:k,attachedItems:A,setAttachedItems:M,icon:Object(v.jsx)(je.E,{})}),Object(v.jsx)(as,{list:I,attachedItems:P,setAttachedItems:T,icon:Object(v.jsx)(de.a,{})})]}),Object(v.jsxs)("div",{className:"attachAndEmojis",children:[Object(v.jsx)("div",{className:"attachBtn",children:Object(v.jsx)("button",{onClick:function(){O(!f)},children:Object(v.jsx)(ge.a,{})})}),Object(v.jsx)("input",{type:"text",style:{background:"var(--lightGrey)",border:"none",outline:"none",minHeight:"100%"},value:s,onChange:function(e){a(e.target.value)},onKeyDown:function(e){"Enter"===e.key&&D()}})]}),Object(v.jsx)("button",{className:"sendBtn",onClick:function(){D()},children:Object(v.jsx)(be.d,{})})]})})),ls=n(130),us=function(e){var t=Object(s.useState)({}),n=Object(j.a)(t,2),a=n[0],c=n[1],r=Object(s.useState)({songs:{},playlists:{},users:{}}),i=Object(j.a)(r,2),o=i[0],l=i[1],b=function(e,t){e.forEach(function(){var e=Object(d.a)(u.a.mark((function e(n){var s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection(t).doc(n).get();case 2:(s=e.sent).exists?l((function(e){var n,a,c,r=e;return r[t][null!==(n=null===(a=s.data())||void 0===a?void 0:a.id)&&void 0!==n?n:null===(c=s.data())||void 0===c?void 0:c.uid]=s.data(),Object(B.a)({},r)})):l((function(e){var t,n,a,c=e;return c[null!==(t=null===(n=s.data())||void 0===n?void 0:n.id)&&void 0!==t?t:null===(a=s.data())||void 0===a?void 0:a.uid]=null,Object(B.a)({},c)}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())};return Object(s.useEffect)((function(){!function(){var t=e.participants.map(function(){var e=Object(d.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(t).get();case 2:return e.abrupt("return",e.sent.data());case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());Promise.all(t).then((function(e){var t={};e.forEach((function(e){t[e.uid]=e})),c(t)}))}(),e.messages.forEach((function(e){b(e.attachedSongs,"songs"),b(e.attachedAlbums,"playlists"),b(e.attachedAuthors,"users")}))}),[]),{participantsData:a,attachedData:o}};function ds(e){var t=Object(s.useState)(!1),n=Object(j.a)(t,2),a=n[0],c=n[1],r=new IntersectionObserver((function(e){var t=Object(j.a)(e,1)[0];return c(t.isIntersecting)}));return Object(s.useEffect)((function(){return r.observe(e.current),function(){r.disconnect()}}),[]),a}var js,bs,hs,fs,Os,ps,ms,gs,xs,vs,ys,Ss,ws,Cs,Ns=function(e,t,n){var a=Object(s.useRef)(),c=ds(a),r=S().currentUser;return Object(s.useEffect)((function(){if(void 0!==t.seenBy&&r.uid!==t.sender&&c&&!t.seenBy.includes(r.uid)){var s=n;s[t.id].seenBy.push(r.uid),m.collection("chats").doc(e).update({messages:s})}}),[c]),[a,c]},ks=H.a.div(js||(js=Object(U.a)(["\n  width: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  opacity: 0.5;\n"]))),Is=function(e){var t=e.chatId,n=e.message,s=e.messageList,a=Ns(t,n,s),c=Object(j.a)(a,2),r=c[0];c[1];return Object(v.jsx)(ks,{ref:r,children:n.message})},As=H.a.div(bs||(bs=Object(U.a)(["\n  width: 100%;\n  height: 40px;\n  font-weight: 500;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: #fff;\n  background: #2c2c2c;\n  position: relative;\n\n  svg {\n    position: absolute;\n    top: 50%;\n    right: 10px;\n    transform: translateY(-50%);\n  }\n"]))),Ps=function(e){var t=e.isNotSeen;return void 0!==t&&t&&Object(v.jsxs)(As,{children:["New messages",Object(v.jsx)(je.e,{})]})},Ls=n(52),Ms=n(41),Ts=H.a.div(hs||(hs=Object(U.a)(["\n  .response-name-and-date {\n    display: flex;\n    align-items: center;\n\n    h5 {\n      color: ",";\n    }\n\n    div {\n      font-size: 0.7em;\n      opacity: 0.8;\n      margin-left: 10px;\n    }\n  }\n\n  .response-message {\n    display: flex;\n    row-gap: 7px;\n    span {\n      color: var(--reallyLightBlue);\n    }\n  }\n"])),(function(e){return e.areYouSender?"var(--lightPurple)":""})),Es=function(e){var t,n=e.allMessages,a=e.messageId,c=e.participantsData,r=Object(s.useMemo)((function(){return n[a]}),[]),i=S().currentUser;return Object(v.jsxs)(Ts,{className:"responseItem",areYouSender:r.sender===i.uid,children:[Object(v.jsxs)("span",{className:"response-name-and-date",children:[Object(v.jsx)("h5",{children:null===(t=c[r.sender])||void 0===t?void 0:t.displayName}),Object(v.jsx)("div",{children:Q(r.sentTime,2)})]}),Object(v.jsxs)("p",{className:"response-message",children:[r.message,Object(v.jsx)("span",{style:{},children:ns(r)})]})]})},Rs=function(e){e.showPhoto;var t=e.messageData,n=e.attachedData,a=e.participantsData,c=e.senderData,r=e.allMessages,i=t.message,o=t.inResponseToMessage,l=t.attachedSongs,u=t.attachedAuthors,d=t.attachedAlbums,b=t.sentTime,h=Ge().screenHeight,f=Object(s.useMemo)((function(){return Q(b,2)}),[b]),O=Object(s.useState)(n.songs),p=Object(j.a)(O,2),m=p[0],g=p[1],x=Object(s.useState)(n.users),y=Object(j.a)(x,2),S=y[0],w=y[1],C=Object(s.useState)(n.playlists),N=Object(j.a)(C,2),k=N[0],I=N[1];return Object(s.useEffect)((function(){l.forEach((function(e){n.songs[e]||se([e],"songs",g,(function(e){return Object(B.a)(Object(B.a)({},m),e.reduce((function(e,t){return Object(Ms.a)({},t.id,t)}),{}))}))})),d.forEach((function(e){n.playlists[e]||se([e],"playlists",I,(function(e){return Object(B.a)(Object(B.a)({},m),e.reduce((function(e,t){return Object(Ms.a)({},t.id,t)}),{}))}))})),u.forEach((function(e){n.users[e]||se([e],"users",w,(function(e){return Object(B.a)(Object(B.a)({},m),e.reduce((function(e,t){return Object(Ms.a)({},t.uid,t)}),{}))}))}))}),[d,u,n.playlists,n.songs,n.users,l,m]),Object(v.jsxs)("div",{className:"messageItemBody",children:[Object(v.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"5px"},children:[Object(v.jsx)("h5",{className:"messageUserName",children:null===c||void 0===c?void 0:c.displayName}),Object(v.jsx)("div",{style:{fontSize:".7em",opacity:".8",marginLeft:"10px"},children:f})]}),null!==o&&o.map((function(e,t){return Object(v.jsx)(Es,{messageId:e,allMessages:r,participantsData:a},t)})),Object(v.jsxs)("div",{children:[Object(v.jsx)("p",{children:i}),l.map((function(e,t){if(m[e])return Object(v.jsx)(Ct,{song:m[e],localIndex:t,position:h},t)})),d.map((function(e,t){if(k[e])return Object(v.jsx)(bn,{playlist:k[e]},t)})),u.map((function(e,t){if(S[e])return Object(v.jsx)(gn,{data:S[e]},t)}))]})]})},Ds=Object(s.memo)((function(e){var t=e.messageData,n=e.chatId,a=e.showPhoto,c=void 0===a||a,r=e.otherMessages,i=e.inResponseToMessageArr,o=e.setInResponseToMessageArr,l=e.participantsData,u=e.attachedData,d=S().currentUser,b=Ge().isMobile,h=t.sender,f=t.id,O=Object(s.useMemo)((function(){return l[h]}),[l,h]),p=Ns(n,t,r),m=Object(j.a)(p,2),g=m[0],x=(m[1],Object(s.useState)(0)),y=Object(j.a)(x,2),w=y[0],C=y[1],N=Object(s.useState)(0),k=Object(j.a)(N,2),I=k[0],A=k[1];Object(Ls.useSwipeable)({onSwiping:function(e){e.deltaX<0&&C(e.deltaX)}});function P(){i.includes(f)||o((function(e){return[].concat(Object(W.a)(e),[f])}))}function L(){var e;clearTimeout(e),A(.2),e=setTimeout((function(){C(0),A(0)}),200)}return Object(s.useEffect)((function(){w<-160&&(L(),P())}),[w]),Object(v.jsxs)("div",{className:"MessageItem "+(h===d.uid?"your":""),ref:g,style:c?{paddingBottom:"15px",transform:"translateX(".concat(w,"px)"),transition:I}:{transform:"translateX(".concat(w,"px)"),transition:I},onTouchEnd:L,children:[Object(v.jsx)("div",{className:"messageItemImage",children:c?Object(v.jsx)("img",{loading:"lazy",src:null===O||void 0===O?void 0:O.photoURL,alt:""}):null}),Object(v.jsx)(Rs,{showPhoto:c,messageData:t,attachedData:u,participantsData:l,senderData:O,allMessages:r}),Object(v.jsx)(Ln,{listOfSeen:t.seenBy}),Object(v.jsx)("button",{className:"respondToMessageBtn",onClick:P,style:b?{opacity:-w/80}:{},children:Object(v.jsx)(de.o,{})})]})})),Bs=Object(s.memo)((function(e){var t=e.message,n=e.index,a=e.messageList,c=e.chatId,r=e.inResponseToMessage,i=e.setInResponseToMessage,o=e.scrollToMessageRef,l=e.scrollToMessageId,u=e.setScrollToMessageId,d=e.setDateRefsArray,b=e.participantsData,h=e.attachedData,f=e.isNotSeen,O=Object(s.useState)(!1),p=Object(j.a)(O,2),m=p[0],g=p[1],x=Object(s.useState)(!1),y=Object(j.a)(x,2),S=y[0],w=y[1],C=Object(s.useRef)(null);return Object(s.useEffect)((function(){var e,t,s,c,r,i;a.length&&((n===a.length-1||(null===(e=a[n+1])||void 0===e?void 0:e.sender)!==(null===(t=a[n])||void 0===t?void 0:t.sender)||Q(null===(s=a[n+1])||void 0===s?void 0:s.sentTime)!==Q(null===(c=a[n])||void 0===c?void 0:c.sentTime))&&g(!0),(0===n||Q(null===(r=a[n])||void 0===r?void 0:r.sentTime)!==Q(null===(i=a[n-1])||void 0===i?void 0:i.sentTime))&&w(!0))}),[a.length]),Object(s.useEffect)((function(){null!==C.current&&d((function(e){return[].concat(Object(W.a)(e),[C])}))}),[S]),Object(v.jsxs)(v.Fragment,{children:[S?Object(v.jsx)("div",{ref:C,style:{width:"100%",display:"flex",justifyContent:"center",alignItems:"center",padding:"10px 0"},children:Q(t.sentTime)}):null,Object(v.jsx)(Ps,{isNotSeen:f}),Object(v.jsx)(Ds,{messageData:t,chatId:c,scrollToMessageRef:o,scrollToMessageId:l,setScrollToMessageId:u,showPhoto:m,otherMessages:a,inResponseToMessageArr:r,setInResponseToMessageArr:i,participantsData:b,attachedData:h},t.id)]})})),Fs=Object(s.memo)((function(e){var t=e.chatId,n=e.chatData,a=e.messageList,c=e.findTopDate,r=e.inResponseToMessage,i=e.setInResponseToMessage,o=e.setDateRefsArray,l=Ge().screenHeight,u=Object(s.useRef)(null),d=us(n),j=d.participantsData,b=d.attachedData,h=S().currentUser,f=Object(s.useMemo)((function(){return a.findIndex((function(e){return!!e.seenBy&&!e.seenBy.includes(h.uid)}))}),[]);return Object(v.jsx)(ls.a,{increaseViewportBy:{top:50,bottom:50},style:{height:l-105+"px",scrollBehavior:"initial",overflowX:"hidden",marginTop:0},data:a,totalCount:a.length,components:{Footer:function(){return Object(v.jsx)(Mn,{typingPeople:n.typing})}},followOutput:"smooth",itemContent:function(e,n){return"soundbubble"!==n.sender?Object(v.jsx)(Bs,{message:n,index:e,messageList:a,chatId:t,setDateRefsArray:o,inResponseToMessage:r,setInResponseToMessage:i,participantsData:j,attachedData:b,isNotSeen:f===e},n.id):Object(v.jsx)(Is,{chatId:t,message:n,messageList:a})},onScroll:c,ref:u})})),Us=function(){var e=Object(o.h)("/chat/:chatId"),t=S().currentUser,n=e.params.chatId,a=Object(s.useState)(""),c=Object(j.a)(a,2),r=c[0],i=c[1],l=Object(s.useState)([]),u=Object(j.a)(l,2),d=u[0],b=u[1],h=Object(s.useState)([]),f=Object(j.a)(h,2),O=f[0],p=f[1],g=Object(o.g)(),x=function(e,t){var n=Object(s.useState)(null),a=Object(j.a)(n,2),c=a[0],r=a[1],i=Object(s.useState)([]),o=Object(j.a)(i,2),l=o[0],u=o[1],d=Object(s.useState)(!0),b=Object(j.a)(d,2),h=b[0],f=b[1],O=Object(s.useState)(""),p=Object(j.a)(O,2),g=p[0],x=p[1];return Object(s.useEffect)((function(){var t=m.collection("chats").doc(e).onSnapshot((function(e){var t,n;r(e.data()),u(null===(t=e.data())||void 0===t?void 0:t.messages),x((null===(n=e.data())||void 0===n?void 0:n.messages.length)?e.data().messages[e.data().messages.length-1].sentTime:(new Date).toString()),f(!1)}));return function(){t()}}),[e]),[c,l,h,g,function(e){t.forEach((function(t){null!==t.current&&t.current.offsetTop-20<=e.target.scrollTop&&x(t.current.innerHTML)}))}]}(n,O),y=Object(j.a)(x,5),w=y[0],C=y[1],N=y[2],k=y[3],I=y[4];return Object(s.useEffect)((function(){void 0===w?g.push("/not-found"):void 0!==(null===w||void 0===w?void 0:w.participants)&&(w.participants.includes(t.uid)||g.push("/chat"))}),[w]),null!==w&&void 0!==w?Object(v.jsxs)("div",{className:"DialoguePage",style:{height:"100%"},children:[N?Object(v.jsx)(M,{top:"50%"}):Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(ts,{data:w}),Object(v.jsx)(Vn,{date:k}),Object(v.jsx)(Fs,{chatId:n,chatData:w,messageList:C,findTopDate:I,setDateRefsArray:p,inResponseToMessage:d,setInResponseToMessage:b}),Object(v.jsx)(os,{chatId:n,chatData:w,messageText:r,setMessageText:i,inResponseToMessage:d,setInResponseToMessage:b,otherMessages:C})]}),"undefined"!==(null===w||void 0===w?void 0:w.wallpaper)?Object(v.jsx)("img",{loading:"lazy",src:w.wallpaper,className:"chatWallpaper",alt:""}):null]}):null},Ws=function(){var e=Object(s.useState)([]),t=Object(j.a)(e,2),n=t[0],a=t[1],c=Object(s.useState)([]),r=Object(j.a)(c,2),i=r[0],o=r[1],l=S().currentUser;return Object(s.useEffect)((function(){m.collection("history").doc(l.uid).onSnapshot((function(e){a(e.data().history)}))}),[m]),Object(s.useEffect)((function(){se(n,"songs",o)}),[n]),Object(v.jsx)("div",{className:"HistoryPage",style:{animation:"zoomIn .2s forwards"},children:Object(v.jsxs)(tn,{children:[Object(v.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[Object(v.jsx)(Ft,{}),Object(v.jsx)("h2",{style:{margin:"0px",marginLeft:"8px"},children:"History"})]}),Object(v.jsx)(It,{listOfSongs:i,source:{source:"/history",name:"History",image:"https://www.seekpng.com/png/full/781-7815113_history-icon-white-png.png",songsList:i},showCount:!0,showSearch:!0,displayIfEmpty:"Nothing here"})]})})},Vs=function(){var e=Object(s.useState)([]),t=Object(j.a)(e,2),n=t[0],a=t[1],c=Object(s.useState)(0),r=Object(j.a)(c,2),i=r[0],o=r[1],l=Object(s.useState)(!0),b=Object(j.a)(l,2),h=b[0],f=b[1],O=Object(s.useState)({}),p=Object(j.a)(O,2),g=p[0],x=p[1],y=Object(s.useState)({}),S=Object(j.a)(y,2),w=S[0],C=S[1],N=Object(s.useState)({}),k=Object(j.a)(N,2),I=k[0],A=k[1];function P(e,t,n){return L.apply(this,arguments)}function L(){return(L=Object(d.a)(u.a.mark((function e(t,n,s){var c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection(n).orderBy(s,"desc").limit(1).get();case 2:c=e.sent.docs[0].data(),t(c),a((function(e){return[].concat(Object(W.a)(e),[c.imageColors[0]])})),"playlists"===n&&f(!1);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){P(x,"users","subscribers"),P(C,"songs","listens"),P(A,"playlists","listens")}),[]),Object(v.jsx)("div",{className:"MainBanner",style:{background:n[i]},children:h?Object(v.jsx)(M,{}):Object(v.jsxs)(v.Fragment,{children:[Object(v.jsxs)("div",{className:"slider",children:[Object(v.jsxs)("div",{className:"sliderItem "+(0===i?"current":""),style:{transform:"translateX(-".concat(100*i,"%)")},children:[Object(v.jsx)("h3",{children:"Most popular artist on platform"}),Object(v.jsx)(gn,{data:g})]}),Object(v.jsxs)("div",{className:"sliderItem "+(1===i?"current":""),style:{transform:"translateX(-".concat(100*i,"%)")},children:[Object(v.jsx)("h3",{children:"Most popular song on platform"}),Object(v.jsx)(Ct,{song:w,localIndex:0,showListens:!0})]}),Object(v.jsxs)("div",{className:"sliderItem "+(2===i?"current":""),style:{transform:"translateX(-".concat(100*i,"%)")},children:[Object(v.jsx)("h3",{children:"Most popular album on platform"}),Object(v.jsx)(bn,{playlist:I})]})]}),Object(v.jsxs)("div",{className:"sliderBtns",children:[Object(v.jsx)("button",{onClick:function(){return o($(i-1,2,0))},children:Object(v.jsx)(de.c,{})}),Object(v.jsx)("button",{onClick:function(){return o($(i+1,2,0))},children:Object(v.jsx)(de.d,{})})]})]})})},zs=function(){var e=le().yourAuthors,t=Object(s.useState)([]),n=Object(j.a)(t,2),a=n[0],c=n[1];return Object(s.useEffect)((function(){void 0!==e&&0!==e.length&&0===a.length&&function(){var t=[];e.forEach((function(e,n){e.ownSongs.forEach(function(){var e=Object(d.a)(u.a.mark((function e(n){var s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("songs").doc(n).get();case 2:rn(s=e.sent.data())&&!t.includes(s.id)&&(c((function(e){return[].concat(Object(W.a)(e),[s])})),t.push(s.id));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}))}()}),[]),Object(v.jsx)("div",{children:Object(v.jsx)(It,{listOfSongs:a,source:{source:"/home",name:"New Songs",image:"",songsList:a},title:"New Songs",isNewSong:!0})})},Hs=function(){var e=le().yourAuthors,t=Object(s.useState)([]),n=Object(j.a)(t,2),a=n[0],c=n[1],r=Object(s.useState)([]),i=Object(j.a)(r,2),o=i[0],l=i[1],u=S().currentUser;return Object(s.useEffect)((function(){void 0!==e&&e.forEach((function(e){pn(e,c)}))}),[]),Object(s.useEffect)((function(){a.forEach((function(e){var t=o.map((function(e){return e.uid}));u.addedAuthors.includes(e.uid)||t.includes(e.uid)||l((function(t){return[].concat(Object(W.a)(t),[e])}))}))}),[a]),Object(v.jsx)("div",{className:"RecommendedAuthors",children:Object(v.jsx)(xn,{listOfAuthors:o,title:"Recommended Authors"})})},Ys=function(e){var t=e.message,n=e.image,s=e.button;return Object(v.jsx)("div",{className:"importantMessage",children:Object(v.jsxs)("div",{children:[n?Object(v.jsx)("img",{loading:"lazy",src:n,alt:""}):null,Object(v.jsx)("h3",{children:t}),s||null]})})},qs=function(){var e=le().yourAuthors,t=S().currentUser,n=Object(s.useState)([]),a=Object(j.a)(n,2),c=a[0],r=a[1];return Object(s.useEffect)((function(){!function(){var n=[];e.forEach((function(e,s){e.ownSongs.forEach(function(){var e=Object(d.a)(u.a.mark((function e(s,a){var c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("songs").doc(s).get();case 2:c=e.sent.data(),!t.addedSongs.includes(s)&&!n.includes(c.id)&&a<=3&&(r((function(e){return[].concat(Object(W.a)(e),[c])})),n.push(c.id));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}))}()}),[]),Object(v.jsx)("div",{className:"RecommendedSongs",children:Object(v.jsx)(It,{listOfSongs:c,source:{source:"/home",name:"Recommended Songs",image:"",songsList:c},title:"Recommended Songs",displayIfEmpty:Object(v.jsx)(Ys,{message:"No songs recommended. Add favorite authors so we could know what to recommend",image:"https://i.pinimg.com/originals/b2/3d/f6/b23df649311586e74a8455c92eb3d76b.png"})})})},Qs=function(){var e=Object(s.useState)([]),t=Object(j.a)(e,2),n=t[0],a=t[1],c=Object(s.useState)(!0),r=Object(j.a)(c,2),i=r[0],o=r[1];return Object(s.useEffect)((function(){o(!0),m.collection("songs").orderBy("listens","desc").limit(15).get().then((function(e){e.docs.forEach((function(e){a((function(t){return[].concat(Object(W.a)(t),[e.data()])}))})),o(!1)}))}),[]),i?Object(v.jsx)(M,{}):Object(v.jsx)(It,{listOfSongs:n,source:{source:"/home",name:"Top 15 Songs",image:"https://media.istockphoto.com/vectors/fire-icon-illustration-for-design-stock-vector-vector-id931601050?k=6&m=931601050&s=170667a&w=0&h=fhRQfwwsW6aXK9OSDM-yj842SFFl2Q9ll6ch-xCK5es=",songsList:n},title:"Top 15 Songs",showListens:!0,showCount:!0})},Gs=(n(271),function(){return Object(v.jsxs)("div",{style:{animation:"zoomIn .2s forwards"},className:"HomePage",children:[Object(v.jsx)(Vs,{}),Object(v.jsxs)(tn,{children:[Object(v.jsx)(zs,{}),Object(v.jsx)(Qs,{}),Object(v.jsx)(qs,{}),Object(v.jsx)(Hs,{})]})]})}),Xs=(n(272),function(){var e=le().yourAuthors,t=Object(s.useState)(""),n=Object(j.a)(t,2),a=n[0],c=n[1],r=Object(s.useState)(e),i=Object(j.a)(r,2),o=i[0],l=i[1];return Object(v.jsx)("div",{className:"AuthorsPage",children:Object(v.jsxs)(tn,{children:[Object(v.jsx)(De,{value:a,setValue:c,setResultAuthorList:l,defaultSearchMode:"users",defaultAuthorsListValue:e,inputText:"Search for authors"}),Object(v.jsx)("div",{className:"authorsContainer",children:o.map((function(e){return Object(v.jsx)(gn,{data:e},e.uid)}))})]})})}),Js=H.a.div(fs||(fs=Object(U.a)(["\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  background: var(--chatsColor);\n  border-radius: var(--standartBorderRadius);\n  font-weight: 600;\n  cursor: pointer;\n  transition: 0.15s, 0.1s box-shadow;\n\n  & .text {\n    transition: 0.15s;\n    height: 25px;\n  }\n\n  &:hover .add-circle {\n    transform: scale(1.3);\n  }\n\n  &:hover .text {\n    opacity: 0;\n    height: 0;\n  }\n\n  &:hover {\n    transform: scale(0.93);\n  }\n\n  &:active {\n    transform: scale(0.9);\n    box-shadow: 0 0 0 7px #ffffff5e;\n  }\n\n  & .add-circle {\n    width: 60px;\n    height: 60px;\n    border-radius: 100%;\n    background: var(--playlistsColor);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    margin-bottom: 10px;\n    transition: 0.2s;\n\n    svg {\n      width: 30px;\n      height: 30px;\n    }\n  }\n"]))),Ks=function(){var e=re(),t=e.toggleModal,n=e.setContent;return Object(v.jsxs)(Js,{onClick:function(){t(),n(Object(v.jsx)(Cn,{}))},className:"playlistItem",children:[Object(v.jsx)("span",{className:"add-circle",children:Object(v.jsx)(je.y,{})}),Object(v.jsx)("span",{className:"text",children:"Add playlist"})]})},_s=function(){var e=le().yourPlaylists,t=Object(s.useState)(e),n=Object(j.a)(t,2),a=n[0],c=n[1],r=Object(s.useState)(""),i=Object(j.a)(r,2),o=i[0],l=i[1];return Object(v.jsx)("div",{className:"PlaylistsPage",children:Object(v.jsxs)(tn,{children:[Object(v.jsx)("div",{style:{display:"flex"},className:"searchAndCreatePlaylist",children:Object(v.jsx)(De,{value:o,setValue:l,setResultPlaylists:c,defaultSearchMode:"playlists",defaultPlaylistsListValue:e,inputText:"Search for playlist name"})}),Object(v.jsxs)("div",{className:"playlistsContainer",children:[Object(v.jsx)(Ks,{}),a&&a.map((function(e,t){return Object(v.jsx)(bn,{playlist:e},e.id)}))]})]})})},$s=function(e){var t=e.playlist,n=le(),a=n.currentSongPlaylistSource,c=n.play,r=Ge().isMobile,o=Object(s.useState)([]),l=Object(j.a)(o,2),u=l[0],d=l[1],b=jn(t,u,d);return Object(v.jsx)(i.b,{to:"/albums/".concat(t.id),className:"playlistWrapper",children:Object(v.jsxs)("div",{className:"library playlistItem",style:{backgroundImage:"url(".concat(t.image,")")},children:[Object(v.jsx)("h2",{style:{background:t.imageColors[2]},children:ht(t.name,10)}),t.image?null:Object(v.jsx)(de.a,{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",width:"60px",height:"60px"}}),r?null:Object(v.jsx)("button",{onClick:b,children:a.name===t.name&&c?Object(v.jsx)(un.b,{}):Object(v.jsx)(un.c,{})})]})})},Zs=n.p+"static/media/wave2.f62cb572.svg",ea=Object(s.memo)((function(){var e=le().yourPlaylists,t=Ge().screenWidth,n=re(),a=n.toggleModal,c=n.setContent,r=Object(s.useMemo)((function(){return function(e){return e<1990&&e>=1780?7:e<1780&&e>=1570?6:e<1570&&e>=1360?5:e<1360&&e>=1150?4:e<1150&&e>=1e3?3:e<1e3&&e>=892?6:e<892&&e>=754?5:e<754&&e>=614?4:e<614&&e>=464?3:2}(t)}),[t]);return Object(v.jsxs)("div",{className:"playLists",children:[Object(v.jsx)("div",{className:"playlistContent",children:e.length?e.map((function(e,t){if(t<r)return Object(v.jsx)($s,{playlist:e},t)})):Object(v.jsxs)("div",{style:{position:"absolute",left:"50%",top:"40%",display:"flex",flexDirection:"column",alignItems:"center",transform:"translate(-50%, -50%)"},children:[Object(v.jsx)("h3",{children:"You don't have playlists"}),Object(v.jsx)(fe,{text:"Add playlist",icon:Object(v.jsx)(je.y,{}),onClick:function(){a(),c(Object(v.jsx)(Cn,{}))}})]})}),Object(v.jsx)("div",{className:"playlistsBackground",children:Object(v.jsx)("img",{loading:"lazy",src:Zs,alt:"wave"})})]})})),ta=Object(s.memo)((function(){var e=le().yourSongs,t=S().currentUser;return Object(v.jsxs)("div",{className:"SongsPage",children:[Object(v.jsx)(ea,{}),Object(v.jsx)("div",{className:"yourSongsList",children:Object(v.jsx)(It,{listOfSongs:e,source:{source:"/library",name:"Your Library",image:t.photoURL,songsList:e},showSearch:!0,showhistory:!0,displayIfEmpty:Object(v.jsx)("h3",{children:"Your library is empty"})})})]})})),na=function(){var e=Object(s.useState)(0),t=Object(j.a)(e,2),n=t[0],a=t[1],c=[Object(v.jsx)(ta,{}),Object(v.jsx)(_s,{}),Object(v.jsx)(Xs,{})];return Object(v.jsxs)("div",{className:"LibraryPage",style:{animation:"zoomIn .2s forwards"},children:[Object(v.jsx)(kn,{pages:["Songs","Playlists","Authors"],currentPage:n,setCurrentPage:a}),c[n]]})},sa=function(e){var t=e.title;return Object(v.jsxs)("div",{className:"titleAndLogo",children:[Object(v.jsx)("div",{className:"title",children:Object(v.jsx)("h1",{children:t})}),Object(v.jsx)("div",{className:"logo",children:Object(v.jsx)("img",{loading:"lazy",src:E,alt:""})})]})},aa=function(e){var t=e.errorMessage,n=re().openBottomMessage;return Object(s.useEffect)((function(){t&&n(t,"failure")}),[t]),t&&Object(v.jsx)("div",{className:"Alert",children:t})},ca=function(){return Object(v.jsxs)("div",{className:"BlurredBg",children:[Object(v.jsx)("div",{className:"circle circle1"}),Object(v.jsx)("div",{className:"circle circle2"}),Object(v.jsx)("div",{className:"circle circle3"}),Object(v.jsx)("div",{className:"circle circle4"}),Object(v.jsx)("div",{className:"circle circle5"})]})},ra=function(){var e=S().login,t=Object(s.useState)(""),n=Object(j.a)(t,2),a=n[0],c=n[1],r=Object(s.useState)(""),o=Object(j.a)(r,2),l=o[0],b=o[1],h=Object(s.useState)(""),f=Object(j.a)(h,2),O=f[0],p=f[1],m=Object(s.useState)(!1),g=Object(j.a)(m,2),x=g[0],y=g[1],w=0!==a.length&&0!==l.length;function C(){return(C=Object(d.a)(u.a.mark((function t(n){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),w){t.next=3;break}return t.abrupt("return",p("One of your fields is totaly empty"));case 3:return t.next=5,e(a,l,p,y);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return Object(v.jsxs)("div",{className:"In-Up-Container",children:[Object(v.jsxs)("div",{className:"CentralPlate",children:[Object(v.jsx)(yn,{loading:x}),Object(v.jsx)(sa,{title:"Log In"}),Object(v.jsx)(aa,{errorMessage:O}),Object(v.jsxs)("div",{className:"inner-plate-content",children:[Object(v.jsx)(me,{type:"email",placeholder:"Enter your email",value:a,setValue:c,margin:!0}),Object(v.jsx)(me,{type:"password",placeholder:"Enter your password",value:l,setValue:b,margin:!0}),Object(v.jsxs)("div",{className:"inAndUpBtns",children:[Object(v.jsx)("button",{className:"upBtn",disabled:x,onClick:function(e){return C.apply(this,arguments)},children:"Log In"}),Object(v.jsx)(i.b,{to:N,children:Object(v.jsx)("button",{className:"inBtn",children:"Create new account"})})]})]})]}),Object(v.jsx)(ca,{})]})},ia=function(e){var t=e.currentTime,n=e.timeSpan,s=e.id;return Object(v.jsx)("div",{className:"Loading",id:s,children:Object(v.jsx)("div",{className:"outer",style:{pointerEvents:"none"},children:Object(v.jsx)("div",{className:"inner",style:t/n<1?{width:t/n*100+"%"}:{width:"0%",opacity:"0"}})})})},oa=H.a.div(Os||(Os=Object(U.a)(["\n  max-height: 490px;\n  width: 1000px;\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n  row-gap: 10px;\n  scroll-behavior: smooth;\n\n  .lyrics-list {\n    overflow-y: auto;\n    overflow-x: hidden;\n    height: 100%;\n    scroll-snap-type: y mandatory;\n    scroll-padding-top: 50px;\n\n    .Loading {\n      max-width: 70%;\n      width: auto;\n    }\n  }\n\n  .lyricsBlock {\n    padding: 10px;\n    box-sizing: border-box;\n    font-size: 1.8em;\n    font-weight: 700;\n    margin: 10px 0;\n    user-select: none;\n    cursor: pointer;\n    border-radius: var(--standartBorderRadius2);\n    transform: scale(0.75) translateX(-80px);\n    opacity: 0.7;\n\n    &:hover {\n      background: #ffffff5c;\n    }\n\n    &.current {\n      background: #ffffff5c;\n      scroll-snap-align: start;\n      transform: scale(1) translateX(0);\n      opacity: 1;\n    }\n  }\n\n  .loading-buttons {\n    display: flex;\n    justify-content: center;\n    column-gap: 4px;\n    width: 100%;\n    min-height: 40px;\n\n    button {\n      background: var(--transparentWhite);\n      min-height: 100%;\n      width: 100%;\n      border-radius: var(--standartBorderRadius3);\n      font-weight: 700;\n      color: #fff;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n\n      svg {\n        margin-right: 7px;\n        width: 16px;\n        height: 16px;\n      }\n    }\n  }\n"]))),la=function(e){var t=e.lyrics,n=e.setLyrics,a=e.currentParagraph,c=e.setCurrentParagraph,r=e.currentTime,i=Object(s.useState)(null),o=Object(j.a)(i,2),l=o[0],u=o[1],d=function(e,s){var a=t,c={text:s,startTime:"undefined"};-1===e?a.unshift(c):e===t.length?a.push(c):a.splice(e,0,c),n(Object(W.a)(a))};return Object(s.useEffect)((function(){t.length&&function(){if(a!==t.length-1&&parseFloat(t[a+1].startTime)<=r)c(a+1)}()}),[r]),Object(v.jsxs)(oa,{children:[Object(v.jsxs)("div",{className:"loading-buttons",children:[!l&&Object(v.jsxs)(v.Fragment,{children:[Object(v.jsxs)("button",{onClick:function(){return u("before")},children:[Object(v.jsx)(je.j,{}),"Place loading before"]}),Object(v.jsxs)("button",{onClick:function(){return u("after")},children:[Object(v.jsx)(je.k,{}),"Place loading after"]})]}),!!l&&Object(v.jsxs)(v.Fragment,{children:[Object(v.jsxs)("h5",{children:["Choose block to insert loading ",l," it"]}),Object(v.jsx)("button",{onClick:function(){return u(null)},children:"Cancel"})]})]}),Object(v.jsx)("div",{className:"lyrics-list",children:t.map((function(e,n){return"@loading"===e.text?Object(v.jsx)(ia,{currentTime:r-t[n].startTime,timeSpan:t[n+1].startTime-t[n].startTime,id:n}):Object(v.jsx)("div",{className:"lyricsBlock "+(a===n&&"current"),onClick:function(){return e=n,t="@loading",void(l&&d("before"===l?e:e+1,t));var e,t},children:e.text})}))})]})},ua=H.a.div(ps||(ps=Object(U.a)(["\n  width: 100%;\n  max-width: 800px;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n\n  .song-image {\n    width: 300px;\n    height: 300px;\n    background-size: cover;\n    background-position: center center;\n    border-radius: var(--standartBorderRadius);\n  }\n"]))),da=function(e){var t=e.song,n=e.chooseSongItem,s=e.play;return Object(v.jsxs)(ua,{children:[Object(v.jsx)("div",{className:"song-image",style:{backgroundImage:"url(".concat(t.cover,")")}}),Object(v.jsxs)("div",{children:[Object(v.jsx)("h3",{children:t.name}),Object(v.jsx)("button",{onClick:function(e){e.stopPropagation(),n()},children:s?Object(v.jsx)(T.e,{}):Object(v.jsx)(T.f,{})})]})]})},ja=H.a.div(ms||(ms=Object(U.a)([""]))),ba=function(){return Object(v.jsx)(ja,{children:Object(v.jsx)("input",{type:"range",name:"",id:""})})},ha=Object(H.a)(tn)(gs||(gs=Object(U.a)(["\n  display: flex;\n  justify-content: center;\n  animation: zoomIn 0.5s forwards;\n  align-items: center;\n  height: 100%;\n  background: ",";\n\n  .lyrics-central-block {\n    display: flex;\n    flex-direction: column;\n    row-gap: 30px;\n  }\n\n  h2 {\n    margin: 0;\n  }\n\n  .image-and-lyrics {\n    display: flex;\n    align-items: center;\n  }\n"])),(function(e){var t=e.colors;return"linear-gradient(45deg, ".concat(t[2],", ").concat(t[3],");")})),fa=function(){var e=Object(s.useState)("3e35c47f-2186-4dea-a415-55616c525874"),t=Object(j.a)(e,2),n=t[0],a=(t[1],Object(s.useState)(null)),c=Object(j.a)(a,2),r=c[0],i=c[1],o=Object(s.useState)([{text:"@loading",startTime:0},{text:"Better",startTime:4.641579},{text:"Nothing, baby",startTime:5.640871},{startTime:6.639756,text:"Nothing feels better"},{text:"I'm not really drunk, I never get that fucked up",startTime:11.643213},{startTime:14.393152,text:"I'm not, I'm so sober"},{text:"Love to see you shine in the night like the diamond you are",startTime:19.133931},{text:"(Love to see you shine in the night like the diamond you are)",startTime:24.379689},{startTime:29.122152,text:"I'm good on the side, it's alright, just hold me in the dark"},{text:"(I'm good on the side, it's alright, just hold me in the dark)",startTime:34.127266},{startTime:38.618776,text:"No one's gotta know what we do, hit me up when you're bored"},{text:"(No one's gotta know what we do, hit me up when you're bored)",startTime:43.868394},{text:"'Cause I live down the street",startTime:48.354129},{text:"So we meet when you need and it's yours",startTime:50.614509},{startTime:55.110749,text:"All I hear is..."},{startTime:56.851265,text:"Nothing feels better than this"},{text:"Nothing feels better",startTime:58.856013},{text:"Nothing feels better than this",startTime:61.608338},{text:"Nothing feels better, oh no",startTime:64.60475},{startTime:68.105615,text:"We don't gotta hide, this is what you like"},{startTime:70.595909,text:"I'll admit"},{text:"Nothing feels better than this",startTime:76.091238},{text:"You say we're just friends but I swear when nobody's around",startTime:78.349369},{text:"(You say we're just friends but I swear when nobody's around)",startTime:82.837355},{startTime:87.08135,text:"You keep my hand around your neck, we connect, are you feeling it now?"},{text:"(You keep my hand around your neck, we connect, are you feeling it now?)",startTime:93.081081},{startTime:94.337571,text:"'Cause I am"},{startTime:96.827651,text:"I got so high the other night, I swear to God, felt my feet lift the ground"},{text:"(I got so high the other night, I swear to God I felt my feet lift the ground)",startTime:102.834804},{startTime:105.574461,text:"Ooh, yeah"},{text:"Your back against the wall, this is all you've been talking about",startTime:107.330933},{startTime:113.829185,text:"In my ears"},{text:"Nothing feels better than this",startTime:115.320862},{startTime:117.812132,text:"Nothing feels better"},{text:"Nothing feels better than this",startTime:120.314059},{startTime:122.816821,text:"Nothing feels better, oh no"},{text:"We don't gotta hide, this is what you like",startTime:127.069368},{startTime:131.308451,text:"I admit"},{startTime:134.80945,text:"Nothing feels better than this"},{text:"Now, left, right, left, right",startTime:136.557457},{text:"Take it back, bring it side to side",startTime:140.05821},{text:"Like that, like that, ayy",startTime:143.30038},{text:"Ooh, now, left, right, left, right",startTime:145.794779},{startTime:149.541102,text:"Take it back, bring it side to side"},{startTime:154.042133,text:"Like"},{text:"Nothing feels better than this",startTime:154.54181},{startTime:157.035804,text:"Nothing feels better"},{text:"Nothing feels better than this",startTime:159.541697},{startTime:162.036662,text:"Nothing feels better, oh no"},{startTime:166.282294,text:"We don't gotta hide, this is what you like"},{startTime:169.528565,text:"I admit"},{text:"Nothing feels better than this (Better than this)",startTime:174.275678},{text:"Nothing feels better than thi",startTime:"undefined"}]),l=Object(j.a)(o,2),u=l[0],d=l[1],b=Object(s.useState)(-1),h=Object(j.a)(b,2),f=h[0],O=h[1],p=le(),g=p.setCurrentSong,x=p.currentSong,y=p.play,S=p.songRef,w=p.setPlay,C=p.setCurrentSongInQueue,N=p.currentTime;console.log(u);var k=function(e){console.log(y),"Space"===e.code&&(y?f+1===0?(u[f+1].startTime=0,d(Object(W.a)(u)),O((function(e){return $(e+1,u.length-1)}))):(u[f+1].startTime=N,d(Object(W.a)(u)),O((function(e){return $(e+1,u.length-1)}))):I())};Object(s.useEffect)((function(){m.collection("songs").doc(n).get().then((function(e){i(e.data())}))}),[]),Object(s.useEffect)((function(){if(u)return document.addEventListener("keypress",k),function(){document.removeEventListener("keypress",k)}}),[u,y]);var I=function(){if(r){if(g(r.id),C(0),r.id===x&&y)return S.current.pause(),void w(!1);S.current.play(),w(!0)}};return r?Object(v.jsx)(ha,{colors:r.imageColors,onClick:k,children:Object(v.jsxs)("div",{className:"lyrics-central-block",children:[Object(v.jsxs)("div",{className:"image-and-lyrics",children:[Object(v.jsx)(da,{song:r,chooseSongItem:I,play:y}),Object(v.jsx)(la,{lyrics:u,setLyrics:d,currentParagraph:f,setCurrentParagraph:O,currentTime:N})]}),Object(v.jsx)(ba,{chooseSongItem:I})]})}):Object(v.jsx)(M,{})},Oa=(n(273),function(){var e=Object(o.g)();return Object(v.jsxs)("div",{className:"PageNotFound",children:[Object(v.jsx)("img",{loading:"lazy",src:"https://i.pinimg.com/originals/b2/3d/f6/b23df649311586e74a8455c92eb3d76b.png",alt:""}),Object(v.jsx)("h2",{children:"Page not found"}),Object(v.jsx)("button",{className:"standartButton",onClick:function(){return e.push("/library")},children:"Back to library"})]})}),pa=function(){var e=Object(s.useState)([]),t=Object(j.a)(e,2),n=t[0],a=t[1],c=Object(s.useState)([]),r=Object(j.a)(c,2),i=r[0],o=r[1],l=Object(s.useState)([]),b=Object(j.a)(l,2),h=b[0],f=b[1],O=S().currentUser;return Object(s.useEffect)((function(){m.collection("searchHistory").doc(O.uid).get().then((function(e){var t;(null===(t=e.data())||void 0===t?void 0:t.history)&&e.data().history.forEach(function(){var e=Object(d.a)(u.a.mark((function e(t){var n,s,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,s=t.type,e.next=3,m.collection(s).doc(n).get();case 3:c=e.sent.data(),e.t0=s,e.next="songs"===e.t0?7:"playlists"===e.t0?9:"users"===e.t0?11:13;break;case 7:return a((function(e){return[].concat(Object(W.a)(e),[c])})),e.abrupt("break",14);case 9:return o((function(e){return[].concat(Object(W.a)(e),[c])})),e.abrupt("break",14);case 11:return f((function(e){return[].concat(Object(W.a)(e),[c])})),e.abrupt("break",14);case 13:return e.abrupt("break",14);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}))}),[]),[n,i,h]},ma=function(){var e=S().searchValue,t=pa(),n=Object(j.a)(t,3),s=n[0],a=n[1],c=n[2];return e?null:Object(v.jsxs)("div",{className:"search-history",style:{animation:"zoomIn .2s forwards"},children:[Object(v.jsx)(It,{listOfSongs:s,source:{source:"/search",name:"Search",image:"https://www.pngkey.com/png/full/87-872187_lupa-search-icon-white-png.png",songsList:s},title:"Search history",showListens:!0,displayIfEmpty:"",isHorizontal:!0}),Object(v.jsx)(xn,{listOfAuthors:c}),Object(v.jsx)(hn,{listOfAlbums:a,loading:!1})]})},ga=(n(274),function(){var e=S(),t=e.searchValue,n=e.setSearchValue,a=Object(s.useState)([]),c=Object(j.a)(a,2),r=c[0],i=c[1],o=Object(s.useState)([]),l=Object(j.a)(o,2),u=l[0],d=l[1],b=Object(s.useState)([]),h=Object(j.a)(b,2),f=h[0],O=h[1],p=Object(s.useState)(""),m=Object(j.a)(p,2),g=m[0],x=m[1];return Object(s.useEffect)((function(){i([]),d([]),O([])}),[t]),Object(s.useEffect)((function(){0!==r.length?x(r[0].imageColors[0]+"a6"):0!==u.length?x(u[0].imageColors[0]+"a6"):0!==f.length?x(f[0].imageColors[0]+"a6"):x("")}),[r,u,f]),Object(v.jsx)("div",{className:"SearchPage",style:{animation:"zoomIn .2s forwards"},children:Object(v.jsxs)(tn,{children:[Object(v.jsx)(De,{value:t,setValue:n,allFoundSongs:r,setAllFoundSongs:i,setResultPlaylists:O,setResultAuthorList:d,focus:!0}),Object(v.jsx)(ma,{}),Object(v.jsx)(It,{listOfSongs:r,source:{source:"/search",name:"Search",image:"https://www.pngkey.com/png/full/87-872187_lupa-search-icon-white-png.png",songsList:r},title:"Songs",showListens:!0,saveSearchHistory:!0,displayIfEmpty:"",isHorizontal:!0}),Object(v.jsx)(xn,{listOfAuthors:u,title:"Authors",saveSearchHistory:!0}),Object(v.jsx)(hn,{listOfAlbums:f,title:"Albums and Playlists",loading:!1,saveSearchHistory:!0}),Object(v.jsx)("div",{className:"colorfullShadow",style:{background:g}})]})})}),xa=function(){return Object(v.jsx)("div",{children:"Account"})},va=function(e){var t=e.boolValue,n=e.setBoolValue;return Object(v.jsx)("div",{className:"SwitchToggle",onClick:function(){return n(!t)},children:Object(v.jsx)("div",{className:"switchInnerCircle",style:t?{transform:"translateX(100%)",background:"var(--green)"}:{}})})},ya=H.a.div(xs||(xs=Object(U.a)(['\n  width: 100%;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  cursor: pointer;\n  transition: 0.2s;\n  padding: 20px 50px;\n  box-sizing: border-box;\n  position: relative;\n\n  &::after {\n    content: "";\n    position: absolute;\n    width: 100%;\n    height: 2px;\n    bottom: 0;\n    left: 0%;\n    /* transform: translateX(-50%); */\n    background: #313131;\n  }\n\n  .icon-and-text {\n    display: flex;\n    align-items: center;\n    justify-content: flex-start;\n    user-select: none;\n\n    svg {\n      margin-right: 7px;\n      width: 20px;\n      height: 20px;\n    }\n  }\n\n  &:hover {\n    background: var(--leftSideBarColor);\n  }\n']))),Sa=function(e){var t=e.icon,n=e.text,a=e.action,c=Object(s.useState)(!1),r=Object(j.a)(c,2),i=r[0],o=r[1],l=function(e){o(e),e&&a&&a()};return Object(v.jsxs)(ya,{onClick:function(){return l(!i)},children:[Object(v.jsxs)("div",{className:"icon-and-text",children:[t,n]}),Object(v.jsx)(va,{boolValue:i,setBoolValue:l})]})},wa=function(){return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(Sa,{icon:Object(v.jsx)(je.c,{}),text:"\u0423\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f"}),Object(v.jsx)(Sa,{icon:Object(v.jsx)(je.c,{}),text:"\u0423\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f"}),Object(v.jsx)(Sa,{icon:Object(v.jsx)(je.c,{}),text:"\u0423\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f"}),Object(v.jsx)(Sa,{icon:Object(v.jsx)(je.c,{}),text:"\u0423\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f"}),Object(v.jsx)(Sa,{icon:Object(v.jsx)(je.c,{}),text:"\u0423\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f"})]})},Ca=function(){return Object(v.jsx)("div",{children:"Music"})},Na=H.a.div(vs||(vs=Object(U.a)(["\n  width: 85%;\n  height: 100px;\n  border-radius: 5px;\n"]))),ka=function(e){var t=e.currentPage,n=[Object(v.jsx)(xa,{}),Object(v.jsx)(Ca,{}),Object(v.jsx)(wa,{})];return Object(v.jsx)(Na,{children:n[t]})},Ia=H.a.button(ys||(ys=Object(U.a)(["\n  width: 100%;\n  display: flex;\n  align-items: center;\n  cursor: pointer;\n  /* transition: 0.1s; */\n  padding: 10px;\n  box-sizing: border-box;\n  background: ",";\n  color: #fff;\n  font-weight: 600;\n\n  svg {\n    margin-right: 7px;\n    width: 16px;\n    height: 16px;\n  }\n  /* \n  &:hover {\n    background: var(--leftSideBarColor);\n  } */\n"])),(function(e){return e.isActive?"var(--lightBlue)":"transparent"})),Aa=function(e){var t=e.icon,n=e.text,s=e.onClick,a=e.isActive;return Object(v.jsxs)(Ia,{onClick:s,isActive:a,children:[t,n]})},Pa=H.a.div(Ss||(Ss=Object(U.a)(["\n  width: 15%;\n  border-radius: 5px;\n  overflow: hidden;\n  background: var(--leftSideBarColor);\n"]))),La=function(e){var t=e.currentPage,n=e.setCurrentPage;return Object(v.jsxs)(Pa,{children:[Object(v.jsx)(Aa,{icon:Object(v.jsx)(je.E,{}),text:"Account",onClick:function(){return n(0)},isActive:0===t}),Object(v.jsx)(Aa,{icon:Object(v.jsx)(de.m,{}),text:"Music",onClick:function(){return n(1)},isActive:1===t}),Object(v.jsx)(Aa,{icon:Object(v.jsx)(je.s,{}),text:"Chat",onClick:function(){return n(2)},isActive:2===t}),Object(v.jsx)(Aa,{icon:Object(v.jsx)(de.m,{}),text:"Music",onClick:function(){return n(3)},isActive:3===t})]})},Ma=H.a.div(ws||(ws=Object(U.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: flex-start;\n"]))),Ta=function(){var e=Object(s.useState)(0),t=Object(j.a)(e,2),n=t[0],a=t[1];return Object(v.jsxs)(tn,{children:[Object(v.jsx)("h2",{children:"Settings"}),Object(v.jsxs)(Ma,{children:[Object(v.jsx)(La,{setCurrentPage:a,currentPage:n}),Object(v.jsx)(ka,{currentPage:n})]})]})},Ea=(n(275),[{path:C,Component:ra},{path:N,Component:function(){var e=Object(s.useState)(1),t=Object(j.a)(e,2),n=t[0],a=t[1],c=Object(s.useState)(""),r=Object(j.a)(c,2),o=r[0],l=r[1],b=Object(s.useState)(""),h=Object(j.a)(b,2),f=h[0],O=h[1],p=Object(s.useState)(""),m=Object(j.a)(p,2),g=m[0],x=m[1],y=Object(s.useState)(""),w=Object(j.a)(y,2),N=w[0],k=w[1],I=Object(s.useState)(!1),A=Object(j.a)(I,2),P=A[0],L=A[1],M=S().signup,T=Object(s.useState)(""),E=Object(j.a)(T,2),R=E[0],D=E[1],B=0!==o.length&&0!==f.length&&0!==g.length,F=Object(s.useState)(""),U=Object(j.a)(F,2),W=U[0],V=U[1],z=Object(s.useState)([]),H=Object(j.a)(z,2),Y=H[0],q=H[1];function Q(){return(Q=Object(d.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),B){e.next=3;break}return e.abrupt("return",k("One of your fields is totaly empty"));case 3:return e.next=5,M(o,g,f,n,R,Y,k,L);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(v.jsxs)("div",{className:"In-Up-Container",children:[Object(v.jsx)(Wt.a,{src:W,getColors:function(e){return q(e)}}),Object(v.jsxs)("div",{className:"CentralPlate",children:[Object(v.jsx)(yn,{loading:P}),Object(v.jsx)(sa,{title:"Sign Up"}),N&&Object(v.jsx)("div",{className:"Alert",children:N}),Object(v.jsxs)("div",{className:"inner-plate-content",children:[Object(v.jsx)(me,{type:"email",placeholder:"Enter your email",value:o,setValue:l,margin:!0}),Object(v.jsx)(me,{type:"text",placeholder:"Enter your name",value:g,setValue:x,margin:!0}),Object(v.jsx)(me,{type:"password",placeholder:"Create password",value:f,setValue:O,margin:!0}),Object(v.jsxs)("div",{style:{display:"flex",width:"100%",justifyContent:"center",margin:"5px 0 15px 0"},children:[Object(v.jsx)(Yt,{label:"User",onClick:function(){return a(0)},currentActive:n,id:0}),Object(v.jsx)(Yt,{label:"Author",onClick:function(){return a(1)},currentActive:n,id:1})]}),Object(v.jsx)(Ht,{text:"Download photo",place:"usersImages/",setItemSrc:D,setImageLocalPath:V}),Object(v.jsxs)("div",{className:"inAndUpBtns",children:[Object(v.jsx)("button",{className:"upBtn",type:"submit",disabled:P,onClick:function(e){return Q.apply(this,arguments)},children:"Sign Up"}),Object(v.jsx)(i.b,{to:C,children:Object(v.jsx)("button",{className:"inBtn",children:"Already registered"})})]})]})]}),Object(v.jsx)(ca,{})]})}}]),Ra=[{path:k,Component:Gs},{path:I,Component:na},{path:A,Component:ga},{path:P,Component:Wn},{path:"/not-found",Component:Oa},{path:"/chat/:chatId",Component:Us},{path:"/albums/:albumId",Component:nn},{path:"/authors/:authorId",Component:An},{path:L,Component:Ws},{path:"/settings",Component:Ta},{path:"/lyrics-editing",Component:fa}],Da=function(){return Object(v.jsxs)(o.d,{children:[Ra.map((function(e,t){var n=e.path,s=e.Component;return Object(v.jsx)(o.b,{path:n,component:s,exact:!0},n)})),Object(v.jsx)(o.a,{to:k})]})},Ba=function(){var e=re().bottomMessage,t=function(){switch(e.type){case"success":return{light:"#69e985",dark:"#12321ce6"};case"failure":return{light:"#f4546a",dark:"#581921d8"};default:return{light:"#69e985",dark:"#12321ce6"}}};return Object(v.jsxs)("div",{className:"bottom-message ".concat(e.isOpenned?"openned":""),style:{background:t().dark,color:t().light},children:[function(){switch(e.type){case"success":return Object(v.jsx)(T.g,{});case"failure":return Object(v.jsx)(T.h,{});default:return Object(v.jsx)(T.g,{})}}(),Object(v.jsx)("span",{children:e.message})]})},Fa=n.p+"static/media/notification.cdade1f4.mp3",Ua=H.a.div(Cs||(Cs=Object(U.a)(["\n  color: #fff;\n  padding: 20px;\n  box-sizing: border-box;\n  border-radius: var(--standartBorderRadius2);\n  background: #000000b9;\n  position: absolute;\n  bottom: 20px;\n  right: 20px;\n  transition: 0.2s;\n  transform: translateY(\n    ","\n  );\n  opacity: ",";\n  width: 250px;\n  height: 90px;\n\n  a {\n    text-decoration: none;\n  }\n\n  &:hover {\n    background: #1f1f1fb3;\n  }\n\n  .image-and-name {\n    display: flex;\n    justify-content: flex-start;\n    align-items: center;\n    font-weight: bold;\n\n    img {\n      width: 25px;\n      height: 25px;\n      border-radius: 100%;\n      margin-right: 7px;\n    }\n  }\n\n  .message {\n    margin-top: 10px;\n    display: flex;\n    white-space: nowrap;\n    overflow: hidden;\n  }\n"])),(function(e){var t=e.show,n=e.index;return t?"-".concat(90*n+10*n,"px"):"90px"}),(function(e){return e.show?"1":"0"})),Wa=function(e){var t=e.chatId,n=e.chatName,a=e.chatImage,c=e.message,r=e.userId,o=e.index,l=Object(s.useState)(null),u=Object(j.a)(l,2),d=u[0],b=u[1],h=Object(s.useState)(!1),f=Object(j.a)(h,2),O=f[0],p=f[1];return Object(s.useEffect)((function(){m.collection("users").doc(r).get().then((function(e){p(!0),new Audio(Fa).play(),b(e.data()),setTimeout((function(){p(!1)}),6e3)}))}),[]),Object(v.jsx)(Ua,{show:O,index:o,children:Object(v.jsxs)(i.b,{to:"/chat/".concat(t),children:[Object(v.jsxs)("div",{className:"image-and-name",children:[Object(v.jsx)("img",{src:(null===a||void 0===a?void 0:a.length)?a:null===d||void 0===d?void 0:d.photoURL,alt:""}),n.length?n:null===d||void 0===d?void 0:d.displayName]}),Object(v.jsx)("div",{className:"message",children:Object(v.jsx)(Tn,{sender:d,isGroup:n.length,message:c,messageLen:20})})]})})},Va=function(){var e=re(),t=e.isOpenConfirm,n=e.confirmContent,a=e.setIsOpenConfirm,c=Object(s.useRef)(null);return Re(c,a),Object(v.jsx)("div",{className:"modal_darkBg confirm",style:t?{}:{opacity:0,visibility:"hidden"},children:Object(v.jsxs)("div",{className:"ConfirmWindow",ref:c,style:t?{}:{transform:"translateY(40px)"},children:[Object(v.jsx)("h3",{children:n.question}),Object(v.jsxs)("div",{className:"confirmButtons",children:[Object(v.jsx)("button",{onClick:n.onConfirm,className:"standartButton",children:n.confirmText}),Object(v.jsx)("button",{onClick:n.onReject,className:"standartButton",children:n.rejectText})]})]})})},za=n(53),Ha=function(e){var t=e.el,n=e.index,a=e.lyricsModeratorMode,c=e.karaokeModeratorTimes,r=e.setKaraokeModeratorTimes,i=e.setInputKaraokeTime,o=e.inputKaraokeTime,l=le(),u=l.currentSongData,d=l.currentParagraph,j=(l.displayAuthors,l.changeCurrentTime),b=l.play,h=l.currentTime,f=l.currentParagraphRef,O=l.lyrics,p=Object(s.useRef)(),m=ds(d===n?f:p),g=d===n?{}:window.innerWidth>1e3?Math.abs(d-n)<2?{transform:"scale(.8) translateX(-58px)"}:{transform:"scale(.75) translateX(-78px)"}:Math.abs(d-n)<2?{transform:"scale(.8) translateX(-11.5%)"}:{transform:"scale(.75) translateX(-15.6%)"};function x(e,t){var n=c;if("down"===t)return n.splice(e+1,0,void 0),r(n),u.lyrics.splice(e+1,0,{startTime:"undefined",text:"@loading"});n.splice(e,0,void 0),r(n),u.lyrics.splice(e,0,{startTime:"undefined",text:"@loading"})}return Object(v.jsxs)("div",{className:"lyricsBlock "+(m?"":"notVisible"),id:n,onClick:function(e){return j(e,t.startTime)},style:b?d===n?{}:Math.abs(d-n)<2?{opacity:.5}:{opacity:.1}:{},ref:d===n?f:p,children:[1===a?Object(v.jsxs)("div",{className:"lyricsBlockInput",children:[Object(v.jsxs)("span",{onClick:function(e){return e.stopPropagation()},children:[void 0!==c[n]&&0!==c[n].length?Object(v.jsx)(de.b,{style:{background:"var(--themeColor3)",color:"var(--themeColor)"}}):Object(v.jsx)(je.J,{})," "]}),Object(v.jsx)("input",{type:"number",value:c[n]||o,onChange:function(e){return function(e,t){var n=c,s=e.target.value;n[t]=s,i(e.target.value),r(n)}(e,n)},onClick:function(e){return e.stopPropagation()}}),Object(v.jsxs)("div",{className:"addLyricsElementBtns",onClick:function(e){return e.stopPropagation()},children:[Object(v.jsx)("button",{onClick:function(){x(n,"up")},children:Object(v.jsx)(de.p,{})}),Object(v.jsx)("button",{onClick:function(){x(n,"down")},children:Object(v.jsx)(de.g,{})})]})]}):null,"@loading"===t.text?Object(v.jsx)(ia,{currentTime:h-O[n].startTime,timeSpan:O[n+1].startTime-O[n].startTime,id:n}):"@end"===t.text?Object(v.jsx)(v.Fragment,{}):Object(v.jsx)("p",{id:n,style:g,children:t.text},n)]},n)},Ya=[{id:0,icon:Object(v.jsx)(de.o,{}),title:"Share",component:function(){var e=le().currentSongData,t=[Object(v.jsx)(ge.c,{}),Object(v.jsx)(T.b,{}),Object(v.jsx)(T.i,{}),Object(v.jsx)(T.j,{}),Object(v.jsx)(Vt.a,{})];return Object(v.jsxs)("div",{className:"Share",children:[Object(v.jsxs)("button",{className:"shareCopyLink",children:[Object(v.jsx)(je.i,{}),"Copy link"]}),Object(v.jsx)("div",{className:"shareOnSocial",children:t.map((function(e,t){return Object(v.jsx)("div",{className:"shareSocialIcon",children:e},t)}))}),Object(v.jsx)("div",{className:"sharePeopleShort",children:Object(v.jsx)(it,{item:e,whatToShare:"song"})})]})}},{id:1,icon:Object(v.jsx)(de.f,{}),title:"More",component:function(){var e=le(),t=e.currentSongData,n=e.setRightSideCurrentPage;return Object(v.jsxs)("div",{className:"Options",children:[Object(v.jsx)("div",{className:"OptionItem",children:Object(v.jsx)(He,{song:t})}),Object(v.jsxs)("div",{className:"OptionItem",onClick:function(){return n(4)},children:[Object(v.jsx)(de.q,{}),"Go to author"]}),Object(v.jsxs)("div",{className:"OptionItem",onClick:function(){return n(5)},children:[Object(v.jsx)(be.c,{}),"Add to playlist"]}),Object(v.jsxs)("div",{className:"OptionItem",onClick:function(){return n(6)},children:[Object(v.jsx)(je.q,{}),"Info"]})]})}},{id:2,icon:Object(v.jsx)(za.c,{}),title:"Lyrics",component:function(){var e=le(),t=e.setIsThereKaraoke,n=e.currentSongData,a=e.setCurrentSongData,c=e.isThereKaraoke,r=e.currentParagraph,i=e.displayAuthors,o=e.currentParagraphRef,l=e.lyrics,u=e.rightSideCurrentPage,d=e.openFullScreenPlayer,b=e.openMenu,h=S().currentUser,f=Object(s.useState)(0),O=Object(j.a)(f,2),p=O[0],g=O[1],x=Object(s.useState)([]),y=Object(j.a)(x,2),w=y[0],C=y[1],N=Object(s.useState)(0),k=Object(j.a)(N,2),I=k[0],A=k[1],P=Object(s.useState)(!1),L=Object(j.a)(P,2),M=L[0],T=L[1];function E(e,t){var n=w,s=e.target.value;n[t]=s,g(e.target.value),C(n)}function R(e,t){var s=w;if("down"===t)return s.splice(e+1,0,void 0),C(s),n.lyrics.splice(e+1,0,{startTime:"undefined",text:"@loading"});s.splice(e,0,void 0),C(s),n.lyrics.splice(e,0,{startTime:"undefined",text:"@loading"})}return Object(s.useEffect)((function(){c&&b&&2===u&&d&&o.current.scrollIntoView()}),[r]),Object(s.useEffect)((function(){l&&"undefined"!==l[0].startTime&&(l.forEach((function(e){w.push(e.startTime)})),T(!0))}),[]),Object(s.useEffect)((function(){var e,s=n;void 0!==s&&0!==p&&(s.lyrics.forEach((function(e,t){e.startTime=w[t]||"undefined"})),a(s),t(!0)),(null===(e=n.lyrics)||void 0===e?void 0:e.some((function(e){return"undefined"===e.startTime})))?T(!1):T(!0)}),[p]),l?Object(v.jsxs)("div",{className:"Lyrics",children:[h.isAdmin?Object(v.jsx)(kn,{pages:["Listen mode","Edit Mode"],currentPage:I,setCurrentPage:A}):null,c?l.map((function(e,t){return Object(v.jsx)(Ha,{el:e,index:t,lyricsModeratorMode:I,karaokeModeratorTimes:w,setKaraokeModeratorTimes:C,setInputKaraokeTime:g,inputKaraokeTime:E})})):l.map((function(e,t){return Object(v.jsxs)("div",{className:"lyricsBlock",children:[1===I?Object(v.jsxs)("div",{className:"lyricsBlockInput",children:[void 0!==w[t]&&0!==w[t].length?Object(v.jsx)(de.b,{style:{background:"var(--themeColor3)",color:"var(--themeColor)"}}):Object(v.jsx)(je.J,{}),Object(v.jsx)("input",{type:"number",value:w[t]||p,onChange:function(e){return E(e,t)},onClick:function(e){return e.stopPropagation()}}),Object(v.jsxs)("div",{className:"addLyricsElementBtns",children:[Object(v.jsx)("button",{onClick:function(){return R(t,"up")},children:Object(v.jsx)(de.p,{})}),Object(v.jsx)("button",{onClick:function(){return R(t,"down")},children:Object(v.jsx)(de.g,{})})]})]}):null,Object(v.jsx)("p",{children:e.text})]},t)})),Object(v.jsxs)("h6",{className:"lyricsAuthors "+(r===l.length-1?"active":""),children:["Authors: ",i()]}),1===I?Object(v.jsx)("button",{onClick:M?function(){m.collection("songs").doc(n.id).update({lyrics:n.lyrics})}:null,className:"updateLyricsBtn",style:M?{}:{opacity:.3},children:"Update Lyrics"}):null]}):Object(v.jsx)("h3",{children:"No lyrics"})}},{id:3,icon:Object(v.jsx)(Hn.a,{}),title:"Queue",component:function(){var e=le(),t=e.currentSongQueue,n=e.currentSongPlaylistSource,s=e.setOpenFullScreenPlayer;return Object(v.jsxs)("div",{className:"Queue",children:[Object(v.jsx)("div",{className:"queueNowIsPlaying",children:Object(v.jsxs)("h5",{style:{marginTop:2},children:["Now is playing:",Object(v.jsxs)(i.b,{onClick:function(){return s(!1)},to:n.source,className:"queueAlbumName",children:[Object(v.jsx)("div",{className:"queueImage",style:n.image?{}:{display:"none"},children:Object(v.jsx)("img",{loading:"lazy",src:n.image,alt:""})}),Object(v.jsx)("span",{children:ht(n.name,25)})]})]})}),t.map((function(e,t){return Object(v.jsx)(Ct,{song:e,localIndex:t},t)}))]})}},{id:4,icon:null,title:"Go To Authors",component:xt},{id:5,icon:null,title:"Add to playlist",component:_e},{id:6,icon:null,title:"Info",component:ot}],qa=function(){var e=le(),t=e.imgColors,n=e.rightSideCurrentPage,c=e.setRightSideCurrentPage,r=e.setOpenFullScreenPlayer,i=e.lyrics,o=e.openMenu,l=e.setOpenMenu,u=Object(s.useRef)(null),d=Object(s.useState)(.05),b=Object(j.a)(d,2),h=b[0],f=b[1],O=Object(s.useState)(0),p=Object(j.a)(O,2),m=p[0],g=p[1],x=Object(s.useState)(0),y=Object(j.a)(x,2),S=y[0],w=y[1],C=Object(s.useState)(0),N=Object(j.a)(C,2),k=N[0],I=N[1],A=Object(s.useRef)(),P=a.a.useRef();Re(P,l);var L=Object(Ls.useSwipeable)({onSwiping:function(e){e.deltaY>0&&w(e.deltaY)}}),M=a.a.useRef(),T=Object(Ls.useSwipeable)({onSwiping:function(e){e.event.stopPropagation(),(o&&0===A.current.scrollTop&&e.deltaY>0||!o&&e.deltaY<0)&&I(e.deltaY)},onSwipedLeft:function(){c($(n+1,3))},onSwipedRight:function(){c($(n-1,3))}});Object(s.useEffect)((function(){S>150&&r(!1)}),[S]),Object(s.useEffect)((function(){!o&&k<-100?(l(!0),I(0),g(.2)):o&&k>150?(l(!1),I(0),g(.2)):function(){var e;clearTimeout(e),g(0),e=setTimeout((function(){g(.2),I(0)}),300)}()}),[k]);function E(){return i&&0===i.length}return Object(s.useEffect)((function(){0!==t.length&&(document.documentElement.style.setProperty("--themeColor",t[1]),document.documentElement.style.setProperty("--themeColor2",t[0]),document.documentElement.style.setProperty("--themeColor3",t[2]),document.documentElement.style.setProperty("--themeColor4",t[5]),document.documentElement.style.setProperty("--themeColorTransparent",t[0]+"6e"))}),[t]),{deltaY:S,transformTransition:h,refPassthroughBg:function(e){L.ref(e),M.current=e},handlers:L,returnToInitial:function(){var e;clearTimeout(e),f(.2),e=setTimeout((function(){w(0),f(0)}),100)},setOpenFullScreenPlayer:r,openMenu:o,setOpenMenu:l,rightSideCurrentPage:n,noLyrics:E,changeRightSidePage:function(e){if(2===e.id&&E())return null;g(.2),c(e.id),l(!0)},lyricsRef:u,rightSideContent:function(e){var t=Ya[e].component;return Object(v.jsx)(t,{})},handlersForMobileMenu:T,refPassthroughMobileMenu:function(e){T.ref(e),P.current=e},deltaYMobileMenu:k,mobileMenuTransition:m,mobileContentScroll:A}};function Qa(e){return e%10===e?"0"+e:e}function Ga(e){return Qa(Math.floor(e/60))+":"+Qa(Math.floor(e%60))}function Xa(e){var t="";return e.forEach((function(e){t+=e.displayName})),t.length}var Ja,Ka,_a=Object(s.memo)((function(e){var t=e.inputRef,n=e.textLimit,s=void 0===n?18:n,a=e.linkToAuthors,c=void 0===a||a,r=le(),i=r.currentSongData,o=r.currentTime,l=r.changeCurrentTime,u=r.songDuration,d=r.setRepeatMode,j=r.repeatMode,b=r.play,h=r.prevSong,f=r.playSong,O=r.nextSong,p=r.setShuffleMode,m=r.shuffleMode,g=r.displayAuthors,x=r.name,y=r.authors,S=r.cover,w=r.inputRange;return-1!==i.id?Object(v.jsxs)("div",{className:"player",children:[Object(v.jsxs)("div",{className:"playerUpperSide",children:[Object(v.jsx)("div",{className:"songCover",children:Object(v.jsx)("img",{loading:"lazy",src:S,alt:""})}),Object(v.jsxs)("div",{className:"nameAndAuthors",children:[Object(v.jsx)("h2",{title:x.length>s?x:null,style:{overflow:"hidden"},children:Object(v.jsx)("div",{style:x.length>s?{animation:"outSideText 17s infinite",whiteSpace:"nowrap"}:{},children:x})}),Object(v.jsx)("h3",{style:{overflow:"hidden"},title:y.map((function(e){return" "+e.displayName})),children:c?Object(v.jsx)("div",{style:Xa(i.authors)>s?{animation:"outSideText 17s infinite",whiteSpace:"nowrap"}:{},children:g()}):Object(v.jsx)("div",{children:ft(y," & ",33)})})]})]}),Object(v.jsxs)("div",{className:"controlPanel",children:[Object(v.jsx)("input",{type:"range",min:"0",ref:t,step:"1",value:o,onChange:function(e){l(e)},style:{background:"linear-gradient(to right, var(--themeColor2) ".concat(w,"%, #fff ").concat(w,"%)")}}),Object(v.jsxs)("div",{className:"startAndEndTime",children:[Object(v.jsx)("span",{children:Ga(o)}),Object(v.jsx)("span",{children:Ga(u)})]}),Object(v.jsxs)("div",{className:"btns",children:[Object(v.jsx)("button",{className:"shuffleBtn",onClick:function(){return p($(m+1,1))},style:m?{background:"var(--reallyTransparentWhite)"}:{},children:Object(v.jsx)(za.b,{style:m?{color:"var(--themeColor)"}:{}})}),Object(v.jsx)("button",{onClick:function(e){e.stopPropagation(),h()},children:Object(v.jsx)(T.a,{})}),Object(v.jsx)("button",{onClick:function(e){e.stopPropagation(),f()},children:b?Object(v.jsx)(T.e,{}):Object(v.jsx)(T.f,{})}),Object(v.jsx)("button",{onClick:function(e){e.stopPropagation(),O()},children:Object(v.jsx)(T.c,{})}),Object(v.jsxs)("button",{className:"repeatBtn",onClick:function(){return d($(j+1,2))},style:j?{background:"var(--reallyTransparentWhite)"}:{},children:[Object(v.jsx)(za.a,{style:j?{color:"var(--themeColor)"}:{}}),Object(v.jsx)("span",{style:2===j?{opacity:1}:{}})]}),Object(v.jsx)(bt,{play:b})]})]})]}):null})),$a=Object(s.memo)((function(){var e=le(),t=e.inputRef,n=e.openFullScreenPlayer,s=Ge(),a=s.isMobile,c=s.screenWidth,r=qa(),i=r.deltaY,o=r.transformTransition,l=r.refPassthroughBg,u=r.handlers,d=r.returnToInitial,j=r.setOpenFullScreenPlayer,b=r.openMenu,h=r.setOpenMenu,f=r.rightSideCurrentPage,O=r.noLyrics,p=r.changeRightSidePage,m=r.lyricsRef,g=r.rightSideContent,x=r.handlersForMobileMenu,y=r.refPassthroughMobileMenu,S=r.deltaYMobileMenu,w=r.mobileMenuTransition,C=r.mobileContentScroll;return Object(v.jsxs)("div",Object(B.a)(Object(B.a)({className:"bg",style:n?{top:0,opacity:1,visibility:"visible",zIndex:10,transform:"translateY(".concat(i,"px)"),borderRadius:"".concat(i<20?i:20,"px ").concat(i<20?i:20,"px 0 0"),transition:".4s opacity, ".concat(o,"s transform, .4s top, .4s visibility")}:{transform:"translateY(".concat(i,"px)"),transition:".4s opacity, ".concat(o,"s transform, .4s top, .4s visibility")},ref:l},u),{},{onTouchEnd:d,children:[Object(v.jsx)("div",{className:"closeFullScreen",onClick:function(){j(!1)},children:window.innerWidth>1e3?Object(v.jsx)(jt.a,{}):Object(v.jsx)(je.t,{style:{opacity:.6}})}),Object(v.jsxs)("div",{className:"FullScreenPlayer",children:[Object(v.jsx)("div",{className:"leftSide",style:b?a?{opacity:.6,visibility:"visible",transform:"translateY(20px)",borderRadius:"10px",transition:".4s"}:null:{width:"100%"},children:Object(v.jsx)(_a,{inputRef:t})}),c>1e3?Object(v.jsxs)("div",{className:"rightSideWrapper",style:b?{}:{transform:"translateX(calc(100% - 90px))",width:0},children:[Object(v.jsx)("button",{className:"menuBtn",style:b?{transform:"rotate(180deg)"}:{opacity:0,visibility:"hidden"},onClick:function(){return h(!b)},children:Object(v.jsx)(de.c,{})}),Object(v.jsx)("div",{className:"rightSideControl",children:Ya.map((function(e,t){return Object(v.jsx)("div",{className:"controlIcon",style:e.id===f&&b?{background:"var(--themeColor)"}:2===e.id&&O()?{opacity:.4}:{},onClick:function(){return p(e)},children:e.icon},e.id)}))}),Object(v.jsx)("div",{className:"rightSide",ref:m,style:b?{}:{display:"none"},children:g(f)})]}):Object(v.jsxs)("div",Object(B.a)(Object(B.a)({className:"mobilePlayerMenu"},x),{},{ref:y,style:b?{top:"calc(100% - calc(70vh + 55px) + ".concat(S,"px)"),transition:"".concat(w,"s")}:{top:"calc(100% - 55px + ".concat(S,"px)"),transition:"".concat(w,"s")},children:[Object(v.jsx)("div",{className:"mobilePlayerMenuClose",children:Object(v.jsx)(je.t,{style:{opacity:.6,width:"50px"},onClick:function(){return h(!b)}})}),Object(v.jsx)("div",{className:"controlIconsWrapper",children:Ya.map((function(e,t){if(t<=3)return Object(v.jsx)("div",{className:"controlIcon",style:e.id===f&&b?{background:"var(--transparentWhite)"}:2===e.id&&O()?{opacity:.4}:{},onClick:function(t){return p(e)},children:e.title},e.id)}))}),Object(v.jsx)("div",{className:"mobilePlayerMenuContent",ref:C,style:b?{}:{opacity:0},children:g(f)})]}))]})]}))})),Za=(n(276),[{id:0,icon:Object(v.jsx)(je.o,{}),title:"Home",link:k},{id:1,icon:Object(v.jsx)(de.m,{}),title:"Library",link:I},{id:2,icon:Object(v.jsx)(de.n,{}),title:"Search",link:A},{id:3,icon:Object(v.jsx)(je.s,{}),title:"Chat",link:P}]),ec=H.a.div(Ja||(Ja=Object(U.a)(["\n  border-radius: 100%;\n  width: 20px;\n  height: 20px;\n  font-size: 0.7em;\n  background: var(--red);\n  color: #fff;\n  font-weight: bold;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  position: absolute;\n  top: 50%;\n  right: 10px;\n  transform: translateY(-50%);\n"]))),tc=function(e){var t=e.value;return!!t&&Object(v.jsx)(ec,{className:"notification-circle",children:Ot(t)})},nc=H.a.div(Ka||(Ka=Object(U.a)(["\n  width: 100%;\n  border-radius: var(--standartBorderRadius);\n  background: var(--navItemColor);\n  color: #fff;\n  font-weight: bold;\n  min-height: 40px;\n  padding: 0.4px 5px;\n  box-sizing: border-box;\n  scroll-snap-type: y mandatory;\n  transition: 0.2s height;\n  position: relative;\n\n  &:hover {\n    a {\n      text-decoration: none;\n    }\n  }\n\n  .personName {\n    white-space: nowrap;\n    text-overflow: ellipsis;\n  }\n"]))),sc=function(){var e=S().currentUser,t=Object(s.useState)(0),n=Object(j.a)(t,2),a=n[0],c=n[1];return Object(s.useEffect)((function(){var t=m.collection("chats").where("participants","array-contains",e.uid).onSnapshot((function(t){c(0),t.docs.map((function(t){var n=t.data();c((function(t){return t+En(n.messages,e)}))}))}));return function(){t()}}),[]),a};function ac(e){var t=e.id,n=e.title,s=e.icon,a=e.link,c=e.currentPage,r=e.setCurrentPage,o=e.notificationValue;return Object(v.jsx)(i.b,{to:a,children:Object(v.jsxs)("div",{className:"NavigationItem "+(t===c?"active":""),onClick:function(){return r(t)},children:[Object(v.jsx)("div",{className:"icon",children:s}),Object(v.jsx)("b",{children:n}),Object(v.jsx)(tc,{value:o})]})})}var cc,rc=function(e){var t=e.currentPage,n=e.setCurrentPage,s=Object(j.a)(Za,4),a=s[0],c=s[1],r=s[2],i=s[3],o=sc();return Object(v.jsxs)("div",{className:"NavigationPanel",children:[Object(v.jsx)(ac,{id:a.id,title:a.title,icon:a.icon,link:a.link,currentPage:t,setCurrentPage:n},0),Object(v.jsx)(ac,{id:c.id,title:c.title,icon:c.icon,link:c.link,currentPage:t,setCurrentPage:n},1),Object(v.jsx)(ac,{id:r.id,title:r.title,icon:r.icon,link:r.link,currentPage:t,setCurrentPage:n},2),Object(v.jsx)(ac,{id:i.id,title:i.title,icon:i.icon,link:i.link,currentPage:t,setCurrentPage:n,notificationValue:o},3)]})},ic=H.a.div(cc||(cc=Object(U.a)(['\n  width: 10px;\n  height: 10px;\n  background: var(--red);\n  box-shadow: 0 0 10px var(--red);\n  border-radius: 100%;\n  position: relative;\n\n  @keyframes waveAnimation {\n    0% {\n      opacity: 0;\n      transform: scale(0.95);\n    }\n    60% {\n      opacity: 0.5;\n      transform: scale(2);\n    }\n    100% {\n      opacity: 0;\n      transform: scale(0.95);\n    }\n  }\n\n  &::after {\n    content: "";\n    width: 10px;\n    height: 10px;\n    background: var(--red);\n    filter: brightness(0.3);\n    border-radius: 100%;\n    animation: waveAnimation 1.5s infinite;\n    position: absolute;\n    top: 0;\n    left: 0;\n    z-index: -1;\n  }\n']))),oc=function(){return Object(v.jsx)(ic,{})},lc=function(e){var t=e.index,n=e.friend,a=S().currentUser,c=re().openBottomMessage,r=Object(s.useState)(0),o=Object(j.a)(r,2),l=o[0],u=o[1],d=Object(s.useState)(!1),b=Object(j.a)(d,2),h=b[0],f=b[1],O=Object(s.useState)(""),p=Object(j.a)(O,2),m=p[0],g=p[1],x=le(),y=x.currentSong,w=x.currentSongData,C=Object(s.useState)(!1),N=Object(j.a)(C,2),k=N[0],I=N[1],A=Rn(n.uid),P=Et(n),L=Object(j.a)(P,2),M=L[0],T=L[1];return Object(s.useEffect)((function(){at([n.uid],a,f,u)}),[]),Object(s.useEffect)((function(){(null===m||void 0===m?void 0:m.length)>0&&(I(!0),setTimeout((function(){g(""),I(!1)}),600))}),[m]),Object(v.jsxs)("div",{className:"person",id:n.uid,children:[Object(v.jsx)("img",{loading:"lazy",src:w.cover,alt:"",className:"sendSongImage "+m}),Object(v.jsxs)("div",{className:"personBtns",children:[Object(v.jsx)(i.b,{to:"/chat/".concat(l),children:Object(v.jsxs)("button",{onClick:function(){h&&st([a.uid,n.uid],l)},children:[Object(v.jsx)(Je,{text:"chat"}),Object(v.jsx)(je.s,{})]})}),Object(v.jsxs)("button",{onClick:T,children:[Object(v.jsx)(Je,{text:A?ht("".concat(null===M||void 0===M?void 0:M.name," | ").concat(null===M||void 0===M?void 0:M.authors[0].displayName)||"No song data",20):"last listened song"}),A?Object(v.jsx)(oc,{}):Object(v.jsx)(je.w,{})]}),Object(v.jsxs)("button",{onClick:function(){k||(rt({shareList:[n.uid],currentUser:a,itemId:y,whatToShare:"song",setShouldCreate:f,setFriendChatId:u}),g("sendAnimation"),c("".concat(w.name," was sent to ").concat(n.displayName)))},children:[Object(v.jsx)(Je,{text:"share"}),Object(v.jsx)(de.o,{})]})]}),Object(v.jsx)(i.b,{className:"personImg",to:"/authors/".concat(n.uid),children:Object(v.jsx)("img",{loading:"lazy",src:n.photoURL,alt:""})}),Object(v.jsx)(Dn,{userUID:n.uid}),Object(v.jsx)("div",{className:"personName",style:{pointerEvents:"none"},children:ht(n.displayName,12)})]},t)},uc=function(e){var t=e.playlist,n=re(),a=n.toggleModal,c=n.setContent,r=Object(s.useState)([]),l=Object(j.a)(r,2),u=l[0],d=l[1],b=jn(t,u,d),h=qe(t),f=Object(j.a)(h,2),O=f[0],p=f[1],m=S().currentUser,g=Object(o.g)();return Object(v.jsxs)("div",{className:"TinyPlaylist",children:[Object(v.jsxs)("div",{className:"TinyPlaylistBtns",children:[t.authors.find((function(e){return e.uid===m.uid}))?Object(v.jsx)("button",{onClick:O,children:p?Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(Je,{text:"remove song"}),Object(v.jsx)(je.d,{})]}):Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(Je,{text:"add song"}),Object(v.jsx)(je.z,{})]})}):Object(v.jsxs)("button",{onClick:function(){a(),c(Object(v.jsx)(it,{item:t,whatToShare:"playlist"}))},children:[Object(v.jsx)(Je,{text:"share"}),Object(v.jsx)(je.C,{})]}),Object(v.jsx)(i.b,{to:"/albums/".concat(t.id),children:Object(v.jsxs)("button",{children:[Object(v.jsx)(Je,{text:"album"}),Object(v.jsx)(de.a,{})]})}),Object(v.jsxs)("button",{onClick:b,children:[Object(v.jsx)(Je,{text:"play"}),Object(v.jsx)(je.x,{})]})]}),Object(v.jsx)("div",{className:"TinyPlaylistImg",style:{backgroundImage:"url(".concat(t.image,")"),display:"inline-block",backgroundPosition:"center center",backgroundSize:"cover",position:"relative"},onClick:function(){return g.push("/albums/".concat(t.id))},children:t.image?null:Object(v.jsx)(de.a,{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",width:"20px",height:"20px"}})}),Object(v.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[Object(v.jsx)("span",{children:ht(t.name,12)}),Object(v.jsx)("span",{style:{fontSize:"0.8em",color:"grey",fontWeight:"500"},children:t.isAlbum?"album":"playlist"})]})]})},dc=(n(277),Object(s.memo)((function(){var e=S().currentUser,t=Object(s.useState)(0),n=Object(j.a)(t,2),a=n[0],c=n[1],r=le(),o=r.leftSideBarInputRef,l=r.setOpenFullScreenPlayer,u=r.currentSongData,d=r.yourFriends,b=r.yourPlaylists,h=re(),f=h.toggleModal,O=h.setContent,p=Object(s.useState)(0),m=Object(j.a)(p,2),x=m[0],y=m[1],w=Object(s.useState)((function(){var e=Za.find((function(e,t){return!!window.location.hash.includes(g(e.title))}));return void 0===e?-1:e.id})),C=Object(j.a)(w,2),N=C[0],k=C[1];return Object(s.useEffect)((function(){c(e.friends.reduce((function(e,t){return"requested"===t.status?e+1:e}),0))}),[JSON.stringify(e.friends)]),Object(v.jsxs)("div",{className:"LeftsideBar",children:[Object(v.jsxs)("div",{className:"logo",children:[Object(v.jsx)("img",{loading:"lazy",src:E,alt:""}),Object(v.jsx)("h3",{children:"Soundbubble"})]}),Object(v.jsx)(nc,{onClick:function(){return k(-1)},children:Object(v.jsx)(i.b,{to:"/authors/".concat(e.uid),children:Object(v.jsxs)("div",{className:"person",style:-1===N?{background:"var(--blue)"}:{},children:[Object(v.jsx)(tc,{value:a}),Object(v.jsx)("div",{className:"personImg",style:{backgroundImage:"url(".concat(e.photoURL,")")}}),Object(v.jsx)("div",{className:"personName",children:ht(e.displayName,11)})]})})}),Object(v.jsx)(rc,{currentPage:N,setCurrentPage:k}),Object(v.jsxs)(nc,{className:"leftSideBarContainer friendsAndPlaylists",children:[Object(v.jsx)("span",{style:{display:x?"none":"block",animation:"scrollFromBottom .2s forwards"},children:d.length>0?Object(v.jsxs)(v.Fragment,{children:[d.map((function(e,t){return t<=2?Object(v.jsx)(lc,{index:e.uid,friend:e}):null})),Object(v.jsx)("h4",{className:"seeMoreBtn",onClick:function(){f(),O(Object(v.jsx)(it,{item:u,whatToShare:"song"}))},children:"See more"})]}):Object(v.jsx)("h4",{style:{alignSelf:"center",width:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:"No friends added"})}),Object(v.jsxs)("span",{style:{display:x?"block":"none",animation:"scrollFromTop .2s forwards"},children:[b.slice(0,3).map((function(e,t){return Object(v.jsx)(uc,{playlist:e},e.id)})),Object(v.jsxs)("button",{className:"createPlaylistBtn",onClick:function(){f(),O(Object(v.jsx)(Cn,{}))},style:{margin:"5px 0"},children:[Object(v.jsx)(de.i,{}),"Create Playlist"]})]}),Object(v.jsxs)("div",{className:"upAndDownBtns",children:[Object(v.jsx)("button",{onClick:function(){return y(0)},style:x?{}:{opacity:"0.3"},children:Object(v.jsx)(je.h,{})}),Object(v.jsx)("button",{onClick:function(){return y(1)},style:x?{opacity:"0.3"}:{},children:Object(v.jsx)(je.e,{})})]})]}),Object(v.jsx)("div",{className:"leftSideBarContainer",children:-1===u.id?null:Object(v.jsxs)("div",{className:"littlePlayer",children:[Object(v.jsx)(_a,{textLimit:15,inputRef:o}),Object(v.jsx)("div",{className:"fullScreenBtn",onClick:function(){return l(!0)},children:Object(v.jsx)(de.j,{})})]})})]})}))),jc=(n(278),function(e){var t=e.element,n=e.currentPage,s=e.setCurrentPage;return Object(v.jsx)(i.b,{to:t.link,className:"MobileControlBarItem",onClick:function(){return s(t.id)},style:t.id===n?{}:{opacity:.4},children:t.icon})}),bc=function(){var e=S().currentUser,t={icon:Object(v.jsx)(de.q,{}),link:"/authors/".concat(e.uid)},n=Object(s.useState)((function(){var e=Za.find((function(e,t){return!!window.location.hash.includes(g(e.title))}));return void 0===e?0:e.id})),a=Object(j.a)(n,2),c=a[0],r=a[1];return Object(v.jsxs)("div",{className:"BottomControlBar",children:[Za.map((function(e,t){return Object(v.jsx)(jc,{element:e,currentPage:c,setCurrentPage:r},t)})),Object(v.jsx)(jc,{element:t,currentPage:c,setCurrentPage:r})]})},hc=function(){var e=le(),t=e.setOpenFullScreenPlayer,n=e.inputRange;return Object(v.jsxs)("div",{className:"FullBottomSide",children:[Object(v.jsxs)("span",{onClick:function(){return t(!0)},style:{display:"block",position:"relative"},children:[Object(v.jsx)(_a,{textLimit:25,linkToAuthors:!1}),Object(v.jsx)("span",{className:"mobileSongRange",style:{width:n+"%"}})]}),Object(v.jsx)(bc,{})]})},fc=function(e){var t=Object.assign({},e),n=re(),a=n.openModal,c=n.setOpenModal,r=n.content,i=Object(s.useRef)(null),o=Ge().screenHeight;return Re(i,c),Object(v.jsx)("div",{className:"modal_darkBg",style:a?{height:o}:{opacity:0,visibility:"hidden"},children:Object(v.jsx)("div",Object(B.a)(Object(B.a)({className:"ModalWindow"},t),{},{ref:i,style:a?{}:{opacity:0,visibility:"hidden",transform:"translateY(40px)"},children:r}))})},Oc=function(){var e,t=Object(s.useState)([]),n=Object(j.a)(t,2),a=n[0],c=n[1],r=S().currentUser,i=Object(o.h)("/chat/:chatId"),l=null===i||void 0===i||null===(e=i.params)||void 0===e?void 0:e.chatId;return Object(s.useEffect)((function(){var e={},t=m.collection("chats").where("participants","array-contains",r.uid).onSnapshot((function(t){c((function(n){var s=Object(W.a)(n);return t.docChanges().map(function(){var t=Object(d.a)(u.a.mark((function t(n){var a,c,i,o,d,j;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=n.doc.data(),l!==a.id&&("added"===n.type?e[a.id]=a.messages.length:"modified"===n.type&&a.messages.length&&e[a.id]&&a.messages.length!==e[a.id]&&(c=a.id,i=a.chatName,o=a.chatImage,d=a.messages,j=d[d.length-1],j.sender!==r.uid&&!j.seenBy.includes(r.uid)&&(s.push({chatId:c,chatName:i,chatImage:o,message:d[d.length-1],userId:d[d.length-1].sender}),e[c]+=1)));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),s}))}));return function(){t()}}),[l]),Object(s.useEffect)((function(){var e;if(a.length)return e=setTimeout((function(){c((function(e){return e.slice(1,e.length)}))}),6200),function(){return clearTimeout(e)}}),[a.length]),[a,c]},pc=function(){var e=le(),t=e.currentSongData,n=e.currentSongPlaylistSource,a=e.nextSong,c=e.prevSong,r=e.songRef,i=e.setPlay,o=function(){navigator.mediaSession.setPositionState({duration:r.current.duration,playbackRate:r.current.playbackRate,position:r.current.currentTime})};function l(){r.current.pause(),i(!1)}Object(s.useEffect)((function(){"mediaSession"in navigator&&-1!==t.id&&(navigator.mediaSession.metadata=new window.MediaMetadata({title:t.name,artist:ft(t.authors),album:n.name,artwork:[{src:t.cover,sizes:"512x512",type:"image/png"}]}),navigator.mediaSession.setActionHandler("play",(function(){r.current.play(),i(!0)})),navigator.mediaSession.setActionHandler("pause",l),navigator.mediaSession.setActionHandler("stop",l),navigator.mediaSession.setActionHandler("nexttrack",(function(){a(),o()})),navigator.mediaSession.setActionHandler("previoustrack",(function(){c(),o()})))}),[t.id])},mc=function(){var e=S().currentUser,t=Object(s.useMemo)((function(){return 3e5}),[]),n=function(){m.collection("users").doc(e.uid).update({online:(new Date).getTime()})};Object(s.useEffect)((function(){var e=setInterval((function(){n()}),t);return function(){return clearInterval(e)}}),[]),Object(s.useEffect)((function(){n()}),[])},gc=function(){var e=le(),t=e.songRef,n=e.loadSongData,a=e.playing,c=e.songSrc,r=e.openFullScreenPlayer,i=e.repeatMode,o=e.setPlay,l=e.prevSong,b=e.currentSongQueue,h=e.nextSong,f=Ge(),O=f.isMobile,p=f.screenHeight,g=Oc(),x=Object(j.a)(g,2),y=x[0],S=x[1];pc(),mc();var w=function(){var e=Object(s.useRef)(),t=le(),n=t.currentSongData,a=t.currentSongPlaylistSource,c=t.songDuration,r=t.play;function i(){-1!==n.id&&(e.current=setTimeout(Object(d.a)(u.a.mark((function e(){var t,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("songs").doc(n.id).get();case 2:t=e.sent.data().listens,++t,m.collection("songs").doc(n.id).update({listens:t}),"albums"===a.source.substr(1,6)&&(s=a.source.substr(8,a.source.length-8),m.collection("playlists").doc(s).get().then((function(e){var t=e.data().listens;t++,m.collection("playlists").doc(s).update({listens:t})}))),n.authors.forEach(function(){var e=Object(d.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(t.uid).get();case 2:n=e.sent.data().numberOfListenersPerMonth,++n,m.collection("users").doc(t.uid).update({numberOfListenersPerMonth:n});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 7:case"end":return e.stop()}}),e)}))),1e3*c*.5))}return Object(s.useEffect)((function(){clearTimeout(e.current),r&&i()}),[r,n.id,c]),i}();return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)("audio",{src:c,ref:t,onLoadedData:n,onTimeUpdate:a,onEnded:function(){return 0===i?(t.current.pause(),o(!1),l()):1===i?1===b.length?(l(),w(),t.current.play()):h():(l(),w(),void t.current.play())}}),Object(v.jsxs)("div",{className:"Wrapper "+(r?"turnedOff":""),style:O?{height:p}:{height:"100vh"},children:[O?"chat"===window.location.hash.substr(2,4)&&window.location.hash.length>6?null:Object(v.jsx)(hc,{}):Object(v.jsx)(dc,{}),Object(v.jsx)("div",{className:"Content",children:Object(v.jsx)(Da,{})}),Object(v.jsx)(Ba,{}),Object(v.jsx)(fc,{}),Object(v.jsx)(Va,{}),y.map((function(e,t){return Object(v.jsx)(Wa,Object(B.a)(Object(B.a)({},e),{},{index:t,notifsLen:y.length,setNotifications:S}))}))]}),Object(v.jsx)($a,{})]})},xc=function(){return S().currentUser.uid?Object(v.jsx)(o.d,{children:Object(v.jsx)(o.b,{path:"/",component:gc})}):Object(v.jsxs)(o.d,{children:[Ea.map((function(e,t){var n=e.path,s=e.Component;return Object(v.jsx)(o.b,{path:n,component:s,exact:!0},t)})),Object(v.jsx)(o.a,{to:C})]})};function vc(){return Object(v.jsx)(i.a,{basename:"/",children:Object(v.jsx)(xc,{})})}r.a.render(Object(v.jsx)(a.a.StrictMode,{children:Object(v.jsx)(Xe,{children:Object(v.jsx)(w,{children:Object(v.jsx)(ie,{children:Object(v.jsx)(ue,{children:Object(v.jsx)(vc,{})})})})})}),document.getElementById("root"))},92:function(e,t,n){}},[[279,1,2]]]);
//# sourceMappingURL=main.5cdeffca.chunk.js.map