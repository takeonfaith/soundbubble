(this.webpackJsonpsoundbubble=this.webpackJsonpsoundbubble||[]).push([[0],{260:function(e,t,n){},261:function(e,t,n){},262:function(e,t,n){},263:function(e,t,n){},264:function(e,t,n){},265:function(e,t,n){},266:function(e,t,n){},267:function(e,t,n){},268:function(e,t,n){},269:function(e,t,n){},270:function(e,t,n){"use strict";n.r(t);var s=n(2),c=n.n(s),a=n(116),r=n.n(a),i=(n(84),n(12)),o=n(14),u=n(5),l=n(6),d=n.n(l),j=n(9),b=n(7),h=n.p+"static/media/Logo3.fc53f4ac.svg",f=n(1),O=function(){return Object(f.jsx)("div",{className:"LoadingData",children:Object(f.jsx)("img",{src:h,alt:""})})},p=n(27),m=n(122),x=n(32),g=function(e){var t=e.listOfChosenItems,n=e.setListOfChosenItems,s=e.itemId;return void 0!==t?Object(f.jsx)("div",{onClick:function(e){return e.preventDefault()},children:t.includes(s)?Object(f.jsx)("button",{type:"button",onClick:function(e){var c=t.filter((function(e){return e!==s}));n(c)},className:"addToListBtn",children:Object(f.jsx)(x.b,{style:{color:"var(--lightBlue)"}})}):Object(f.jsx)("button",{type:"button",onClick:function(){return n((function(e){return[].concat(Object(j.a)(e),[s])}))},className:"addToListBtn",children:Object(f.jsx)(x.d,{})})}):null},v=function(e){var t=e.data,n=e.chosenArray,s=e.setChosenArray,c=Object(m.a)(e,["data","chosenArray","setChosenArray"]);return Object(f.jsxs)("div",Object(p.a)(Object(p.a)({className:"person"},c),{},{children:[Object(f.jsx)(g,{listOfChosenItems:n,setListOfChosenItems:s,itemId:t.uid}),Object(f.jsx)("div",{className:"pesronImg",children:Object(f.jsx)("img",{src:t.photoURL,alt:""})}),Object(f.jsx)("div",{className:"personName",children:t.displayName})]}))},y=n(117);n(129),n(130),n(131);var S=y.a.initializeApp({apiKey:"AIzaSyBuDoETyUrO2RCDAlFMsW2uV-QmtCT8t6Y",authDomain:"soundbubble-27737.firebaseapp.com",projectId:"soundbubble-27737",storageBucket:"soundbubble-27737.appspot.com",messagingSenderId:"527274299416",appId:"1:527274299416:web:64b1ac2d05f4262df0736d",measurementId:"G-9TP9PEEV11"}),w=S.auth(),N=S.storage(),C=S.firestore();function k(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e>t?n:e<n?t:e}function I(e){for(var t=[],n=new Array(e.length),s=0;s<e.length;){var c=Math.floor(Math.random()*e.length);t.includes(c)||(t.push(c),n[c]=e[s],s++)}return n}var A=function(e,t,n,c){Object(s.useEffect)((function(){e.uid&&(n&&t())}),c)},P=n(121);function L(e){return e.replace(/\s/g,"").replace(/[,'._/]/g,"").replace(/-/g,"").toLowerCase()}var T=function(e){for(var t=[],n=L(e),s=1;s<n.length+1;s++)t.push(n.substr(0,s));return t},E=c.a.createContext(),M=function(){return Object(s.useContext)(E)},R=function(e){var t=e.children,n=Object(s.useState)({}),c=Object(u.a)(n,2),a=c[0],r=c[1],i=Object(s.useState)(null),o=Object(u.a)(i,2),l=o[0],j=o[1],h=Object(s.useState)(!0),O=Object(u.a)(h,2),p=O[0],m=O[1];Object(s.useEffect)((function(){if(null!==l)return C.collection("users").doc(l).onSnapshot((function(e){e.data()&&void 0===a.uid&&r(e.data())}))}),[C,l]),Object(s.useEffect)((function(){return w.onAuthStateChanged(function(){var e=Object(b.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t?j(t.uid):(j(null),r({}),m(!1));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]);var x={currentUser:a,setCurrentUser:r,login:function(e,t,n,s){return s(!0),w.signInWithEmailAndPassword(e,t).then().catch((function(e){n(e.message),s(!1)}))},signup:function(e,t,n,s,c,a,r,i){return i(!0),w.createUserWithEmailAndPassword(e,n).then((function(e){C.collection("users").doc(e.user.uid).set({uid:e.user.uid,displayName:t,photoURL:c||"https://images.fineartamerica.com/images/artworkimages/mediumlarge/1/music-icon-mohammed-jabir-ap.jpg",isAuthor:1===parseInt(s),isVerified:1===parseInt(s),numberOfListenersPerMonth:0,ownSongs:[],ownPlaylists:[],addedSongs:[],addedPlaylists:[],addedAuthors:[],lastSongPlayed:"",chats:[],friends:[],subscribers:0,regDate:P.a.firestore.FieldValue.serverTimestamp(),imageColors:a}),C.collection("search").doc(e.user.uid).set({place:"users",uid:e.user.uid,variantsOfName:T(t)}),i(!1)})).catch((function(e){r(e.message)}))},logout:function(){return w.signOut()},loading:p,setLoading:m};return Object(f.jsx)(E.Provider,{value:x,children:t})},B=Object(s.createContext)(null),D=function(){return Object(s.useContext)(B)},U=function(e){var t=e.children,n=M(),c=n.currentUser,a=n.loading,r=n.setLoading,o=Object(s.useState)([]),l=Object(u.a)(o,2),h=l[0],p=l[1],m=Object(s.useState)([]),x=Object(u.a)(m,2),g=x[0],y=x[1],S=Object(s.useState)([]),w=Object(u.a)(S,2),N=w[0],P=w[1],L=Object(s.useState)([]),T=Object(u.a)(L,2),E=T[0],R=T[1],D=Object(s.useState)([]),U=Object(u.a)(D,2),W=U[0],F=U[1],H=Object(s.useState)(-1),Y=Object(u.a)(H,2),K=Y[0],V=Y[1],z=Object(s.useState)(0),Q=Object(u.a)(z,2),q=Q[0],G=Q[1],X=Object(s.useState)({}),J=Object(u.a)(X,2),_=J[0],Z=J[1],$=Object(s.useState)({id:-1}),ee=Object(u.a)($,2),te=ee[0],ne=ee[1],se=Object(s.useState)([]),ce=Object(u.a)(se,2),ae=ce[0],re=ce[1],ie=Object(s.useState)(!1),oe=Object(u.a)(ie,2),ue=oe[0],le=oe[1],de=Object(s.useState)(0),je=Object(u.a)(de,2),be=je[0],he=je[1],fe=Object(s.useState)(0),Oe=Object(u.a)(fe,2),pe=Oe[0],me=Oe[1],xe=Object(s.useState)(1),ge=Object(u.a)(xe,2),ve=ge[0],ye=ge[1],Se=Object(s.useState)(0),we=Object(u.a)(Se,2),Ne=we[0],Ce=we[1],ke=Object(s.useState)(0),Ie=Object(u.a)(ke,2),Ae=Ie[0],Pe=Ie[1],Le=Object(s.useState)(!0),Te=Object(u.a)(Le,2),Ee=Te[0],Me=Te[1],Re=Object(s.useState)(!1),Be=Object(u.a)(Re,2),De=Be[0],Ue=Be[1],We=Object(s.useRef)(null),Fe=Object(s.useRef)(null),He=Object(s.useRef)(null),Ye=Object(s.useRef)(null),Ke=Object(s.useState)(0),Ve=Object(u.a)(Ke,2),ze=Ve[0],Qe=Ve[1],qe=Object(s.useState)(!1),Ge=Object(u.a)(qe,2),Xe=Ge[0],Je=Ge[1];function _e(){return(void 0===te.lyrics||0!==te.lyrics.length)&&(void 0===te.lyrics||"undefined"!==te.lyrics[0].startTime)}function Ze(){return $e.apply(this,arguments)}function $e(){return($e=Object(b.a)(d.a.mark((function e(){var t,n,s,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0!==c.uid&&(t={id:-1,name:"",songSrc:"",authors:[],cover:"",listens:0,releaseDate:"",lyrics:[],imageColors:[]},n=c.lastSongPlayed||c.addedSongs[0]||t.id,s=c.lastQueue||{source:"/library",name:"Your Library",image:c.photoURL,songsList:h}||[],V(n),Z(s),-1!==n?(a=C.collection("songs").doc(n),a.get().then((function(e){if(e.exists){var t=e.data();ne(t),re(t.imageColors||[]),r(!1)}})).catch((function(e){console.log("Error getting document:",e),r(!1)}))):(ne(t),re([]),r(!1)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function et(){return(et=Object(b.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:-1!==K?C.collection("songs").doc(K).get().then((function(e){if(e.exists){var t=e.data();re(t.imageColors||[]),ne(t)}})):Ze();case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function tt(){var e=[];c.addedSongs&&c.addedSongs.map((function(t,n){C.collection("songs").doc(t).get().then((function(t){t.exists?(e.unshift(t.data()),n===c.addedSongs.length-1&&p(e)):console.log("No such document!"),n===c.addedSongs.length-1&&(F([]),c.lastQueue&&(c.lastQueue.songsList.forEach(function(){var e=Object(b.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("songs").doc(t).get();case 2:n=e.sent.data(),F((function(e){return[].concat(Object(j.a)(e),[n])}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),G(c.lastQueue.songsList.findIndex((function(e){return e===c.lastSongPlayed})))))}))}))}Object(s.useEffect)((function(){c.addedSongs&&c.addedSongs.length!==h.length&&tt()}),[c.addedSongs]),A(c,(function(){y([]),c.ownPlaylists&&c.ownPlaylists.map((function(e,t){C.collection("playlists").doc(e).get().then((function(e){e.exists?y((function(t){return[e.data()].concat(Object(j.a)(t))})):console.log("No such document!")})).catch((function(e){console.log("Error getting document:",e)}))})),c.addedPlaylists&&c.addedPlaylists.map((function(e,t){C.collection("playlists").doc(e).get().then((function(e){e.exists?y((function(t){return[].concat(Object(j.a)(t),[e.data()])})):console.log("No such document!")})).catch((function(e){console.log("Error getting document:",e)}))}))}),c.addedPlaylists&&c.addedPlaylists.length+c.ownPlaylists.length!==g.length,[c.addedPlaylists]),A(c,(function(){R([]),void 0!==c.friends&&c.friends.forEach(function(){var e=Object(b.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("users").doc(t.uid).get();case 2:n=e.sent.data(),"added"===t.status&&R((function(e){return[].concat(Object(j.a)(e),[n])}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),c.friends&&c.friends.filter((function(e){return"added"===e.status})).length!==E.length,[c.friends]),A(c,(function(){P([]);var e=[];c.addedAuthors&&c.addedAuthors.map((function(t,n){C.collection("users").doc(t).get().then((function(t){t.exists?(e.unshift(t.data()),n===c.addedAuthors.length-1&&P(e)):console.log("No such document!")})).catch((function(e){console.log("Error getting document:",e)}))}))}),c.addedAuthors&&c.addedAuthors.length!==N.length,[c.addedAuthors]),A(c,(function(){return et.apply(this,arguments)}),c&&(-1===te.id||K||c.lastSongPlayed),[K,c.lastSongPlayed]),Object(s.useEffect)((function(){void 0===c.uid&&(ne({id:-1}),V(-1))}),[c.uid]),Object(s.useEffect)((function(){Me(_e())}),[te.lyrics]),Object(s.useEffect)((function(){if(!a)if(Ne){var e=I(W);F(e),G(e.findIndex((function(e){return e.id===K})))}else F(_.songsList),G(_.songsList.findIndex((function(e){return e.id===K})))}),[Ne]);var nt=Object(s.useRef)();function st(){nt.current=setTimeout((function(){console.log("count added");var e=te.listens;if(e++,C.collection("songs").doc(te.id).update({listens:e}),"albums"===_.source.substr(1,6)){console.log("I Updated album listen count");var t=_.source.substr(8,_.source.length-8);C.collection("playlists").doc(t).get().then((function(e){var n=e.data().listens;n++,C.collection("playlists").doc(t).update({listens:n})}))}}),1e3*pe*.5)}function ct(){for(var e=0,t=te.lyrics.length-1,n=parseFloat(parseFloat(We.current.currentTime).toFixed(1));e<=t;){var s=Math.floor((e+t)/2),c=parseFloat(parseFloat(te.lyrics[s].startTime).toFixed(1)),a=s!==te.lyrics.length-1?parseFloat(parseFloat(te.lyrics[s+1].startTime).toFixed(1)):t;if("undefined"===te.lyrics[s].startTime)return;if(n>=c&&n<=a){Pe(s);break}c<n?e=s+1:t=s-1}}function at(){return(at=Object(b.a)(d.a.mark((function e(t){var n,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t&&t.stopPropagation(),n=k(q+1,W.length-1),e.next=4,C.collection("songs").doc(W[n].id).get();case 4:return e.next=6,e.sent.data().id;case 6:s=e.sent,Pe(0),V(s),G(k(n,W.length-1)),C.collection("users").doc(c.uid).update({lastSongPlayed:s});case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function rt(){return(rt=Object(b.a)(d.a.mark((function e(t){var n,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.stopPropagation(),!(be>5)){e.next=6;break}return We.current.currentTime=0,he(0),Pe(0),e.abrupt("return");case 6:return n=k(q-1,W.length-1),e.next=9,C.collection("songs").doc(W[n].id).get();case 9:return e.next=11,e.sent.data().id;case 11:s=e.sent,Pe(0),V(s),G(k(n,W.length-1)),C.collection("users").doc(c.uid).update({lastSongPlayed:s});case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){clearTimeout(nt.current),ue&&st()}),[ue,te.id]),Object(s.useEffect)((function(){Pe(0)}),[te.id]),Object(s.useEffect)((function(){2===ze&&ct()}),[ze]),Object(s.useEffect)((function(){document.title=te.name||"Soundbubble"}),[te.name]),Object(f.jsx)(B.Provider,{value:{yourSongs:h,setYourSongs:p,yourPlaylists:g,yourFriends:E,currentSongQueue:W,currentSongPlaylistSource:_,setCurrentSongPlaylistSource:Z,setCurrentSongQueue:F,setCurrentSongInQueue:G,play:ue,setPlay:le,songSrc:te.songSrc,currentTime:be,setCurrentTime:he,songDuration:pe,songRef:We,name:te.name,authors:te.authors,lyrics:te.lyrics,cover:te.cover,imgColors:ae,setImgColors:re,currentSong:K,setCurrentSong:V,repeatMode:ve,setRepeatMode:ye,shuffleMode:Ne,setShuffleMode:Ce,inputRef:He,leftSideBarInputRef:Ye,isThereKaraoke:Ee,rightSideCurrentPage:ze,currentParagraph:Ae,currentParagraphRef:Fe,nextSong:function(e){return at.apply(this,arguments)},prevSong:function(e){return rt.apply(this,arguments)},playSong:function(e){e&&e.stopPropagation(),ue?We.current.pause():We.current.play(),le(!ue)},playing:function(e){he(e.target.currentTime),Ee&&2===ze&&De&&Xe&&function(){if(Ae!==te.lyrics.length-1&&parseFloat(te.lyrics[Ae+1].startTime)<=We.current.currentTime)Pe(Ae+1)}(),document.documentElement.style.setProperty("--inputRange",e.target.currentTime/pe*100+"%")},defineCurrentParagraph:ct,setRightSideCurrentPage:Qe,changeCurrentTime:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if("div"===e.target.localName||"p"===e.target.localName)return he(t),We.current.currentTime=t,document.documentElement.style.setProperty("--inputRange",t/pe*100+"%"),Ee&&2===ze&&De&&Pe(parseInt(e.target.id)),We.current.play(),void le(!0);he(e.target.value),We.current.currentTime=e.target.value,document.documentElement.style.setProperty("--inputRange",e.target.value/pe*100+"%"),Ee&&2===ze&&De&&ct()},displayAuthors:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:te.authors,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" & ";return e.map((function(n,s){return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(i.b,{to:"/authors/".concat(n.uid),onClick:function(e){e.stopPropagation(),Ue(!1)},children:n.displayName},n.uid),s===e.length-1?"":t]})}))},displayAuthorsFull:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:te.authors;return e.map((function(e,t){return Object(f.jsx)(f.Fragment,{children:Object(f.jsx)(i.b,{to:"/authors/".concat(e.uid),onClick:function(e){e.stopPropagation(),Ue(!1)},children:Object(f.jsx)(v,{data:e})},e.uid)})}))},openFullScreenPlayer:De,setOpenFullScreenPlayer:Ue,loadSongData:function(e){he(e.target.currentTime),me(e.target.duration),He.current.max=e.target.duration,window.innerWidth>1e3&&(Ye.current.max=e.target.duration),document.documentElement.style.setProperty("--inputRange","0%"),ue?e.target.play():e.target.pause()},findLen:function(){var e="";return te.authors.forEach((function(t){e+=t.displayName})),e.length},fetchYourSongs:tt,setOpenMenu:Je,openMenu:Xe,currentSongData:te,setCurrentSongData:ne,setIsThereKaraoke:Me,checkKaraoke:_e,setYourPlaylists:y,yourAuthors:N,setYourAuthors:P,updateListenCount:st},children:a?Object(f.jsx)(O,{}):t})},W=n(8),F=n(33);function H(e){return e%10===e?"0"+e:e}function Y(e){var t=new Date(1970,0,1);return t.setSeconds(e),t}function K(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=["January","February","March","April","May","June","July","August","September","October","November","December"],s=isNaN(e)?new Date(e):e.seconds?Y(e.seconds+10800):Y(e/1e3+10800);return 0===t?n[s.getMonth()]+" "+s.getDate()+", "+s.getFullYear():1===t?n[s.getMonth()]+" "+s.getDate():2===t?H(s.getHours())+":"+H(s.getMinutes()):3===t?n[s.getMonth()]+" "+s.getDate()+", "+s.getFullYear()+" at "+H(s.getHours())+":"+H(s.getMinutes()):void 0}var V=c.a.createContext(),z=function(){return Object(s.useContext)(V)},Q=function(e){var t=e.children,n=Object(s.useState)(window.innerWidth),c=Object(u.a)(n,2),a=c[0],r=c[1],i=Object(s.useState)(window.innerHeight),o=Object(u.a)(i,2),l=o[0],d=o[1],j=Object(s.useState)(window.innerWidth<1e3),b=Object(u.a)(j,2),h=b[0],O=b[1];function p(){r(window.innerWidth),d(window.innerHeight),O(window.innerWidth<1e3)}Object(s.useEffect)((function(){return window.addEventListener("resize",p),function(){window.removeEventListener("resize",p)}}),[]);var m={screenWidth:a,screenHeight:l,isMobile:h};return Object(f.jsx)(V.Provider,{value:m,children:t})},q=function(e){var t=e.text,n=e.direction,s=void 0===n?"top":n;return z().isMobile?null:Object(f.jsx)("div",{className:"Hint "+s,children:Object(f.jsx)("h5",{children:t})})},G=function(e){var t=e.color,n=void 0===t?"":t,s=Object(o.g)();return Object(f.jsx)("div",{className:"BackBtn",children:Object(f.jsxs)("button",{onClick:function(){return s.goBack()},style:n.length?{color:n}:{},children:[Object(f.jsx)(q,{text:"go back",direction:"bottom"}),Object(f.jsx)(W.a,{})]})})},X=function(e){var t=e.imagesList,n=e.borderColor,s=void 0===n?"#fff":n;return Object(f.jsx)("div",{className:"SmallImages",style:{marginRight:-7*(t.length-1)},children:t.map((function(e,t){return Object(f.jsx)("div",{className:"smallImgContainer",style:{border:"3px solid ".concat(s),transform:"translateX(".concat(-15*t,"px)")},children:Object(f.jsx)("img",{src:e,alt:""})},t)}))})};function J(e){return e<1e3?e:e<1e6?parseFloat(e/1e3).toFixed(1)+"K":e<1e9?parseFloat(e/1e6).toFixed(1)+"M":void 0}var _=n(25),Z=c.a.createContext(),$=function(){return Object(s.useContext)(Z)},ee=function(e){var t=e.children,n=Object(s.useState)(!1),c=Object(u.a)(n,2),a=c[0],r=c[1],i=Object(s.useState)(Object(f.jsx)("h1",{children:"Test"})),o=Object(u.a)(i,2),l=o[0],d=o[1],j=Object(s.useState)(!1),b=Object(u.a)(j,2),h=b[0],O=b[1],p=Object(s.useState)({confirmText:"Confirm Action",rejectText:"Cancel",onConfirmL:function(){return null},onReject:function(){return null}}),m=Object(u.a)(p,2),x=m[0],g=m[1];function v(){O(!1)}var y={openModal:a,setOpenModal:r,toggleModal:function(){r(!a)},setContent:d,content:l,isOpenConfirm:h,setIsOpenConfirm:O,openConfirm:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Cancel",s=arguments.length>3?arguments[3]:void 0,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:v;O(!0),g({question:e,confirmText:t,rejectText:n,onConfirm:s,onReject:c})},closeConfirm:v,confirmContent:x};return Object(f.jsx)(Z.Provider,{value:y,children:t})},te=function(e,t){Object(s.useEffect)((function(){function n(n){e.current&&!e.current.contains(n.target)&&t(!1)}return document.addEventListener("mousedown",n),function(){document.removeEventListener("mousedown",n)}}),[e])};function ne(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}var se=function(){var e=Object(b.a)(d.a.mark((function e(t){var n,s,c,a,r,i=arguments;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=i.length>1&&void 0!==i[1]?i[1]:ne(),s=i.length>2&&void 0!==i[2]?i[2]:"",c=i.length>3&&void 0!==i[3]?i[3]:"",a=i.length>4&&void 0!==i[4]?i[4]:[],r=i.length>5&&void 0!==i[5]?i[5]:[],C.collection("chats").doc(n).set({chatImage:c,chatName:s,id:n,messages:[],participants:t,wallpaper:"undefined",admins:t.length>2?a:[],typing:[],imageColors:r}),t.map(function(){var e=Object(b.a)(d.a.mark((function e(t){var s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("users").doc(t).get();case 2:(s=e.sent.data().chats).push(n),C.collection("users").doc(t).update({chats:s});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ce=function(){var e=Object(b.a)(d.a.mark((function e(t,n,s,c){var a,r,i;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=!1,r=0,!n.chats){e.next=9;break}return e.next=5,C.collection("chats").where("participants","array-contains",n.uid).get();case 5:return e.sent.docs.forEach((function(e){var n=0;return t.every((function(t){return!!e.data().participants.includes(t)&&(n++,!0)})),n+1!==e.data().participants.length||n!==t.length||(a=!0,s(!1),c(e.data().id),r=e.data().id,!1)})),a||(i=ne(),a=!0,s(!0),c(i),r=i),e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})));return function(t,n,s,c){return e.apply(this,arguments)}}(),ae=function(e){var t=e.data,n=e.color,c=M().currentUser,a=Object(s.useState)(!1),r=Object(u.a)(a,2),o=r[0],l=r[1],d=Object(s.useState)(0),j=Object(u.a)(d,2),b=j[0],h=j[1];return Object(s.useEffect)((function(){ce([t.uid],c,l,h)}),[t.uid]),Object(f.jsx)(i.b,{to:"/chat/".concat(b),style:{display:"block",width:"fit-content",textDecoration:"none"},children:Object(f.jsxs)("button",{onClick:function(){o&&se([c.uid,t.uid],b)},style:{background:n},className:"ChatWithFriendButton",children:[Object(f.jsx)(W.p,{})," Messages"]})})},re=function(e){var t=e.top,n=void 0===t?"20%":t;return Object(f.jsx)("div",{className:"LoadingCircle",style:{top:n},children:Object(f.jsx)("img",{src:"https://icon-library.com/images/spinner-icon-gif/spinner-icon-gif-28.jpg",alt:""})})},ie=n(13),oe=function(e,t,n,s){var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[],i=arguments.length>7?arguments[7]:void 0;if(0!==s.length||0!==c.length||0!==a.length||0!==r.length||i){var o=t.messages;o.push({id:t.messages.length,sender:n,message:s,sentTime:(new Date).toString(),inResponseToMessage:i||null,attachedSongs:c,attachedAlbums:a,attachedAuthors:r,seenBy:[n]}),C.collection("chats").doc(e).update({messages:o})}};var ue=function(e){var t,n=e.value,c=e.setValue,a=e.setAllFoundSongs,r=e.setResultPlaylists,i=e.setResultAuthorList,o=e.focus,l=void 0!==o&&o,h=e.defaultSearchMode,O=void 0===h?void 0:h,p=e.inputText,m=void 0===p?"Search for songs or for people":p,x=e.defaultSongsListValue,g=e.defaultAuthorsListValue,v=e.defaultPlaylistsListValue,y=Object(s.useState)(!1),S=Object(u.a)(y,2),w=S[0],N=S[1],k=Object(s.useState)(""),I=Object(u.a)(k,2),A=I[0],P=I[1],T=Object(s.useState)(!1),E=Object(u.a)(T,2),M=E[0],R=E[1],B=Object(s.useState)(0),D=Object(u.a)(B,2),U=D[0],F=D[1],H=Object(s.useRef)(null);function Y(e){return K.apply(this,arguments)}function K(){return(K=Object(b.a)(d.a.mark((function e(t){var s,c,o,u,l=arguments;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=l.length>1&&void 0!==l[1]?l[1]:[],c=l.length>2?l[2]:void 0,o=[],u=L(n),e.next=6,C.collection("search").where("variantsOfName","array-contains",u).get();case 6:e.sent.docs.forEach(function(){var e=Object(b.a)(d.a.mark((function e(n){var u,l;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((u=n.data()).place!==t){e.next=18;break}return e.next=4,C.collection(u.place).doc(u.uid).get();case 4:if(l=e.sent.data(),void 0!==s&&s.length?s.map((function(e){return e.id})).includes(l.id)&&o.push(l):l.isPrivate||o.push(l),void 0!==O||0!==U||0===o.length){e.next=18;break}e.t0=u.place,e.next="songs"===e.t0?10:"users"===e.t0?12:"playlists"===e.t0?14:16;break;case 10:return o.forEach(function(){var e=Object(b.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("songs").doc(t.id).get();case 2:e.sent.data().authors.forEach(function(){var e=Object(b.a)(d.a.mark((function e(t,n){var s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n<3)){e.next=5;break}return e.next=3,C.collection("users").doc(t.uid).get();case 3:s=e.sent.data(),i((function(e){return[].concat(Object(j.a)(e),[s])}));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.abrupt("break",18);case 12:return o.forEach(function(){var e=Object(b.a)(d.a.mark((function e(t){var n,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("users").doc(t.uid).get();case 2:return n=e.sent.data().ownSongs,e.next=5,C.collection("users").doc(t.uid).get();case 5:s=e.sent.data().ownPlaylists,n.forEach(function(){var e=Object(b.a)(d.a.mark((function e(t,n){var s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n<3)){e.next=5;break}return e.next=3,C.collection("songs").doc(t).get();case 3:s=e.sent.data(),a((function(e){return[].concat(Object(j.a)(e),[s])}));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),s.forEach(function(){var e=Object(b.a)(d.a.mark((function e(t,n){var s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n<3)){e.next=5;break}return e.next=3,C.collection("playlists").doc(t).get();case 3:s=e.sent.data(),r((function(e){return[].concat(Object(j.a)(e),[s])}));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.abrupt("break",18);case 14:return o.forEach(function(){var e=Object(b.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("playlists").doc(t.id).get();case 2:e.sent.data().authors.forEach(function(){var e=Object(b.a)(d.a.mark((function e(t,n){var s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n<3)){e.next=5;break}return e.next=3,C.collection("users").doc(t.uid).get();case 3:s=e.sent.data(),i((function(e){return[].concat(Object(j.a)(e),[s])}));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.abrupt("break",18);case 16:return P("Wrong search mode"),e.abrupt("break",18);case 18:c(o),N(!1),0!==o.length&&R(!0);case 21:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function V(){if(N(!0),R(!1),""!==n)if(void 0===O)0!==U&&1!==U||(Y("songs",x,a),i([]),r([])),0!==U&&2!==U||(Y("users",g,i),a([]),r([])),0!==U&&3!==U||(Y("playlists",v,r),i([]),a([]));else switch(O){case"songs":Y("songs",x,a);break;case"playlists":Y("playlists",v,r);break;case"authors":Y("users",g,i);break;default:Y("songs",x,a)}else void 0!==x&&a(x),void 0!==g&&i(g),void 0!==v&&r(v),N(!1);P("Not found")}return Object(s.useEffect)((function(){l&&H.current.focus()}),[]),Object(s.useEffect)((function(){V()}),[U]),Object(f.jsxs)("div",{style:{marginTop:"10px",width:"100%"},children:[Object(f.jsxs)("div",{className:"searchBar",children:[Object(f.jsxs)("div",{className:"searchBarElement",children:[Object(f.jsx)(W.x,{}),Object(f.jsx)("span",{onClick:function(){return n.length?c(""):null},children:n.length?Object(f.jsx)(W.H,{}):null})]}),Object(f.jsx)("input",{type:"text",placeholder:m,value:n,onChange:function(e){return c(e.target.value)},onKeyUp:function(){return e=V,clearTimeout(t),void(t=setTimeout(e,1e3));var e},onKeyDown:function(){clearTimeout(t)},ref:H}),Object(f.jsxs)("div",{className:"searchFilters",style:void 0!==O?{display:"none"}:{},children:[Object(f.jsx)("button",{onClick:function(){return F(0)},style:0===U?{background:"var(--lightBlue)"}:{},children:"All"}),Object(f.jsx)("button",{onClick:function(){return F(1)},style:1===U?{background:"var(--lightBlue)"}:{},children:"Songs"}),Object(f.jsx)("button",{onClick:function(){return F(2)},style:2===U?{background:"var(--lightBlue)"}:{},children:"Authors"}),Object(f.jsx)("button",{onClick:function(){return F(3)},style:3===U?{background:"var(--lightBlue)"}:{},children:"Playlists"})]})]}),Object(f.jsx)("div",{className:"authorsResult",children:w?Object(f.jsx)("div",{style:{position:"relative",width:"100%",height:"50px",marginTop:"40px"},children:Object(f.jsx)(re,{})}):M||0===n.length?null:Object(f.jsx)("h2",{children:A})})]})},le=function(e){var t=e.item,n=e.whatToShare,c=void 0===n?"song":n,a=D().yourFriends,r=Object(s.useState)([]),i=Object(u.a)(r,2),o=i[0],l=i[1],j=M().currentUser,h=Object(s.useState)(""),O=Object(u.a)(h,2),p=O[0],m=O[1],g=Object(s.useState)(!1),y=Object(u.a)(g,2),S=y[0],w=y[1],N=$().toggleModal,k=Object(s.useState)(""),I=Object(u.a)(k,2),A=I[0],P=I[1],L=Object(s.useState)([]),T=Object(u.a)(L,2),E=T[0],R=T[1];return Object(s.useEffect)((function(){S&&setTimeout((function(){N(),w(!1)}),1e3)}),[S]),Object(f.jsxs)("div",{className:"FriendsListToShareWith",children:[S?Object(f.jsxs)("div",{className:"successMessageSent",children:[Object(f.jsx)(x.c,{}),"Song has sent!"]}):null,Object(f.jsxs)("div",{children:[Object(f.jsx)(ue,{value:A,setValue:P,setResultAuthorList:R,defaultSearchMode:"authors",inputText:"Search for friends"}),Object(f.jsx)("div",{children:E.length>0?E.map((function(e,t){return Object(f.jsx)(v,{data:e,showChoose:!0,chosenArray:o,setChosenArray:l},t)})):a.map((function(e,t){return Object(f.jsx)(v,{data:e,showChoose:!0,chosenArray:o,setChosenArray:l},t)}))})]}),Object(f.jsxs)("div",{children:[Object(f.jsx)("form",{children:Object(f.jsx)("input",{type:"text",placeholder:"Your message",style:{margin:0},onChange:function(e){return m(e.target.value)}})}),Object(f.jsxs)("button",{className:"shareBtn",style:o.length?{maxWidth:"none",background:"var(--purpleAndBlueGrad)"}:{opacity:.5,maxWidth:"none",background:"var(--purpleAndBlueGrad)"},onClick:function(){o.length>0&&(!function(e,t,n,s){var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";e.map(function(){var e=Object(b.a)(d.a.mark((function e(a){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Promise.resolve(ce([a],t,(function(){return null}),(function(){return null}))).then(function(){var e=Object(b.a)(d.a.mark((function e(r){var i,o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("chats").doc(r).get();case 2:if(void 0===(i=e.sent.data())){e.next=17;break}e.t0=s,e.next="song"===e.t0?7:"playlist"===e.t0?9:"author"===e.t0?11:13;break;case 7:return oe(r,i,t.uid,c,[n]),e.abrupt("break",15);case 9:return oe(r,i,t.uid,c,[],[n]),e.abrupt("break",15);case 11:return oe(r,i,t.uid,c,[],[],[n]),e.abrupt("break",15);case 13:return oe(r,i,t.uid,c,[n]),e.abrupt("break",15);case 15:e.next=19;break;case 17:o=ne(),se([t.uid,a],o).then(Object(b.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("chats").doc(o).get();case 2:i=e.sent.data(),e.t0=s,e.next="song"===e.t0?6:"playlist"===e.t0?8:"author"===e.t0?10:12;break;case 6:return oe(o,i,t.uid,c,[n]),e.abrupt("break",14);case 8:return oe(o,i,t.uid,c,[],[n]),e.abrupt("break",14);case 10:return oe(o,i,t.uid,c,[],[],[n]),e.abrupt("break",14);case 12:return oe(o,i,t.uid,c,[n]),e.abrupt("break",14);case 14:case"end":return e.stop()}}),e)}))));case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}(o,j,"author"===c?t.uid:t.id,c,p),w(!0))},children:["Share with ",o.length," ",o.length>1?"friends":"friend"]})]})]})},de=n(34),je=n(19),be=function(e){var t=e.currentActive,n=e.id,s=e.label,c=e.onClick;return Object(f.jsxs)("div",{className:"RadioBtn",id:n,onClick:c,children:[Object(f.jsx)("span",{className:"radioLabel",style:t===n?{color:"var(--blue)",opacity:1,fontWeight:"bold"}:{},children:s}),Object(f.jsx)("span",{className:"radioCircle",style:t===n?{background:"var(--blue)"}:{}})]})},he=function(e){var t=e.play;return Object(f.jsxs)("div",{className:"ColorCircles",style:t?{}:{opacity:0,transform:"scale(.95)"},children:[Object(f.jsx)("span",{className:"colorCircle"}),Object(f.jsx)("span",{className:"colorCircle"}),Object(f.jsx)("span",{className:"colorCircle"})]})},fe=n(21),Oe=function(e){var t=e.song,n=e.listOfSongs,c=e.setListOfSongs,a=e.showListens,r=void 0!==a&&a,i=e.listens,o=void 0===i?0:i,l=e.isNewSong,d=void 0!==l&&l,b=D(),h=(b.setCurrentSong,b.currentSong),O=b.displayAuthors,p=b.play,m=(b.songRef,b.setPlay,b.setYourSongs,b.yourPlaylists,b.currentSongQueue,b.setCurrentSongInQueue,b.fetchYourSongs),x=Object(s.useState)(!1),g=Object(u.a)(x,2),v=g[0],y=g[1],S=Object(s.useState)(0),w=Object(u.a)(S,2),N=(w[0],w[1]),k=Object(s.useRef)(null),I=M().currentUser;return te(k,y),Object(f.jsxs)("div",{className:"SongItem "+(n.includes(t.id)?"inList":""),onClick:function(){if(!n.includes(t.id))return c((function(e){return[].concat(Object(j.a)(e),[t.id])}));var e=n.filter((function(e){return e!==t.id}));c(e)},ref:v?k:null,style:v?{background:"var(--playlistsColor)"}:{},children:[Object(f.jsxs)("div",{className:"songItemImageAndName",children:[Object(f.jsxs)("div",{className:"songItemImage",children:[Object(f.jsx)("div",{className:"songItemPlayOrPause",children:t.id===h&&p?null:Object(f.jsx)(fe.c,{})}),Object(f.jsxs)("div",{className:"playingAnimation",style:t.id===h&&p?{opacity:1,visibility:"visible"}:{},children:[Object(f.jsx)(fe.b,{}),Object(f.jsx)(he,{play:p})]}),Object(f.jsx)("img",{src:t.cover,alt:""})]}),Object(f.jsxs)("div",{className:"songItemNameAndAuthor",children:[Object(f.jsxs)("div",{className:"songItemName",style:{display:"flex",alignItems:"center"},children:[t.name,Object(f.jsx)("span",{style:{marginLeft:"10px",fontWeight:"500"},children:r?Object(f.jsxs)("span",{style:{display:"flex",alignItems:"center",opacity:.7,fontSize:".8em"},className:d?"newSongMarker":"",children:[J(o)," ",Object(f.jsx)(_.c,{})]}):d?Object(f.jsx)("span",{style:{display:"flex",alignItems:"center",fontSize:".7em"},className:"newSongMarker",children:"New"}):null})]}),Object(f.jsx)("div",{className:"songItemAuthor",children:O(t.authors)})]})]}),Object(f.jsxs)("div",{className:"songItemMoreBtn",onClick:function(e){e.stopPropagation(),y(!v),N(e.target.getBoundingClientRect().top)},children:[Object(f.jsx)("button",{onClick:function(e){if(e.stopPropagation(),I.addedSongs.includes(t.id)){var n=I.addedSongs.filter((function(e){return e!==t.id}));return C.collection("users").doc(I.uid).update({addedSongs:n}),m(),void y(!1)}var s=I.addedSongs;s.push(t.id),C.collection("users").doc(I.uid).update({addedSongs:s}),m()},children:I.addedSongs.includes(t.id)?Object(f.jsx)(W.b,{}):Object(f.jsx)(W.w,{})}),Object(f.jsx)("button",{children:Object(f.jsx)(W.s,{})})]})]})},pe=n(30);function me(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;return e.substr(0,t)+(e.length>t?"...":"")}var xe=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" & ",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,s=e.map((function(e){return e.displayName})).join(t);return me(s,n)},ge=function(e,t,n,s){e.stopPropagation();var c=t.authors.map((function(e){return e.uid})),a=[];c.forEach((function(e){n.addedAuthors.includes(e)||a.push(e)}));var r=n.addedSongs;r.push(t.id),C.collection("users").doc(n.uid).update({addedSongs:r,addedAuthors:[].concat(a,Object(j.a)(n.addedAuthors))}),a.forEach(function(){var e=Object(b.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("users").doc(t).get();case 2:n=e.sent.data().subscribers,n++,C.collection("users").doc(t).update({subscribers:n});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())};function ve(e,t){return e.filter((function(e){return this.indexOf(e)<0}),t)}var ye=function(e,t,n,s){e.stopPropagation();var c=t.authors.map((function(e){return e.uid})),a=[],r=n.addedSongs.filter((function(e){return e!==t.id}));c.forEach((function(e){s.forEach((function(t){r.includes(t.id)&&t.authors.find((function(t){return t.uid===e}))&&a.push(e)}))}));var i=ve(c,a),o=ve(n.addedAuthors,i);C.collection("users").doc(n.uid).update({addedSongs:r,addedAuthors:o}),i.forEach(function(){var e=Object(b.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("users").doc(t).get();case 2:n=e.sent.data().subscribers,n--,C.collection("users").doc(t).update({subscribers:n});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())};function Se(e){var t=e.song,n=M().currentUser,s=D().yourSongs,c=$(),a=c.openConfirm,r=c.setOpenModal;return n.addedSongs.includes(t.id)?Object(f.jsxs)("span",{onClick:function(e){e.stopPropagation(),r(!1),a("You sure you want to delete this song from library?","Yes, delete it","No, just kidding",(function(e){return ye(e,t,n,s)}))},children:[Object(f.jsx)(W.B,{}),"Delete"]}):Object(f.jsxs)("span",{onClick:function(e){return ge(e,t,n)},children:[Object(f.jsx)(W.w,{}),"Add"]})}var we=function(e){var t=e.person;return Object(f.jsx)(i.b,{to:"/authors/".concat(t.uid),children:Object(f.jsxs)("div",{className:"PersonTinyVerticalItem",children:[Object(f.jsx)("div",{className:"personTinyImage",children:Object(f.jsx)("img",{src:t.photoURL,alt:""})}),Object(f.jsx)("div",{className:"personTinyName",children:t.displayName})]})})},Ne=function(e){var t=e.data,n=e.title,c=Object(s.useState)([]),a=Object(u.a)(c,2),r=a[0],i=a[1],o=Object(s.useState)(0),l=Object(u.a)(o,2),h=l[0],O=l[1],p=Object(s.useRef)(null),m=Object(s.useState)(!1),x=Object(u.a)(m,2),g=x[0],v=x[1];return Object(s.useEffect)((function(){r.length>0&&(p.current.scrollWidth>p.current.offsetWidth&&v(!0))}),[r]),Object(s.useEffect)((function(){i([]),i([]),t.friends.forEach(function(){var e=Object(b.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("added"!==t.status){e.next=5;break}return e.next=3,C.collection("users").doc(t.uid).get();case 3:n=e.sent.data(),i((function(e){return[].concat(Object(j.a)(e),[n])}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[t.uid]),r.length>0?Object(f.jsxs)("div",{className:"PersonTinyList",children:[n&&Object(f.jsx)("h2",{children:n}),Object(f.jsxs)("div",{style:{position:"relative"},children:[Object(f.jsx)("div",{className:"personTinyListWrapper",ref:p,onScroll:function(e){return O(e.target.scrollLeft)},children:r.map((function(e,t){return Object(f.jsx)(we,{person:e},e.uid)}))}),Object(f.jsxs)("div",{className:"authorsShiftButtons",children:[Object(f.jsx)("button",{onClick:function(){var e=p.current.scrollLeft;p.current.scrollLeft=e-200,O(e-200)},style:h<=0?{visibility:"hidden",opacity:"0"}:{},children:Object(f.jsx)(W.d,{})}),Object(f.jsx)("button",{onClick:function(){var e=p.current.scrollLeft;p.current.scrollLeft=e+200,O(e+200)},style:g&&p.current&&p.current.scrollWidth-p.current.offsetWidth!==h?{}:{visibility:"hidden",opacity:"0"},children:Object(f.jsx)(W.e,{})})]})]})]}):null},Ce=function(e){var t=e.song,n=D().currentSongData,c=$(),a=(c.toggleModal,c.setContent),r=M().currentUser,i=Object(s.useState)(t||n),o=Object(u.a)(i,2),l=o[0],h=o[1],O=D().displayAuthors,p=Object(s.useState)([]),m=Object(u.a)(p,2),x=m[0],g=m[1],v=Object(s.useState)(!0),y=Object(u.a)(v,2),S=(y[0],y[1]);function w(){return(w=Object(b.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return S(!0),g([]),e.next=4,C.collection("users").where("addedSongs","array-contains",l.id).get();case 4:e.sent.forEach((function(e){r.friends.find((function(t){return t.uid===e.data().uid}))&&g((function(t){return[].concat(Object(j.a)(t),[e.data()])})),console.log(e.data()),S(!1)}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){void 0!==t&&h(t)}),[t&&t.id]),Object(s.useEffect)((function(){!function(){w.apply(this,arguments)}()}),[l.id]),Object(f.jsxs)("div",{className:"SongInfo",children:[Object(f.jsx)("div",{className:"songImage",children:Object(f.jsx)("img",{src:l.cover,alt:""})}),Object(f.jsxs)("div",{className:"songInfoContent",children:[Object(f.jsx)("h3",{style:{color:l.imageColors[0]},children:l.name}),Object(f.jsx)("span",{children:O(l.authors,", ")}),Object(f.jsxs)("div",{style:{display:"flex",alignItems:"center",opacity:"0.6",fontSize:".9em",position:"relative"},className:"listensAndDate",children:[Object(f.jsxs)("p",{className:"infoListens",style:{marginRight:"15px",position:"relative"},children:[l.listens," ",Object(f.jsx)(_.c,{})]}),Object(f.jsx)("span",{children:K(l.releaseDate)})]}),Object(f.jsx)("h4",{style:{margin:"10px 0"},children:x.length>0?"Friends that listen that song":"None of your friends listens this"}),Object(f.jsx)("div",{style:{display:"flex",alignItems:"center"},children:x.map((function(e,t){return Object(f.jsx)(we,{person:e},e.uid)}))}),x.length<=0?Object(f.jsx)("button",{className:"shareBtn",style:{minHeight:"35px",background:l.imageColors[0]},onClick:function(){a(Object(f.jsx)(le,{item:l,whatToShare:"song"}))},children:"Share"}):null]})]})},ke=function(e){var t=e.song,n=D(),c=n.yourPlaylists,a=n.currentSongData,r=M().currentUser,i=Object(s.useState)(t||a),o=Object(u.a)(i,2),l=o[0],d=o[1];return Object(s.useEffect)((function(){t&&t.id&&d(t)}),[t]),Object(f.jsx)("div",{className:"AddToPlaylists",children:Object(f.jsx)("div",{style:{display:"flex",flexDirection:"column"},children:c.map((function(e,t){if(r.ownPlaylists.includes(e.id))return Object(f.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(t){return function(e,t,n,s){if(s[e.target.id].songs.includes(n.id)){var c=s[e.target.id].songs.filter((function(e){return e!==n.id}));return s[e.target.id].songs=c,void C.collection("playlists").doc(t).update({songs:c})}var a=s[e.target.id].songs;a.unshift(n.id),s[e.target.id].songs=a,C.collection("playlists").doc(t).update({songs:a})}(t,e.id,l,c)},id:t,children:[e.songs.includes(l.id)?Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(q,{text:"Remove ".concat(a.name," from playlist")}),Object(f.jsx)(W.b,{})]}):Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(q,{text:'Add "'.concat(l.name,'" to playlist')}),Object(f.jsx)(W.w,{})]}),e.name]},t)}))})})},Ie=n(24),Ae=function(e){var t=e.openMoreWindow,n=e.song,s=e.moreWindowPosRelativeToViewport,c=$(),a=c.toggleModal,r=c.setContent;return t?Object(f.jsxs)("div",{className:"songItemMenuWindow",style:s>window.innerHeight/2+100?{top:"auto",bottom:"110%"}:{top:"110%",bottom:"auto"},onClick:function(e){return e.stopPropagation()},children:[Object(f.jsx)("div",{className:"songItemMenuWindowItem",children:Object(f.jsx)(Se,{song:n})}),Object(f.jsxs)("div",{className:"songItemMenuWindowItem",children:[Object(f.jsx)("div",{className:"songItemMenuWindow inner",children:Object(f.jsx)(ke,{song:n})}),Object(f.jsx)(Ie.c,{}),"Add to playlist ",Object(f.jsx)(Ie.a,{})]}),Object(f.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){a(),r(Object(f.jsx)(le,{item:n,whatToShare:"song"}))},children:[Object(f.jsx)(W.z,{}),"Share"]}),Object(f.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){a(),r(Object(f.jsx)(Ce,{song:n}))},children:[Object(f.jsx)(W.n,{}),"Info"]}),Object(f.jsxs)("div",{className:"songItemMenuWindowItem",children:[Object(f.jsx)(W.i,{}),"Flag"]})]}):null},Pe=function(e){var t=e.listOfAuthors,n=D().displayAuthorsFull;return Object(f.jsx)("div",{className:"rightSideAuthorsList",children:Object(f.jsx)("div",{className:"rightSideAuthorsListCentralBlock",children:n(t)})})},Le=function(e){var t=e.song,n=$().setContent;return Object(f.jsxs)("div",{className:"SongItemMobileMoreWindow",children:[Object(f.jsxs)("div",{className:"simpleSongElement",style:{background:t.imageColors[0]},children:[Object(f.jsx)("div",{className:"simpleSongElementImage",children:Object(f.jsx)("img",{src:t.cover,alt:""})}),Object(f.jsx)("span",{children:t.name})]}),Object(f.jsx)("div",{className:"songItemMenuWindowItem",children:Object(f.jsx)(Se,{song:t})}),Object(f.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){return n(Object(f.jsx)(ke,{song:t}))},children:[Object(f.jsx)(Ie.c,{}),"Add to playlist"]}),Object(f.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){n(Object(f.jsx)(le,{item:t,whatToShare:"song"}))},children:[Object(f.jsx)(W.z,{}),"Share"]}),Object(f.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){n(Object(f.jsx)(Ce,{song:t}))},children:[Object(f.jsx)(W.n,{}),"Info"]}),Object(f.jsxs)("div",{className:"songItemMenuWindowItem",children:[Object(f.jsx)(W.i,{}),"Flag"]}),Object(f.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){n(Object(f.jsx)(Pe,{listOfAuthors:t.authors,title:"Authors"}))},children:[Object(f.jsx)(W.F,{}),"Authors"]})]})},Te=function(e){var t=e.song,n=e.localIndex,c=e.showListens,a=void 0!==c&&c,r=e.isNewSong,i=void 0!==r&&r,o=e.listOfChosenSongs,l=e.setListOfSongs,d=D(),j=d.yourSongs,b=d.setCurrentSong,h=d.currentSong,O=d.displayAuthors,p=d.play,m=d.songRef,x=d.setPlay,v=d.setCurrentSongInQueue,y=z().isMobile,S=Object(s.useState)(!1),w=Object(u.a)(S,2),N=w[0],k=w[1],I=Object(s.useState)(0),A=Object(u.a)(I,2),P=A[0],L=A[1],T=Object(s.useRef)(null),E=M(),R=E.currentUser,B=(E.setCurrentUser,$()),U=B.toggleModal,F=B.setContent,H=B.openConfirm,Y=B.closeConfirm;return te(T,k),Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(g,{listOfChosenItems:o,setListOfChosenItems:l,itemId:t.id}),Object(f.jsxs)("div",{className:"SongItem "+(t.id===h&&p?"playingNow":""),onClick:function(){if(b(t.id),C.collection("users").doc(R.uid).update({lastSongPlayed:t.id}),v(n),t.id===h&&p)return m.current.pause(),void x(!1);m.current.play(),x(!0)},ref:N?T:null,style:N?{background:"var(--playlistsColor)"}:{},children:[Object(f.jsxs)("div",{className:"songItemImageAndName",children:[Object(f.jsxs)("div",{className:"songItemImage",children:[Object(f.jsx)("div",{className:"songItemPlayOrPause",children:t.id===h&&p?null:Object(f.jsx)(fe.c,{})}),Object(f.jsxs)("div",{className:"playingAnimation",style:t.id===h&&p?{opacity:1,visibility:"visible"}:{},children:[Object(f.jsx)(fe.b,{}),Object(f.jsx)(he,{play:p})]}),Object(f.jsx)("img",{src:t.cover,alt:""})]}),Object(f.jsxs)("div",{className:"songItemNameAndAuthor",children:[Object(f.jsxs)("div",{className:"songItemName",style:{display:"flex",alignItems:"center"},children:[me(t.name,window.innerWidth>1e3?30:17),Object(f.jsx)("span",{style:{marginLeft:"10px",fontWeight:"500"},children:a?Object(f.jsxs)("span",{style:{display:"flex",alignItems:"center",opacity:.7,fontSize:".8em"},className:i?"newSongMarker":"",children:[J(t.listens)," ",Object(f.jsx)(_.c,{})]}):i?Object(f.jsx)("span",{style:{display:"flex",alignItems:"center",fontSize:".7em"},className:"newSongMarker",children:"New"}):null})]}),y?Object(f.jsx)("div",{className:"songItemAuthor",children:xe(t.authors," & ",30)}):Object(f.jsx)("div",{className:"songItemAuthor",children:O(t.authors)})]})]}),Object(f.jsxs)("div",{className:"songItemMoreBtn",children:[R.addedSongs.includes(t.id)?Object(f.jsxs)("button",{onClick:function(e){e.stopPropagation(),H('You sure you want to delete "'.concat(t.name,'" from library?'),"Yes, delete it","No, just kidding",(function(e){ye(e,t,R,j),Y()}))},style:{position:"relative"},children:[Object(f.jsx)(q,{text:"delete song"}),Object(f.jsx)(W.G,{})]}):Object(f.jsxs)("button",{onClick:function(e){return ge(e,t,R)},style:{position:"relative"},children:[Object(f.jsx)(q,{text:"add song"}),Object(f.jsx)(W.w,{})]}),Object(f.jsxs)("button",{onClick:y?function(e){e.stopPropagation(),U(),F(Object(f.jsx)(Le,{song:t}))}:function(e){e.stopPropagation(),k(!N),L(e.target.getBoundingClientRect().top)},children:[Object(f.jsx)(q,{text:"more"}),Object(f.jsx)(W.s,{})]})]}),Object(f.jsx)(Ae,{openMoreWindow:N,song:t,moreWindowPosRelativeToViewport:P})]})]})},Ee=function(e){var t=e.func,n=e.lenOfList,s=e.maxLen,c=void 0===s?5:s,a=e.boolVal;return Object(f.jsx)("div",{onClick:n>c?t:null,className:"MoreBtn",style:n<=c?{display:"none"}:{},children:Object(f.jsx)("button",{style:a?{background:"var(--pink)",color:"#ff8db2"}:{},children:a?"Close":"More"})})},Me=function(e){var t=e.title,n=e.func,s=e.boolVal,c=e.lenOfList,a=e.maxLen,r=void 0===a?5:a,i=e.marginBottom,o=void 0===i?0:i;return 0!==c?Object(f.jsxs)("div",{className:"topTitle",style:{margin:"10px 0"},children:[Object(f.jsx)("h2",{style:{margin:o},children:t}),Object(f.jsx)(Ee,{func:n,boolVal:s,lenOfList:c,maxLen:r})]}):null},Re=function(e){var t=e.listOfSongs,n=e.source,c=e.title,a=void 0===c?"":c,r=e.showListens,i=void 0!==r&&r,o=e.isNewSong,l=void 0!==o&&o,d=e.showCount,j=void 0!==d&&d,b=e.listOfChosenSongs,h=e.setListOfSongs,O=e.showSearch,p=void 0!==O&&O,m=e.displayIfEmpty,x=D(),g=x.setCurrentSongQueue,v=x.setCurrentSongPlaylistSource,y=(x.playSong,x.setCurrentSong,M().currentUser),S=Object(s.useState)(!1),w=Object(u.a)(S,2),N=w[0],k=w[1],I=Object(s.useState)(""),A=Object(u.a)(I,2),P=A[0],L=A[1],T=Object(s.useState)(t),E=Object(u.a)(T,2),R=E[0],B=E[1];return Object(s.useEffect)((function(){B(t),t.length>1&&xe(t[1].authors)}),[t]),Object(f.jsxs)("div",{className:"SongList",onClick:function(){if("no"!==n&&0!==t.length){g(t),v(n);var e=t.map((function(e){return e.id}));C.collection("users").doc(y.uid).update({lastQueue:{image:n.image,name:n.name,songsList:e,source:n.source}})}},children:[0!==a.length?Object(f.jsx)(Me,{title:a,func:function(){return k(!N)},boolVal:N,lenOfList:t.length}):null,p?Object(f.jsx)(ue,{value:P,setValue:L,allFoundSongs:R,setAllFoundSongs:B,defaultSearchMode:"songs",defaultSongsListValue:t,inputText:"Search for songs"}):null,R.map((function(e,t){return 0===a.length||N||t<5?Object(f.jsxs)("span",{className:"topSongItem",children:[j?Object(f.jsx)("h3",{style:{opacity:"0.7"},children:t+1}):null,Object(f.jsx)(Te,{song:e,localIndex:t,showListens:i,isNewSong:l,listOfChosenSongs:b,setListOfSongs:h},e.id)]}):void 0})),0===t.length?m:null]})},Be=function(e){var t,n,c=e.playlist,a=M().currentUser,r=Object(s.useState)(c.name),i=Object(u.a)(r,2),o=i[0],l=i[1],h=Object(s.useState)(c.image),O=Object(u.a)(h,2),p=O[0],m=O[1],x=Object(s.useState)(""),g=Object(u.a)(x,2),y=g[0],S=g[1],w=Object(s.useState)([]),k=Object(u.a)(w,2),I=k[0],A=k[1],P=Object(s.useState)(c.authors),L=Object(u.a)(P,2),T=L[0],E=L[1],R=Object(s.useState)(c.creationDate),B=Object(u.a)(R,2),D=B[0],U=B[1],F=Object(s.useState)(""),H=Object(u.a)(F,2),Y=H[0],K=H[1],V=Object(s.useState)([]),z=Object(u.a)(V,2),Q=z[0],q=z[1],G=Object(s.useState)(c.songs),X=Object(u.a)(G,2),J=X[0],_=X[1],Z=Object(s.useState)(c.isAlbum?1:0),$=Object(u.a)(Z,2),ee=$[0],te=$[1],se=Object(s.useState)(c.isPrivate?1:0),ce=Object(u.a)(se,2),ae=ce[0],ie=ce[1],oe=Object(s.useState)(!1),ue=Object(u.a)(oe,2),le=ue[0],he=ue[1],fe=Object(s.useState)(!1),Oe=Object(u.a)(fe,2),me=Oe[0],xe=Oe[1],ge=Object(s.useState)(""),ve=Object(u.a)(ge,2),ye=ve[0],Se=ve[1],we=Object(s.useState)(c.imageColors),Ne=Object(u.a)(we,2),Ce=Ne[0],ke=Ne[1];function Ie(e){return Ae.apply(this,arguments)}function Ae(){return(Ae=Object(b.a)(d.a.mark((function e(t){var n,s,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return he(!0),A([]),n=a.friends.map((function(e){if("added"===e.status)return e.uid})),s=a.isAdmin?C.collection("users").where("displayName","==",y):C.collection("users").where("uid","in",n).where("displayName","==",y),e.next=6,s.get();case 6:void 0!==(c=e.sent)&&(c.docs.forEach((function(e){A([].concat(Object(j.a)(I),[e.data()]))})),he(!1));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Pe(e){return Le.apply(this,arguments)}function Le(){return(Le=Object(b.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return xe(!0),q([]),n=C.collection("songs").where("name","==",Y),e.next=5,n.get();case 5:e.sent.docs.forEach((function(e){q([].concat(Object(j.a)(I),[e.data()]))})),xe(!1);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Te(e){var t=T.filter((function(t){return t.uid!==e.uid}));return E(t)}function Ee(){return(Ee=Object(b.a)(d.a.mark((function e(t,n,s){var c,a,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=t.target.files[0],Se(URL.createObjectURL(c)),a=N.ref(),r=a.child(n+c.name),e.next=6,r.put(c);case 6:return e.t0=s,e.next=9,r.getDownloadURL();case 9:e.t1=e.sent,(0,e.t0)(e.t1);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Me(){return(Me=Object(b.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),ne(),T.length>c.authors.length?T.filter((function(e){return!c.authors.find((function(t){return t.uid===e.uid}))})).forEach(function(){var e=Object(b.a)(d.a.mark((function e(t){var n,s,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("users").doc(t.uid).get();case 2:n=e.sent,s=n.data(),(a=s.ownPlaylists).push(c.id),console.log(a),C.collection("users").doc(t.uid).update({ownPlaylists:a});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()):T.length<c.authors.length&&c.authors.filter((function(e){return!T.find((function(t){return t.uid===e.uid}))})).forEach(function(){var e=Object(b.a)(d.a.mark((function e(t){var n,s,a,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("users").doc(t.uid).get();case 2:n=e.sent,s=n.data(),a=s.ownPlaylists,r=a.filter((function(e){return e!==c.id})),console.log(r),C.collection("users").doc(t.uid).update({ownPlaylists:r});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),C.collection("playlists").doc(c.id).update({id:c.id,name:o,songs:J,authors:T,image:p,listens:c.listens,creationDate:D,subscribers:c.subscribers,isAlbum:1===ee,imageColors:Ce,isPrivate:1==ae});case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Be(e){clearTimeout(n),n=setTimeout(e,1e3)}return Object(s.useEffect)((function(){0===Y.length&&c.songs.map(function(){var e=Object(b.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),e.next=3,C.collection("songs").doc(t).get();case 3:n=e.sent.data(),xe(!1),console.log(n),q((function(e){return[].concat(Object(j.a)(e),[n])}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[Y]),Object(f.jsxs)("div",{className:"AddSong",children:[Object(f.jsx)(pe.a,{src:ye,getColors:function(e){return ke(e)}}),Object(f.jsxs)("form",{children:[Object(f.jsxs)("label",{children:[Object(f.jsx)("h3",{children:"Playlist name"}),Object(f.jsx)("input",{type:"text",placeholder:"Enter playlist name",value:o,onChange:function(e){return l(e.target.value)},required:!0})]}),Object(f.jsxs)("label",{children:[Object(f.jsx)("h3",{children:"Playlist authors"}),Object(f.jsx)("input",{type:"text",placeholder:"Enter author name",value:y,onChange:function(e){return S(e.target.value)},style:{marginBottom:"5px"},onKeyUp:function(){return Be(Ie)},onKeyDown:function(){return clearTimeout(n)}}),Object(f.jsx)("div",{className:"chosenAuthorsList",children:T.map((function(e){return Object(f.jsxs)("div",{className:"chosenAuthorItem",children:[Object(f.jsx)("span",{children:e.displayName}),Object(f.jsx)(W.H,{onClick:function(){return e.uid===a.uid?null:Te(e)}})]})}))}),Object(f.jsx)("div",{className:"authorsResult",children:le?Object(f.jsx)("div",{style:{position:"relative",width:"100%",height:"50px"},children:Object(f.jsx)(re,{})}):I.map((function(e,t){return Object(f.jsx)(v,{data:e,onClick:function(){return function(e){if(!T.some((function(t){return t.uid===e.uid})))return E((function(t){return[].concat(Object(j.a)(t),[{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL}])}));Te(e)}(e)},style:T.includes(e.uid)?{background:"var(--green)"}:{}},t)}))})]}),Object(f.jsxs)("label",{children:[Object(f.jsx)("h3",{children:"Search for songs"}),Object(f.jsx)("input",(t={type:"text",placeholder:"Search for songs",value:Y,onChange:function(e){return K(e.target.value)},onKeyDown:Pe,onKeyUp:function(){return Be(Pe)}},Object(de.a)(t,"onKeyDown",(function(){return clearTimeout(n)})),Object(de.a)(t,"style",{marginBottom:"5px"}),t)),Object(f.jsx)("div",{className:"chosenAuthorsList",children:J.map((function(e){return Object(f.jsxs)("div",{className:"chosenAuthorItem",children:[Object(f.jsx)("span",{children:e}),Object(f.jsx)(W.H,{onClick:function(){return function(e){var t=J.filter((function(t){return t!==e}));return _(t)}(e)}})]})}))}),Object(f.jsx)("div",{className:"authorsResult",children:me?Object(f.jsx)("div",{style:{position:"relative",width:"100%",height:"50px"},children:Object(f.jsx)(re,{})}):Object(f.jsx)(Re,{listOfSongs:Q,source:"no",listOfChosenSongs:J,setListOfSongs:_})})]}),a.isAdmin||a.isAuthor?Object(f.jsxs)("div",{style:{display:"flex",justifyContent:"flex-start",margin:"15px 0"},children:[Object(f.jsx)(be,{label:"Playlist",onClick:function(){return te(0)},currentActive:ee,id:0}),Object(f.jsx)(be,{label:"Album",onClick:function(){return te(1)},currentActive:ee,id:1})]}):null,Object(f.jsxs)("div",{style:{display:"flex",justifyContent:"flex-start",margin:"15px 0"},children:[Object(f.jsx)(be,{label:"Not Private",onClick:function(){return ie(0)},currentActive:ae,id:0}),Object(f.jsx)(be,{label:"Private",onClick:function(){return ie(1)},currentActive:ae,id:1})]}),a.isAdmin||a.isAuthor?Object(f.jsxs)("label",{children:[Object(f.jsx)("h3",{children:"Release Date"}),Object(f.jsx)("input",{type:"date",name:"",id:"",value:D,onChange:function(e){return U(e.target.value)}})]}):null,Object(f.jsxs)("label",{className:"downloadFile",children:[Object(f.jsxs)("div",{className:"downloadPhoto",children:[Object(f.jsxs)("span",{className:"downloadBtnText",children:[Object(f.jsx)(je.d,{}),"Download playlist cover"]}),Object(f.jsx)("span",{className:"photoLoadLine",style:""!==p?{width:"100%"}:{}})]}),Object(f.jsx)("input",{type:"file",name:"",id:"",onChange:function(e){return function(e,t,n){return Ee.apply(this,arguments)}(e,"songsImages/",m)}})]}),Object(f.jsx)("button",{type:"button",className:"addSongBtn",onClick:function(e){return Me.apply(this,arguments)},children:"Update playlist"})]})]})},De=function(){var e=Object(b.a)(d.a.mark((function e(t,n){var s,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("users").doc(n.uid).get();case 2:(s=e.sent.data().addedAuthors).push(t.uid),C.collection("users").doc(n.uid).update({addedAuthors:s}),c=t.subscribers,c++,C.collection("users").doc(t.uid).update({subscribers:c});case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();function Ue(e,t){var n=e.friends,s=t.friends;n.push({status:"requested",uid:t.uid}),s.push({status:"awaiting",uid:e.uid}),C.collection("users").doc(e.uid).update({friends:n}),C.collection("users").doc(t.uid).update({friends:s})}n(120);var We=function(e){var t=e.userUID,n=Object(s.useState)(""),c=Object(u.a)(n,2),a=c[0],r=c[1],i=Object(s.useState)(!1),o=Object(u.a)(i,2),l=o[0],d=o[1];return Object(s.useEffect)((function(){var e=C.collection("users").doc(t).onSnapshot((function(e){if(void 0!==t){var n=(new Date).getTime()-3e5,s=e.data().online>n;d(s),void 0===e.data().online?r("offline"):s||r("last seen "+K(e.data().online,3))}}));return function(){e()}}),[C,t]),l?Object(f.jsx)("span",{children:"Online"}):Object(f.jsx)("span",{children:a})},Fe=function(){var e=Object(b.a)(d.a.mark((function e(t,n){var s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("users").doc(n.uid).get();case 2:(s=e.sent.data().addedPlaylists).push(t.id),C.collection("users").doc(n.uid).update({addedPlaylists:s}),C.collection("playlists").doc(t.id).update({subscribers:++t.subscribers});case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),He=function(){var e=Object(b.a)(d.a.mark((function e(t,n){var s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=n.addedPlaylists.filter((function(e){return e!==t.id})),C.collection("users").doc(n.uid).update({addedPlaylists:s}),C.collection("playlists").doc(t.id).update({subscribers:--t.subscribers});case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Ye=(n(260),function(){$().setContent;return Object(f.jsx)("div",{className:"GeneralSettings",children:"Settings"})}),Ke=function(){var e=$().setContent,t=[{id:0,title:"General",icon:Object(f.jsx)(W.o,{}),to:Object(f.jsx)(Ye,{}),color:"var(--red)"},{id:1,title:"General",icon:Object(f.jsx)(W.o,{}),to:Object(f.jsx)("h2",{children:"Test"}),color:"var(--lightBlue)"},{id:2,title:"General",icon:Object(f.jsx)(W.o,{}),to:Object(f.jsx)("h2",{children:"Test"}),color:"var(--green)"}];return Object(f.jsx)("div",{className:"SettingsList",children:t.map((function(t){return Object(f.jsxs)("button",{className:"SettingItem",style:{color:t.color},onClick:function(){return e(t.to)},children:[Object(f.jsxs)("div",{className:"settingItemIconAndTitle",children:[t.icon,Object(f.jsx)("h3",{children:t.title})]}),Object(f.jsx)(x.a,{})]},t.id)}))})},Ve=function(e){var t=e.data,n=$().setContent;return Object(f.jsxs)("div",{className:"AuthorMoreWindow",style:{top:"110%",bottom:"auto"},onClick:function(e){return e.stopPropagation()},children:[Object(f.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){n(Object(f.jsx)(le,{item:t,whatToShare:void 0!==t.authors?"playlist":"author"}))},children:[Object(f.jsx)(W.z,{}),"Share"]}),Object(f.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){n(Object(f.jsx)("h2",{children:"test"}))},children:[Object(f.jsx)(W.n,{}),"Info"]}),Object(f.jsxs)("div",{className:"songItemMenuWindowItem",children:[Object(f.jsx)(W.i,{}),"Flag"]})]})},ze=function(e){var t=e.amountOfPages,n=e.currentPage;return Object(f.jsx)("div",{className:"CirclePages",children:t.map((function(e,t){return Object(f.jsx)("div",{className:"circleItem",style:t===n?{background:"var(--reallyLightBlue)"}:{}})}))})},Qe=n(39),qe=function(e){var t,n,c=e.data,a=e.headerColors,r=z().isMobile,i=D(),o=i.displayAuthors,l=(i.setYourPlaylists,Object(s.useState)([])),h=Object(u.a)(l,2),O=h[0],p=h[1],m=Object(s.useState)([]),g=Object(u.a)(m,2),v=g[0],y=g[1],S=M(),w=S.currentUser,N=S.logout,k=Object(s.useState)(0),I=Object(u.a)(k,2),A=I[0],P=I[1],L=Object(s.useState)(0),T=Object(u.a)(L,2),E=T[0],R=T[1],B=Object(s.useState)(.05),U=Object(u.a)(B,2),H=U[0],Y=U[1],V=Object(s.useState)(!1),Q=Object(u.a)(V,2),Z=Q[0],ee=Q[1],ne=Object(s.useRef)(null),se=Object(Qe.useSwipeable)({onSwiping:function(e){R(e.deltaX)}}),ce=$(),re=ce.toggleModal,oe=ce.setContent,ue=ce.openConfirm,de=ce.closeConfirm,je=w.friends.find((function(e){return e.uid===c.uid&&"added"===e.status})),be=Object(s.useRef)(null);function he(){return(he=Object(b.a)(d.a.mark((function e(){var t,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===c.authors||O.length){e.next=7;break}return t=c.authors.map((function(e){return e.uid})),n=C.collection("users").where("uid","in",t),e.next=5,n.get();case 5:e.sent.docs.forEach((function(e){console.log(e.data()),p((function(t){return[].concat(Object(j.a)(t),[e.data()])})),y((function(t){return[].concat(Object(j.a)(t),[e.data().photoURL])}))}));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}te(be,ee),Object(s.useEffect)((function(){0===A&&E<-150?(P(1),R(0)):1===A&&E>150&&(P(0),R(0))}),[E]),console.log(E),Object(s.useEffect)((function(){!function(){he.apply(this,arguments)}()}),[c]);function fe(){}return Object(f.jsxs)("div",{className:"Header",style:a.length?{background:"linear-gradient(45deg, ".concat(a[2],", ").concat(a[0],")")}:{background:"var(--yellowAndPinkGrad)"},ref:function(e){se.ref(e),ne.current=e},onTouchEnd:function(){var e;clearTimeout(e),Y(.2),R(0),e=setTimeout((function(){Y(0)}),200)},children:[Object(f.jsxs)("div",{className:"headerBtns",style:{background:a[2]},children:[Object(f.jsx)(G,{}),Object(f.jsxs)("div",{style:{display:"flex"},children:[Object(f.jsx)("div",{className:"headerBackBtn",children:c.authors?w.ownPlaylists.includes(c.id)?Object(f.jsxs)("button",{onClick:function(){return ue("Are you sure you want to DELETE this playlist forever?!","Yes, pretty sure","No, I Don't!",(function(){de()}))},children:[Object(f.jsx)(q,{text:"delete playlist",direction:"bottom"}),Object(f.jsx)(W.A,{})]}):w.addedPlaylists.includes(c.id)?Object(f.jsxs)("button",{onClick:function(){return ue("Are you sure you want to remove this playlist from library?","Yes, pretty sure","No-no-no, go away",(function(){He(c,w),de()}))},children:[Object(f.jsx)(q,{text:"remove playlist from library",direction:"bottom"}),Object(f.jsx)(_.a,{})]}):Object(f.jsxs)("button",{onClick:function(){return Fe(c,w)},children:[Object(f.jsx)(q,{text:"add playlist",direction:"bottom"}),Object(f.jsx)(W.w,{})]}):w.addedAuthors.includes(c.uid)?Object(f.jsxs)("button",{children:[Object(f.jsx)(q,{text:"remove author from library",direction:"bottom"}),Object(f.jsx)(_.a,{})]}):w.uid===c.uid?Object(f.jsxs)("button",{onClick:function(){re(),oe(Object(f.jsx)(Ke,{}))},children:[Object(f.jsx)(q,{text:"settings",direction:"bottom"}),Object(f.jsx)(W.y,{})]}):!c.isAuthor&&w.friends.find((function(e){return e.uid===c.uid&&"added"===e.status}))?Object(f.jsxs)("button",{onClick:fe,children:[Object(f.jsx)(q,{text:"remove from friend list",direction:"bottom"}),Object(f.jsx)(W.D,{})]}):!c.isAuthor&&w.friends.find((function(e){return e.uid===c.uid&&"awaiting"===e.status}))?Object(f.jsxs)("button",{onClick:Ue,children:[Object(f.jsx)(q,{text:"waiting for response",direction:"bottom"}),Object(f.jsx)(ie.i,{style:{animation:"loading 1s infinite linear"}})]}):c.isAuthor?Object(f.jsxs)("button",{onClick:function(){return De(c,w)},children:[Object(f.jsx)(q,{text:"subscribe",direction:"bottom"}),Object(f.jsx)(W.w,{})]}):Object(f.jsxs)("button",{onClick:function(){return Ue(c,w)},children:[Object(f.jsx)(q,{text:"add friend",direction:"bottom"}),Object(f.jsx)(W.E,{})]})}),Object(f.jsxs)("div",{className:"headerMoreBtn",ref:be,children:[Object(f.jsxs)("button",{onClick:r?function(){re(),oe(Object(f.jsx)(Ve,{data:c}))}:function(){return ee(!Z)},children:[Object(f.jsx)(q,{text:"more",direction:"bottom"}),Object(f.jsx)(W.s,{})]}),Z?Object(f.jsxs)("div",{className:"songItemMenuWindow",style:{top:"110%",bottom:"auto"},onClick:function(e){return e.stopPropagation()},children:[Object(f.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){re(),oe(Object(f.jsx)(le,{item:c,whatToShare:void 0!==c.authors?"playlist":"author"}))},children:[Object(f.jsx)(W.z,{}),"Share"]}),Object(f.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){re(),oe(Object(f.jsx)("h2",{children:"test"}))},children:[Object(f.jsx)(W.n,{}),"Info"]}),Object(f.jsxs)("div",{className:"songItemMenuWindowItem",children:[Object(f.jsx)(W.i,{}),"Flag"]})]}):null]})]}),w.uid===c.uid?Object(f.jsxs)("button",{onClick:N,children:[Object(f.jsx)(q,{text:"quit",direction:"bottom"}),Object(f.jsx)(x.e,{})]}):null]}),Object(f.jsx)("div",{style:{transform:"translateX(".concat(E,"px)"),transition:H+"s",opacity:1-Math.abs(E/200)},children:0===A?Object(f.jsxs)("div",{children:[Object(f.jsx)("div",{className:"headerAuthorsImage",style:void 0===c.authors?{animation:"floatingBorderRadius 10s infinite ease-in-out"}:{},children:Object(f.jsx)("img",{src:c.photoURL||c.image,alt:""})}),Object(f.jsxs)("div",{className:"headerAuthorInfo",children:[Object(f.jsxs)("div",{className:"headerAuthorsName",children:[void 0!==c.authors?c.isAlbum?Object(f.jsx)("h5",{children:"Album"}):Object(f.jsx)("h5",{children:"Playlist"}):c.isAuthor?Object(f.jsx)("h5",{children:"Author"}):Object(f.jsxs)("h5",{children:["User ",void 0===c.authors&&je?Object(f.jsx)(We,{userUID:c.uid}):null]}),Object(f.jsxs)("div",{style:{display:"flex",alignItems:"center",margin:"2px 0 10px 0"},children:[Object(f.jsx)("h1",{children:c.displayName||c.name}),c.isVerified?Object(f.jsx)(F.b,{style:{color:a[0]}}):null,c.isPrivate?Object(f.jsx)(_.b,{}):null,c.authors&&c.authors.find((function(e){return e.uid===w.uid}))||c.authors&&w.isAdmin?Object(f.jsx)("button",{onClick:function(){re(),oe(Object(f.jsx)(Be,{playlist:c}))},className:"customizeAlbumBtn",children:Object(f.jsx)(W.h,{})}):null]})]}),void 0!==c.authors?Object(f.jsxs)("div",{className:"headerAuthorsImagesAndNames",children:[Object(f.jsx)(X,{imagesList:v,borderColor:a[2]}),Object(f.jsx)("div",{className:"headerAuthors",children:o(O,", ")})]}):null,Object(f.jsxs)("div",{className:"headerListenersAndSubs",children:[Object(f.jsxs)("div",{className:"headerListenersAndSubsItem",title:(null!==(t=c.listens)&&void 0!==t?t:c.numberOfListenersPerMonth)+" listeners per month",children:[Object(f.jsx)("span",{children:J(null!==(n=c.listens)&&void 0!==n?n:c.numberOfListenersPerMonth)}),Object(f.jsx)(W.k,{})]}),Object(f.jsxs)("div",{className:"headerListenersAndSubsItem",title:c.subscribers+" subscribers",children:[Object(f.jsx)("span",{children:J(c.subscribers)}),Object(f.jsx)(W.E,{})]}),void 0!==c.creationDate?Object(f.jsx)("div",{className:"headerListenersAndSubsItem",children:Object(f.jsx)("span",{children:K(c.creationDate)})}):null]}),je?Object(f.jsx)(ae,{data:c,color:a[3]}):null]})]}):Object(f.jsx)("div",{children:"hello"})}),r?Object(f.jsx)(ze,{amountOfPages:[1,2],currentPage:A}):null]})},Ge=function(){var e=Object(o.h)("/albums/:albumId"),t=Object(s.useState)([]),n=Object(u.a)(t,2),c=n[0],a=n[1],r=Object(s.useState)([]),i=Object(u.a)(r,2),l=i[0],h=i[1],O=e.params.albumId,p=Object(s.useState)([]),m=Object(u.a)(p,2),x=m[0],g=m[1],v=Object(s.useState)(!0),y=Object(u.a)(v,2),S=y[0],w=y[1];function N(){return(N=Object(b.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:C.collection("playlists").doc(O).onSnapshot((function(e){e.exists?(g(e.data()),h(e.data().imageColors)):console.log("No such document!")}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){!function(){N.apply(this,arguments)}()}),[O,C]),Object(s.useEffect)((function(){a([]),0!==x.length&&(x.songs.map(function(){var e=Object(b.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("songs").doc(t).get();case 2:n=e.sent.data(),a((function(e){return[].concat(Object(j.a)(e),[n])}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),w(!1))}),[x]),Object(f.jsx)("div",{className:"AlbumPage",style:{animation:"zoomIn .2s forwards"},children:S?Object(f.jsx)(re,{top:"50%"}):Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(qe,{data:x,headerColors:l,setHeaderColors:h}),Object(f.jsx)(Re,{listOfSongs:c,source:{source:"/albums/".concat(x.id),name:x.name,image:x.image,songsList:c},showSearch:!0,defaultSearchMode:"songs"})]})})},Xe=function(){var e,t,n=M().currentUser,c=Object(s.useState)(""),a=Object(u.a)(c,2),r=a[0],i=a[1],o=Object(s.useState)(""),l=Object(u.a)(o,2),h=l[0],O=l[1],p=Object(s.useState)(""),m=Object(u.a)(p,2),x=m[0],g=m[1],y=Object(s.useState)([]),S=Object(u.a)(y,2),w=S[0],k=S[1],I=Object(s.useState)(n.isAdmin?[]:[{uid:n.uid,photoURL:n.photoURL,displayName:n.displayName}]),A=Object(u.a)(I,2),P=A[0],L=A[1],E=Object(s.useState)(n.isAdmin?"":(new Date).toString()),R=Object(u.a)(E,2),B=R[0],D=R[1],U=Object(s.useState)(""),F=Object(u.a)(U,2),H=F[0],Y=F[1],K=Object(s.useState)([]),V=Object(u.a)(K,2),z=V[0],Q=V[1],q=Object(s.useState)([]),G=Object(u.a)(q,2),X=G[0],J=G[1],_=Object(s.useState)(0),Z=Object(u.a)(_,2),$=Z[0],ee=Z[1],te=Object(s.useState)(0),se=Object(u.a)(te,2),ce=se[0],ae=se[1],ie=Object(s.useState)(!1),oe=Object(u.a)(ie,2),ue=oe[0],le=oe[1],he=Object(s.useState)(!1),fe=Object(u.a)(he,2),me=fe[0],xe=fe[1],ge=Object(s.useState)(""),ve=Object(u.a)(ge,2),ye=ve[0],Se=ve[1],we=Object(s.useState)([]),Ne=Object(u.a)(we,2),Ce=Ne[0],ke=Ne[1];function Ie(e){return Ae.apply(this,arguments)}function Ae(){return(Ae=Object(b.a)(d.a.mark((function e(t){var s,c,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return le(!0),k([]),s=n.friends.map((function(e){if("added"===e.status)return e.uid})),c=n.isAdmin?C.collection("users").where("displayName","==",x):C.collection("users").where("uid","in",s).where("displayName","==",x),e.next=6,c.get();case 6:void 0!==(a=e.sent)&&(a.docs.forEach((function(e){k([].concat(Object(j.a)(w),[e.data()]))})),le(!1));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Pe(e){return Le.apply(this,arguments)}function Le(){return(Le=Object(b.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return xe(!0),Q([]),n=C.collection("songs").where("name","==",H),e.next=5,n.get();case 5:e.sent.docs.forEach((function(e){Q([].concat(Object(j.a)(w),[e.data()]))})),xe(!1);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Te(e){var t=P.filter((function(t){return t.uid!==e.uid}));return L(t)}function Ee(){return(Ee=Object(b.a)(d.a.mark((function e(t,n,s){var c,a,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=t.target.files[0],Se(URL.createObjectURL(c)),a=N.ref(),r=a.child(n+c.name),e.next=6,r.put(c);case 6:return e.t0=s,e.next=9,r.getDownloadURL();case 9:e.t1=e.sent,(0,e.t0)(e.t1);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Me(){return(Me=Object(b.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),n=ne(),C.collection("playlists").doc(n).set({id:n,name:r,songs:X,authors:P,image:h,listens:0,creationDate:B,subscribers:0,isAlbum:$,imageColors:Ce,isPrivate:!0===ce}).then((function(){k([]),g(""),L([]),O(""),i(""),D(""),Y(""),J([]),ae(0)})).catch((function(e){console.log(e)})),P.forEach(function(){var e=Object(b.a)(d.a.mark((function e(t){var s,c,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("users").doc(t.uid).get();case 2:s=e.sent,c=s.data(),(a=c.ownPlaylists).push(n),C.collection("users").doc(t.uid).update({ownPlaylists:a});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),C.collection("search").doc(n).set({place:"playlists",uid:n,variantsOfName:T(r)});case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Re(e){clearTimeout(t),t=setTimeout(e,1e3)}return Object(f.jsxs)("div",{className:"AddSong",children:[Object(f.jsx)(pe.a,{src:ye,getColors:function(e){return ke(e)}}),Object(f.jsxs)("form",{onSubmit:function(e){return Me.apply(this,arguments)},children:[Object(f.jsxs)("label",{children:[Object(f.jsx)("h3",{children:"Playlist name"}),Object(f.jsx)("input",{type:"text",placeholder:"Enter playlist name",value:r,onChange:function(e){return i(e.target.value)},required:!0})]}),Object(f.jsxs)("label",{children:[Object(f.jsx)("h3",{children:"Playlist authors"}),Object(f.jsx)("input",{type:"text",placeholder:"Enter author name",value:x,onChange:function(e){return g(e.target.value)},style:{marginBottom:"5px"},onKeyUp:function(){return Re(Ie)},onKeyDown:function(){return clearTimeout(t)}}),Object(f.jsx)("div",{className:"chosenAuthorsList",children:P.map((function(e){return Object(f.jsxs)("div",{className:"chosenAuthorItem",children:[Object(f.jsx)("span",{children:e.displayName}),Object(f.jsx)(W.H,{onClick:function(){return e.uid===n.uid?null:Te(e)}})]})}))}),Object(f.jsx)("div",{className:"authorsResult",children:ue?Object(f.jsx)("div",{style:{position:"relative",width:"100%",height:"50px"},children:Object(f.jsx)(re,{})}):w.map((function(e,t){return Object(f.jsx)(v,{data:e,onClick:function(){return function(e){if(!P.some((function(t){return t.uid===e.uid})))return L((function(t){return[].concat(Object(j.a)(t),[{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL}])}));Te(e)}(e)},style:P.includes(e.uid)?{background:"var(--green)"}:{}},t)}))})]}),Object(f.jsxs)("label",{children:[Object(f.jsx)("h3",{children:"Search for songs"}),Object(f.jsx)("input",(e={type:"text",placeholder:"Search for songs",value:H,onChange:function(e){return Y(e.target.value)},onKeyDown:Pe,onKeyUp:function(){return Re(Pe)}},Object(de.a)(e,"onKeyDown",(function(){return clearTimeout(t)})),Object(de.a)(e,"style",{marginBottom:"5px"}),e)),Object(f.jsx)("div",{className:"chosenAuthorsList",children:X.map((function(e){return Object(f.jsxs)("div",{className:"chosenAuthorItem",children:[Object(f.jsx)("span",{children:e}),Object(f.jsx)(W.H,{onClick:function(){return function(e){var t=X.filter((function(t){return t!==e}));return J(t)}(e)}})]})}))}),Object(f.jsx)("div",{className:"authorsResult",children:me?Object(f.jsx)("div",{style:{position:"relative",width:"100%",height:"50px"},children:Object(f.jsx)(re,{})}):z.map((function(e,t){return Object(f.jsx)(Oe,{song:e,listOfSongs:X,setListOfSongs:J})}))})]}),n.isAdmin||n.isAuthor?Object(f.jsxs)("div",{style:{display:"flex",justifyContent:"flex-start",margin:"15px 0"},children:[Object(f.jsx)(be,{label:"Playlist",onClick:function(){return ee(0)},currentActive:$,id:0}),Object(f.jsx)(be,{label:"Album",onClick:function(){return ee(1)},currentActive:$,id:1})]}):null,Object(f.jsxs)("div",{style:{display:"flex",justifyContent:"flex-start",margin:"15px 0"},children:[Object(f.jsx)(be,{label:"Not Private",onClick:function(){return ae(0)},currentActive:ce,id:0}),Object(f.jsx)(be,{label:"Private",onClick:function(){return ae(1)},currentActive:ce,id:1})]}),n.isAdmin||n.isAuthor?Object(f.jsxs)("label",{children:[Object(f.jsx)("h3",{children:"Release Date"}),Object(f.jsx)("input",{type:"date",name:"",id:"",value:B,onChange:function(e){return D(e.target.value)}})]}):null,Object(f.jsxs)("label",{className:"downloadFile",children:[Object(f.jsxs)("div",{className:"downloadPhoto",children:[Object(f.jsxs)("span",{className:"downloadBtnText",children:[Object(f.jsx)(je.d,{}),"Download playlist cover"]}),Object(f.jsx)("span",{className:"photoLoadLine",style:""!==h?{width:"100%"}:{}})]}),Object(f.jsx)("input",{type:"file",name:"",id:"",onChange:function(e){return function(e,t,n){return Ee.apply(this,arguments)}(e,"songsImages/",O)}})]}),Object(f.jsx)("button",{type:"submit",className:"addSongBtn",children:"Add playlist"})]})]})},Je=function(e){var t=e.setErrorMessage,n=e.setImageLocalPath,s=e.downloadedPhoto,c=e.setDownloadedPhoto,a=e.place,r=e.btnText,i=void 0===r?"Download song cover":r;function o(){return(o=Object(b.a)(d.a.mark((function e(s,c,a){var r,i,o,u,l,j;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t(""),r=s.target.files[0],i=!1,"songsImages/"===c||"chatCovers/"===c?(console.log("image"),(o=[".jpg",".png",".jpeg"]).find((function(e){return r.name.substr(r.name.length-e.length,e.length)===e}))?i=!0:t("Format of your file is not valid. Download file with one of these: ".concat(o.map((function(e){return" "+e}))))):"songs/"===c&&(console.log("song"),(u=[".mp3",".mp4a",".flac",".wav",".wma"]).find((function(e){return r.name.substr(r.name.length-e.length,e.length)===e}))?i=!0:t("Format of your file is not valid. Download file with one of these: ".concat(u.map((function(e){return e}))))),!i){e.next=16;break}return console.log(r),n(URL.createObjectURL(r)),l=N.ref(),j=l.child(c+r.name),e.next=11,j.put(r);case 11:return e.t0=a,e.next=14,j.getDownloadURL();case 14:e.t1=e.sent,(0,e.t0)(e.t1);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(f.jsxs)("label",{className:"downloadFile",children:[Object(f.jsxs)("div",{className:"downloadPhoto",children:[Object(f.jsxs)("span",{className:"downloadBtnText",children:[Object(f.jsx)(je.d,{}),i]}),Object(f.jsx)("span",{className:"photoLoadLine",style:""!==s?{width:"100%"}:{}})]}),Object(f.jsx)("input",{type:"file",name:"",id:"",onChange:function(e){return function(e,t,n){return o.apply(this,arguments)}(e,a,c)}})]})},_e=function(e){var t=e.errorMessage;return t&&Object(f.jsx)("div",{className:"Alert",children:t})},Ze=function(e){var t=e.loading;return Object(f.jsx)("div",{className:"FullScreenLoading",style:t?{}:{opacity:"0",visibility:"hidden"},children:Object(f.jsx)("img",{src:"https://icon-library.com/images/spinner-icon-gif/spinner-icon-gif-28.jpg",alt:""})})},$e=function(){var e=M().currentUser,t=Object(s.useState)(""),n=Object(u.a)(t,2),c=n[0],a=n[1],r=Object(s.useState)(""),i=Object(u.a)(r,2),o=i[0],l=i[1],h=Object(s.useState)(""),O=Object(u.a)(h,2),p=O[0],m=O[1],x=Object(s.useState)(""),g=Object(u.a)(x,2),y=g[0],S=g[1],w=Object(s.useState)([]),k=Object(u.a)(w,2),I=k[0],A=k[1],P=Object(s.useState)(e.isAdmin?[]:[{uid:e.uid,photoURL:e.photoURL,displayName:e.displayName}]),L=Object(u.a)(P,2),E=L[0],R=L[1],B=Object(s.useState)(""),D=Object(u.a)(B,2),U=D[0],F=D[1],H=Object(s.useState)(""),Y=Object(u.a)(H,2),K=Y[0],V=Y[1],z=Object(s.useState)(""),Q=Object(u.a)(z,2),q=Q[0],G=Q[1],X=Object(s.useState)([]),J=Object(u.a)(X,2),_=J[0],Z=J[1],$=Object(s.useState)(!1),ee=Object(u.a)($,2),te=ee[0],se=(ee[1],Object(s.useState)([])),ce=Object(u.a)(se,2),ae=ce[0],ie=ce[1],oe=Object(s.useState)(""),le=Object(u.a)(oe,2),de=le[0],be=le[1],he=Object(s.useState)(!1),fe=Object(u.a)(he,2),Oe=fe[0],me=fe[1],xe=Object(s.useState)(!1),ge=Object(u.a)(xe,2),ve=ge[0],ye=ge[1];function Se(e){var t=E.filter((function(t){return t.uid!==e.uid}));return R(t)}function we(){return(we=Object(b.a)(d.a.mark((function e(t,n,s){var c,a,r,i,o,u;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(be(""),c=t.target.files[0],a=!1,"songsImages/"===n?(r=[".jpg",".png",".jpeg"]).find((function(e){return c.name.substr(c.name.length-e.length,e.length)===e}))?a=!0:be("Format of your file is not valid. Download file with one of these: ".concat(r.map((function(e){return" "+e})))):"songs/"===n&&((i=[".mp3",".mp4a",".flac",".wav",".wma"]).find((function(e){return c.name.substr(c.name.length-e.length,e.length)===e}))?a=!0:be("Format of your file is not valid. Download file with one of these: ".concat(i.map((function(e){return e}))))),!a){e.next=15;break}return G(URL.createObjectURL(c)),o=N.ref(),u=o.child(n+c.name),e.next=10,u.put(c);case 10:return e.t0=s,e.next=13,u.getDownloadURL();case 13:e.t1=e.sent,(0,e.t0)(e.t1);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ne(){return(Ne=Object(b.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),ye(!0),n=ne(),console.log(ae),be(""),0===c.length?be("Song has to have some name"):0===E.length?be("Song has to have at least 1 author"):0===o.length?be("You didn't load song cover"):0===p.length?be("You didn't load song file"):0===U.length?be("You have to set release date for a song"):(C.collection("songs").doc(n).set({id:n,name:c,songSrc:p,authors:E,cover:o,listens:0,releaseDate:U,lyrics:ae,imageColors:_}).then((function(){A([]),S(""),R([]),V([]),l(""),a(""),m(""),F(""),V([]),me(!0),Z([]),ye(!1)})).catch((function(e){be(e),ye(!1)})),E.forEach(function(){var e=Object(b.a)(d.a.mark((function e(t){var s,c,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("users").doc(t.uid).get();case 2:s=e.sent,c=s.data(),(a=c.ownSongs).push(n),C.collection("users").doc(t.uid).update({ownSongs:a});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),C.collection("search").doc(n).set({place:"songs",uid:n,variantsOfName:T(c)}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){Oe&&setTimeout((function(){me(!1)}),2e3)}),[Oe]),Object(f.jsxs)("div",{className:"AddSong",children:[Object(f.jsx)(Ze,{loading:ve}),Object(f.jsx)(pe.a,{src:q,getColors:function(e){return Z(e)}}),Object(f.jsxs)("form",{onSubmit:function(e){return Ne.apply(this,arguments)},children:[Object(f.jsxs)("label",{children:[Object(f.jsx)("h3",{children:"Song name"}),Object(f.jsx)("input",{type:"text",placeholder:"Enter song name",value:c,onChange:function(e){return a(e.target.value)}})]}),Object(f.jsxs)("label",{children:[Object(f.jsx)("h3",{children:"Song authors"}),Object(f.jsx)(ue,{value:y,setValue:S,setResultAuthorList:A,defaultSearchMode:"authors"}),Object(f.jsx)("div",{className:"chosenAuthorsList",children:E.map((function(t){return Object(f.jsxs)("div",{className:"chosenAuthorItem",children:[Object(f.jsx)("span",{children:t.displayName}),Object(f.jsx)(W.H,{onClick:function(){(e.isAdmin||t.uid!==e.uid)&&Se(t)}})]})}))}),Object(f.jsx)("div",{className:"authorsResult",children:te?Object(f.jsx)("div",{style:{position:"relative",width:"100%",height:"50px"},children:Object(f.jsx)(re,{})}):I.map((function(e,t){return Object(f.jsx)(v,{data:e,onClick:function(){return function(e){if(!E.some((function(t){return t.uid===e.uid})))return R((function(t){return[].concat(Object(j.a)(t),[{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL}])}));Se(e)}(e)},style:E.includes(e.uid)?{background:"var(--green)"}:{}},t)}))})]}),Object(f.jsxs)("label",{children:[Object(f.jsx)("h3",{children:"Release Date"}),Object(f.jsx)("input",{type:"date",name:"",id:"",value:U,onChange:function(e){return F(e.target.value)}})]}),Object(f.jsx)(_e,{errorMessage:de}),Object(f.jsx)("div",{style:{width:"100%",display:"flex"},children:_.map((function(e,t){return Object(f.jsx)("input",{type:"color",value:e,style:{width:"100%",height:"60px",padding:"0",borderRadius:"0px"},onChange:function(e){!function(e,t){_[t]=e.target.value,Z(Object(j.a)(_))}(e,t)}})}))}),Object(f.jsx)(Je,{setErrorMessage:be,setImageLocalPath:G,downloadedPhoto:o,setDownloadedPhoto:l,place:"songsImages/"}),Object(f.jsxs)("label",{className:"downloadFile",children:[Object(f.jsxs)("div",{className:"downloadPhoto",children:[Object(f.jsxs)("span",{className:"downloadBtnText",children:[Object(f.jsx)(je.d,{}),"Download song file"]}),Object(f.jsx)("span",{className:"photoLoadLine",style:""!==p?{width:"100%"}:{}})]}),Object(f.jsx)("input",{type:"file",name:"",id:"",onChange:function(e){return function(e,t,n){return we.apply(this,arguments)}(e,"songs/",m)}})]}),Object(f.jsx)("label",{children:Object(f.jsx)("textarea",{name:"",id:"",placeholder:"Add song lyrics",value:K,onKeyDown:function(e){for(var t=[],n=0,s=0;s<K.length;s++)"\n"!==K[s]&&void 0!==K[s+1]||(t.push({startTime:"undefined",text:K.substr(n,s-n)}),n=s+1);ie(t)},onChange:function(e){return V(e.target.value)}})}),Object(f.jsx)("button",{type:"submit",className:"addSongBtn",children:Oe?"Song Successfully added. Congrats!":"Add song"})]})]})},et=function(e){var t=e.pages,n=e.currentPage,s=e.setCurrentPage;return Object(f.jsx)("div",{className:"Slider",children:t.map((function(e,t){return Object(f.jsx)("div",{className:"sliderItem "+(t===n?"current":""),onClick:function(){return s(t)},children:e},t)}))})},tt=function(e){var t=e.data,n=M().currentUser,c=Object(s.useState)(!1),a=Object(u.a)(c,2),r=a[0],i=a[1],o=Object(s.useState)(0),l=Object(u.a)(o,2),d=l[0],j=l[1],b=[Object(f.jsx)($e,{}),Object(f.jsx)(Xe,{})];return(n.isAdmin||t.isAuthor)&&t.uid===n.uid?Object(f.jsxs)("div",{className:"AddSong",children:[Object(f.jsx)("button",{onClick:function(){return i(!r)},style:r?{background:"var(--red)"}:{},className:"openAddSongWindowBtn",children:Object(f.jsx)(W.v,{style:r?{transform:"rotate(45deg)"}:{}})}),Object(f.jsxs)("div",{className:"addSongWindow",style:r?{display:"flex"}:{},children:[Object(f.jsx)(et,{pages:["Song","Playlists"],currentPage:d,setCurrentPage:j}),b[d]]})]}):null},nt=function(e){var t=e.person,n=e.addFriend,s=e.rejectFriend;return Object(f.jsxs)("div",{className:"FriendRequestItem",children:[Object(f.jsx)(i.b,{to:"/authors/".concat(t.uid),children:Object(f.jsxs)("div",{className:"friendRequestImageAndName",children:[Object(f.jsx)("div",{className:"requestImage",children:Object(f.jsx)("img",{src:t.photoURL,alt:""})}),Object(f.jsx)("h3",{children:t.displayName})]})}),Object(f.jsxs)("div",{className:"requestButtons",children:[Object(f.jsxs)("button",{style:{color:"var(--green)"},onClick:function(){return n(t.uid)},children:[Object(f.jsx)(W.b,{}),Object(f.jsx)("span",{children:"Add"})]}),Object(f.jsxs)("button",{style:{color:"var( --lightRed)"},onClick:function(){return s(t.uid)},children:[Object(f.jsx)(W.G,{}),Object(f.jsx)("span",{children:"Reject"})]})]})]})},st=function(){var e=M().currentUser,t=Object(s.useState)([]),n=Object(u.a)(t,2),c=n[0],a=n[1];function r(t){var n=e.friends,s=c.find((function(e){return e.uid===t})).friends;n.find((function(e){return e.uid===t})).status="added",s.find((function(t){return t.uid===e.uid})).status="added",C.collection("users").doc(e.uid).update({friends:n}),C.collection("users").doc(t).update({friends:s}),e.friends=n}function i(t){var n=e.friends,s=c.find((function(e){return e.uid===t})).friends;n.find((function(e){return e.uid===t})).status="rejected",s.find((function(t){return t.uid===e.uid})).status="rejected",C.collection("users").doc(e.uid).update({friends:n}),C.collection("users").doc(t).update({friends:s})}return Object(s.useEffect)((function(){e.friends.forEach(function(){var e=Object(b.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("requested"!==t.status){e.next=5;break}return e.next=3,C.collection("users").doc(t.uid).get();case 3:n=e.sent.data(),a((function(e){return[].concat(Object(j.a)(e),[n])}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]),Object(f.jsx)("div",{children:c.map((function(e,t){return Object(f.jsx)(nt,{person:e,addFriend:r,rejectFriend:i},t)}))})},ct=function(){var e=Object(b.a)(d.a.mark((function e(t,n,s,c){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n([]),a=[],void 0!==t.ownPlaylists&&0!==t.ownPlaylists.length&&t.ownPlaylists.forEach(function(){var e=Object(b.a)(d.a.mark((function e(r,i){var o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("playlists").doc(r).get();case 2:(o=e.sent.data())&&(!o.isPrivate||t.uid===s&&o.isPrivate)&&a.push(o),i===t.ownPlaylists.length-1&&(a.sort((function(e,t){return new Date(t.creationDate).getTime()-new Date(e.creationDate).getTime()})),c(!1),n(a));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e)})));return function(t,n,s,c){return e.apply(this,arguments)}}(),at=function(e){var t=e.playlist,n=e.listOfChosenAlbums,c=e.setListOfChosenAlbums,a=new Date(t.creationDate),r=M().currentUser,o=z().isMobile,l=D(),h=l.setCurrentSongQueue,O=l.setCurrentSongPlaylistSource,p=l.playSong,m=l.setCurrentSongInQueue,x=l.setCurrentSong,v=l.currentSongPlaylistSource,y=l.songRef,S=l.setPlay,w=l.play,N=Object(s.useState)([]),k=Object(u.a)(N,2),I=k[0],A=k[1];return Object(s.useEffect)((function(){if(I.length){var e={source:"/albums/".concat(t.id),name:t.name,image:t.image,songsList:I},n=I.map((function(e){return e.id}));h(I),m(0),x(I[0].id),y.current.play(),S(!0),O(e),C.collection("users").doc(r.uid).update({lastSongPlayed:I[0].id,lastQueue:{image:e.image,name:e.name,songsList:n,source:e.source}})}}),[I.length]),Object(f.jsxs)(i.b,{to:"/albums/".concat(t.id),style:{textDecoration:"none"},className:"playlistWrapper",children:[Object(f.jsx)(g,{listOfChosenItems:n,setListOfChosenItems:c,itemId:t.id}),Object(f.jsxs)("div",{className:"playlistItem",children:[t.image?Object(f.jsx)("img",{src:t.image,alt:""}):Object(f.jsxs)("h1",{children:[t.name.split(" ")[0][0],t.name.split(" ")[1][0]]}),Object(f.jsx)("button",{onClick:function(e){e.preventDefault(),v.name!==t.name?(A([]),0!==t.length&&t.songs.map(function(){var e=Object(b.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("songs").doc(t).get();case 2:n=e.sent.data(),A((function(e){return[].concat(Object(j.a)(e),[n])}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())):p()},children:v.name===t.name&&w?Object(f.jsx)(fe.b,{}):Object(f.jsx)(fe.c,{})})]}),Object(f.jsxs)("h4",{style:{display:"flex",alignItems:"center",margin:"5px 0"},children:[me(t.name,o?10:15),Object(f.jsx)("span",{style:{fontSize:".6em",opacity:.6,fontWeight:"500",marginLeft:"7px"},children:t.isAlbum?1===t.songs.length?"single":"album":"playlist"})]}),Object(f.jsx)("h5",{style:{margin:"5px 0"},children:a.getFullYear()})]})},rt=function(e){var t=e.listOfAlbums,n=e.title,c=void 0===n?"":n,a=e.loading,r=void 0===a||a,i=e.listOfChosenAlbums,o=e.setListOfChosenAlbums,l=Object(s.useState)(0),d=Object(u.a)(l,2),j=d[0],b=d[1],h=Object(s.useRef)(null),O=Object(s.useState)(!1),p=Object(u.a)(O,2),m=p[0],x=p[1];return Object(s.useEffect)((function(){t.length>0&&!r&&(h.current.scrollWidth>h.current.offsetWidth&&x(!0))}),[t]),t.length>0?r?Object(f.jsx)(re,{}):Object(f.jsxs)("div",{className:"AuthorsList",children:[0!==c.length?Object(f.jsx)("h2",{children:c}):null,Object(f.jsx)("div",{className:"authorsWrapper",ref:h,onScroll:function(e){return b(e.target.scrollLeft)},children:t.map((function(e,t){return Object(f.jsx)(at,{playlist:e,listOfChosenAlbums:i,setListOfChosenAlbums:o},t)}))}),Object(f.jsxs)("div",{className:"authorsShiftButtons",children:[Object(f.jsx)("button",{onClick:function(){var e=h.current.scrollLeft;h.current.scrollLeft=e-220,b(e-220)},style:j<=0?{visibility:"hidden",opacity:"0"}:{},children:Object(f.jsx)(W.d,{})}),Object(f.jsx)("button",{onClick:function(){var e=h.current.scrollLeft;h.current.scrollLeft=e+220,b(e+220)},style:m&&h.current&&h.current.scrollWidth-h.current.offsetWidth!==j?{}:{visibility:"hidden",opacity:"0"},children:Object(f.jsx)(W.e,{})})]})]}):null},it=function(e){var t=e.authorsData,n=M().currentUser,c=Object(s.useState)([]),a=Object(u.a)(c,2),r=a[0],i=a[1],o=Object(s.useState)(!0),l=Object(u.a)(o,2),d=l[0],j=l[1];return Object(s.useEffect)((function(){ct(t,i,n.uid,j)}),[t.ownPlaylists]),Object(f.jsx)(rt,{listOfAlbums:r,title:"Albums",loading:d})};function ot(e,t,n){var s=[];e.forEach((function(e){var t=e.authors;0!==t.length&&s.push(t)})),s=s.flat();for(var c=new Set(s.map((function(e){return e.uid})).filter((function(e){return e!==t.uid}))),a=Array.from(c),r=[],i=0;i<a.length;i++)for(var o=0;o<s.length;o++)if(a[i]===s[o].uid){r.push(s[o]);break}return n(r),r}function ut(e,t){return lt.apply(this,arguments)}function lt(){return(lt=Object(b.a)(d.a.mark((function e(t,n){var s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0!==t&&void 0!==t.ownSongs&&0!==t.ownSongs.length&&(s=[],t.ownSongs.forEach(function(){var e=Object(b.a)(d.a.mark((function e(c,a){var r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("songs").doc(c).get();case 2:if(r=e.sent.data(),s.push(r),a!==t.ownSongs.length-1){e.next=6;break}return e.abrupt("return",ot(s,t,n));case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var dt=function(e){var t=e.data,n=e.listOfChosenAuthors,s=e.setListOfChosenAuthors;return Object(f.jsxs)(i.b,{to:"/authors/".concat(t.uid),className:"AuthorItemBig",children:[Object(f.jsx)(g,{listOfChosenItems:n,setListOfChosenItems:s,itemId:t.uid}),Object(f.jsxs)("div",{children:[Object(f.jsx)("div",{className:"AuthorItemBigImage",children:Object(f.jsx)("img",{src:t.photoURL,alt:""})}),Object(f.jsx)("h3",{children:t.displayName})]})]})},jt=function(e){var t=e.listOfAuthors,n=e.title,c=void 0===n?"":n,a=e.listOfChosenAuthors,r=e.setListOfChosenAuthors,i=Object(s.useState)(0),o=Object(u.a)(i,2),l=o[0],d=o[1],j=Object(s.useRef)(null),b=Object(s.useState)(!1),h=Object(u.a)(b,2),O=h[0],p=h[1];return Object(s.useEffect)((function(){t.length>0&&(j.current.scrollWidth>j.current.offsetWidth&&p(!0))}),[t]),t.length>0?Object(f.jsxs)("div",{className:"AuthorsList",children:[0!==c.length?Object(f.jsx)("h2",{children:c}):null,Object(f.jsx)("div",{className:"authorsWrapper",ref:j,onScroll:function(e){return d(e.target.scrollLeft)},children:t.map((function(e){return Object(f.jsx)(dt,{data:e,listOfChosenAuthors:a,setListOfChosenAuthors:r},e.uid)}))}),Object(f.jsxs)("div",{className:"authorsShiftButtons",children:[Object(f.jsx)("button",{onClick:function(){var e=j.current.scrollLeft;j.current.scrollLeft=e-200,d(e-200)},style:l<=0?{visibility:"hidden",opacity:"0"}:{},children:Object(f.jsx)(W.d,{})}),Object(f.jsx)("button",{onClick:function(){var e=j.current.scrollLeft;j.current.scrollLeft=e+200,d(e+200)},style:O&&null!==j.current&&j.current.scrollWidth-j.current.offsetWidth!==l?{}:{visibility:"hidden",opacity:"0"},children:Object(f.jsx)(W.e,{})})]})]}):null},bt=function(e){var t=e.data,n=Object(s.useState)([]),c=Object(u.a)(n,2),a=c[0],r=c[1];return Object(s.useEffect)((function(){ut(t,r)}),[t]),Object(f.jsx)(jt,{listOfAuthors:a,title:"Similar Authors"})};function ht(e){var t=new Date(e.releaseDate);return(new Date).getTime()-t.getTime()<18144e5}var ft=function(e){e.authorId;var t=e.authorsData,n=(e.headerColors,Object(s.useState)([])),c=Object(u.a)(n,2),a=c[0],r=c[1],i=Object(s.useState)([]),o=Object(u.a)(i,2),l=o[0],h=o[1];function O(){return(O=Object(b.a)(d.a.mark((function e(){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r([]),n=[],t.isAuthor?void 0!==t.ownSongs&&0!==t.ownSongs.length&&t.ownSongs.forEach(function(){var e=Object(b.a)(d.a.mark((function e(s,c){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("songs").doc(s).get();case 2:a=e.sent.data(),n.push(a),ht(a)&&!l.includes(a)&&h((function(e){return[].concat(Object(j.a)(e),[a])})),c===t.ownSongs.length-1&&(n.sort((function(e,t){return t.listens-e.listens})),r(n));case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()):t.addedSongs.forEach(function(){var e=Object(b.a)(d.a.mark((function e(s,c){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("songs").doc(s).get();case 2:a=e.sent.data(),n.unshift(a),c===t.addedSongs.length-1&&r(n);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){!function(){O.apply(this,arguments)}(),h([])}),[t.ownSongs]),t.isAuthor?Object(f.jsxs)("div",{className:"TopSongs",children:[Object(f.jsx)(Re,{listOfSongs:l,source:{source:"/authors/".concat(t.uid),name:t.displayName,image:t.photoURL,songsList:l},isNewSong:!0}),Object(f.jsx)(Re,{listOfSongs:a,source:{source:"/authors/".concat(t.uid),name:t.displayName,image:t.photoURL,songsList:a},title:"Popular Songs",showListens:!0,showCount:!0})]}):Object(f.jsx)(Re,{listOfSongs:a,source:{source:"/authors/".concat(t.uid),name:t.displayName+"'s Library",image:t.photoURL,songsList:a},title:t.displayName+"'s Library",showListens:!0,showCount:!0})},Ot=(n(261),function(){var e=Object(o.h)("/authors/:authorId"),t=M().currentUser,n=Object(s.useState)([]),c=Object(u.a)(n,2),a=c[0],r=c[1],i=e.params.authorId,l=Object(s.useState)([]),j=Object(u.a)(l,2),h=j[0],O=j[1],p=Object(s.useState)(!0),m=Object(u.a)(p,2),x=m[0],g=m[1];function v(){return(v=Object(b.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:C.collection("users").doc(i).get().then((function(e){e.exists?(O(e.data()),r(e.data().imageColors),g(!1)):console.log("No such document!")})).catch((function(e){console.log("Error getting document:",e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){!function(){v.apply(this,arguments)}()}),[i]),Object(f.jsx)("div",{className:"AuthorPage",style:{animation:"zoomIn .2s forwards"},children:x?Object(f.jsx)(re,{}):Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(qe,{data:h,headerColors:a,setHeaderColors:r}),t.uid===h.uid?Object(f.jsx)(st,{}):null,Object(f.jsx)(tt,{data:h}),Object(f.jsx)(ft,{author:i,authorsData:h,headerColors:a}),h.friends&&!h.isAuthor?Object(f.jsx)(Ne,{data:h,title:"Friends"}):null,Object(f.jsx)(it,{authorsData:h,headerColors:a}),h.isAuthor?Object(f.jsx)(bt,{data:h}):null]})})}),pt=function(e){var t=e.chatId,n=Object(s.useState)([]),c=Object(u.a)(n,2),a=c[0],r=c[1],i=Object(s.useState)(!0),o=Object(u.a)(i,2),l=o[0],h=o[1],O=Object(s.useState)(0),p=Object(u.a)(O,2),m=p[0],x=p[1],g=[Object(f.jsx)(Re,{listOfSongs:a,source:{source:"/chat/".concat(t),name:"Chat with ".concat(t),image:"",songsList:a}}),Object(f.jsx)(jt,{listOfAuthors:a}),Object(f.jsx)(rt,{listOfAlbums:a,loading:l})];function v(e,t){return y.apply(this,arguments)}function y(){return(y=Object(b.a)(d.a.mark((function e(n,s){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("chats").doc(t).get();case 2:e.sent.data().messages.forEach((function(e){e[n].length>0&&e[n].forEach(function(){var e=Object(b.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:C.collection(s).doc(t).get().then((function(e){r((function(t){return[].concat(Object(j.a)(t),[e.data()])}))}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){switch(m){case 0:v("attachedSongs","songs").then((function(){return h(!1)}));break;case 1:v("attachedAuthors","users").then((function(){return h(!1)}));break;case 2:v("attachedAlbums","playlists").then((function(){return h(!1)}))}}),[m]),Object(s.useEffect)((function(){r([])}),[t]),console.log(a),Object(f.jsxs)("div",{className:"AttachmentList",children:[Object(f.jsx)(et,{pages:["Songs","Authors","Playlists"],currentPage:m,setCurrentPage:function(e){x(e),h(!0),r([])}}),l?Object(f.jsx)(re,{}):a.length>0?g[m]:Object(f.jsx)("h2",{children:"Nothing here"})]})},mt=function(e,t,n,c,a,r,i,o){var u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:[];function l(){return j.apply(this,arguments)}function j(){return(j=Object(b.a)(d.a.mark((function s(){var u;return d.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(u=[],void 0!==n){s.next=15;break}if(void 0===r){s.next=9;break}return s.next=5,C.collection(t).where(r,i,o).get();case 5:s.sent.docs.forEach((function(e){u.push(e.data())})),s.next=13;break;case 9:return s.next=11,C.collection(t).get();case 11:s.sent.docs.forEach((function(e){u.push(e.data())}));case 13:s.next=18;break;case 15:return s.next=17,n.forEach(function(){var e=Object(b.a)(d.a.mark((function e(s,r){var i;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection(t).doc(s).get();case 2:i=e.sent.data(),u.push(i),r===n.length-1&&(void 0!==a?(u.sort(a),c(u)):c(u));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 17:e(!1);case 18:return s.abrupt("return",u);case 19:case"end":return s.stop()}}),s)})))).apply(this,arguments)}Object(s.useEffect)((function(){e(!0),c([]),l().then((function(t){void 0===n&&(c(t),e(!1))}))}),u)},xt=n(61),gt=function(e){var t=e.data,n=Object(s.useState)([]),c=Object(u.a)(n,2),a=c[0],r=c[1],i=Object(s.useState)(!0),o=Object(u.a)(i,2),l=o[0],h=o[1],O=Object(s.useState)(t.chatName),p=Object(u.a)(O,2),m=p[0],x=p[1],g=Object(s.useState)(t.chatImage),y=Object(u.a)(g,2),S=y[0],w=y[1],k=Object(s.useState)(""),I=Object(u.a)(k,2),A=I[0],P=I[1],L=Object(s.useState)(t.imageColors||[]),T=Object(u.a)(L,2),E=T[0],M=T[1],R=$().setContent,B=Object(s.useState)(0),D=Object(u.a)(B,2),U=D[0],H=D[1],Y=Object(s.useState)(!1),K=Object(u.a)(Y,2),V=K[0],z=K[1];function Q(){return(Q=Object(b.a)(d.a.mark((function e(t,n,s){var c,a,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=t.target.files[0],P(URL.createObjectURL(c)),a=N.ref(),r=a.child(n+c.name),e.next=6,r.put(c);case 6:return e.t0=s,e.next=9,r.getDownloadURL();case 9:e.t1=e.sent,(0,e.t0)(e.t1);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return function(e,t,n,c){function a(){t.forEach(function(){var e=Object(b.a)(d.a.mark((function e(t){var s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("users").doc(t).get();case 2:s=e.sent.data(),n((function(e){return[].concat(Object(j.a)(e),[s])}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e(!1)}Object(s.useEffect)((function(){return e(!0),a(),function(){return a()}}),c)}(h,t.participants,r,[t.id]),Object(s.useEffect)((function(){m.trim()!==t.chatName.trim()||S!==t.chatImage?z(!0):z(!1)}),[m,S]),Object(s.useEffect)((function(){x(t.chatName)}),[t.id]),Object(f.jsxs)("div",{className:"ChatInfo",children:[Object(f.jsx)(pe.a,{src:A,getColors:function(e){return M(e)}}),Object(f.jsxs)("div",{className:"chatInfoImageAndName",children:[Object(f.jsxs)("div",{className:"chatInfoImage",children:[Object(f.jsxs)("label",{className:"changePhoto",children:[Object(f.jsx)(Ie.b,{}),"Change photo",Object(f.jsx)("input",{type:"file",style:{display:"none"},onChange:function(e){return function(e,t,n){return Q.apply(this,arguments)}(e,"chatCovers/",w)}})]}),Object(f.jsx)("img",{src:S,alt:""})]}),Object(f.jsxs)("div",{children:[Object(f.jsx)("input",{type:"text",className:"standartInput",value:m,onChange:function(e){return x(e.target.value)}}),Object(f.jsxs)("div",{className:"chatInfoButtons",children:[Object(f.jsxs)("button",{className:"chatInfoButton",children:[Object(f.jsx)(W.y,{}),"Settings"]}),Object(f.jsxs)("button",{className:"chatInfoButton",onClick:function(){return R(Object(f.jsx)(pt,{chatId:t.id}))},children:[Object(f.jsx)(F.a,{}),me("Attachments",7)]}),Object(f.jsxs)("button",{className:"chatInfoButton",children:[Object(f.jsx)(xt.b,{}),"Sound"]})]})]}),V?Object(f.jsx)("button",{className:"standartButton",onClick:function(){C.collection("chats").doc(t.id).update({chatName:m,chatImage:S,imageColors:E})},children:"Update Chat"}):null]}),Object(f.jsx)("h4",{children:"Chat participants"}),Object(f.jsx)(et,{pages:["All participants","Administrators"],currentPage:U,setCurrentPage:H}),l?Object(f.jsx)(re,{}):a.map((function(e){return 1!==U||t.admins.includes(e.uid)?Object(f.jsx)(v,{data:e},e.uid):void 0}))]})},vt=function(e){var t=e.chatId,n=e.image,s=e.currentWallpaper;return Object(f.jsx)("div",{className:"WallpaperItem "+(n===s?"active":""),onClick:function(){C.collection("chats").doc(t).update({wallpaper:n})},style:"undefined"===n?{background:"var(--playlistsColor)"}:{},children:"undefined"!==n?Object(f.jsx)("img",{src:n,alt:""}):null})},yt=function(e){var t=e.chatId,n=e.currentWallpaper,c=Object(s.useState)([]),a=Object(u.a)(c,2),r=a[0],i=a[1],o=Object(s.useState)(!0),l=Object(u.a)(o,2),d=l[0],j=l[1];return mt(j,"chatWallpapers",void 0,i),console.log(r),d?Object(f.jsx)(re,{}):Object(f.jsxs)("div",{className:"Wallpapers",children:[Object(f.jsx)("h2",{children:"Wallpapers"}),Object(f.jsxs)("div",{className:"wallpapreWrapper",children:[Object(f.jsx)(vt,{chatId:t,image:"undefined"}),r.map((function(e,s){return Object(f.jsx)(vt,{chatId:t,image:e.image,currentWallpaper:n},e.id)}))]})]})},St=function(e){var t=e.chatId,n=e.currentWallpaper,c=e.data,a=Object(s.useState)(),r=Object(u.a)(a,2),i=r[0],o=r[1],l=$(),d=l.toggleModal,j=l.setContent,b=Object(s.useRef)(null);return te(b,o),Object(f.jsxs)("div",{className:"ChatMoreBtn",ref:b,children:[Object(f.jsx)("button",{onClick:function(){return o(!i)},children:Object(f.jsx)(W.r,{})}),Object(f.jsxs)("div",{className:"chatHeaderMenuWindow",style:i?{}:{display:"none"},children:[c.participants.length>2?Object(f.jsxs)("div",{className:"chatHeaderMenuWindowItem",onClick:function(){d(),j(Object(f.jsx)(gt,{data:c}))},children:[Object(f.jsx)(W.n,{}),Object(f.jsx)("span",{children:"Info"})]}):null,Object(f.jsxs)("div",{className:"chatHeaderMenuWindowItem",children:[Object(f.jsx)(W.x,{}),Object(f.jsx)("span",{children:"Search messages"})]}),Object(f.jsxs)("div",{className:"chatHeaderMenuWindowItem",onClick:function(){d(),j(Object(f.jsx)(pt,{chatId:t}))},children:[Object(f.jsx)(W.j,{}),Object(f.jsx)("span",{children:"Attachments"})]}),Object(f.jsxs)("div",{className:"chatHeaderMenuWindowItem",onClick:function(){d(),j(Object(f.jsx)(yt,{chatId:t,currentWallpaper:n}))},children:[Object(f.jsx)(W.m,{}),Object(f.jsx)("span",{children:"Change wallpaper"})]}),Object(f.jsxs)("div",{className:"chatHeaderMenuWindowItem",children:[Object(f.jsx)(W.A,{}),Object(f.jsx)("span",{children:"Delete chat"})]})]})]})},wt=function(e){var t=e.data,n=M().currentUser,c=$(),a=c.toggleModal,r=c.setContent,o=Object(s.useState)({}),l=Object(u.a)(o,2),j=l[0],h=l[1],O=Object(s.useState)(""===t.chatName?[]:t.imageColors),p=Object(u.a)(O,2),m=p[0],x=p[1];function g(){return(g=Object(b.a)(d.a.mark((function e(){var s,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=t.participants.find((function(e){return e!==n.uid})),e.next=3,C.collection("users").doc(s).get();case 3:c=e.sent.data(),h(c),x(c.imageColors);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){""===t.chatName&&function(){g.apply(this,arguments)}()}),[t.id]),Object(f.jsxs)("div",{className:"ChatHeader",style:m.length?{background:"linear-gradient(45deg, ".concat(m[0],", ").concat(m[1],")")}:{background:"linear-gradient(45deg, grey, lightgrey)"},children:[Object(f.jsx)(G,{}),2===t.participants.length?Object(f.jsxs)(i.b,{className:"chatHeaderImageAndName",to:"/authors/".concat(j.uid),children:[Object(f.jsx)("div",{className:"chatHeaderImage",children:Object(f.jsx)("img",{src:j.photoURL||t.chatImage,alt:""})}),Object(f.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center"},children:[Object(f.jsx)("h4",{children:j.displayName||t.chatName}),Object(f.jsx)(We,{userUID:j.uid})]})]}):Object(f.jsxs)("div",{className:"chatHeaderImageAndName",onClick:function(){a(),r(Object(f.jsx)(gt,{data:t}))},children:[Object(f.jsx)("div",{className:"chatHeaderImage",children:Object(f.jsx)("img",{src:j.photoURL||t.chatImage,alt:""})}),Object(f.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center"},children:[Object(f.jsx)("h4",{children:j.displayName||t.chatName}),Object(f.jsx)(We,{userUID:j.uid})]})]}),Object(f.jsx)(St,{chatId:t.id,data:t,currentWallpaper:t.wallpaper})]})},Nt=n(80);function Ct(e){return e.attachedSongs.length?"Audio":e.attachedAlbums.length?"Album":e.attachedAuthors.length?"Author":e.inResponseToMessage&&e.inResponseToMessage.length?"Forwarded message":""}function kt(e){var t=Object(s.useState)(!1),n=Object(u.a)(t,2),c=n[0],a=n[1],r=new IntersectionObserver((function(e){var t=Object(u.a)(e,1)[0];return a(t.isIntersecting)}));return Object(s.useEffect)((function(){return r.observe(e.current),function(){r.disconnect()}}),[]),c}var It=function(){return Object(f.jsx)("div",{className:"SongItem SongItemLoading",children:Object(f.jsxs)("div",{className:"songItemImageAndName",children:[Object(f.jsx)("div",{className:"songItemImage"}),Object(f.jsxs)("div",{className:"songItemNameAndAuthor",children:[Object(f.jsx)("div",{className:"songItemName"}),Object(f.jsx)("div",{className:"songItemAuthor"})]})]})})},At=function(e){var t=e.listOfSeen;return Object(f.jsx)("div",{className:"SeenByCircle",style:void 0!==t?t.length<=1?{opacity:"1",visibility:"visible"}:{}:null})},Pt=function(e){var t=e.messageData,n=e.chatId,c=e.scrollToMessageRef,a=e.setScrollToMessageId,r=e.scrollToMessageId,i=e.showPhoto,o=void 0===i||i,l=e.otherMessages,h=e.inResponseToMessageArr,O=e.setInResponseToMessageArr,p=M().currentUser,m=z().isMobile,x=t.message,g=t.attachedAlbums,v=t.attachedSongs,y=t.attachedAuthors,S=t.sender,w=t.inResponseToMessage,N=t.id,k=t.sentTime,I=Object(s.useState)({}),A=Object(u.a)(I,2),P=A[0],L=A[1],T=K(k,2),E=Object(s.useState)([]),R=Object(u.a)(E,2),B=R[0],D=R[1],U=Object(s.useState)([]),W=Object(u.a)(U,2),F=W[0],H=W[1],Y=Object(s.useState)([]),V=Object(u.a)(Y,2),Q=V[0],q=V[1],G=Object(s.useState)([]),X=Object(u.a)(G,2),J=X[0],_=X[1],Z=Object(s.useState)([]),$=Object(u.a)(Z,2),ee=$[0],te=$[1],ne=Object(s.useRef)(),se=kt(ne),ce=Object(s.useState)(0),ae=Object(u.a)(ce,2),re=ae[0],oe=ae[1],ue=Object(s.useState)(0),le=Object(u.a)(ue,2),de=le[0],be=le[1],he=Object(Qe.useSwipeable)({onSwiping:function(e){e.deltaX<0&&oe(e.deltaX)}});function fe(){return(fe=Object(b.a)(d.a.mark((function e(){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("users").doc(t.sender).get();case 2:n=e.sent.data(),L(n);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Oe(e,t,n){return e.forEach(function(){var e=Object(b.a)(d.a.mark((function e(s){var c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection(t).doc(s).get();case 2:c=e.sent.data(),n((function(e){return[].concat(Object(j.a)(e),[c])}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}function pe(){h.includes(N)||O((function(e){return[].concat(Object(j.a)(e),[N])}))}function me(){var e;clearTimeout(e),be(.2),e=setTimeout((function(){oe(0),be(0)}),200)}Object(s.useEffect)((function(){if(void 0!==t.seenBy&&p.uid!==t.sender&&se&&!t.seenBy.includes(p.uid)){var e=l;e[t.id].seenBy.push(p.uid),C.collection("chats").doc(n).update({messages:e})}}),[se]),Object(s.useEffect)((function(){!function(){fe.apply(this,arguments)}(),Oe(v,"songs",D),Oe(y,"users",H),Oe(g,"playlists",q),null!==w&&w.forEach(function(){var e=Object(b.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return _((function(e){return[].concat(Object(j.a)(e),[l[t]])})),e.next=3,C.collection("users").doc(l[t].sender).get();case 3:n=e.sent.data().displayName,te((function(e){return[n].concat(Object(j.a)(e))}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]),Object(s.useEffect)((function(){re<-160&&(me(),pe())}),[re]);Nt.a,je.a,je.c;return Object(f.jsxs)("div",{className:"MessageItem "+(S===p.uid?"your":""),ref:N===r?c:function(e){he.ref(e),ne.current=e},style:se?o?{paddingBottom:"15px",transform:"translateX(".concat(re,"px)"),transition:de}:{transform:"translateX(".concat(re,"px)"),transition:de}:{opacity:"0",visibility:"hidden"},onTouchEnd:me,children:[Object(f.jsx)("div",{className:"messageItemImage",children:o?Object(f.jsx)("img",{src:P.photoURL,alt:""}):null}),Object(f.jsxs)("div",{className:"messageItemBody",style:N===r?{animation:"showResponseMessage .5s forwards"}:o?{borderRadius:"var(--standartBorderRadius2) var(--standartBorderRadius) var(--standartBorderRadius) 5px"}:{},children:[Object(f.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"5px"},children:[Object(f.jsx)("h5",{className:"messageUserName",children:P.displayName}),Object(f.jsx)("div",{style:{fontSize:".7em",opacity:".8",marginLeft:"10px"},children:T})]}),null!==w?J.map((function(e,t){return Object(f.jsxs)("div",{className:"responseItem",onClick:function(){return a(e.id)},children:[Object(f.jsxs)("span",{style:{display:"flex",alignItems:"center"},children:[Object(f.jsx)("h5",{style:e.sender===p.uid?{color:"var(--lightPurple)"}:{},children:ee[t]}),Object(f.jsx)("div",{style:{fontSize:".7em",opacity:".8",marginLeft:"10px"},children:K(e.sentTime,2)})]}),Object(f.jsxs)("p",{children:[e.message,Object(f.jsx)("span",{style:{marginLeft:"5px",color:"var(--reallyLightBlue)"},children:Ct(e)})]})]})})):null,Object(f.jsxs)("div",{children:[Object(f.jsx)("p",{children:x}),B.map((function(e,t){return se?Object(f.jsx)(Te,{song:e,localIndex:t},t):Object(f.jsx)(It,{})})),Q.map((function(e,t){return Object(f.jsx)(at,{playlist:e},t)})),F.map((function(e,t){return Object(f.jsx)(dt,{data:e},t)}))]})]}),Object(f.jsx)(At,{listOfSeen:t.seenBy}),Object(f.jsx)("button",{className:"respondToMessageBtn",onClick:pe,style:m?{opacity:-re/80}:{},children:Object(f.jsx)(ie.l,{})})]})},Lt=function(e){var t=e.message,n=e.index,c=e.messageList,a=e.chatId,r=e.inResponseToMessage,i=e.setInResponseToMessage,o=e.scrollToMessageRef,l=e.scrollToMessageId,d=e.setScrollToMessageId,b=e.setDateRefsArray,h=Object(s.useState)(!1),O=Object(u.a)(h,2),p=O[0],m=O[1],x=Object(s.useState)(!1),g=Object(u.a)(x,2),v=g[0],y=g[1],S=Object(s.useRef)(null);return Object(s.useEffect)((function(){(n===c.length-1||c[n+1].sender!==c[n].sender||K(c[n+1].sentTime)!==K(c[n].sentTime))&&m(!0),(0===n||K(c[n].sentTime)!==K(c[n-1].sentTime))&&y(!0)}),[]),Object(s.useEffect)((function(){null!==S.current&&b((function(e){return[].concat(Object(j.a)(e),[S])}))}),[v]),Object(f.jsxs)(f.Fragment,{children:[v?Object(f.jsx)("div",{ref:S,style:{width:"100%",display:"flex",justifyContent:"center",alignItems:"center",padding:"10px 0"},children:K(t.sentTime)}):null,Object(f.jsx)(Pt,{messageData:t,chatId:a,scrollToMessageRef:o,scrollToMessageId:l,setScrollToMessageId:d,showPhoto:p,otherMessages:c,inResponseToMessageArr:r,setInResponseToMessageArr:i},t.id)]})},Tt=function(e){var t=e.chatId,n=e.messageList,c=e.inResponseToMessage,a=e.setInResponseToMessage,r=e.messagesWindowRef,i=e.setDateRefsArray,o=Object(s.useRef)(null),l=Object(s.useState)(-1),d=Object(u.a)(l,2),j=d[0],b=d[1];return Object(s.useEffect)((function(){-1!==j&&(r.current.scrollTo(0,o.current.offsetTop-65<0?0:o.current.offsetTop-65),setTimeout((function(){b(-1)}),500))}),[j]),n.length?Object(f.jsx)(f.Fragment,{children:n.map((function(e,s){return Object(f.jsx)(Lt,{message:e,index:s,messageList:n,chatId:t,inResponseToMessage:c,setInResponseToMessage:a,scrollToMessageRef:o,scrollToMessageId:j,setScrollToMessageId:b,setDateRefsArray:i},e.id)}))}):null},Et=function(e){var t=e.attachedItems,n=e.setAttachedItems,s=e.icon;return Object(f.jsx)("div",{className:"AttachedItemsInChatInput",children:t.map((function(e,c){return Object(f.jsxs)("div",{className:"attachedSongItem",children:[s,Object(f.jsx)("span",{children:e}),Object(f.jsx)("button",{className:"removeMessageFromResponse",onClick:function(){return function(e,t,n){t(e.filter((function(e){return e!==n})))}(t,n,e)},children:Object(f.jsx)(W.G,{})})]},e)}))})},Mt=function(e){var t=e.chatId,n=e.chatData,c=e.messageText,a=e.setMessageText,r=e.inResponseToMessage,i=e.setInResponseToMessage,o=e.otherMessages,l=M().currentUser,h=Object(s.useState)(!1),O=Object(u.a)(h,2),p=O[0],m=O[1],x=D(),g=x.yourSongs,v=x.yourAuthors,y=x.yourPlaylists,S=Object(s.useState)(""),w=Object(u.a)(S,2),N=w[0],k=w[1],I=Object(s.useState)(g),A=Object(u.a)(I,2),P=A[0],L=A[1],T=Object(s.useState)([]),E=Object(u.a)(T,2),R=(E[0],E[1],Object(s.useState)([])),B=Object(u.a)(R,2),U=B[0],H=B[1],Y=Object(s.useState)([]),K=Object(u.a)(Y,2),V=K[0],z=K[1],Q=Object(s.useState)([]),q=Object(u.a)(Q,2),G=q[0],X=q[1],J=Object(s.useState)(y),Z=Object(u.a)(J,2),$=Z[0],ee=Z[1],ne=Object(s.useState)(v),se=Object(u.a)(ne,2),ce=se[0],ae=se[1],re=Object(s.useState)([]),le=Object(u.a)(re,2),de=le[0],je=le[1],be=Object(s.useState)([]),he=Object(u.a)(be,2),fe=he[0],Oe=he[1],pe=Object(s.useRef)(null);function xe(){oe(t,n,l.uid,c,U,V,G,r),a(""),H([]),X([]),z([]),i([]),m(!1)}return te(pe,m),Object(s.useEffect)((function(){0===N.length&&L(g)}),[N]),Object(s.useEffect)((function(){if(0===c.length)C.collection("chats").doc(t).update({typing:n.typing.filter((function(e){return e!==l.uid}))});else if(!n.typing.includes(l.uid)){var e=n.typing;e.push(l.uid),C.collection("chats").doc(t).update({typing:e})}}),[c]),Object(s.useEffect)((function(){je([]),r.forEach(function(){var e=Object(b.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("users").doc(o[t].sender).get();case 2:n=e.sent.data().displayName,je((function(e){return[].concat(Object(j.a)(e),[n])}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[r.length]),Object(s.useEffect)((function(){Oe([]),U.forEach(function(){var e=Object(b.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("songs").doc(t).get();case 2:n=e.sent.data().name,Oe((function(e){return[].concat(Object(j.a)(e),[n])}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[U.length]),Object(f.jsxs)("div",{className:"chatInput",style:p?{borderRadius:"0 0 var(--standartBorderRadius) var(--standartBorderRadius)",transition:".2s"}:{},ref:pe,children:[Object(f.jsx)("div",{className:"attachWindow",style:p?{height:"400px",opacity:"1"}:{},children:p?Object(f.jsxs)("div",{style:p?{maxHeight:"100%",overflowY:"auto"}:{display:"none"},children:[Object(f.jsx)(ue,{value:N,setValue:k,setAllFoundSongs:L,setResultPlaylists:ee,setResultAuthorList:ae}),Object(f.jsx)(Re,{listOfSongs:P,source:"no",listOfChosenSongs:U,setListOfSongs:H}),Object(f.jsx)(jt,{listOfAuthors:ce,listOfChosenAuthors:G,setListOfChosenAuthors:X}),Object(f.jsx)(rt,{listOfAlbums:$,loading:!1,listOfChosenAlbums:V,setListOfChosenAlbums:z})]}):null}),Object(f.jsxs)("div",{className:"inResponseArea",style:r.length||fe.length||G.length||V.length?{}:{height:"0",padding:"0",opacity:"0",top:"0",visibility:"hidden"},children:[Object(f.jsx)("div",{className:"responseMessages",children:r.map((function(e,t){return Object(f.jsxs)("div",{className:"responseItem",children:[Object(f.jsx)("h5",{style:o[e].sender===l.uid?{color:"var(--lightPurple)"}:{},children:de[t]}),Object(f.jsxs)("p",{children:[me(o[e].message,35),Object(f.jsx)("span",{style:{marginLeft:"5px",color:"var(--reallyLightBlue)"},children:Ct(o[e])})]}),Object(f.jsx)("button",{onClick:function(){return t=e,void i(r.filter((function(e){return e!==t})));var t},className:"removeMessageFromResponse",children:Object(f.jsx)(W.G,{})})]},e)}))}),Object(f.jsx)(Et,{attachedItems:U,setAttachedItems:H,icon:Object(f.jsx)(_.c,{})}),Object(f.jsx)(Et,{attachedItems:G,setAttachedItems:X,icon:Object(f.jsx)(W.C,{})}),Object(f.jsx)(Et,{attachedItems:V,setAttachedItems:z,icon:Object(f.jsx)(ie.a,{})})]}),Object(f.jsxs)("div",{className:"attachAndEmojis",children:[Object(f.jsx)("div",{className:"attachBtn",children:Object(f.jsx)("button",{onClick:function(){m(!p)},children:Object(f.jsx)(F.a,{})})}),Object(f.jsx)("input",{type:"text",style:{background:"var(--lightGrey)",border:"none",outline:"none",minHeight:"100%"},value:c,onChange:function(e){a(e.target.value)},onKeyUp:function(e){"Enter"===e.key&&xe()}})]}),Object(f.jsx)("button",{className:"sendBtn",onClick:function(){xe()},children:Object(f.jsx)(Ie.d,{})})]})},Rt=function(e){var t=e.date;return Object(f.jsx)("div",{className:"DateOnTop",children:K(t)})},Bt=function(e){var t=e.typingPeople,n=Object(s.useState)([]),c=Object(u.a)(n,2),a=c[0],r=c[1],i=M().currentUser;return Object(s.useEffect)((function(){r([]),t.map(function(){var e=Object(b.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("users").doc(t).get();case 2:(n=e.sent.data()).uid!==i.uid&&r((function(e){return[].concat(Object(j.a)(e),[n])}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[t]),a.length>0?Object(f.jsxs)("div",{className:"typingWrapper",children:[Object(f.jsx)(X,{imagesList:a.map((function(e){return e.photoURL})),borderColor:"var(--navItemColor)"}),Object(f.jsxs)("div",{className:"TypingAnimation",children:[Object(f.jsx)("span",{className:"typingCircle"}),Object(f.jsx)("span",{className:"typingCircle"}),Object(f.jsx)("span",{className:"typingCircle"})]})]}):null},Dt=function(){var e=Object(o.h)("/chat/:chatId"),t=M().currentUser,n=e.params.chatId,c=Object(s.useState)(""),a=Object(u.a)(c,2),r=a[0],i=a[1],l=Object(s.useState)([]),d=Object(u.a)(l,2),j=d[0],b=d[1],h=Object(s.useRef)(null),O=Object(s.useRef)(null),p=z().screenHeight,m=Object(s.useState)(!0),x=Object(u.a)(m,2),g=x[0],v=x[1],y=Object(s.useState)([]),S=Object(u.a)(y,2),w=S[0],N=S[1],k=Object(s.useState)([]),I=Object(u.a)(k,2),A=I[0],P=I[1],L=Object(s.useState)(""),T=Object(u.a)(L,2),E=T[0],R=T[1],B=Object(s.useState)([]),D=Object(u.a)(B,2),U=D[0],W=D[1],F=Object(o.g)();return Object(s.useEffect)((function(){var e=C.collection("chats").doc(n).onSnapshot((function(e){b(e.data()),N(e.data().messages),R(e.data().messages.length?e.data().messages[0].sentTime:(new Date).toString()),v(!1)}));return function(){e()}}),[C,n]),Object(s.useEffect)((function(){void 0!==j.participants&&(j.participants.includes(t.uid)||F.push("/chat"))}),[j]),Object(s.useEffect)((function(){null!==O.current&&w.length>0&&function(){var e=O.current.scrollHeight-O.current.clientHeight;O.current.scrollTo(0,e)}()}),[w]),Object(f.jsxs)("div",{className:"DialoguePage",children:[g?Object(f.jsx)(re,{}):Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(wt,{data:j}),Object(f.jsx)(Rt,{date:E}),Object(f.jsxs)("div",{className:"chatMessagesWindow",ref:O,onScroll:function(e){U.forEach((function(t){null!==t.current&&t.current.offsetTop-70<=e.target.scrollTop&&R(t.current.innerHTML)}))},style:{height:p-170+"px"},children:[Object(f.jsx)(Tt,{chatId:n,messageList:w,inResponseToMessage:A,setInResponseToMessage:P,messagesWindowRef:O,setDateRefsArray:W}),Object(f.jsx)("span",{className:"scrollToBottomElement",ref:h}),Object(f.jsx)(Bt,{typingPeople:j.typing})]}),Object(f.jsx)(Mt,{chatId:n,chatData:j,messageText:r,setMessageText:i,inResponseToMessage:A,setInResponseToMessage:P,otherMessages:w})]}),"undefined"!==j.wallpaper?Object(f.jsx)("img",{src:j.wallpaper,className:"chatWallpaper",alt:""}):null]})},Ut="/login",Wt="/signup",Ft="/home",Ht="/library",Yt="/search",Kt="/chat",Vt=function(){return Object(f.jsxs)("div",{className:"BlurredBg",children:[Object(f.jsx)("div",{className:"circle circle1"}),Object(f.jsx)("div",{className:"circle circle2"}),Object(f.jsx)("div",{className:"circle circle3"}),Object(f.jsx)("div",{className:"circle circle4"}),Object(f.jsx)("div",{className:"circle circle5"})]})},zt=function(e){var t=e.title;return Object(f.jsxs)("div",{className:"titleAndLogo",children:[Object(f.jsx)("div",{className:"title",children:Object(f.jsx)("h1",{children:t})}),Object(f.jsx)("div",{className:"logo",children:Object(f.jsx)("img",{src:h,alt:""})})]})},Qt=(n(262),n(263),function(){var e=Object(s.useState)([]),t=Object(u.a)(e,2),n=t[0],c=t[1],a=Object(s.useState)(0),r=Object(u.a)(a,2),i=r[0],o=r[1],l=Object(s.useState)(!0),h=Object(u.a)(l,2),O=h[0],p=h[1],m=Object(s.useState)({}),x=Object(u.a)(m,2),g=x[0],v=x[1],y=Object(s.useState)({}),S=Object(u.a)(y,2),w=S[0],N=S[1],I=Object(s.useState)({}),A=Object(u.a)(I,2),P=A[0],L=A[1];function T(e,t,n){return E.apply(this,arguments)}function E(){return(E=Object(b.a)(d.a.mark((function e(t,n,s){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection(n).orderBy(s,"desc").get();case 2:return e.next=4,e.sent.docs[0].data();case 4:a=e.sent,t(a),c((function(e){return[].concat(Object(j.a)(e),[a.imageColors[0]])})),"playlists"===n&&p(!1);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){T(v,"users","subscribers"),T(N,"songs","listens"),T(L,"playlists","listens")}),[]),Object(f.jsx)("div",{className:"MainBanner",style:{background:n[i]},children:O?Object(f.jsx)(re,{}):Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)("div",{className:"slider",children:[Object(f.jsxs)("div",{className:"sliderItem "+(0===i?"current":""),style:{transform:"translateX(-".concat(100*i,"%)")},children:[Object(f.jsx)("h3",{children:"Most popular artist on platform"}),Object(f.jsx)(dt,{data:g})]}),Object(f.jsxs)("div",{className:"sliderItem "+(1===i?"current":""),style:{transform:"translateX(-".concat(100*i,"%)")},children:[Object(f.jsx)("h3",{children:"Most popular song on platform"}),Object(f.jsx)(Te,{song:w,localIndex:0,showListens:!0})]}),Object(f.jsxs)("div",{className:"sliderItem "+(2===i?"current":""),style:{transform:"translateX(-".concat(100*i,"%)")},children:[Object(f.jsx)("h3",{children:"Most popular album on platform"}),Object(f.jsx)(at,{playlist:P})]})]}),Object(f.jsxs)("div",{className:"sliderBtns",children:[Object(f.jsx)("button",{onClick:function(){return o(k(i-1,2,0))},children:Object(f.jsx)(ie.c,{})}),Object(f.jsx)("button",{onClick:function(){return o(k(i+1,2,0))},children:Object(f.jsx)(ie.d,{})})]})]})})}),qt=function(){var e=D().yourAuthors,t=Object(s.useState)([]),n=Object(u.a)(t,2),c=n[0],a=n[1];return Object(s.useEffect)((function(){void 0!==e&&0!==e.length&&0===c.length&&function(){var t=[];e.forEach((function(e,n){e.ownSongs.forEach(function(){var e=Object(b.a)(d.a.mark((function e(n){var s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("songs").doc(n).get();case 2:ht(s=e.sent.data())&&!t.includes(s.id)&&(a((function(e){return[].concat(Object(j.a)(e),[s])})),t.push(s.id));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}))}()}),[]),Object(f.jsx)("div",{children:Object(f.jsx)(Re,{listOfSongs:c,source:{source:"/home",name:"New Songs",image:"",songsList:c},title:"New Songs",isNewSong:!0})})},Gt=function(){var e=D().yourAuthors,t=Object(s.useState)([]),n=Object(u.a)(t,2),c=n[0],a=n[1],r=Object(s.useState)([]),i=Object(u.a)(r,2),o=i[0],l=i[1],d=M().currentUser;return Object(s.useEffect)((function(){void 0!==e&&e.forEach((function(e){ut(e,a)}))}),[]),Object(s.useEffect)((function(){c.forEach((function(e){var t=o.map((function(e){return e.uid}));d.addedAuthors.includes(e.uid)||t.includes(e.uid)||l((function(t){return[].concat(Object(j.a)(t),[e])}))}))}),[c]),Object(f.jsx)("div",{className:"RecommendedAuthors",children:Object(f.jsx)(jt,{listOfAuthors:o,title:"Recommended Authors"})})},Xt=function(e){var t=e.message,n=e.image,s=e.button;return Object(f.jsx)("div",{className:"importantMessage",children:Object(f.jsxs)("div",{children:[n?Object(f.jsx)("img",{src:n,alt:""}):null,Object(f.jsx)("h3",{children:t}),s||null]})})},Jt=function(){var e=D().yourAuthors,t=M().currentUser,n=Object(s.useState)([]),c=Object(u.a)(n,2),a=c[0],r=c[1];return Object(s.useEffect)((function(){!function(){var n=[];e.forEach((function(e,s){e.ownSongs.forEach(function(){var e=Object(b.a)(d.a.mark((function e(s,c){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("songs").doc(s).get();case 2:a=e.sent.data(),!t.addedSongs.includes(s)&&!n.includes(a.id)&&c<=3&&(r((function(e){return[].concat(Object(j.a)(e),[a])})),n.push(a.id));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}))}()}),[]),Object(f.jsx)("div",{className:"RecommendedSongs",children:Object(f.jsx)(Re,{listOfSongs:a,source:{source:"/home",name:"Recommended Songs",image:"",songsList:a},title:"Recommended Songs",displayIfEmpty:Object(f.jsx)(Xt,{message:"No songs recommended. Add favorite authors so we could know what to recommend",image:"https://i.pinimg.com/originals/b2/3d/f6/b23df649311586e74a8455c92eb3d76b.png"})})})},_t=function(){var e=Object(s.useState)([]),t=Object(u.a)(e,2),n=t[0],c=t[1],a=Object(s.useState)(!0),r=Object(u.a)(a,2),i=r[0],o=r[1];return Object(s.useEffect)((function(){o(!0),C.collection("songs").orderBy("listens","desc").limit(15).get().then((function(e){e.docs.forEach((function(e){c((function(t){return[].concat(Object(j.a)(t),[e.data()])}))})),o(!1)}))}),[]),i?Object(f.jsx)(re,{}):Object(f.jsx)(Re,{listOfSongs:n,source:{source:"/home",name:"Top 15 Songs",image:"https://media.istockphoto.com/vectors/fire-icon-illustration-for-design-stock-vector-vector-id931601050?k=6&m=931601050&s=170667a&w=0&h=fhRQfwwsW6aXK9OSDM-yj842SFFl2Q9ll6ch-xCK5es=",songsList:n},title:"Top 15 Songs",showListens:!0,showCount:!0})},Zt=(n(264),n(265),n.p+"static/media/wave2.f62cb572.svg"),$t=function(e){var t=e.playlist,n=D(),c=n.setCurrentSongQueue,a=n.setCurrentSongPlaylistSource,r=n.playSong,o=n.setCurrentSongInQueue,l=n.setCurrentSong,h=n.currentSongPlaylistSource,O=n.songRef,p=n.setPlay,m=n.play,x=Object(s.useState)([]),g=Object(u.a)(x,2),v=g[0],y=g[1];return Object(s.useEffect)((function(){v.length&&(c(v),o(0),l(v[0].id),O.current.play(),p(!0),a({source:"/albums/".concat(t.id),name:t.name,image:t.image,songsList:v}))}),[v.length]),Object(f.jsx)(i.b,{to:"/albums/".concat(t.id),className:"playlistWrapper",children:Object(f.jsxs)("div",{className:"library playlistItem",children:[t.image?Object(f.jsx)("img",{src:t.image,alt:""}):Object(f.jsxs)("h1",{children:[t.name.split(" ")[0][0],t.name.split(" ")[1][0]]}),Object(f.jsx)("h2",{style:{background:t.imageColors[2]},children:me(t.name,10)}),Object(f.jsx)("button",{onClick:function(e){e.preventDefault(),h.name!==t.name?0!==t.length&&t.songs.map(function(){var e=Object(b.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("songs").doc(t).get();case 2:n=e.sent.data(),y((function(e){return[].concat(Object(j.a)(e),[n])}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()):r()},children:h.name===t.name&&m?Object(f.jsx)(fe.b,{}):Object(f.jsx)(fe.c,{})})]})})},en=function(){var e=D(),t=e.yourSongs,n=e.yourPlaylists,s=(e.setYourSongs,M().currentUser);return Object(f.jsxs)("div",{className:"SongsPage",children:[Object(f.jsxs)("div",{className:"playLists",children:[Object(f.jsx)("div",{className:"playlistContent",children:n.map((function(e,t){return Object(f.jsx)($t,{playlist:e},t)}))}),Object(f.jsx)("div",{className:"playlistsBackground",children:Object(f.jsx)("img",{src:Zt,alt:"erwerrnjeqjweqwqeqwewerbjfrwjfbewjerbh"})})]}),Object(f.jsx)("div",{className:"yourSongsList",children:Object(f.jsx)(Re,{listOfSongs:t,source:{source:"/library",name:"Your Library",image:s.photoURL,songsList:t},showSearch:!0,displayIfEmpty:Object(f.jsx)(i.b,{to:"/search",children:Object(f.jsx)("button",{className:"standartButton",children:"Search for songs"})})})})]})},tn=function(){return Object(f.jsx)("div",{className:"CreatePlaylistPage",children:Object(f.jsx)(Xe,{})})},nn=function(){var e=D().yourPlaylists,t=$(),n=t.toggleModal,s=t.setContent;return Object(f.jsxs)("div",{className:"PlaylistsPage",children:[Object(f.jsxs)("button",{className:"createPlaylistBtn",onClick:function(){n(),s(Object(f.jsx)(tn,{}))},children:[Object(f.jsx)(ie.g,{}),"Create Playlist"]}),Object(f.jsx)("div",{className:"playlistsContainer",children:e&&e.map((function(e,t){return Object(f.jsx)(at,{playlist:e},e.id)}))})]})},sn=function(){var e=D().yourAuthors;return Object(f.jsx)("div",{className:"AuthorsPage",children:Object(f.jsx)("div",{className:"authorsContainer",children:e.map((function(e){return Object(f.jsx)(dt,{data:e},e.uid)}))})})};var cn=function(e){var t=e.userUID,n=Object(s.useState)(!1),c=Object(u.a)(n,2),a=c[0],r=c[1];return Object(s.useEffect)((function(){var e=C.collection("users").doc(t).onSnapshot((function(e){if(void 0!==t){var n=(new Date).getTime()-3e5,s=e.data().online>n;r(s)}}));return function(){e()}}),[C,t]),a?Object(f.jsx)("div",{className:"onlineCircle"}):null},an=function(e){var t=e.amountOfUnseen;return 0!==t?Object(f.jsx)("div",{className:"AmountOfUnseenMessages",children:t}):null},rn=n(81),on=function(e){var t=e.messages,n=M().currentUser,c=Object(s.useState)(""),a=Object(u.a)(c,2),r=a[0],i=a[1],o=Object(s.useState)(!1),l=Object(u.a)(o,2),j=l[0],h=l[1],O=Object(s.useState)(""),p=Object(u.a)(O,2),m=p[0],x=p[1],g=[null,Object(f.jsx)(W.t,{}),Object(f.jsx)(ie.a,{}),Object(f.jsx)(W.C,{})],v=Object(s.useState)(0),y=Object(u.a)(v,2),S=y[0],w=y[1];function N(){return(N=Object(b.a)(d.a.mark((function e(){var n,s,c,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t){e.next=22;break}if(n=t[t.length-1],x((function(e){return e+n.message})),h(0!==n.message.length),!n.attachedSongs.length){e.next=10;break}return e.next=7,C.collection("songs").doc(n.attachedSongs[0]).get();case 7:s=e.sent.data().name,w(1),i((function(e){return e+s}));case 10:if(!n.attachedAlbums.length){e.next=16;break}return e.next=13,C.collection("playlists").doc(n.attachedAlbums[0]).get();case 13:c=e.sent.data().name,w(2),i((function(e){return e+c}));case 16:if(!n.attachedAuthors.length){e.next=22;break}return e.next=19,C.collection("users").doc(n.attachedAuthors[0]).get();case 19:a=e.sent.data().displayName,w(3),i((function(e){return e+a}));case 22:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){!function(){N.apply(this,arguments)}()}),[]),Object(f.jsxs)("div",{className:"messageShowOutside",children:[t[t.length-1].sender===n.uid?Object(f.jsx)("span",{style:{marginRight:"5px"},children:"You:"}):null,me(m,30),j&&r.length?Object(f.jsx)(rn.a,{}):null,g[S],r,Object(f.jsx)(At,{listOfSeen:t[t.length-1].seenBy})]})},un=function(e){var t=e.chatData,n=M().currentUser,c=t.chatName,a=t.chatImage,r=t.participants,o=t.messages,l=Object(s.useState)({}),j=Object(u.a)(l,2),h=j[0],O=j[1],p=Object(s.useState)(0),m=Object(u.a)(p,2),x=m[0],g=m[1];function v(){return(v=Object(b.a)(d.a.mark((function e(){var t,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.find((function(e){return e!==n.uid})),e.next=3,C.collection("users").doc(t).get();case 3:s=e.sent.data(),O(s);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){g(function(e,t){return e.reduce((function(e,n){return n.sender===t.uid||void 0===n.seenBy||n.seenBy.includes(t.uid)?e:(console.log("i'm here"),++e)}),0)}(o,n))}),[]),Object(s.useEffect)((function(){""===c&&function(){v.apply(this,arguments)}()}),[]),t?Object(f.jsx)(i.b,{to:"/chat/".concat(t.id),children:Object(f.jsxs)("div",{className:"ChatItem "+(x>0?"unseen":""),children:[Object(f.jsx)("div",{className:"chatItemImage",children:Object(f.jsx)("img",{src:a||h.photoURL,alt:""})}),Object(f.jsx)(cn,{userUID:h.uid}),Object(f.jsxs)("div",{style:{width:"100%"},children:[Object(f.jsxs)("h4",{style:{display:"flex",justifyContent:"space-between",width:"100%"},children:[Object(f.jsx)("span",{children:c||h.displayName}),Object(f.jsxs)("div",{children:[o.length?Object(f.jsx)("span",{style:{opacity:".6",fontWeight:"500",fontSize:".8em"},children:K(o[o.length-1].sentTime,t&&Date.now()-new Date(o[o.length-1].sentTime).getTime()>86e6?0:2)}):null,Object(f.jsx)(an,{amountOfUnseen:x})]})]}),o.length?Object(f.jsx)("p",{style:o[o.length-1].sender!==n.uid?{color:"#fff"}:{},children:Object(f.jsx)(on,{messages:o})}):null]})]})}):null},ln=(n(266),function(e){var t=Object.assign({},e),n=$(),c=n.openModal,a=n.setOpenModal,r=n.content,i=Object(s.useRef)(null),o=z().screenHeight;return te(i,a),Object(f.jsx)("div",{className:"modal_darkBg",style:c?{height:o}:{opacity:0,visibility:"hidden"},children:Object(f.jsx)("div",Object(p.a)(Object(p.a)({className:"ModalWindow"},t),{},{ref:i,style:c?{}:{opacity:0,visibility:"hidden",transform:"translateY(40px)"},children:r}))})}),dn=function(){var e=M().currentUser,t=D().yourFriends,n=Object(s.useState)(""),c=Object(u.a)(n,2),a=c[0],r=c[1],i=Object(s.useState)(t),l=Object(u.a)(i,2),d=l[0],b=l[1],h=Object(s.useState)([]),O=Object(u.a)(h,2),p=O[0],m=O[1],x=Object(s.useState)(""),g=Object(u.a)(x,2),y=g[0],S=g[1],w=Object(s.useState)(""),N=Object(u.a)(w,2),C=N[0],k=N[1],I=Object(s.useState)(""),A=Object(u.a)(I,2),P=A[0],L=A[1],T=ne(),E=Object(o.g)(),R=Object(s.useState)(!1),B=Object(u.a)(R,2),U=B[0],W=B[1],F=Object(s.useState)(0),H=Object(u.a)(F,2),Y=H[0],K=H[1];return Object(s.useEffect)((function(){p.length>=1&&ce(p,e,W,K)}),[p]),Object(f.jsxs)("div",{className:"CreateChat",children:[Object(f.jsx)(ue,{value:a,setValue:r,setResultAuthorList:b,focus:!0,inputText:"Search for friends",defaultSearchMode:"authors"}),d.map((function(e){return Object(f.jsx)(v,{data:e,chosenArray:p,setChosenArray:m})})),p.length>1&&U?Object(f.jsxs)("div",{children:[Object(f.jsx)("input",{type:"text",style:{marginBottom:"10px"},className:"standartInput",placeholder:"Enter chat name",value:C,onChange:function(e){return k(e.target.value)}}),Object(f.jsx)(Je,{setErrorMessage:L,setImageLocalPath:function(){return null},downloadedPhoto:y,setDownloadedPhoto:S,place:"chatCovers/",btnText:"Download chat image"})]}):null,Object(f.jsx)(_e,{errorMessage:P}),p.length>=1?Object(f.jsx)("button",{className:"addSongBtn",onClick:function(){U?(se([e.uid].concat(Object(j.a)(p)),T,C,y,[e.uid]),E.push("/chat/".concat(T))):E.push("/chat/".concat(Y))},children:U?"Create Chat":"Go to chat"}):null]})},jn=function(e){var t=e.boolValue,n=e.setBoolValue;return Object(f.jsx)("div",{className:"SwitchToggle",onClick:function(){return n(!t)},children:Object(f.jsx)("div",{className:"switchInnerCircle",style:t?{transform:"translateX(100%)",background:"var(--green)"}:{}})})},bn=[{path:Ut,Component:function(){var e=M().login,t=Object(s.useState)(""),n=Object(u.a)(t,2),c=n[0],a=n[1],r=Object(s.useState)(""),o=Object(u.a)(r,2),l=o[0],j=o[1],h=Object(s.useState)(""),O=Object(u.a)(h,2),p=O[0],m=O[1],x=Object(s.useState)(!1),g=Object(u.a)(x,2),v=g[0],y=g[1],S=0!==c.length&&0!==l.length;function w(){return(w=Object(b.a)(d.a.mark((function t(n){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),S){t.next=3;break}return t.abrupt("return",m("One of your fields is totaly empty"));case 3:return t.next=5,e(c,l,m,y);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return Object(f.jsxs)("div",{className:"In-Up-Container",children:[Object(f.jsxs)("div",{className:"CentralPlate",children:[Object(f.jsx)(Ze,{loading:v}),Object(f.jsx)(zt,{title:"Log In"}),Object(f.jsx)(_e,{errorMessage:p}),Object(f.jsxs)("form",{onSubmit:function(e){return w.apply(this,arguments)},children:[Object(f.jsx)("input",{type:"email",placeholder:"Enter your Email",className:"emailInput",onChange:function(e){return a(e.target.value)}}),Object(f.jsx)("input",{type:"password",name:"",id:"",placeholder:"Enter your password",onChange:function(e){return j(e.target.value)}}),Object(f.jsxs)("div",{className:"inAndUpBtns",children:[Object(f.jsx)("button",{className:"upBtn",disabled:v,children:"Log In"}),Object(f.jsx)(i.b,{to:Wt,children:Object(f.jsx)("button",{className:"inBtn",children:"Create new account"})})]})]})]}),Object(f.jsx)(Vt,{})]})}},{path:Wt,Component:function(){var e=Object(s.useState)(1),t=Object(u.a)(e,2),n=t[0],c=t[1],a=Object(s.useState)(""),r=Object(u.a)(a,2),o=r[0],l=r[1],j=Object(s.useState)(""),h=Object(u.a)(j,2),O=h[0],p=h[1],m=Object(s.useState)(""),x=Object(u.a)(m,2),g=x[0],v=x[1],y=Object(s.useState)(""),S=Object(u.a)(y,2),w=S[0],C=S[1],k=Object(s.useState)(!1),I=Object(u.a)(k,2),A=I[0],P=I[1],L=M().signup,T=Object(s.useState)(""),E=Object(u.a)(T,2),R=E[0],B=E[1],D=0!==o.length&&0!==O.length&&0!==g.length,U=Object(s.useState)(""),W=Object(u.a)(U,2),F=W[0],H=W[1],Y=Object(s.useState)([]),K=Object(u.a)(Y,2),V=K[0],z=K[1];function Q(){return(Q=Object(b.a)(d.a.mark((function e(t){var n,s,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.target.files[0],H(URL.createObjectURL(n)),s=N.ref(),c=s.child("usersImages/".concat(n.name)),e.next=6,c.put(n);case 6:return e.t0=B,e.next=9,c.getDownloadURL();case 9:e.t1=e.sent,(0,e.t0)(e.t1);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(){return(q=Object(b.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),D){e.next=3;break}return e.abrupt("return",C("One of your fields is totaly empty"));case 3:return e.next=5,L(o,g,O,n,R,V,C,P);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(f.jsxs)("div",{className:"In-Up-Container",children:[Object(f.jsx)(pe.a,{src:F,getColors:function(e){return z(e)}}),Object(f.jsxs)("div",{className:"CentralPlate",children:[Object(f.jsx)(Ze,{loading:A}),Object(f.jsx)(zt,{title:"Sign Up"}),w&&Object(f.jsx)("div",{className:"Alert",children:w}),Object(f.jsxs)("form",{onSubmit:function(e){return q.apply(this,arguments)},children:[Object(f.jsx)("input",{type:"email",placeholder:"Enter your Email",className:"emailInput",onChange:function(e){return l(e.target.value)}}),Object(f.jsx)("input",{type:"text",placeholder:"Enter your name",onChange:function(e){return v(e.target.value)}}),Object(f.jsx)("input",{type:"password",name:"",id:"",placeholder:"Create a password",onChange:function(e){return p(e.target.value)}}),Object(f.jsxs)("div",{style:{display:"flex",width:"100%",justifyContent:"center",margin:"5px 0 15px 0"},children:[Object(f.jsx)(be,{label:"User",onClick:function(){return c(0)},currentActive:n,id:0}),Object(f.jsx)(be,{label:"Author",onClick:function(){return c(1)},currentActive:n,id:1})]}),Object(f.jsxs)("label",{className:"downloadFile",children:[Object(f.jsxs)("div",{className:"downloadPhoto",children:[""===R?Object(f.jsxs)("span",{className:"downloadBtnText",children:[Object(f.jsx)(je.d,{}),"Download photo"]}):Object(f.jsx)("span",{className:"downloadBtnText",children:"Done"}),Object(f.jsx)("span",{className:"photoLoadLine",style:""!==R?{width:"100%"}:{}})]}),Object(f.jsx)("input",{type:"file",name:"",id:"",onChange:function(e){return Q.apply(this,arguments)}})]}),Object(f.jsxs)("div",{className:"inAndUpBtns",children:[Object(f.jsx)("button",{className:"upBtn",type:"submit",disabled:A,children:"Sign Up"}),Object(f.jsx)(i.b,{to:Ut,children:Object(f.jsx)("button",{className:"inBtn",children:"Already have the account"})})]})]})]}),Object(f.jsx)(Vt,{})]})}}],hn=[{path:Ft,Component:function(){return Object(f.jsxs)("div",{style:{animation:"zoomIn .2s forwards"},className:"HomePage",children:[Object(f.jsx)(Qt,{}),Object(f.jsx)(qt,{}),Object(f.jsx)(Jt,{}),Object(f.jsx)(Gt,{}),Object(f.jsx)(_t,{})]})}},{path:Ht,Component:function(){var e=Object(s.useState)(0),t=Object(u.a)(e,2),n=t[0],c=t[1],a=[Object(f.jsx)(en,{}),Object(f.jsx)(nn,{}),Object(f.jsx)(sn,{})];return Object(f.jsxs)("div",{className:"LibraryPage",style:{animation:"zoomIn .2s forwards"},children:[Object(f.jsx)(et,{pages:["Songs","Playlists","Authors"],currentPage:n,setCurrentPage:c}),a[n]]})}},{path:Yt,Component:function(){var e=Object(s.useState)(""),t=Object(u.a)(e,2),n=t[0],c=t[1],a=Object(s.useState)([]),r=Object(u.a)(a,2),i=r[0],o=r[1],l=Object(s.useState)([]),d=Object(u.a)(l,2),j=d[0],b=d[1],h=Object(s.useState)([]),O=Object(u.a)(h,2),p=O[0],m=O[1],x=Object(s.useState)(""),g=Object(u.a)(x,2),v=g[0],y=g[1];return Object(s.useEffect)((function(){o([]),b([]),m([])}),[n]),Object(s.useEffect)((function(){0!==i.length?y(i[0].imageColors[0]+"a6"):0!==j.length?y(j[0].imageColors[0]+"a6"):0!==p.length?y(p[0].imageColors[0]+"a6"):y("")}),[i,j,p]),Object(f.jsxs)("div",{className:"SearchPage",style:{animation:"zoomIn .2s forwards"},children:[Object(f.jsx)(ue,{value:n,setValue:c,allFoundSongs:i,setAllFoundSongs:o,setResultPlaylists:m,setResultAuthorList:b,focus:!0}),Object(f.jsx)(Re,{listOfSongs:i,source:{source:"/search",name:"Search",image:"https://lh3.googleusercontent.com/proxy/PJSN5iZPJhIuQKV-efbS0KD_HoL9nu4cyDmwOfWatZdeOyLBsEtosSWHTw4aK9ZKhrTEW2LGZCGxmH9vYFYx_PT16PIrETeNqijSxA",songsList:i},title:"Songs",showListens:!0,displayIfEmpty:""}),Object(f.jsx)(jt,{listOfAuthors:j,title:"Authors"}),Object(f.jsx)(rt,{listOfAlbums:p,title:"Albums and Playlists",loading:!1}),Object(f.jsx)("div",{className:"colorfullShadow",style:{background:v}})]})}},{path:Kt,Component:function(){var e=Object(s.useState)([]),t=Object(u.a)(e,2),n=t[0],c=t[1],a=$(),r=a.toggleModal,i=a.setContent,o=M().currentUser,l=Object(s.useState)(!0),d=Object(u.a)(l,2),j=d[0],b=d[1],h=Object(s.useState)(!1),O=Object(u.a)(h,2),p=O[0],m=O[1],x=Object(s.useState)(""),g=Object(u.a)(x,2);g[0],g[1];return mt(b,"chats",o.chats,c,(function(e,t){if(t.messages.length&&e.messages.length)return new Date(t.messages[t.messages.length-1].sentTime).getTime()-new Date(e.messages[e.messages.length-1].sentTime).getTime()})),Object(f.jsxs)("div",{style:{animation:"zoomIn .2s forwards",minHeight:"100%"},children:[Object(f.jsxs)("div",{style:{marginBottom:"10px",display:"flex",alignItems:"start",width:"100%"},children:[Object(f.jsxs)("button",{className:"standartButton",onClick:function(){r(),i(Object(f.jsx)(dn,{}))},children:[Object(f.jsx)(W.v,{}),"Create chat"]}),Object(f.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[Object(f.jsx)("span",{style:{margin:"0px 10px"},children:"No sound"}),Object(f.jsx)(jn,{boolValue:p,setBoolValue:m})]})]}),j?Object(f.jsx)(re,{}):Object(f.jsx)("div",{className:"chatsWrapper",children:n.map((function(e,t){return Object(f.jsx)(un,{chatData:e},t)}))})]})}}],fn=function(){return Object(f.jsxs)(o.d,{children:[Object(f.jsx)(o.b,{path:"/authors/:authorId",component:Ot,exact:!0}),Object(f.jsx)(o.b,{path:"/albums/:albumId",component:Ge,exact:!0}),Object(f.jsx)(o.b,{path:"/chat/:chatId",component:Dt,exact:!0}),hn.map((function(e,t){var n=e.path,s=e.Component;return Object(f.jsx)(o.b,{path:n,component:s,exact:!0},t)})),Object(f.jsx)(o.a,{to:Ft})]})},On=n(31),pn=n(42);function mn(e){return e%10===e?"0"+e:e}function xn(e){return mn(Math.floor(e/60))+":"+mn(Math.floor(e%60))}var gn=function(e){var t=e.inputRef,n=e.textLimit,s=void 0===n?18:n,c=e.linkToAuthors,a=void 0===c||c,r=D(),i=r.currentSongData,o=r.findLen,u=r.currentTime,l=r.changeCurrentTime,d=r.songDuration,j=r.setRepeatMode,b=r.repeatMode,h=r.play,O=r.prevSong,p=r.playSong,m=r.nextSong,x=r.setShuffleMode,g=r.shuffleMode,v=r.displayAuthors,y=r.name,S=r.authors,w=r.cover;return-1!==i.id?Object(f.jsxs)("div",{className:"player",children:[Object(f.jsxs)("div",{className:"playerUpperSide",children:[Object(f.jsx)("div",{className:"songCover",children:Object(f.jsx)("img",{src:w,alt:""})}),Object(f.jsxs)("div",{className:"nameAndAuthors",children:[Object(f.jsx)("h2",{title:y.length>s?y:null,style:{overflow:"hidden"},children:Object(f.jsx)("div",{style:y.length>s?{animation:"outSideText 17s infinite",whiteSpace:"nowrap"}:{},children:y})}),Object(f.jsx)("h3",{title:S.map((function(e){return" "+e.displayName})),style:{overflow:"hidden"},children:a?Object(f.jsx)("div",{style:o()>s?{animation:"outSideText 17s infinite",whiteSpace:"nowrap"}:{},children:v()}):Object(f.jsx)("div",{children:xe(S," & ",33)})})]})]}),Object(f.jsxs)("div",{className:"controlPanel",children:[Object(f.jsx)("input",{type:"range",min:"0",ref:t,step:"1",value:u,onChange:function(e){l(e)}}),Object(f.jsxs)("div",{className:"startAndEndTime",children:[Object(f.jsx)("span",{children:xn(u)}),Object(f.jsx)("span",{children:xn(d)})]}),Object(f.jsxs)("div",{className:"btns",children:[Object(f.jsx)("button",{className:"shuffleBtn",onClick:function(){return x(k(g+1,1))},style:g?{background:"var(--reallyTransparentWhite)"}:{},children:Object(f.jsx)(pn.b,{style:g?{color:"var(--themeColor)"}:{}})}),Object(f.jsx)("button",{onClick:O,children:Object(f.jsx)(On.a,{})}),Object(f.jsx)("button",{onClick:p,children:h?Object(f.jsx)(On.d,{}):Object(f.jsx)(On.e,{})}),Object(f.jsx)("button",{onClick:m,children:Object(f.jsx)(On.c,{})}),Object(f.jsxs)("button",{className:"repeatBtn",onClick:function(){return j(k(b+1,2))},style:b?{background:"var(--reallyTransparentWhite)"}:{},children:[Object(f.jsx)(pn.a,{style:b?{color:"var(--themeColor)"}:{}}),Object(f.jsx)("span",{style:2===b?{opacity:1}:{}})]}),Object(f.jsx)(he,{play:h})]})]})]}):null},vn=(n(267),[{id:0,icon:Object(f.jsx)(W.l,{}),title:"Home",link:Ft},{id:1,icon:Object(f.jsx)(ie.j,{}),title:"Library",link:Ht},{id:2,icon:Object(f.jsx)(ie.k,{}),title:"Search",link:Yt},{id:3,icon:Object(f.jsx)(W.p,{}),title:"Chat",link:Kt}]),yn=function(e){var t=e.element,n=e.currentPage,s=e.setCurrentPage;return Object(f.jsx)(i.b,{to:t.link,className:"MobileControlBarItem",onClick:function(){return s(t.id)},style:t.id===n?{color:"var(--blue)"}:{},children:t.icon})},Sn=function(){var e=M().currentUser,t={icon:Object(f.jsx)(ie.n,{}),link:"/authors/".concat(e.uid)},n=Object(s.useState)((function(){var e=vn.find((function(e,t){return console.log(window.location.hash),!!window.location.hash.includes(L(e.title))}));return void 0===e?0:e.id})),c=Object(u.a)(n,2),a=c[0],r=c[1];return Object(f.jsxs)("div",{className:"BottomControlBar",children:[vn.map((function(e,t){return Object(f.jsx)(yn,{element:e,currentPage:a,setCurrentPage:r},t)})),Object(f.jsx)(yn,{element:t,currentPage:a,setCurrentPage:r})]})},wn=function(){var e=D().setOpenFullScreenPlayer;return Object(f.jsxs)("div",{className:"FullBottomSide",children:[Object(f.jsx)("span",{onClick:function(){return e(!0)},children:Object(f.jsx)(gn,{textLimit:25,linkToAuthors:!1})}),Object(f.jsx)(Sn,{})]})},Nn=function(e){var t=e.currentTime,n=e.timeSpan,s=e.id;return Object(f.jsx)("div",{className:"Loading",id:s,children:Object(f.jsx)("div",{className:"outer",style:{pointerEvents:"none"},children:Object(f.jsx)("div",{className:"inner",style:t/n<1?{width:t/n*100+"%"}:{width:"0%",opacity:"0"}})})})},Cn=function(e){var t=e.el,n=e.index,c=e.lyricsModeratorMode,a=e.karaokeModeratorTimes,r=e.setKaraokeModeratorTimes,i=e.setInputKaraokeTime,o=e.inputKaraokeTime,u=D(),l=u.currentSongData,d=u.currentParagraph,j=(u.displayAuthors,u.changeCurrentTime),b=u.play,h=u.currentTime,O=u.currentParagraphRef,p=u.lyrics,m=Object(s.useRef)(),x=kt(d===n?O:m),g=d===n?{}:window.innerWidth>1e3?Math.abs(d-n)<2?{transform:"scale(.8) translateX(-58px)"}:{transform:"scale(.75) translateX(-78px)"}:Math.abs(d-n)<2?{transform:"scale(.8) translateX(-11.5%)"}:{transform:"scale(.75) translateX(-15.6%)"};function v(e,t){var n=a;if("down"===t)return n.splice(e+1,0,void 0),r(n),l.lyrics.splice(e+1,0,{startTime:"undefined",text:"@loading"});n.splice(e,0,void 0),r(n),l.lyrics.splice(e,0,{startTime:"undefined",text:"@loading"})}return Object(f.jsxs)("div",{className:"lyricsBlock",id:n,onClick:function(e){return j(e,t.startTime)},style:b&&d!==n&&x?Math.abs(d-n)<2?{opacity:.5,filter:"blur(1px)"}:{opacity:.2,filter:"blur(2px)"}:{},ref:d===n?O:m,children:[1===c?Object(f.jsxs)("div",{className:"lyricsBlockInput",children:[Object(f.jsxs)("span",{onClick:function(e){return e.stopPropagation()},children:[void 0!==a[n]&&0!==a[n].length?Object(f.jsx)(ie.b,{style:{background:"var(--themeColor3)",color:"var(--themeColor)"}}):Object(f.jsx)(W.H,{})," "]}),Object(f.jsx)("input",{type:"number",value:a[n]||o,onChange:function(e){return function(e,t){var n=a,s=e.target.value;n[t]=s,i(e.target.value),r(n)}(e,n)},onClick:function(e){return e.stopPropagation()}}),Object(f.jsxs)("div",{className:"addLyricsElementBtns",onClick:function(e){return e.stopPropagation()},children:[Object(f.jsx)("button",{onClick:function(){v(n,"up")},children:Object(f.jsx)(ie.m,{})}),Object(f.jsx)("button",{onClick:function(){v(n,"down")},children:Object(f.jsx)(ie.f,{})})]})]}):null,"@loading"===t.text?Object(f.jsx)(Nn,{currentTime:h-p[n].startTime,timeSpan:p[n+1].startTime-p[n].startTime,id:n}):"@end"===t.text?Object(f.jsx)(f.Fragment,{}):Object(f.jsx)("p",{id:n,style:g,children:t.text},n)]},n)},kn=[{id:0,icon:Object(f.jsx)(ie.l,{}),title:"Share",component:function(){var e=D().currentSongData,t=[Object(f.jsx)(F.c,{}),Object(f.jsx)(On.b,{}),Object(f.jsx)(On.f,{}),Object(f.jsx)(On.g,{}),Object(f.jsx)(je.b,{})];return Object(f.jsxs)("div",{className:"Share",children:[Object(f.jsxs)("button",{className:"shareCopyLink",children:[Object(f.jsx)(W.g,{}),"Copy link"]}),Object(f.jsx)("div",{className:"shareOnSocial",children:t.map((function(e,t){return Object(f.jsx)("div",{className:"shareSocialIcon",children:e},t)}))}),Object(f.jsx)("div",{className:"sharePeopleShort",children:Object(f.jsx)(le,{item:e,whatToShare:"song"})})]})}},{id:1,icon:Object(f.jsx)(ie.e,{}),title:"More",component:function(){M().currentUser;var e=D(),t=e.currentSongData,n=e.setRightSideCurrentPage;return Object(f.jsxs)("div",{className:"Options",children:[Object(f.jsx)("div",{className:"OptionItem",children:Object(f.jsx)(Se,{song:t})}),Object(f.jsxs)("div",{className:"OptionItem",onClick:function(){return n(4)},children:[Object(f.jsx)(ie.n,{}),"Go to author"]}),Object(f.jsxs)("div",{className:"OptionItem",onClick:function(){return n(5)},children:[Object(f.jsx)(Ie.c,{}),"Add to playlist"]}),Object(f.jsxs)("div",{className:"OptionItem",onClick:function(){return n(6)},children:[Object(f.jsx)(W.n,{}),"Info"]})]})}},{id:2,icon:Object(f.jsx)(pn.c,{}),title:"Lyrics",component:function(){var e=D(),t=e.setIsThereKaraoke,n=e.currentSongData,c=e.setCurrentSongData,a=e.isThereKaraoke,r=e.currentParagraph,i=e.displayAuthors,o=(e.changeCurrentTime,e.play,e.currentTime,e.currentParagraphRef),l=(e.currentSong,e.lyrics),d=e.rightSideCurrentPage,j=e.openFullScreenPlayer,b=e.openMenu,h=M().currentUser,O=Object(s.useState)(0),p=Object(u.a)(O,2),m=p[0],x=p[1],g=Object(s.useState)([]),v=Object(u.a)(g,2),y=v[0],S=v[1],w=Object(s.useState)(0),N=Object(u.a)(w,2),k=N[0],I=N[1],A=Object(s.useState)(!1),P=Object(u.a)(A,2),L=P[0],T=P[1];function E(e,t){var n=y,s=e.target.value;n[t]=s,x(e.target.value),S(n)}function R(e,t){var s=y;if("down"===t)return s.splice(e+1,0,void 0),S(s),n.lyrics.splice(e+1,0,{startTime:"undefined",text:"@loading"});s.splice(e,0,void 0),S(s),n.lyrics.splice(e,0,{startTime:"undefined",text:"@loading"})}return Object(s.useEffect)((function(){a&&b&&2===d&&j&&o.current.scrollIntoView()}),[r]),Object(s.useEffect)((function(){l[0]&&"undefined"!==l[0].startTime&&(l.forEach((function(e){y.push(e.startTime)})),T(!0))}),[]),Object(s.useEffect)((function(){var e=n;void 0!==e&&0!==m&&(e.lyrics.forEach((function(e,t){e.startTime=y[t]||"undefined"})),c(e),t(!0)),n.lyrics.some((function(e){return"undefined"===e.startTime}))?T(!1):T(!0)}),[m]),Object(f.jsxs)("div",{className:"Lyrics",children:[h.isAdmin?Object(f.jsx)(et,{pages:["Listen mode","Edit Mode"],currentPage:k,setCurrentPage:I}):null,a?l.map((function(e,t){return Object(f.jsx)(Cn,{el:e,index:t,lyricsModeratorMode:k,karaokeModeratorTimes:y,setKaraokeModeratorTimes:S,setInputKaraokeTime:x,inputKaraokeTime:E})})):l.map((function(e,t){return Object(f.jsxs)("div",{className:"lyricsBlock",children:[1===k?Object(f.jsxs)("div",{className:"lyricsBlockInput",children:[void 0!==y[t]&&0!==y[t].length?Object(f.jsx)(ie.b,{style:{background:"var(--themeColor3)",color:"var(--themeColor)"}}):Object(f.jsx)(W.H,{}),Object(f.jsx)("input",{type:"number",value:y[t]||m,onChange:function(e){return E(e,t)},onClick:function(e){return e.stopPropagation()}}),Object(f.jsxs)("div",{className:"addLyricsElementBtns",children:[Object(f.jsx)("button",{onClick:function(){return R(t,"up")},children:Object(f.jsx)(ie.m,{})}),Object(f.jsx)("button",{onClick:function(){return R(t,"down")},children:Object(f.jsx)(ie.f,{})})]})]}):null,Object(f.jsx)("p",{children:e.text})]},t)})),Object(f.jsxs)("h6",{className:"lyricsAuthors "+(r===l.length-1?"active":""),children:["Authors:  ",i()]}),1===k?Object(f.jsx)("button",{onClick:L?function(){C.collection("songs").doc(n.id).update({lyrics:n.lyrics})}:null,className:"updateLyricsBtn",style:L?{}:{opacity:.3},children:"Update Lyrics"}):null]})}},{id:3,icon:Object(f.jsx)(xt.a,{}),title:"Queue",component:function(){var e=D(),t=e.currentSongQueue,n=e.currentSongPlaylistSource,s=e.setOpenFullScreenPlayer;return Object(f.jsxs)("div",{className:"Queue",children:[Object(f.jsx)("div",{className:"queueNowIsPlaying",children:Object(f.jsxs)("h5",{style:{marginTop:2},children:["Now is playing:",Object(f.jsxs)(i.b,{onClick:function(){return s(!1)},to:n.source,className:"queueAlbumName",children:[Object(f.jsx)("div",{className:"queueImage",children:Object(f.jsx)("img",{src:n.image,alt:""})}),Object(f.jsx)("span",{children:me(n.name,25)})]})]})}),t.map((function(e,t){return Object(f.jsx)(Te,{song:e,localIndex:t},t)}))]})}},{id:4,icon:null,title:"Go To Authors",component:Pe},{id:5,icon:null,title:"Add to playlist",component:ke},{id:6,icon:null,title:"Info",component:Ce}];function In(){var e=D(),t=e.imgColors,n=e.inputRef,a=e.rightSideCurrentPage,r=e.setRightSideCurrentPage,i=e.openFullScreenPlayer,o=e.setOpenFullScreenPlayer,l=e.lyrics,d=e.openMenu,j=e.setOpenMenu,b=z(),h=b.isMobile,O=b.screenHeight,m=Object(s.useRef)(null),x=Object(s.useState)(.05),g=Object(u.a)(x,2),v=g[0],y=g[1],S=Object(s.useState)(0),w=Object(u.a)(S,2),N=w[0],C=w[1],I=Object(s.useState)(0),A=Object(u.a)(I,2),P=A[0],L=A[1],T=Object(s.useState)(0),E=Object(u.a)(T,2),M=E[0],R=E[1],B=Object(s.useRef)(),U=c.a.useRef();te(U,j);var F=Object(Qe.useSwipeable)({onSwiping:function(e){e.deltaY>0&&L(e.deltaY)}}),H=c.a.useRef(),Y=Object(Qe.useSwipeable)({onSwiping:function(e){e.event.stopPropagation(),(d&&0===B.current.scrollTop&&e.deltaY>0||!d&&e.deltaY<0)&&R(e.deltaY)},onSwipedLeft:function(){r(k(a+1,3))},onSwipedRight:function(){r(k(a-1,3))}});Object(s.useEffect)((function(){P>150&&o(!1)}),[P]),Object(s.useEffect)((function(){!d&&M<-100?(j(!0),R(0),C(.2)):d&&M>150?(j(!1),R(0),C(.2)):function(){var e;clearTimeout(e),C(0),e=setTimeout((function(){C(.2),R(0)}),300)}()}),[M]);function K(e){var t=kn[e].component;return Object(f.jsx)(t,{})}function V(){return l&&0===l.length}function Q(e){if(2===e.id&&V())return null;C(.2),r(e.id),j(!0)}return Object(s.useEffect)((function(){0!==t.length&&(document.documentElement.style.setProperty("--themeColor",t[1]),document.documentElement.style.setProperty("--themeColor2",t[0]),document.documentElement.style.setProperty("--themeColor3",t[2]),document.documentElement.style.setProperty("--themeColor4",t[5]),document.documentElement.style.setProperty("--themeColorTransparent",t[0]+"6e"))}),[t]),Object(f.jsxs)("div",Object(p.a)(Object(p.a)({className:"bg",style:i?{height:O+"px",top:0,opacity:1,visibility:"visible",zIndex:10,transform:"translateY(".concat(P,"px)"),borderRadius:"".concat(P<20?P:20,"px ").concat(P<20?P:20,"px 0 0"),transition:".4s opacity, ".concat(v,"s transform, .4s top, .4s visibility")}:{transform:"translateY(".concat(P,"px)"),transition:".4s opacity, ".concat(v,"s transform, .4s top, .4s visibility")},ref:function(e){F.ref(e),H.current=e}},F),{},{onTouchEnd:function(){var e;clearTimeout(e),y(.2),e=setTimeout((function(){L(0),y(0)}),100)},children:[Object(f.jsxs)("div",{className:"auroraWrapper",children:[Object(f.jsx)("div",{className:"auroraCircle"}),Object(f.jsx)("div",{className:"auroraCircle"}),Object(f.jsx)("div",{className:"auroraCircle"})]}),Object(f.jsx)("div",{className:"closeFullScreen",onClick:function(){o(!1)},children:window.innerWidth>1e3?Object(f.jsx)(fe.a,{}):Object(f.jsx)(W.q,{style:{opacity:.6}})}),Object(f.jsxs)("div",{className:"FullScreenPlayer",children:[Object(f.jsx)("div",{className:"leftSide",style:d?h?{opacity:.6,visibility:"visible",transform:"translateY(20px)",borderRadius:"10px",transition:".4s"}:null:{width:"100%"},children:Object(f.jsx)(gn,{inputRef:n})}),window.innerWidth>1e3?Object(f.jsxs)("div",{className:"rightSideWrapper",style:d?{}:{transform:"translateX(calc(100% - 90px))",width:0},children:[Object(f.jsx)("button",{className:"menuBtn",style:d?{transform:"rotate(180deg)"}:{opacity:0,visibility:"hidden"},onClick:function(){return j(!d)},children:Object(f.jsx)(ie.c,{})}),Object(f.jsx)("div",{className:"rightSideControl",children:kn.map((function(e,t){return Object(f.jsx)("div",{className:"controlIcon",style:e.id===a&&d?{background:"var(--themeColor)"}:2===e.id&&V()?{opacity:.4}:{},onClick:function(){return Q(e)},children:e.icon},e.id)}))}),Object(f.jsx)("div",{className:"rightSide",ref:m,style:d?{}:{display:"none"},children:K(a)})]}):Object(f.jsxs)("div",Object(p.a)(Object(p.a)({className:"mobilePlayerMenu"},Y),{},{ref:function(e){Y.ref(e),U.current=e},style:d?{top:"calc(100% - calc(70vh + 55px) + ".concat(M,"px)"),transition:"".concat(N,"s")}:{top:"calc(100% - 55px + ".concat(M,"px)"),transition:"".concat(N,"s")},children:[Object(f.jsx)("div",{className:"mobilePlayerMenuClose",children:Object(f.jsx)(W.q,{style:{opacity:.6,width:"50px"},onClick:function(){return j(!d)}})}),Object(f.jsx)("div",{className:"controlIconsWrapper",children:kn.map((function(e,t){if(t<=3)return Object(f.jsx)("div",{className:"controlIcon",style:e.id===a&&d?{background:"var(--transparentWhite)"}:2===e.id&&V()?{opacity:.4}:{},onClick:function(t){return Q(e)},children:e.title},e.id)}))}),Object(f.jsx)("div",{className:"mobilePlayerMenuContent",ref:B,style:d?{}:{opacity:0},children:K(a)})]}))]})]}))}function An(e){var t=e.id,n=e.title,s=e.icon,c=e.link,a=e.currentPage,r=e.setCurrentPage;return Object(f.jsx)(i.b,{to:c,children:Object(f.jsxs)("div",{className:"NavigationItem "+(t===a?"active":""),onClick:function(){return r(t)},children:[Object(f.jsx)("div",{className:"icon",children:s}),Object(f.jsx)("b",{children:n})]})})}n(268);var Pn=function(e){var t=e.index,n=e.friend,c=M().currentUser,a=Object(s.useState)(0),r=Object(u.a)(a,2),o=r[0],l=r[1],d=Object(s.useState)(!1),j=Object(u.a)(d,2),b=j[0],h=j[1];Object(s.useEffect)((function(){ce([n.uid],c,h,l)}),[]);var O=D().currentSong;return Object(f.jsxs)("div",{className:"person",id:n.uid,children:[Object(f.jsxs)("div",{className:"personBtns",children:[Object(f.jsx)(i.b,{to:"/chat/".concat(o),children:Object(f.jsxs)("button",{onClick:function(){b&&se([c.uid,n.uid],o)},children:[Object(f.jsx)(q,{text:"chat"}),Object(f.jsx)(W.p,{})]})}),Object(f.jsx)(i.b,{to:"/authors/".concat(n.uid),children:Object(f.jsxs)("button",{children:[Object(f.jsx)(q,{text:"profile"}),Object(f.jsx)(W.C,{})]})}),Object(f.jsxs)("button",{onClick:function(e){return function(e,t){console.log("id:",e.target.id,"songId:",t)}(e,O)},children:[Object(f.jsx)(q,{text:"share"}),Object(f.jsx)(ie.l,{})]})]}),Object(f.jsx)("div",{className:"pesronImg",style:{pointerEvents:"none"},children:Object(f.jsx)("img",{src:n.photoURL,alt:""})}),Object(f.jsx)(cn,{userUID:n.uid}),Object(f.jsx)("div",{className:"personName",style:{pointerEvents:"none"},children:n.displayName})]},t)},Ln=function(e){var t=e.playlist,n=$();n.toggleModal,n.setContent;return Object(f.jsxs)("div",{className:"TinyPlaylist",children:[Object(f.jsxs)("div",{className:"TinyPlaylistBtns",children:[Object(f.jsxs)("button",{children:[Object(f.jsx)(q,{text:"add song"}),Object(f.jsx)(W.w,{})]}),Object(f.jsx)(i.b,{to:"/albums/".concat(t.id),children:Object(f.jsxs)("button",{children:[Object(f.jsx)(q,{text:"album"}),Object(f.jsx)(ie.a,{})]})}),Object(f.jsxs)("button",{children:[Object(f.jsx)(q,{text:"play"}),Object(f.jsx)(W.u,{})]})]}),Object(f.jsx)("div",{className:"TinyPlaylistImg",children:Object(f.jsx)("img",{src:t.image,alt:""})}),Object(f.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[Object(f.jsx)("span",{children:me(t.name,13)}),Object(f.jsx)("span",{style:{fontSize:"0.8em",color:"grey",fontWeight:"500"},children:t.isAlbum?"album":"playlist"})]})]})},Tn=function(){return Object(f.jsx)("div",{className:"NotificationCircle"})},En=function(){var e=M().currentUser,t=D(),n=t.leftSideBarInputRef,c=t.setOpenFullScreenPlayer,a=t.currentSongData,r=t.yourFriends,o=t.yourPlaylists,l=$(),d=l.toggleModal,j=l.setContent,b=Object(s.useState)(0),O=Object(u.a)(b,2),p=O[0],m=O[1],x=Object(s.useState)((function(){var e=vn.find((function(e,t){return!!window.location.hash.includes(L(e.title))}));return void 0===e?0:e.id})),g=Object(u.a)(x,2),v=g[0],y=g[1];return Object(f.jsxs)("div",{className:"LeftsideBar",children:[Object(f.jsxs)("div",{className:"logo",children:[Object(f.jsx)("img",{src:h,alt:""}),Object(f.jsx)("h3",{children:"Soundbubble"})]}),Object(f.jsx)("div",{className:"leftSideBarContainer",onClick:function(){return y(-1)},children:Object(f.jsx)(i.b,{to:"/authors/".concat(e.uid),children:Object(f.jsxs)("div",{className:"person",style:-1===v?{background:"var(--blue)"}:{},children:[e.friends.some((function(e){return"requested"===e.status}))?Object(f.jsx)(Tn,{}):null,Object(f.jsx)("div",{className:"pesronImg",children:Object(f.jsx)("img",{src:e.photoURL,alt:""})}),Object(f.jsx)("div",{className:"personName",children:e.displayName})]})})}),Object(f.jsx)("div",{className:"NavigationPanel",children:vn.map((function(e,t){var n=e.id,s=e.title,c=e.icon,a=e.link;return Object(f.jsx)(An,{id:n,title:s,icon:c,link:a,currentPage:v,setCurrentPage:y},t)}))}),Object(f.jsxs)("div",{className:"leftSideBarContainer friendsAndPlaylists",children:[Object(f.jsx)("span",{style:{display:p?"none":"block",animation:"scrollFromBottom .2s forwards"},children:r.length>0?Object(f.jsxs)(f.Fragment,{children:[r.map((function(e,t){return t<=2?Object(f.jsx)(Pn,{index:e.uid,friend:e}):null})),Object(f.jsx)("h4",{className:"seeMoreBtn",onClick:function(){d(),j(Object(f.jsx)(le,{item:a,whatToShare:"song"}))},children:"See more"})]}):Object(f.jsx)("h4",{style:{alignSelf:"center",width:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:"No friends added"})}),Object(f.jsxs)("span",{style:{display:p?"block":"none",animation:"scrollFromTop .2s forwards"},children:[o.map((function(e,t){if(t<=2)return Object(f.jsx)(Ln,{playlist:e},e.id)})),Object(f.jsxs)("button",{className:"createPlaylistBtn",onClick:function(){d(),j(Object(f.jsx)(tn,{}))},style:{margin:"5px 0"},children:[Object(f.jsx)(ie.g,{}),"Create Playlist"]})]}),Object(f.jsxs)("div",{className:"upAndDownBtns",children:[Object(f.jsx)("button",{onClick:function(){return m(0)},style:p?{}:{opacity:"0.3"},children:Object(f.jsx)(W.f,{})}),Object(f.jsx)("button",{onClick:function(){return m(1)},style:p?{opacity:"0.3"}:{},children:Object(f.jsx)(W.c,{})})]})]}),Object(f.jsx)("div",{className:"leftSideBarContainer",children:-1===a.id?null:Object(f.jsxs)("div",{className:"littlePlayer",children:[Object(f.jsx)(gn,{textLimit:15,inputRef:n}),Object(f.jsx)("div",{className:"fullScreenBtn",onClick:function(){return c(!0)},children:Object(f.jsx)(ie.h,{})})]})})]})},Mn=(n(269),function(){var e=$(),t=e.isOpenConfirm,n=e.confirmContent,c=e.setIsOpenConfirm,a=(e.closeComfirm,Object(s.useRef)(null));return te(a,c),Object(f.jsx)("div",{className:"modal_darkBg confirm",style:t?{}:{opacity:0,visibility:"hidden"},children:Object(f.jsxs)("div",{className:"ConfirmWindow",ref:a,style:t?{}:{transform:"translateY(40px)"},children:[Object(f.jsx)("h3",{children:n.question}),Object(f.jsxs)("div",{className:"confirmButtons",children:[Object(f.jsx)("button",{onClick:n.onConfirm,className:"standartButton",children:n.confirmText}),Object(f.jsx)("button",{onClick:n.onReject,className:"standartButton",children:n.rejectText})]})]})})}),Rn=function(){var e=D(),t=e.songRef,n=e.loadSongData,c=e.playing,a=e.songSrc,r=e.openFullScreenPlayer,i=e.repeatMode,o=e.setPlay,l=e.prevSong,d=e.currentSongQueue,j=e.nextSong,b=e.updateListenCount,h=(e.currentSongInQueue,z()),O=h.isMobile,p=h.screenHeight,m=M(),x=m.currentUser,g=(m.setCurrentUser,Object(s.useState)(!0)),v=Object(u.a)(g,2),y=v[0],S=v[1];return Object(s.useEffect)((function(){var e=setInterval((function(){C.collection("users").doc(x.uid).update({online:(new Date).getTime()}),S(!y)}),3e5);return function(){return clearInterval(e)}}),[y]),Object(s.useEffect)((function(){C.collection("users").doc(x.uid).update({online:(new Date).getTime()})}),[]),Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("audio",{src:a,ref:t,onLoadedData:n,onTimeUpdate:c,onEnded:function(){return console.log("i workdfasd"),0===i?(t.current.pause(),o(!1),l()):1===i?1===d.length?(l(),b(),t.current.play()):j():(l(),b(),void t.current.play())}}),Object(f.jsxs)("div",{className:"Wrapper "+(r?"turnedOff":""),style:O?{height:p}:{height:"100vh"},children:[O?"chat"===window.location.hash.substr(2,4)&&window.location.hash.length>6?null:Object(f.jsx)(wn,{}):Object(f.jsx)(En,{}),Object(f.jsx)("div",{className:"Content",children:Object(f.jsx)(fn,{})}),Object(f.jsx)(ln,{}),Object(f.jsx)(Mn,{})]}),Object(f.jsx)(In,{})]})},Bn=function(){return M().currentUser.uid?Object(f.jsx)(o.d,{children:Object(f.jsx)(o.b,{path:"/",component:Rn})}):Object(f.jsxs)(o.d,{children:[bn.map((function(e,t){var n=e.path,s=e.Component;return Object(f.jsx)(o.b,{path:n,component:s,exact:!0},t)})),Object(f.jsx)(o.a,{to:Ut})]})};function Dn(){return Object(f.jsx)(i.a,{basename:"/",children:Object(f.jsx)(Bn,{})})}r.a.render(Object(f.jsx)(c.a.StrictMode,{children:Object(f.jsx)(Q,{children:Object(f.jsx)(R,{children:Object(f.jsx)(U,{children:Object(f.jsx)(ee,{children:Object(f.jsx)(Dn,{})})})})})}),document.getElementById("root"))},84:function(e,t,n){}},[[270,1,2]]]);
//# sourceMappingURL=main.04a682ee.chunk.js.map