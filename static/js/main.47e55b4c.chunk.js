(this.webpackJsonpsoundbubble=this.webpackJsonpsoundbubble||[]).push([[0],{262:function(e,t,n){},263:function(e,t,n){},264:function(e,t,n){},265:function(e,t,n){},266:function(e,t,n){},267:function(e,t,n){},268:function(e,t,n){},269:function(e,t,n){},270:function(e,t,n){},271:function(e,t,n){},272:function(e,t,n){},273:function(e,t,n){"use strict";n.r(t);var s=n(2),c=n.n(s),a=n(119),r=n.n(a),i=(n(86),n(13)),o=n(14),l=n(4),u=n(6),d=n.n(u),j=n(8),b=n.p+"static/media/Logo3.fc53f4ac.svg",h=n(1),f=function(){return Object(h.jsx)("div",{className:"LoadingData",children:Object(h.jsx)("img",{loading:"lazy",src:b,alt:""})})},O=n(20),p=n(41),m=n(9),x=n(33),g=function(e){var t=e.listOfChosenItems,n=e.setListOfChosenItems,s=e.itemId;return void 0!==t?Object(h.jsx)("div",{onClick:function(e){return e.preventDefault()},children:t.includes(s)?Object(h.jsx)("button",{type:"button",onClick:function(e){var c=t.filter((function(e){return e!==s}));n(c)},className:"addToListBtn",children:Object(h.jsx)(x.b,{style:{color:"var(--lightBlue)"}})}):Object(h.jsx)("button",{type:"button",onClick:function(){return n((function(e){return[].concat(Object(m.a)(e),[s])}))},className:"addToListBtn",children:Object(h.jsx)(x.d,{})})}):null},v=function(e){var t=e.data,n=e.chosenArray,s=e.setChosenArray,c=Object(p.a)(e,["data","chosenArray","setChosenArray"]);return Object(h.jsxs)("div",Object(O.a)(Object(O.a)({className:"person"},c),{},{children:[Object(h.jsx)(g,{listOfChosenItems:n,setListOfChosenItems:s,itemId:t.uid}),Object(h.jsx)("div",{className:"pesronImg",children:Object(h.jsx)("img",{loading:"lazy",src:t.photoURL,alt:""})}),Object(h.jsx)("div",{className:"personName",children:t.displayName})]}))},y=n(83);n(130),n(131),n(132),n(133);var S=y.a.initializeApp({apiKey:"AIzaSyBuDoETyUrO2RCDAlFMsW2uV-QmtCT8t6Y",authDomain:"soundbubble-27737.firebaseapp.com",projectId:"soundbubble-27737",storageBucket:"soundbubble-27737.appspot.com",messagingSenderId:"527274299416",appId:"1:527274299416:web:64b1ac2d05f4262df0736d",measurementId:"G-9TP9PEEV11"});y.a.analytics();var w=S.auth(),N=S.storage(),C=S.firestore();function k(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e>t?n:e<n?t:e}function I(e){for(var t=[],n=new Array(e.length),s=0;s<e.length;){var c=Math.floor(Math.random()*e.length);t.includes(c)||(t.push(c),n[c]=e[s],s++)}return n}var A=function(e,t,n,c){Object(s.useEffect)((function(){e.uid&&n&&t()}),[JSON.stringify(c)])},P=n(123);function L(e){return e.replace(/\s/g,"").replace(/[,'._/]/g,"").replace(/-/g,"").toLowerCase()}var T=function(e){for(var t=[],n=L(e),s=1;s<n.length+1;s++)t.push(n.substr(0,s));return t},E=c.a.createContext(),R=function(){return Object(s.useContext)(E)},M=function(e){var t=e.children,n=Object(s.useState)({}),c=Object(l.a)(n,2),a=c[0],r=c[1],i=Object(s.useState)(null),o=Object(l.a)(i,2),u=o[0],b=o[1],f=Object(s.useState)(!0),O=Object(l.a)(f,2),p=O[0],m=O[1];Object(s.useEffect)((function(){if(null!==u)return C.collection("users").doc(u).onSnapshot((function(e){e.data()&&void 0===a.uid&&r(e.data())}))}),[C,u]),Object(s.useEffect)((function(){return w.onAuthStateChanged(function(){var e=Object(j.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t?b(t.uid):(b(null),r({}),m(!1));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]);var x={currentUser:a,setCurrentUser:r,login:function(e,t,n,s){return s(!0),w.signInWithEmailAndPassword(e,t).then().catch((function(e){n(e.message),s(!1)}))},signup:function(e,t,n,s,c,a,r,i){return i(!0),w.createUserWithEmailAndPassword(e,n).then((function(e){C.collection("users").doc(e.user.uid).set({uid:e.user.uid,displayName:t,photoURL:c||"https://images.fineartamerica.com/images/artworkimages/mediumlarge/1/music-icon-mohammed-jabir-ap.jpg",isAuthor:1===parseInt(s),isVerified:1===parseInt(s),numberOfListenersPerMonth:0,ownSongs:[],ownPlaylists:[],addedSongs:[],addedPlaylists:[],addedAuthors:[],lastSongPlayed:"",chats:[],friends:[],subscribers:0,regDate:P.a.firestore.FieldValue.serverTimestamp(),imageColors:a}),C.collection("search").doc(e.user.uid).set({place:"users",uid:e.user.uid,variantsOfName:T(t)}),i(!1)})).catch((function(e){r(e.message)}))},logout:function(){return w.signOut()},loading:p,setLoading:m};return Object(h.jsx)(E.Provider,{value:x,children:t})},D=c.a.createContext(),B=function(){return Object(s.useContext)(D)},U=function(e){var t=e.children,n=Object(s.useState)(!1),c=Object(l.a)(n,2),a=c[0],r=c[1],i=Object(s.useState)(Object(h.jsx)("h1",{children:"Test"})),o=Object(l.a)(i,2),u=o[0],d=o[1],j=Object(s.useState)(!1),b=Object(l.a)(j,2),f=b[0],O=b[1],p=Object(s.useState)({confirmText:"Confirm Action",rejectText:"Cancel",onConfirmL:function(){return null},onReject:function(){return null}}),m=Object(l.a)(p,2),x=m[0],g=m[1];function v(){O(!1)}var y={openModal:a,setOpenModal:r,toggleModal:function(){r(!a)},setContent:d,content:u,isOpenConfirm:f,setIsOpenConfirm:O,openConfirm:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Cancel",s=arguments.length>3?arguments[3]:void 0,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:v;O(!0),g({question:e,confirmText:t,rejectText:n,onConfirm:s,onReject:c})},closeConfirm:v,confirmContent:x};return Object(h.jsx)(D.Provider,{value:y,children:t})},W=Object(s.createContext)(null),F=function(){return Object(s.useContext)(W)},z=function(e){var t=e.children,n=R(),c=n.currentUser,a=n.loading,r=n.setLoading,o=B().setOpenModal,u=Object(s.useState)([]),b=Object(l.a)(u,2),O=b[0],p=b[1],m=Object(s.useState)([]),x=Object(l.a)(m,2),g=x[0],y=x[1],S=Object(s.useState)([]),w=Object(l.a)(S,2),N=w[0],P=w[1],L=Object(s.useState)([]),T=Object(l.a)(L,2),E=T[0],M=T[1],D=Object(s.useState)([]),U=Object(l.a)(D,2),F=U[0],z=U[1],H=Object(s.useState)(-1),Y=Object(l.a)(H,2),V=Y[0],Q=Y[1],q=Object(s.useState)(0),K=Object(l.a)(q,2),X=K[0],G=K[1],J=Object(s.useState)({}),_=Object(l.a)(J,2),Z=_[0],$=_[1],ee=Object(s.useState)(0),te=Object(l.a)(ee,2),ne=te[0],se=te[1],ce=Object(s.useState)({id:-1}),ae=Object(l.a)(ce,2),re=ae[0],ie=ae[1],oe=Object(s.useState)([]),le=Object(l.a)(oe,2),ue=le[0],de=le[1],je=Object(s.useState)(!1),be=Object(l.a)(je,2),he=be[0],fe=be[1],Oe=Object(s.useState)(0),pe=Object(l.a)(Oe,2),me=pe[0],xe=pe[1],ge=Object(s.useState)(0),ve=Object(l.a)(ge,2),ye=ve[0],Se=ve[1],we=Object(s.useState)(1),Ne=Object(l.a)(we,2),Ce=Ne[0],ke=Ne[1],Ie=Object(s.useState)(0),Ae=Object(l.a)(Ie,2),Pe=Ae[0],Le=Ae[1],Te=Object(s.useState)(0),Ee=Object(l.a)(Te,2),Re=Ee[0],Me=Ee[1],De=Object(s.useState)(!1),Be=Object(l.a)(De,2),Ue=Be[0],We=Be[1],Fe=Object(s.useState)(!1),ze=Object(l.a)(Fe,2),He=ze[0],Ye=ze[1],Ve=Object(s.useRef)(null),Qe=Object(s.useRef)(null),qe=Object(s.useRef)(null),Ke=Object(s.useRef)(null),Xe=Object(s.useState)(0),Ge=Object(l.a)(Xe,2),Je=Ge[0],_e=Ge[1],Ze=Object(s.useState)(!1),$e=Object(l.a)(Ze,2),et=$e[0],tt=$e[1];function nt(){return(void 0===re.lyrics||0!==re.lyrics.length)&&(void 0===re.lyrics||"undefined"!==re.lyrics[0].startTime)}function st(){return ct.apply(this,arguments)}function ct(){return(ct=Object(j.a)(d.a.mark((function e(){var t,n,s,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0!==c.uid&&(t={id:-1,name:"",songSrc:"",authors:[],cover:"",listens:0,releaseDate:"",lyrics:[],imageColors:[]},n=c.lastSongPlayed||c.addedSongs[0]||t.id,s=c.lastQueue||{source:"/library",name:"Your Library",image:c.photoURL,songsList:O}||[],Q(n),$(s),-1!==n?(a=C.collection("songs").doc(n),a.get().then((function(e){if(e.exists){var t=e.data();ie(t),de(t.imageColors||[]),r(!1)}})).catch((function(e){console.log("Error getting document:",e),r(!1)}))):(ie(t),de([]),r(!1)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function at(){return(at=Object(j.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:-1!==V?C.collection("songs").doc(V).get().then((function(e){if(e.exists){var t=e.data();de(t.imageColors||[]),ie(t)}})):st();case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function rt(){var e=[];c.addedSongs&&c.addedSongs.map((function(t,n){C.collection("songs").doc(t).get().then((function(t){t.exists?(e.unshift(t.data()),n===c.addedSongs.length-1&&p(e)):console.log("No such document!"),n===c.addedSongs.length-1&&function(){var e=[];c.lastQueue&&(c.lastQueue.songsList.forEach(function(){var t=Object(j.a)(d.a.mark((function t(n,s){var a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,C.collection("songs").doc(n).get();case 2:a=t.sent.data(),e.push(a),s===c.lastQueue.songsList.length-1&&z(e);case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),G(c.lastQueue.songsList.findIndex((function(e){return e===c.lastSongPlayed}))))}()}))}))}Object(s.useEffect)((function(){c.addedSongs&&c.addedSongs.length!==O.length&&rt()}),[c.addedSongs]),A(c,(function(){var e=[];c.ownPlaylists&&c.ownPlaylists.map((function(t,n){C.collection("playlists").doc(t).get().then((function(t){t.exists?(e.push(t.data()),n===c.ownPlaylists.length-1&&y(e)):console.log("No such document!")})).catch((function(e){console.log("Error getting document:",e)}))})),c.addedPlaylists&&c.addedPlaylists.map((function(t,n){C.collection("playlists").doc(t).get().then((function(t){t.exists?(e.push(t.data()),n===c.addedPlaylists.length-1&&y(e)):console.log("No such document!")})).catch((function(e){console.log("Error getting document:",e)}))}))}),c.ownPlaylists&&String(c.ownPlaylists.concat(c.addedPlaylists))!==String(g),[c.ownPlaylists]),A(c,(function(){var e=[];void 0!==c.friends&&c.friends.forEach(function(){var t=Object(j.a)(d.a.mark((function t(n,s){var a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,C.collection("users").doc(n.uid).get();case 2:a=t.sent.data(),"added"===n.status&&e.push(a),s===c.friends.length-1&&M(e);case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())}),c.friends&&String(c.friends.filter((function(e){return"added"===e.status})))!==String(E),[c.friends]),A(c,(function(){var e=[];c.addedAuthors&&c.addedAuthors.map((function(t,n){C.collection("users").doc(t).get().then((function(t){t.exists?(e.unshift(t.data()),n===c.addedAuthors.length-1&&P(e)):console.log("No such document!")})).catch((function(e){console.log("Error getting document:",e)}))}))}),c.addedAuthors&&c.addedAuthors.length!==N.length,[c.addedAuthors]),A(c,(function(){return at.apply(this,arguments)}),c&&(-1===re.id||V||c.lastSongPlayed),[V,c.lastSongPlayed]),Object(s.useEffect)((function(){void 0===c.uid&&(ie({id:-1}),Q(-1),z([]),P([]),p([]),M([]),y([]))}),[c.uid]),Object(s.useEffect)((function(){We(nt())}),[re.lyrics]),Object(s.useEffect)((function(){if(!a)if(Pe){var e=I(F);z(e),G(e.findIndex((function(e){return e.id===V})))}else z(Z.songsList),G(Z.songsList.findIndex((function(e){return e.id===V})))}),[Pe]);var it=Object(s.useRef)();function ot(){it.current=setTimeout((function(){var e=re.listens;if(e++,C.collection("songs").doc(re.id).update({listens:e}),"albums"===Z.source.substr(1,6)){var t=Z.source.substr(8,Z.source.length-8);C.collection("playlists").doc(t).get().then((function(e){var n=e.data().listens;n++,C.collection("playlists").doc(t).update({listens:n})}))}}),1e3*ye*.5)}function lt(){for(var e=0,t=re.lyrics.length-1,n=parseFloat(parseFloat(Ve.current.currentTime).toFixed(1));e<=t;){var s=Math.floor((e+t)/2),c=parseFloat(parseFloat(re.lyrics[s].startTime).toFixed(1)),a=s!==re.lyrics.length-1?parseFloat(parseFloat(re.lyrics[s+1].startTime).toFixed(1)):t;if("undefined"===re.lyrics[s].startTime)return;if(n>=c&&n<=a){Me(s);break}c<n?e=s+1:t=s-1}}function ut(){return(ut=Object(j.a)(d.a.mark((function e(t){var n,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t&&t.stopPropagation(),n=k(X+1,F.length-1),e.next=4,C.collection("songs").doc(F[n].id).get();case 4:return e.next=6,e.sent.data().id;case 6:s=e.sent,Me(0),Q(s),G(k(n,F.length-1)),C.collection("users").doc(c.uid).update({lastSongPlayed:s});case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function dt(){return(dt=Object(j.a)(d.a.mark((function e(t){var n,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.stopPropagation(),!(me>5)){e.next=6;break}return Ve.current.currentTime=0,xe(0),Me(0),e.abrupt("return");case 6:return n=k(X-1,F.length-1),e.next=9,C.collection("songs").doc(F[n].id).get();case 9:return e.next=11,e.sent.data().id;case 11:s=e.sent,Me(0),Q(s),G(k(n,F.length-1)),C.collection("users").doc(c.uid).update({lastSongPlayed:s});case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){clearTimeout(it.current),he&&ot()}),[he,re.id]),Object(s.useEffect)((function(){Me(0)}),[re.id]),Object(s.useEffect)((function(){2===Je&&lt()}),[Je]),Object(s.useEffect)((function(){document.title=re.name||"Soundbubble"}),[re.name]),Object(h.jsx)(W.Provider,{value:{yourSongs:O,setYourSongs:p,yourPlaylists:g,yourFriends:E,currentSongQueue:F,currentSongPlaylistSource:Z,setCurrentSongPlaylistSource:$,setCurrentSongQueue:z,setCurrentSongInQueue:G,play:he,setPlay:fe,songSrc:re.songSrc,currentTime:me,setCurrentTime:xe,songDuration:ye,songRef:Ve,name:re.name,authors:re.authors,lyrics:re.lyrics,cover:re.cover,imgColors:ue,setImgColors:de,currentSong:V,setCurrentSong:Q,repeatMode:Ce,setRepeatMode:ke,shuffleMode:Pe,setShuffleMode:Le,inputRef:qe,leftSideBarInputRef:Ke,isThereKaraoke:Ue,rightSideCurrentPage:Je,currentParagraph:Re,currentParagraphRef:Qe,nextSong:function(e){return ut.apply(this,arguments)},prevSong:function(e){return dt.apply(this,arguments)},playSong:function(e){e&&e.stopPropagation(),he?Ve.current.pause():Ve.current.play(),fe(!he)},playing:function(e){xe(e.target.currentTime),Ue&&2===Je&&He&&et&&function(){if(Re!==re.lyrics.length-1&&parseFloat(re.lyrics[Re+1].startTime)<=Ve.current.currentTime)Me(Re+1)}(),se(e.target.currentTime/ye*100)},defineCurrentParagraph:lt,setRightSideCurrentPage:_e,changeCurrentTime:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if("div"===e.target.localName||"p"===e.target.localName){if(void 0!==t)return xe(t),Ve.current.currentTime=t,se(t/ye*100),Ue&&2===Je&&He&&Me(parseInt(e.target.id)),Ve.current.play(),void fe(!0)}else xe(e.target.value),Ve.current.currentTime=e.target.value,se(e.target.value/ye*100),Ue&&2===Je&&He&&lt()},displayAuthors:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re.authors,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" & ";return e.map((function(n,s){return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(i.b,{to:"/authors/".concat(n.uid),onClick:function(e){e.stopPropagation(),Ye(!1)},children:n.displayName},n.uid),s===e.length-1?"":t]})}))},displayAuthorsFull:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re.authors;return e.map((function(e,t){return Object(h.jsx)(h.Fragment,{children:Object(h.jsx)(i.b,{to:"/authors/".concat(e.uid),onClick:function(e){e.stopPropagation(),Ye(!1),o(!1)},children:Object(h.jsx)(v,{data:e})},e.uid)})}))},openFullScreenPlayer:He,setOpenFullScreenPlayer:Ye,loadSongData:function(e){xe(e.target.currentTime),Se(e.target.duration),qe.current.max=e.target.duration,window.innerWidth>1e3&&(Ke.current.max=e.target.duration),se(0),he?e.target.play():e.target.pause()},findLen:function(){var e="";return re.authors.forEach((function(t){e+=t.displayName})),e.length},fetchYourSongs:rt,setOpenMenu:tt,openMenu:et,currentSongData:re,setCurrentSongData:ie,setIsThereKaraoke:We,checkKaraoke:nt,setYourPlaylists:y,yourAuthors:N,setYourAuthors:P,updateListenCount:ot,inputRange:ne},children:a?Object(h.jsx)(f,{}):t})},H=n(7),Y=n(28);function V(e){return e%10===e?"0"+e:e}function Q(e){var t=new Date(1970,0,1);return t.setSeconds(e),t}function q(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=["January","February","March","April","May","June","July","August","September","October","November","December"],s=isNaN(e)?new Date(e):e.seconds?Q(e.seconds+10800):Q(e/1e3+10800);return 0===t?n[s.getMonth()]+" "+s.getDate()+", "+s.getFullYear():1===t?n[s.getMonth()]+" "+s.getDate():2===t?V(s.getHours())+":"+V(s.getMinutes()):3===t?n[s.getMonth()]+" "+s.getDate()+", "+s.getFullYear()+" at "+V(s.getHours())+":"+V(s.getMinutes()):void 0}var K=c.a.createContext(),X=function(){return Object(s.useContext)(K)},G=function(e){var t=e.children,n=Object(s.useState)(window.innerWidth),c=Object(l.a)(n,2),a=c[0],r=c[1],i=Object(s.useState)(window.innerHeight),o=Object(l.a)(i,2),u=o[0],d=o[1],j=Object(s.useState)(window.innerWidth<1e3),b=Object(l.a)(j,2),f=b[0],O=b[1];function p(){r(window.innerWidth),d(window.innerHeight),O(window.innerWidth<1e3)}Object(s.useEffect)((function(){return window.addEventListener("resize",p),function(){window.removeEventListener("resize",p)}}),[]);var m={screenWidth:a,screenHeight:u,isMobile:f};return Object(h.jsx)(K.Provider,{value:m,children:t})},J=function(e){var t=e.text,n=e.direction,s=void 0===n?"top":n,c=Object(p.a)(e,["text","direction"]);return X().isMobile?null:Object(h.jsx)("div",Object(O.a)(Object(O.a)({className:"Hint "+s},c),{},{children:Object(h.jsx)("h5",{children:t})}))},_=function(e){var t=e.color,n=void 0===t?"":t,s=Object(o.g)();return Object(h.jsx)("div",{className:"BackBtn",children:Object(h.jsxs)("button",{onClick:function(){return s.goBack()},style:n.length?{color:n}:{},children:[Object(h.jsx)(J,{text:"go back",direction:"bottom"}),Object(h.jsx)(H.a,{})]})})},Z=function(e){var t=e.imagesList,n=e.borderColor,s=void 0===n?"#fff":n;return Object(h.jsx)("div",{className:"SmallImages",style:{marginRight:-7*(t.length-1)},children:t.map((function(e,t){return Object(h.jsx)("div",{className:"smallImgContainer",style:{border:"3px solid ".concat(s),transform:"translateX(".concat(-15*t,"px)")},children:Object(h.jsx)("img",{loading:"lazy",src:e,alt:""})},t)}))})};function $(e){return e<1e3?e:e<1e6?parseFloat(e/1e3).toFixed(1)+"K":e<1e9?parseFloat(e/1e6).toFixed(1)+"M":void 0}var ee=n(26),te=function(e,t){Object(s.useEffect)((function(){function n(n){e.current&&!e.current.contains(n.target)&&t(!1)}return document.addEventListener("mousedown",n),function(){document.removeEventListener("mousedown",n)}}),[e])};function ne(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}var se=function(){var e=Object(j.a)(d.a.mark((function e(t){var n,s,c,a,r,i=arguments;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=i.length>1&&void 0!==i[1]?i[1]:ne(),s=i.length>2&&void 0!==i[2]?i[2]:"",c=i.length>3&&void 0!==i[3]?i[3]:"",a=i.length>4&&void 0!==i[4]?i[4]:[],r=i.length>5&&void 0!==i[5]?i[5]:[],C.collection("chats").doc(n).set({chatImage:c,chatName:s,id:n,messages:[],participants:t,wallpaper:"undefined",admins:t.length>2?a:[],typing:[],imageColors:r}),t.map(function(){var e=Object(j.a)(d.a.mark((function e(t){var s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("users").doc(t).get();case 2:(s=e.sent.data().chats).push(n),C.collection("users").doc(t).update({chats:s});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ce=function(){var e=Object(j.a)(d.a.mark((function e(t,n,s,c){var a,r,i;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=!1,r=0,!n.chats){e.next=9;break}return e.next=5,C.collection("chats").where("participants","array-contains",n.uid).get();case 5:return e.sent.docs.forEach((function(e){var n=0;return t.every((function(t){return!!e.data().participants.includes(t)&&(n++,!0)})),n+1!==e.data().participants.length||n!==t.length||(a=!0,s(!1),c(e.data().id),r=e.data().id,!1)})),a||(i=ne(),a=!0,s(!0),c(i),r=i),e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})));return function(t,n,s,c){return e.apply(this,arguments)}}(),ae=function(e){var t=e.data,n=e.color,c=R().currentUser,a=Object(s.useState)(!1),r=Object(l.a)(a,2),o=r[0],u=r[1],d=Object(s.useState)(0),j=Object(l.a)(d,2),b=j[0],f=j[1];return Object(s.useEffect)((function(){ce([t.uid],c,u,f)}),[t.uid]),Object(h.jsx)(i.b,{to:"/chat/".concat(b),style:{display:"block",width:"fit-content",textDecoration:"none"},children:Object(h.jsxs)("button",{onClick:function(){o&&se([c.uid,t.uid],b)},style:{background:n},className:"ChatWithFriendButton",children:[Object(h.jsx)(H.q,{})," Messages"]})})},re=function(e){var t=e.top,n=void 0===t?"20%":t;return Object(h.jsx)("div",{className:"LoadingCircle",style:{top:n},children:Object(h.jsx)("img",{loading:"lazy",src:"https://icon-library.com/images/spinner-icon-gif/spinner-icon-gif-28.jpg",alt:""})})},ie=n(12),oe=function(e,t,n,s){var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[],i=arguments.length>7?arguments[7]:void 0;if(0!==s.length||0!==c.length||0!==a.length||0!==r.length||i){var o=(null===t||void 0===t?void 0:t.messages)||[];o.push({id:o.length,sender:n,message:s,sentTime:(new Date).toString(),inResponseToMessage:i||null,attachedSongs:c,attachedAlbums:a,attachedAuthors:r,seenBy:[n]}),C.collection("chats").doc(e).update({messages:o})}};function le(e,t,n,s){var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";e.map(function(){var e=Object(j.a)(d.a.mark((function e(a){var r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=[{uid:a,status:"added"}].concat(Object(m.a)(t.friends.filter((function(e){return e.uid!==a})))),C.collection("users").doc(t.uid).update({friends:r}),Promise.resolve(ce([a],t,(function(){return null}),(function(){return null}))).then(function(){var e=Object(j.a)(d.a.mark((function e(r){var i,o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("chats").doc(r).get();case 2:if(i=e.sent.data(),console.log(r,i),void 0===i){e.next=18;break}e.t0=s,e.next="song"===e.t0?8:"playlist"===e.t0?10:"author"===e.t0?12:14;break;case 8:return oe(r,i,t.uid,c,[n]),e.abrupt("break",16);case 10:return oe(r,i,t.uid,c,[],[n]),e.abrupt("break",16);case 12:return oe(r,i,t.uid,c,[],[],[n]),e.abrupt("break",16);case 14:return oe(r,i,t.uid,c,[n]),e.abrupt("break",16);case 16:e.next=20;break;case 18:o=ne(),se([t.uid,a],o).then(Object(j.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("chats").doc(o).get();case 2:i=e.sent.data(),e.t0=s,e.next="song"===e.t0?6:"playlist"===e.t0?8:"author"===e.t0?10:12;break;case 6:return oe(o,i,t.uid,c,[n]),e.abrupt("break",14);case 8:return oe(o,i,t.uid,c,[],[n]),e.abrupt("break",14);case 10:return oe(o,i,t.uid,c,[],[],[n]),e.abrupt("break",14);case 12:return oe(o,i,t.uid,c,[n]),e.abrupt("break",14);case 14:case"end":return e.stop()}}),e)}))));case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}var ue=function(e){var t,n=e.value,c=e.setValue,a=e.setAllFoundSongs,r=e.setResultPlaylists,i=e.setResultAuthorList,o=e.focus,u=void 0!==o&&o,b=e.defaultSearchMode,f=void 0===b?void 0:b,O=e.inputText,p=void 0===O?"Search for songs or for people":O,x=e.defaultSongsListValue,g=e.defaultAuthorsListValue,v=e.defaultPlaylistsListValue,y=Object(s.useState)(!1),S=Object(l.a)(y,2),w=S[0],N=S[1],k=Object(s.useState)(""),I=Object(l.a)(k,2),A=I[0],P=I[1],T=Object(s.useState)(!1),E=Object(l.a)(T,2),R=E[0],M=E[1],D=Object(s.useState)(0),B=Object(l.a)(D,2),U=B[0],W=B[1],F=Object(s.useRef)(null);function z(e){return Y.apply(this,arguments)}function Y(){return(Y=Object(j.a)(d.a.mark((function e(t){var s,c,o,l,u=arguments;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=u.length>1&&void 0!==u[1]?u[1]:[],c=u.length>2?u[2]:void 0,o=[],l=L(n),e.next=6,C.collection("search").where("variantsOfName","array-contains",l).get();case 6:e.sent.docs.forEach(function(){var e=Object(j.a)(d.a.mark((function e(n){var l,u;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((l=n.data()).place!==t){e.next=21;break}return e.next=4,C.collection(l.place).doc(l.uid).get();case 4:if(u=e.sent.data(),void 0!==s&&s.length?s.map((function(e){return e.id||e.uid})).includes(l.uid)&&o.push(u):u.isPrivate||o.push(u),void 0!==f||0!==U||0===o.length){e.next=18;break}e.t0=l.place,e.next="songs"===e.t0?10:"users"===e.t0?12:"playlists"===e.t0?14:16;break;case 10:return o.forEach(function(){var e=Object(j.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("songs").doc(t.id).get();case 2:e.sent.data().authors.forEach(function(){var e=Object(j.a)(d.a.mark((function e(t,n){var s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n<3)){e.next=5;break}return e.next=3,C.collection("users").doc(t.uid).get();case 3:s=e.sent.data(),i((function(e){return e.find((function(e){return e.uid===t.uid}))?e:[].concat(Object(m.a)(e),[s])}));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.abrupt("break",18);case 12:return o.forEach(function(){var e=Object(j.a)(d.a.mark((function e(t){var n,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("users").doc(t.uid).get();case 2:return n=e.sent.data().ownSongs,e.next=5,C.collection("users").doc(t.uid).get();case 5:s=e.sent.data().ownPlaylists,n.forEach(function(){var e=Object(j.a)(d.a.mark((function e(t,n){var s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n<3)){e.next=5;break}return e.next=3,C.collection("songs").doc(t).get();case 3:s=e.sent.data(),a((function(e){return e.find((function(e){return e.id===t}))?e:[].concat(Object(m.a)(e),[s])}));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),s.forEach(function(){var e=Object(j.a)(d.a.mark((function e(t,n){var s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n<3)){e.next=5;break}return e.next=3,C.collection("playlists").doc(t).get();case 3:s=e.sent.data(),r((function(e){return e.find((function(e){return e.id===t}))?e:[].concat(Object(m.a)(e),[s])}));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.abrupt("break",18);case 14:return o.forEach(function(){var e=Object(j.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("playlists").doc(t.id).get();case 2:e.sent.data().authors.forEach(function(){var e=Object(j.a)(d.a.mark((function e(t,n){var s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n<3)){e.next=5;break}return e.next=3,C.collection("users").doc(t.uid).get();case 3:s=e.sent.data(),i((function(e){return e.find((function(e){return e.uid===t.uid}))?e:[].concat(Object(m.a)(e),[s])}));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.abrupt("break",18);case 16:return P("Wrong search mode"),e.abrupt("break",18);case 18:c(o),N(!1),0!==o.length&&M(!0);case 21:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),N(!1),0===o.length&&c([]);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function V(){if(N(!0),M(!1),""!==n)if(void 0===f)0!==U&&1!==U||(z("songs",x,a),i([]),r([])),0!==U&&2!==U||(z("users",g,i),a([]),r([])),0!==U&&3!==U||(z("playlists",v,r),i([]),a([]));else switch(f){case"songs":z("songs",x,a);break;case"playlists":z("playlists",v,r);break;case"authors":z("users",g,i);break;default:z("songs",x,a)}else void 0!==x&&a(x),void 0!==g&&i(g),void 0!==v&&r(v),N(!1);P("Not found")}return Object(s.useEffect)((function(){u&&F.current.focus()}),[]),Object(s.useEffect)((function(){V()}),[U]),Object(h.jsxs)("div",{style:{marginTop:"10px",width:"100%"},children:[Object(h.jsxs)("div",{className:"searchBar",children:[Object(h.jsxs)("div",{className:"searchBarElement",children:[Object(h.jsx)(H.y,{}),Object(h.jsx)("span",{onClick:function(){return n.length?c(""):null},children:n.length?Object(h.jsx)(H.I,{}):null})]}),Object(h.jsx)("input",{type:"text",placeholder:p,value:n,onChange:function(e){return c(e.target.value)},onKeyUp:function(){return e=V,clearTimeout(t),void(t=setTimeout(e,1e3));var e},onKeyDown:function(){clearTimeout(t)},ref:F}),Object(h.jsxs)("div",{className:"searchFilters",style:void 0!==f?{display:"none"}:{},children:[Object(h.jsx)("button",{onClick:function(){return W(0)},style:0===U?{background:"var(--lightBlue)"}:{},children:"All"}),Object(h.jsx)("button",{onClick:function(){return W(1)},style:1===U?{background:"var(--lightBlue)"}:{},children:"Songs"}),Object(h.jsx)("button",{onClick:function(){return W(2)},style:2===U?{background:"var(--lightBlue)"}:{},children:"Authors"}),Object(h.jsx)("button",{onClick:function(){return W(3)},style:3===U?{background:"var(--lightBlue)"}:{},children:"Playlists"})]})]}),Object(h.jsx)("div",{className:"authorsResult",children:w?Object(h.jsx)("div",{style:{position:"relative",width:"100%",height:"50px",marginTop:"40px"},children:Object(h.jsx)(re,{})}):R||0===n.length?null:Object(h.jsx)("h2",{children:A})})]})},de=function(e){var t=e.item,n=e.whatToShare,c=void 0===n?"song":n,a=F().yourFriends,r=Object(s.useState)([]),i=Object(l.a)(r,2),o=i[0],u=i[1],d=R().currentUser,j=Object(s.useState)(""),b=Object(l.a)(j,2),f=b[0],O=b[1],p=Object(s.useState)(!1),m=Object(l.a)(p,2),g=m[0],y=m[1],S=B().toggleModal,w=Object(s.useState)(""),N=Object(l.a)(w,2),C=N[0],k=N[1],I=Object(s.useState)([]),A=Object(l.a)(I,2),P=A[0],L=A[1];return Object(s.useEffect)((function(){g&&setTimeout((function(){S(),y(!1)}),1e3)}),[g]),Object(h.jsxs)("div",{className:"FriendsListToShareWith",children:[g?Object(h.jsxs)("div",{className:"successMessageSent",children:[Object(h.jsx)(x.c,{}),"Song has sent!"]}):null,Object(h.jsxs)("div",{style:{overflowY:"auto",maxHeight:"300px"},children:[Object(h.jsx)(ue,{value:C,setValue:k,setResultAuthorList:L,defaultAuthorsListValue:a,defaultSearchMode:"authors",inputText:"Search for friends"}),Object(h.jsx)("div",{children:P.length>0?P.map((function(e,t){return Object(h.jsx)(v,{data:e,chosenArray:o,setChosenArray:u},t)})):a.map((function(e,t){return Object(h.jsx)(v,{data:e,chosenArray:o,setChosenArray:u},t)}))})]}),Object(h.jsxs)("div",{children:[Object(h.jsx)("form",{children:Object(h.jsx)("input",{type:"text",placeholder:"Your message",style:{margin:0},onChange:function(e){return O(e.target.value)}})}),Object(h.jsxs)("button",{className:"shareBtn",style:o.length?{maxWidth:"none",background:"var(--purpleAndBlueGrad)"}:{opacity:.5,maxWidth:"none",background:"var(--purpleAndBlueGrad)"},onClick:function(){o.length>0&&(le(o,d,"author"===c?t.uid:t.id,c,f),y(!0))},children:["Share with ",o.length," ",o.length>1?"friends":"friend"]})]})]})},je=n(19),be=function(e){var t=e.currentActive,n=e.id,s=e.label,c=e.onClick;return Object(h.jsxs)("div",{className:"RadioBtn",id:n,onClick:c,children:[Object(h.jsx)("span",{className:"radioLabel",style:t===n?{color:"var(--blue)",opacity:1,fontWeight:"bold"}:{},children:s}),Object(h.jsx)("span",{className:"radioCircle",style:t===n?{background:"var(--blue)"}:{}})]})},he=function(e){var t=e.play;return Object(h.jsxs)("div",{className:"ColorCircles",style:t?{}:{opacity:0,transform:"scale(.95)"},children:[Object(h.jsx)("span",{className:"colorCircle"}),Object(h.jsx)("span",{className:"colorCircle"}),Object(h.jsx)("span",{className:"colorCircle"})]})},fe=n(22),Oe=function(e){var t=e.song,n=e.listOfSongs,c=e.setListOfSongs,a=e.showListens,r=void 0!==a&&a,i=e.listens,o=void 0===i?0:i,u=e.isNewSong,d=void 0!==u&&u,j=F(),b=(j.setCurrentSong,j.currentSong),f=j.displayAuthors,O=j.play,p=(j.songRef,j.setPlay,j.setYourSongs,j.yourPlaylists,j.currentSongQueue,j.setCurrentSongInQueue,j.fetchYourSongs),x=Object(s.useState)(!1),g=Object(l.a)(x,2),v=g[0],y=g[1],S=Object(s.useState)(0),w=Object(l.a)(S,2),N=(w[0],w[1]),k=Object(s.useRef)(null),I=R().currentUser;return te(k,y),Object(h.jsxs)("div",{className:"SongItem "+(n.includes(t.id)?"inList":""),onClick:function(){if(!n.includes(t.id))return c((function(e){return[].concat(Object(m.a)(e),[t.id])}));var e=n.filter((function(e){return e!==t.id}));c(e)},ref:v?k:null,style:v?{background:"var(--playlistsColor)"}:{},children:[Object(h.jsxs)("div",{className:"songItemImageAndName",children:[Object(h.jsxs)("div",{className:"songItemImage",children:[Object(h.jsx)("div",{className:"songItemPlayOrPause",children:t.id===b&&O?null:Object(h.jsx)(fe.c,{})}),Object(h.jsxs)("div",{className:"playingAnimation",style:t.id===b&&O?{opacity:1,visibility:"visible"}:{},children:[Object(h.jsx)(fe.b,{}),Object(h.jsx)(he,{play:O})]}),Object(h.jsx)("img",{loading:"lazy",src:t.cover,alt:""})]}),Object(h.jsxs)("div",{className:"songItemNameAndAuthor",children:[Object(h.jsxs)("div",{className:"songItemName",style:{display:"flex",alignItems:"center"},children:[t.name,Object(h.jsx)("span",{style:{marginLeft:"10px",fontWeight:"500"},children:r?Object(h.jsxs)("span",{style:{display:"flex",alignItems:"center",opacity:.7,fontSize:".8em"},className:d?"newSongMarker":"",children:[$(o)," ",Object(h.jsx)(ee.c,{})]}):d?Object(h.jsx)("span",{style:{display:"flex",alignItems:"center",fontSize:".7em"},className:"newSongMarker",children:"New"}):null})]}),Object(h.jsx)("div",{className:"songItemAuthor",children:f(t.authors)})]})]}),Object(h.jsxs)("div",{className:"songItemMoreBtn",onClick:function(e){e.stopPropagation(),y(!v),N(e.target.getBoundingClientRect().top)},children:[Object(h.jsx)("button",{onClick:function(e){if(e.stopPropagation(),I.addedSongs.includes(t.id)){var n=I.addedSongs.filter((function(e){return e!==t.id}));return C.collection("users").doc(I.uid).update({addedSongs:n}),p(),void y(!1)}var s=I.addedSongs;s.push(t.id),C.collection("users").doc(I.uid).update({addedSongs:s}),p()},children:I.addedSongs.includes(t.id)?Object(h.jsx)(H.c,{}):Object(h.jsx)(H.x,{})}),Object(h.jsx)("button",{children:Object(h.jsx)(H.t,{})})]})]})},pe=n(31);function me(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;return e.substr(0,t)+(e.length>t?"...":"")}var xe=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" & ",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,s=e.map((function(e){return e.displayName})).join(t);return me(s,n)},ge=function(e,t,n,s){e.stopPropagation();var c=t.authors.map((function(e){return e.uid})),a=[];c.forEach((function(e){n.addedAuthors.includes(e)||a.push(e)}));var r=n.addedSongs;r.push(t.id),C.collection("users").doc(n.uid).update({addedSongs:r,addedAuthors:[].concat(a,Object(m.a)(n.addedAuthors))}),a.forEach(function(){var e=Object(j.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("users").doc(t).get();case 2:n=e.sent.data().subscribers,n++,C.collection("users").doc(t).update({subscribers:n});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())};function ve(e,t){return e.filter((function(e){return this.indexOf(e)<0}),t)}var ye=function(e,t,n,s){e.stopPropagation();var c=t.authors.map((function(e){return e.uid})),a=[],r=n.addedSongs.filter((function(e){return e!==t.id}));c.forEach((function(e){s.forEach((function(t){r.includes(t.id)&&t.authors.find((function(t){return t.uid===e}))&&a.push(e)}))}));var i=ve(c,a),o=ve(n.addedAuthors,i);C.collection("users").doc(n.uid).update({addedSongs:r,addedAuthors:o}),i.forEach(function(){var e=Object(j.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("users").doc(t).get();case 2:n=e.sent.data().subscribers,n--,C.collection("users").doc(t).update({subscribers:n});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())};function Se(e){var t=e.song,n=R().currentUser,s=F().yourSongs,c=B(),a=c.openConfirm,r=c.setOpenModal;return n.addedSongs.includes(t.id)?Object(h.jsxs)("span",{onClick:function(e){e.stopPropagation(),r(!1),a("You sure you want to delete this song from library?","Yes, delete it","No, just kidding",(function(e){return ye(e,t,n,s)}))},children:[Object(h.jsx)(H.C,{}),"Delete"]}):Object(h.jsxs)("span",{onClick:function(e){return ge(e,t,n)},children:[Object(h.jsx)(H.x,{}),"Add"]})}var we=function(e){var t=e.person,n=B().setOpenModal;return Object(h.jsx)(i.b,{to:"/authors/".concat(t.uid),children:Object(h.jsxs)("div",{className:"PersonTinyVerticalItem",onClick:function(){return n(!1)},children:[Object(h.jsx)("div",{className:"personTinyImage",children:Object(h.jsx)("img",{loading:"lazy",src:t.photoURL,alt:""})}),Object(h.jsx)("div",{className:"personTinyName",children:t.displayName})]})})},Ne=function(e){var t=e.song,n=F().currentSongData,c=B().setContent,a=(R().currentUser,Object(s.useState)(t||n)),r=Object(l.a)(a,2),i=r[0],o=r[1],u=F(),b=u.displayAuthors,f=u.yourFriends,O=Object(s.useState)([]),p=Object(l.a)(O,2),x=p[0],g=p[1],v=Object(s.useState)(!0),y=Object(l.a)(v,2),S=y[0],w=y[1];function N(){return(N=Object(j.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:w(!0),g([]),f.forEach((function(e){e.addedSongs.includes(i.id)&&g((function(t){return[].concat(Object(m.a)(t),[e])}))})),w(!1);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){void 0!==t&&o(t)}),[t&&t.id]),Object(s.useEffect)((function(){!function(){N.apply(this,arguments)}()}),[i.id]),Object(h.jsxs)("div",{className:"SongInfo",children:[Object(h.jsx)("div",{className:"songImage",style:{backgroundImage:"url(".concat(i.cover,")")}}),Object(h.jsxs)("div",{className:"songInfoContent",children:[Object(h.jsx)("h3",{style:{color:i.imageColors[0]},children:i.name}),Object(h.jsx)("span",{children:b(i.authors,", ")}),Object(h.jsxs)("div",{style:{display:"flex",alignItems:"center",opacity:"0.6",fontSize:".9em",position:"relative"},className:"listensAndDate",children:[Object(h.jsxs)("p",{className:"infoListens",style:{marginRight:"15px",position:"relative"},children:[i.listens," ",Object(h.jsx)(ee.c,{})]}),Object(h.jsx)("span",{children:q(i.releaseDate)})]}),Object(h.jsx)("h4",{style:{margin:"10px 0"},children:x.length>0?"Friends that listen that song":"None of your friends listens this"}),S?Object(h.jsx)("div",{style:{position:"relative",height:"50px"},children:Object(h.jsx)(re,{top:"50%"})}):Object(h.jsx)("div",{style:{display:"flex",alignItems:"center"},children:x.length>0?x.map((function(e,t){return Object(h.jsx)(we,{person:e},e.uid)})):Object(h.jsx)("button",{className:"shareBtn",style:{minHeight:"35px",background:i.imageColors[0]},onClick:function(){c(Object(h.jsx)(de,{item:i,whatToShare:"song"}))},children:"Share"})})]})]})},Ce=function(e,t){var n=Object(s.useState)([]),c=Object(l.a)(n,2),a=c[0],r=c[1],i=Object(s.useState)(!1),o=Object(l.a)(i,2),u=o[0],d=o[1],j=R().currentUser,b=F().currentSong,h=t||b;return Object(s.useEffect)((function(){var t=C.collection("playlists").doc(e).onSnapshot((function(e){e.exists&&r(e.data().songs)}));return function(){return t()}}),[C]),Object(s.useEffect)((function(){d(a.includes(h))}),[a,h]),[function(){if(a.length>0&&void 0!==e){if(a.includes(h)){var t=a.filter((function(e){return e!==h}));return void C.collection("playlists").doc(e).update({songs:t})}var n=a;n.unshift(h),console.log(e),C.collection("playlists").doc(e).update({songs:n});var s=[e].concat(Object(m.a)(j.ownPlaylists.filter((function(t){return t!==e}))));C.collection("users").doc(j.uid).update({ownPlaylists:s})}},u]},ke=function(e){var t=e.playlist,n=e.song,s=Ce(t.id,n.id),c=Object(l.a)(s,2),a=c[0],r=c[1];return Object(h.jsxs)("div",{className:"songItemMenuWindowItem",onClick:a,children:[r?Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(J,{text:"Remove ".concat(n.name," from playlist")}),Object(h.jsx)(H.c,{})]}):Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(J,{text:'Add "'.concat(n.name,'" to playlist')}),Object(h.jsx)(H.x,{})]}),t.name]})},Ie=function(e){var t=e.song,n=F(),c=n.yourPlaylists,a=n.currentSongData,r=R().currentUser,i=Object(s.useState)(t||a),o=Object(l.a)(i,2),u=o[0],d=o[1];return Object(s.useEffect)((function(){(null===t||void 0===t?void 0:t.id)&&d(t)}),[null===t||void 0===t?void 0:t.id]),Object(h.jsx)("div",{className:"AddToPlaylists",children:Object(h.jsx)("div",{style:{display:"flex",flexDirection:"column"},children:c.length?c.map((function(e,t){if(r.ownPlaylists.includes(e.id))return Object(h.jsx)(ke,{playlist:e,song:u})})):"No playlists created"})})},Ae=n(25),Pe=function(e){var t=e.errorMessage;return t&&Object(h.jsx)("div",{className:"Alert",children:t})};function Le(e){for(var t=[],n=0,s=0;s<e.length;s++)"\n"!==e[s]&&void 0!==e[s+1]||(t.push({startTime:"undefined",text:e.substr(n,s-n)}),n=s+1);return t}var Te=function(e){var t=e.song,n=R().currentUser,c=Object(s.useState)(t.name),a=Object(l.a)(c,2),r=a[0],i=a[1],o=Object(s.useState)(t.authors),u=Object(l.a)(o,2),b=u[0],f=u[1],O=Object(s.useState)(t.cover),p=Object(l.a)(O,2),x=p[0],g=p[1],y=Object(s.useState)(t.imageColors),S=Object(l.a)(y,2),w=S[0],N=S[1],k=Object(s.useState)(t.lyrics.map((function(e){return e.text})).join("\n")),I=Object(l.a)(k,2),A=I[0],P=I[1],L=Object(s.useState)([]),T=Object(l.a)(L,2),E=T[0],M=T[1],D=Object(s.useState)(""),B=Object(l.a)(D,2),U=B[0],W=B[1],F=Object(s.useState)(""),z=Object(l.a)(F,2),Y=z[0],V=z[1];function Q(e){var t=b.filter((function(t){return t.uid!==e.uid}));return f(t)}return Object(s.useEffect)((function(){i(t.name),f(t.authors),g(t.cover),N(t.imageColors),P(t.lyrics.map((function(e){return e.text})).join("\n"))}),[t.id]),Object(h.jsxs)("div",{children:[Object(h.jsxs)("div",{className:"SongInfo",style:{flexDirection:"column",marginBottom:"10px"},children:[Object(h.jsx)("h3",{children:"Song cover"}),Object(h.jsxs)("div",{style:{display:"flex"},children:[Object(h.jsx)("div",{children:Object(h.jsx)("img",{loading:"lazy",src:x,alt:"",className:"songImage"})}),Object(h.jsx)("div",{style:{background:"linear-gradient(-135deg, ".concat(w[0],", ").concat(w[5]),width:"100%",borderRadius:"var(--standartBorderRadius2)",display:"flex",justifyContent:"center",alignItems:"center"},children:Object(h.jsx)("h4",{style:{color:w[1]},children:r})})]})]}),Object(h.jsx)("div",{style:{width:"100%",display:"flex"},children:w.map((function(e,t){return Object(h.jsx)("input",{type:"color",value:e,style:{width:"100%",height:"60px",padding:"0",borderRadius:"0px"},onChange:function(e){!function(e,t){w[t]=e.target.value,N(Object(m.a)(w))}(e,t)}})}))}),Object(h.jsxs)("div",{children:[Object(h.jsx)("h3",{children:"Song name"}),Object(h.jsx)("input",{type:"text",className:"standartInput",value:r,onChange:function(e){return i(e.target.value)}})]}),Object(h.jsxs)("div",{children:[Object(h.jsx)("h3",{children:"Authors"}),Object(h.jsx)(ue,{value:U,setValue:W,setResultAuthorList:M,defaultSearchMode:"authors"}),Object(h.jsx)("div",{className:"songAuthorsList",children:b.map((function(e){return Object(h.jsxs)("div",{className:"chosenAuthorItem",children:[Object(h.jsx)("span",{children:e.displayName}),Object(h.jsx)(H.I,{onClick:function(){(n.isAdmin||e.uid!==n.uid)&&Q(e)}})]})}))}),Object(h.jsx)("div",{className:"authorsResult",children:E.map((function(e,t){return Object(h.jsx)(v,{data:e,onClick:function(){return function(e){if(!b.some((function(t){return t.uid===e.uid})))return f((function(t){return[].concat(Object(m.a)(t),[{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL}])}));Q(e)}(e)},style:b.includes(e.uid)?{background:"var(--green)"}:{}},t)}))})]}),Object(h.jsxs)("div",{children:[Object(h.jsx)("h3",{children:"Lyrics"}),Object(h.jsx)("textarea",{type:"text",className:"standartInput",style:{height:"200px",fontWeight:"500"},value:A,onChange:function(e){return P(e.target.value)}})]}),Object(h.jsx)(Pe,{errorMessage:Y}),Object(h.jsx)("button",{className:"addSongBtn",onClick:function(){if(0===r.length)V("Name shouldn't be empty");else if(0===b.length)V("Song has to have at least 1 author");else if(0===x.length)V("Song has to have cover");else{if(b.length>t.authors.length)b.filter((function(e){return!t.authors.find((function(t){return t.uid===e.uid}))})).forEach(function(){var e=Object(j.a)(d.a.mark((function e(n){var s,c,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("users").doc(n.uid).get();case 2:s=e.sent,c=s.data(),(a=c.ownSongs).push(t.id),console.log(a),C.collection("users").doc(n.uid).update({ownSongs:a});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());else if(b.length<t.authors.length){t.authors.filter((function(e){return!b.find((function(t){return t.uid===e.uid}))})).forEach(function(){var e=Object(j.a)(d.a.mark((function e(n){var s,c,a,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("users").doc(n.uid).get();case 2:s=e.sent,c=s.data(),a=c.ownSongs,r=a.filter((function(e){return e!==t.id})),console.log(r),C.collection("users").doc(n.uid).update({ownSongs:r});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}C.collection("songs").doc(t.id).update({name:r,authors:b,image:x,imageColors:w,lyrics:Le(A)})}},children:"Update Song"})]})},Ee=function(e){var t=e.openMoreWindow,n=e.song,s=e.moreWindowPosRelativeToViewport,c=B(),a=c.toggleModal,r=c.setContent,i=R().currentUser;return t?Object(h.jsxs)("div",{className:"songItemMenuWindow",style:s>window.innerHeight/2+100?{top:"auto",bottom:"110%"}:{top:"110%",bottom:"auto"},onClick:function(e){return e.stopPropagation()},children:[i.isAdmin?Object(h.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){a(),r(Object(h.jsx)(Te,{song:n}))},children:[Object(h.jsx)(ie.h,{}),"Edit"]}):null,Object(h.jsx)("div",{className:"songItemMenuWindowItem",children:Object(h.jsx)(Se,{song:n})}),Object(h.jsxs)("div",{className:"songItemMenuWindowItem",children:[Object(h.jsx)("div",{className:"songItemMenuWindow inner",children:Object(h.jsx)(Ie,{song:n})}),Object(h.jsx)(Ae.c,{}),"Add to playlist ",Object(h.jsx)(Ae.a,{})]}),Object(h.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){a(),r(Object(h.jsx)(de,{item:n,whatToShare:"song"}))},children:[Object(h.jsx)(H.A,{}),"Share"]}),Object(h.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){a(),r(Object(h.jsx)(Ne,{song:n}))},children:[Object(h.jsx)(H.o,{}),"Info"]}),Object(h.jsxs)("div",{className:"songItemMenuWindowItem",children:[Object(h.jsx)(H.j,{}),"Flag"]})]}):null},Re=function(e){var t=e.listOfAuthors,n=F().displayAuthorsFull;return Object(h.jsx)("div",{className:"rightSideAuthorsList",children:Object(h.jsx)("div",{className:"rightSideAuthorsListCentralBlock",children:n(t)})})},Me=function(e){var t=e.song,n=B().setContent,s=R().currentUser;return Object(h.jsxs)("div",{className:"SongItemMobileMoreWindow",children:[Object(h.jsxs)("div",{className:"simpleSongElement",style:{background:t.imageColors[0]},children:[Object(h.jsx)("div",{className:"simpleSongElementImage",children:Object(h.jsx)("img",{loading:"lazy",src:t.cover,alt:""})}),Object(h.jsx)("span",{children:t.name})]}),s.isAdmin?Object(h.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){n(Object(h.jsx)(Te,{song:t}))},children:[Object(h.jsx)(ie.h,{}),"Edit"]}):null,Object(h.jsx)("div",{className:"songItemMenuWindowItem",children:Object(h.jsx)(Se,{song:t})}),Object(h.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){return n(Object(h.jsx)(Ie,{song:t}))},children:[Object(h.jsx)(Ae.c,{}),"Add to playlist"]}),Object(h.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){n(Object(h.jsx)(de,{item:t,whatToShare:"song"}))},children:[Object(h.jsx)(H.A,{}),"Share"]}),Object(h.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){n(Object(h.jsx)(Ne,{song:t}))},children:[Object(h.jsx)(H.o,{}),"Info"]}),Object(h.jsxs)("div",{className:"songItemMenuWindowItem",children:[Object(h.jsx)(H.j,{}),"Flag"]}),Object(h.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){n(Object(h.jsx)(Re,{listOfAuthors:t.authors,title:"Authors"}))},children:[Object(h.jsx)(H.G,{}),"Authors"]})]})},De=function(e){var t=e.song,n=e.localIndex,c=e.showListens,a=void 0!==c&&c,r=e.isNewSong,i=void 0!==r&&r,o=e.listOfChosenSongs,u=e.setListOfSongs,d=e.position,j=F(),b=j.yourSongs,f=j.setCurrentSong,O=j.currentSong,p=j.displayAuthors,m=j.play,x=j.songRef,v=j.setPlay,y=j.setCurrentSongInQueue,S=X().isMobile,w=Object(s.useState)(!1),N=Object(l.a)(w,2),k=N[0],I=N[1],A=Object(s.useState)(0),P=Object(l.a)(A,2),L=P[0],T=P[1],E=Object(s.useRef)(null),M=R(),D=M.currentUser,U=(M.setCurrentUser,B()),W=U.toggleModal,z=U.setContent,Y=U.openConfirm,V=U.closeConfirm;return te(E,I),Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(g,{listOfChosenItems:o,setListOfChosenItems:u,itemId:t.id}),Object(h.jsxs)("div",{className:"SongItem "+(t.id===O&&m?"playingNow":""),onClick:function(){if(f(t.id),C.collection("users").doc(D.uid).update({lastSongPlayed:t.id}),y(n),t.id===O&&m)return x.current.pause(),void v(!1);x.current.play(),v(!0)},ref:k?E:null,style:k?{background:"var(--playlistsColor)"}:{},children:[Object(h.jsxs)("div",{className:"songItemImageAndName",children:[Object(h.jsxs)("div",{className:"songItemImage",children:[Object(h.jsx)("div",{className:"songItemPlayOrPause",children:t.id===O&&m?null:Object(h.jsx)(fe.c,{})}),Object(h.jsxs)("div",{className:"playingAnimation",style:t.id===O&&m?{opacity:1,visibility:"visible"}:{},children:[Object(h.jsx)(fe.b,{}),Object(h.jsx)(he,{play:m})]}),Object(h.jsx)("img",{loading:"lazy",src:t.cover,alt:""})]}),Object(h.jsxs)("div",{className:"songItemNameAndAuthor",children:[Object(h.jsxs)("div",{className:"songItemName",style:{display:"flex",alignItems:"center"},children:[me(t.name,window.innerWidth>1e3?30:17),Object(h.jsx)("span",{style:{marginLeft:"10px",fontWeight:"500"},children:a?Object(h.jsxs)("span",{style:{display:"flex",alignItems:"center",opacity:.7,fontSize:".8em"},className:i?"newSongMarker":"",children:[$(t.listens)," ",Object(h.jsx)(ee.c,{})]}):i?Object(h.jsx)("span",{style:{display:"flex",alignItems:"center",fontSize:".7em"},className:"newSongMarker",children:"New"}):null})]}),S?Object(h.jsx)("div",{className:"songItemAuthor",children:xe(t.authors," & ",30)}):Object(h.jsx)("div",{className:"songItemAuthor",children:p(t.authors)})]})]}),Object(h.jsxs)("div",{className:"songItemMoreBtn",children:[D.addedSongs.includes(t.id)?Object(h.jsxs)("button",{onClick:function(e){e.stopPropagation(),Y('You sure you want to delete "'.concat(t.name,'" from library?'),"Yes, delete it","No, just kidding",(function(e){ye(e,t,D,b),V()}))},style:{position:"relative"},children:[Object(h.jsx)(J,{text:"delete song"}),Object(h.jsx)(H.H,{})]}):Object(h.jsxs)("button",{onClick:function(e){return ge(e,t,D)},style:{position:"relative"},children:[Object(h.jsx)(J,{text:"add song"}),Object(h.jsx)(H.x,{})]}),Object(h.jsxs)("button",{onClick:S?function(e){e.stopPropagation(),W(),z(Object(h.jsx)(Me,{song:t}))}:function(e){e.stopPropagation(),I(!k),T(d||e.target.getBoundingClientRect().top)},children:[Object(h.jsx)(J,{text:"more"}),Object(h.jsx)(H.t,{})]})]}),Object(h.jsx)(Ee,{openMoreWindow:k,song:t,moreWindowPosRelativeToViewport:L})]})]})},Be=function(e){var t=e.func,n=e.lenOfList,s=e.maxLen,c=void 0===s?5:s,a=e.boolVal;return Object(h.jsx)("div",{onClick:n>c?t:null,className:"MoreBtn",style:n<=c?{display:"none"}:{},children:Object(h.jsx)("button",{style:a?{background:"var(--pink)",color:"#ff8db2"}:{},children:a?"Close":"More"})})},Ue=function(e){var t=e.title,n=e.func,s=e.boolVal,c=e.lenOfList,a=e.maxLen,r=void 0===a?5:a,i=e.marginBottom,o=void 0===i?0:i;return 0!==c?Object(h.jsxs)("div",{className:"topTitle",style:{margin:"10px 0"},children:[Object(h.jsx)("h2",{style:{margin:o},children:t}),Object(h.jsx)(Be,{func:n,boolVal:s,lenOfList:c,maxLen:r})]}):null},We=function(e){var t=e.listOfSongs,n=e.source,c=e.title,a=void 0===c?"":c,r=e.showListens,i=void 0!==r&&r,o=e.isNewSong,u=void 0!==o&&o,d=e.showCount,j=void 0!==d&&d,b=e.listOfChosenSongs,f=e.setListOfSongs,O=e.showSearch,p=void 0!==O&&O,m=e.displayIfEmpty,x=F(),g=x.setCurrentSongQueue,v=x.setCurrentSongPlaylistSource,y=(x.playSong,x.setCurrentSong,R().currentUser),S=Object(s.useState)(!1),w=Object(l.a)(S,2),N=w[0],k=w[1],I=Object(s.useState)(""),A=Object(l.a)(I,2),P=A[0],L=A[1],T=Object(s.useState)(t),E=Object(l.a)(T,2),M=E[0],D=E[1];return Object(s.useEffect)((function(){D(t),t.length>1&&xe(t[1].authors)}),[t]),Object(h.jsxs)("div",{className:"SongList",onClick:function(){if("no"!==n&&0!==t.length){g(t),v(n);var e=t.map((function(e){return e.id}));C.collection("users").doc(y.uid).update({lastQueue:{image:n.image,name:n.name,songsList:e,source:n.source}})}},children:[0!==a.length?Object(h.jsx)(Ue,{title:a,func:function(){return k(!N)},boolVal:N,lenOfList:t.length}):null,p?Object(h.jsx)(ue,{value:P,setValue:L,allFoundSongs:M,setAllFoundSongs:D,defaultSearchMode:"songs",defaultSongsListValue:t,inputText:"Search for songs"}):null,M.map((function(e,t){return 0===a.length||N||t<5?Object(h.jsxs)("span",{className:"topSongItem",children:[j?Object(h.jsx)("h3",{style:{opacity:"0.7"},children:t+1}):null,Object(h.jsx)(De,{song:e,localIndex:t,showListens:i,isNewSong:u,listOfChosenSongs:b,setListOfSongs:f},e.id)]}):void 0})),Object(h.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:0===t.length?m:null})]})},Fe=function(e){var t=e.playlist,n=R().currentUser,c=Object(s.useState)(t.name),a=Object(l.a)(c,2),r=a[0],i=a[1],o=Object(s.useState)(t.image),u=Object(l.a)(o,2),b=u[0],f=u[1],O=Object(s.useState)(""),p=Object(l.a)(O,2),x=p[0],g=p[1],y=Object(s.useState)([]),S=Object(l.a)(y,2),w=S[0],k=S[1],I=Object(s.useState)(t.authors),A=Object(l.a)(I,2),P=A[0],L=A[1],T=Object(s.useState)(t.creationDate),E=Object(l.a)(T,2),M=E[0],D=E[1],B=Object(s.useState)(""),U=Object(l.a)(B,2),W=U[0],F=U[1],z=Object(s.useState)([]),Y=Object(l.a)(z,2),V=Y[0],Q=Y[1],q=Object(s.useState)(t.songs),K=Object(l.a)(q,2),X=K[0],G=K[1],J=Object(s.useState)(t.isAlbum?1:0),_=Object(l.a)(J,2),Z=_[0],$=_[1],ee=Object(s.useState)(t.isPrivate?1:0),te=Object(l.a)(ee,2),se=te[0],ce=te[1],ae=Object(s.useState)(!1),ie=Object(l.a)(ae,2),oe=ie[0],le=(ie[1],Object(s.useState)(!1)),de=Object(l.a)(le,2),he=de[0],fe=de[1],Oe=Object(s.useState)(""),me=Object(l.a)(Oe,2),xe=me[0],ge=me[1],ve=Object(s.useState)(t.imageColors),ye=Object(l.a)(ve,2),Se=ye[0],we=ye[1];function Ne(e){var t=P.filter((function(t){return t.uid!==e.uid}));return L(t)}function Ce(){return(Ce=Object(j.a)(d.a.mark((function e(t,n,s){var c,a,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=t.target.files[0],ge(URL.createObjectURL(c)),a=N.ref(),r=a.child(n+c.name),e.next=6,r.put(c);case 6:return e.t0=s,e.next=9,r.getDownloadURL();case 9:e.t1=e.sent,(0,e.t0)(e.t1);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ke(){return(ke=Object(j.a)(d.a.mark((function e(n){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.preventDefault(),ne(),P.length>t.authors.length?P.filter((function(e){return!t.authors.find((function(t){return t.uid===e.uid}))})).forEach(function(){var e=Object(j.a)(d.a.mark((function e(n){var s,c,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("users").doc(n.uid).get();case 2:s=e.sent,c=s.data(),(a=c.ownPlaylists).push(t.id),console.log(a),C.collection("users").doc(n.uid).update({ownPlaylists:a});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()):P.length<t.authors.length&&t.authors.filter((function(e){return!P.find((function(t){return t.uid===e.uid}))})).forEach(function(){var e=Object(j.a)(d.a.mark((function e(n){var s,c,a,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("users").doc(n.uid).get();case 2:s=e.sent,c=s.data(),a=c.ownPlaylists,r=a.filter((function(e){return e!==t.id})),console.log(r),C.collection("users").doc(n.uid).update({ownPlaylists:r});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),C.collection("playlists").doc(t.id).update({id:t.id,name:r,songs:X,authors:P,image:b,listens:t.listens,creationDate:M,subscribers:t.subscribers,isAlbum:1===Z,imageColors:Se,isPrivate:1===se});case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){i(t.name),f(t.image),L(t.authors)}),[t.id]),Object(s.useEffect)((function(){0===W.length&&t.songs.map(function(){var e=Object(j.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),e.next=3,C.collection("songs").doc(t).get();case 3:n=e.sent.data(),fe(!1),Q((function(e){return[].concat(Object(m.a)(e),[n])}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[W]),Object(h.jsxs)("div",{className:"AddSong",children:[Object(h.jsx)(pe.a,{src:xe,getColors:function(e){return we(e)}}),Object(h.jsxs)("form",{children:[Object(h.jsxs)("label",{children:[Object(h.jsx)("h3",{children:"Playlist name"}),Object(h.jsx)("input",{type:"text",placeholder:"Enter playlist name",value:r,onChange:function(e){return i(e.target.value)},required:!0})]}),Object(h.jsxs)("label",{children:[Object(h.jsx)("h3",{children:"Playlist authors"}),Object(h.jsx)(ue,{value:x,setValue:g,setResultAuthorList:k,defaultSearchMode:"authors",inputText:"Search for authors"}),Object(h.jsx)("div",{className:"chosenAuthorsList",children:P.map((function(e){return Object(h.jsxs)("div",{className:"chosenAuthorItem",children:[Object(h.jsx)("span",{children:e.displayName}),Object(h.jsx)(H.I,{onClick:function(){return e.uid===n.uid?null:Ne(e)}})]})}))}),Object(h.jsx)("div",{className:"authorsResult",children:oe?Object(h.jsx)("div",{style:{position:"relative",width:"100%",height:"50px"},children:Object(h.jsx)(re,{})}):w.map((function(e,t){return Object(h.jsx)(v,{data:e,onClick:function(){return function(e){if(!P.some((function(t){return t.uid===e.uid})))return L((function(t){return[].concat(Object(m.a)(t),[{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL}])}));Ne(e)}(e)},style:P.includes(e.uid)?{background:"var(--green)"}:{}},t)}))})]}),Object(h.jsxs)("label",{children:[Object(h.jsx)("h3",{children:"Search for songs"}),Object(h.jsx)(ue,{value:W,setValue:F,setAllFoundSongs:Q,defaultSearchMode:"songs",inputText:"Search for songs"}),Object(h.jsx)("div",{className:"chosenAuthorsList",children:X.map((function(e){return Object(h.jsxs)("div",{className:"chosenAuthorItem",children:[Object(h.jsx)("span",{children:e}),Object(h.jsx)(H.I,{onClick:function(){return function(e){var t=X.filter((function(t){return t!==e}));return G(t)}(e)}})]})}))}),Object(h.jsx)("div",{className:"authorsResult",children:he?Object(h.jsx)("div",{style:{position:"relative",width:"100%",height:"50px"},children:Object(h.jsx)(re,{})}):Object(h.jsx)(We,{listOfSongs:V,source:"no",listOfChosenSongs:X,setListOfSongs:G})})]}),n.isAdmin||n.isAuthor?Object(h.jsxs)("div",{style:{display:"flex",justifyContent:"flex-start",margin:"15px 0"},children:[Object(h.jsx)(be,{label:"Playlist",onClick:function(){return $(0)},currentActive:Z,id:0}),Object(h.jsx)(be,{label:"Album",onClick:function(){return $(1)},currentActive:Z,id:1})]}):null,Object(h.jsxs)("div",{style:{display:"flex",justifyContent:"flex-start",margin:"15px 0"},children:[Object(h.jsx)(be,{label:"Not Private",onClick:function(){return ce(0)},currentActive:se,id:0}),Object(h.jsx)(be,{label:"Private",onClick:function(){return ce(1)},currentActive:se,id:1})]}),n.isAdmin||n.isAuthor?Object(h.jsxs)("label",{children:[Object(h.jsx)("h3",{children:"Release Date"}),Object(h.jsx)("input",{type:"date",name:"",id:"",value:M,onChange:function(e){return D(e.target.value)}})]}):null,Object(h.jsxs)("label",{className:"downloadFile",children:[Object(h.jsxs)("div",{className:"downloadPhoto",children:[Object(h.jsxs)("span",{className:"downloadBtnText",children:[Object(h.jsx)(je.d,{}),"Download playlist cover"]}),Object(h.jsx)("span",{className:"photoLoadLine",style:""!==b?{width:"100%"}:{}})]}),Object(h.jsx)("input",{type:"file",name:"",id:"",onChange:function(e){return function(e,t,n){return Ce.apply(this,arguments)}(e,"songsImages/",f)}})]}),Object(h.jsx)("button",{type:"button",className:"addSongBtn",onClick:function(e){return ke.apply(this,arguments)},children:"Update playlist"})]})]})},ze=function(){var e=Object(j.a)(d.a.mark((function e(t,n){var s,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("users").doc(n.uid).get();case 2:(s=e.sent.data().addedAuthors).push(t.uid),C.collection("users").doc(n.uid).update({addedAuthors:s}),c=t.subscribers,c++,C.collection("users").doc(t.uid).update({subscribers:c});case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();function He(e,t){var n=e.friends,s=t.friends;n.push({status:"requested",uid:t.uid}),s.push({status:"awaiting",uid:e.uid}),C.collection("users").doc(e.uid).update({friends:n}),C.collection("users").doc(t.uid).update({friends:s})}n(122);var Ye=function(e){var t=e.userUID,n=Object(s.useState)(""),c=Object(l.a)(n,2),a=c[0],r=c[1],i=Object(s.useState)(!1),o=Object(l.a)(i,2),u=o[0],d=o[1];return Object(s.useEffect)((function(){var e=C.collection("users").doc(t).onSnapshot((function(e){if(void 0!==t){var n=(new Date).getTime()-3e5,s=e.data().online>n;d(s),void 0===e.data().online?r("offline"):s||r("last seen "+q(e.data().online,3))}}));return function(){e()}}),[C,t]),u?Object(h.jsx)("span",{children:"Online"}):Object(h.jsx)("span",{children:a})},Ve=function(){var e=Object(j.a)(d.a.mark((function e(t,n){var s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("users").doc(n.uid).get();case 2:(s=e.sent.data().addedPlaylists).push(t.id),C.collection("users").doc(n.uid).update({addedPlaylists:s}),C.collection("playlists").doc(t.id).update({subscribers:++t.subscribers});case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Qe=function(){var e=Object(j.a)(d.a.mark((function e(t,n){var s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=n.addedPlaylists.filter((function(e){return e!==t.id})),C.collection("users").doc(n.uid).update({addedPlaylists:s}),C.collection("playlists").doc(t.id).update({subscribers:--t.subscribers});case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),qe=(n(262),function(){B().setContent;return Object(h.jsx)("div",{className:"GeneralSettings",children:"Settings"})}),Ke=function(){var e=B().setContent,t=[{id:0,title:"General",icon:Object(h.jsx)(H.p,{}),to:Object(h.jsx)(qe,{}),color:"var(--red)"},{id:1,title:"General",icon:Object(h.jsx)(H.p,{}),to:Object(h.jsx)("h2",{children:"Test"}),color:"var(--lightBlue)"},{id:2,title:"General",icon:Object(h.jsx)(H.p,{}),to:Object(h.jsx)("h2",{children:"Test"}),color:"var(--green)"}];return Object(h.jsx)("div",{className:"SettingsList",children:t.map((function(t){return Object(h.jsxs)("button",{className:"SettingItem",style:{color:t.color},onClick:function(){return e(t.to)},children:[Object(h.jsxs)("div",{className:"settingItemIconAndTitle",children:[t.icon,Object(h.jsx)("h3",{children:t.title})]}),Object(h.jsx)(x.a,{})]},t.id)}))})},Xe=function(e){var t=e.text,n=void 0===t?"See more":t,s=Object(p.a)(e,["text"]);return Object(h.jsxs)("div",Object(O.a)(Object(O.a)({className:"SeeMoreRoundButton"},s),{},{children:[Object(h.jsx)("button",{children:Object(h.jsx)(H.b,{})}),Object(h.jsx)("span",{children:n})]}))},Ge=function(e){var t=e.listOfPeople,n=e.title;return Object(h.jsxs)("div",{children:[n?Object(h.jsx)("h2",{style:{marginTop:"0",marginBottom:"7px"},children:n}):null,t.map((function(e){return Object(h.jsx)(v,{data:e})}))]})},Je=function(e){var t=e.album,n=B().setContent,c=F().yourFriends,a=Object(s.useState)([]),r=Object(l.a)(a,2),i=r[0],o=r[1],u=Object(s.useState)(!0),b=Object(l.a)(u,2),f=b[0],O=b[1];function p(){return(p=Object(j.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:O(!0),o([]),c.forEach((function(e){e.addedPlaylists.includes(t.id)&&o((function(t){return[].concat(Object(m.a)(t),[e])}))})),O(!1);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){!function(){p.apply(this,arguments)}()}),[t.uid]),Object(h.jsxs)("div",{className:"SongInfo",children:[Object(h.jsx)("div",{className:"songImage",style:{backgroundImage:"url(".concat(t.image,")")}}),Object(h.jsxs)("div",{className:"songInfoContent",children:[Object(h.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[Object(h.jsx)("span",{style:{opacity:".5",fontWeight:500,fontSize:".7em"},children:t.isAlbum?"Album":"Playlist"}),Object(h.jsx)("h3",{style:{color:t.imageColors[1]},children:t.name})]}),Object(h.jsxs)("div",{style:{display:"flex",opacity:"0.6",fontSize:".9em",position:"relative"},className:"listensAndDate",children:[Object(h.jsxs)("p",{className:"infoListens",style:{marginRight:"20px",position:"relative"},children:[t.listens,Object(h.jsx)(H.l,{})]}),Object(h.jsxs)("p",{className:"infoListens",style:{marginRight:"20px",position:"relative"},children:[t.subscribers," ",Object(h.jsx)(H.F,{})]}),Object(h.jsx)("span",{children:q(t.creationDate)})]}),Object(h.jsx)("h4",{style:{margin:"10px 0"},children:i.length>0?"Friends subscribed":"None of your friends subscribed"}),f?Object(h.jsx)("div",{style:{position:"relative",height:"50px"},children:Object(h.jsx)(re,{top:"50%"})}):Object(h.jsx)("div",{style:{display:"flex"},children:i.length>0?Object(h.jsxs)(h.Fragment,{children:[i.map((function(e,t){if(t<2)return Object(h.jsx)(we,{person:e},e.uid)})),i.length>2?Object(h.jsx)(Xe,{onClick:function(){return n(Object(h.jsx)(Ge,{listOfPeople:i,title:"Friends subscribed to ".concat(t.name)}))}}):null]}):Object(h.jsx)("button",{className:"shareBtn",style:{minHeight:"35px",background:t.imageColors[0]},onClick:function(){n(Object(h.jsx)(de,{item:t,whatToShare:"playlist"}))},children:"Share"})})]})]})},_e=function(e){var t=e.author,n=B().setContent,c=F().yourFriends,a=Object(s.useState)([]),r=Object(l.a)(a,2),i=r[0],o=r[1],u=Object(s.useState)(!0),b=Object(l.a)(u,2),f=b[0],O=b[1];function p(){return(p=Object(j.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:O(!0),o([]),c.forEach((function(e){t.isAuthor?e.addedAuthors.includes(t.uid)&&o((function(t){return[].concat(Object(m.a)(t),[e])})):e.friends.find((function(e){return e.uid===t.uid}))&&o((function(t){return[].concat(Object(m.a)(t),[e])}))})),O(!1);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){!function(){p.apply(this,arguments)}()}),[t.uid]),Object(h.jsxs)("div",{className:"SongInfo",children:[Object(h.jsx)("div",{className:"songImage",style:{backgroundImage:"url(".concat(t.photoURL,")")}}),Object(h.jsxs)("div",{className:"songInfoContent",children:[Object(h.jsxs)("div",{style:{display:"flex",flexDirection:"column-reverse"},children:[Object(h.jsxs)("h3",{style:{color:t.imageColors[1]},children:[t.displayName,t.isVerified?Object(h.jsx)(Y.b,{style:{color:t.imageColors[0],width:"15px",height:"15px",marginLeft:"5px"}}):null]}),Object(h.jsx)("span",{style:{opacity:".5",fontWeight:500,fontSize:".7em"},children:t.isAuthor?"Author":"User"})]}),Object(h.jsxs)("div",{style:{display:"flex",opacity:"0.6",fontSize:".9em",position:"relative"},className:"listensAndDate",children:[Object(h.jsxs)("p",{className:"infoListens",style:{marginRight:"20px",position:"relative"},children:[t.numberOfListenersPerMonth,Object(h.jsx)(H.l,{})]}),Object(h.jsxs)("p",{className:"infoListens",style:{marginRight:"20px",position:"relative"},children:[t.subscribers," ",Object(h.jsx)(H.F,{})]}),Object(h.jsx)("span",{children:q(t.regDate)})]}),Object(h.jsx)("h4",{style:{margin:"10px 0"},children:i.length>0?"Friends subscribed":"None of your friends subscribed"}),f?Object(h.jsx)("div",{style:{position:"relative",height:"50px"},children:Object(h.jsx)(re,{top:"50%"})}):Object(h.jsx)("div",{style:{display:"flex"},children:i.length>0?Object(h.jsxs)(h.Fragment,{children:[i.map((function(e,t){if(t<2)return Object(h.jsx)(we,{person:e},e.uid)})),i.length>2?Object(h.jsx)(Xe,{onClick:function(){return n(Object(h.jsx)(Ge,{listOfPeople:i,title:"Friends subscribed to ".concat(t.displayName)}))}}):null]}):Object(h.jsx)("button",{className:"shareBtn",style:{minHeight:"35px",background:t.imageColors[0]},onClick:function(){n(Object(h.jsx)(de,{item:t,whatToShare:"author"}))},children:"Share"})})]})]})},Ze=function(e){var t=e.data,n=B().setContent;return Object(h.jsxs)("div",{className:"AuthorMoreWindow",style:{top:"110%",bottom:"auto"},onClick:function(e){return e.stopPropagation()},children:[Object(h.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){n(Object(h.jsx)(de,{item:t,whatToShare:void 0!==t.authors?"playlist":"author"}))},children:[Object(h.jsx)(H.A,{}),"Share"]}),Object(h.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){n(void 0!==t.authors?Object(h.jsx)(Je,{album:t}):Object(h.jsx)(_e,{author:t}))},children:[Object(h.jsx)(H.o,{}),"Info"]}),Object(h.jsxs)("div",{className:"songItemMenuWindowItem",children:[Object(h.jsx)(H.j,{}),"Flag"]})]})},$e=function(e){var t=Object(s.useState)([]),n=Object(l.a)(t,2),c=n[0],a=n[1],r=Object(s.useState)([]),i=Object(l.a)(r,2),o=i[0],u=i[1];function b(){return(b=Object(j.a)(d.a.mark((function t(){var n,s,c,r;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===(null===e||void 0===e?void 0:e.authors)){t.next=10;break}return n=e.authors.map((function(e){return e.uid})),t.next=4,C.collection("users").where("uid","in",n).get();case 4:s=t.sent,c=[],r=[],s.docs.forEach((function(e){c.push(e.data()),r.push(e.data().photoURL)})),a(c),u(r);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return Object(s.useEffect)((function(){!function(){b.apply(this,arguments)}()}),[null===e||void 0===e?void 0:e.id]),[c,o]},et=function(e){var t,n,c=e.data,a=e.headerColors,r=X().isMobile,i=F().displayAuthors,o=$e(c),u=Object(l.a)(o,2),d=u[0],j=u[1],b=R(),f=b.currentUser,O=b.logout,p=Object(s.useState)(!1),m=Object(l.a)(p,2),g=m[0],v=m[1],y=B(),S=y.toggleModal,w=y.setContent,N=y.openConfirm,k=y.closeConfirm,I=f.friends.find((function(e){return e.uid===c.uid&&"added"===e.status})),A=Object(s.useRef)(null);return te(A,v),Object(h.jsxs)("div",{className:"Header",style:a.length?{background:"linear-gradient(45deg, ".concat(a[2],", ").concat(a[0],")")}:{background:"var(--yellowAndPinkGrad)"},children:[Object(h.jsxs)("div",{className:"headerBtns",style:{background:a[2]},children:[Object(h.jsx)(_,{}),Object(h.jsxs)("div",{style:{display:"flex"},children:[Object(h.jsx)("div",{className:"headerBackBtn",children:c.authors?f.ownPlaylists.includes(c.id)&&1===c.authors.length?Object(h.jsxs)("button",{onClick:function(){return N("Are you sure you want to DELETE this playlist forever?!","Yes, pretty sure","No, I Don't!",(function(){var e;e=c.id,C.collection("users").where("addedPlaylists","array-contains",e).get().then((function(t){t.docs.forEach((function(t){var n=t.data().addedPlaylists.filter((function(t){return t!==e}));C.collection("users").doc(t.data().uid).update({addedPlaylists:n})}))})),C.collection("users").where("ownPlaylists","array-contains",e).get().then((function(t){t.docs.forEach((function(t){var n=t.data().addedPlaylists.filter((function(t){return t!==e}));C.collection("users").doc(t.data().uid).update({ownPlaylists:n})}))})),C.collection("search").doc(e).delete().then((function(){C.collection("playlists").doc(e).delete()})),k()}))},children:[Object(h.jsx)(J,{text:"delete playlist",direction:"bottom"}),Object(h.jsx)(H.B,{})]}):f.ownPlaylists.includes(c.id)?Object(h.jsxs)("button",{onClick:function(){return N("Are you sure you want to quit this playlist?","Yes, pretty sure","No, I Don't!",(function(){c.id,k()}))},children:[Object(h.jsx)(J,{text:"quit playlist",direction:"bottom"}),Object(h.jsx)(ie.e,{})]}):f.addedPlaylists.includes(c.id)?Object(h.jsxs)("button",{onClick:function(){return N("Are you sure you want to remove this playlist from library?","Yes, pretty sure","No-no-no, go away",(function(){Qe(c,f),k()}))},children:[Object(h.jsx)(J,{text:"remove playlist from library",direction:"bottom"}),Object(h.jsx)(ee.a,{})]}):Object(h.jsxs)("button",{onClick:function(){return Ve(c,f)},children:[Object(h.jsx)(J,{text:"add playlist",direction:"bottom"}),Object(h.jsx)(H.x,{})]}):f.addedAuthors.includes(c.uid)?Object(h.jsxs)("button",{children:[Object(h.jsx)(J,{text:"remove author from library",direction:"bottom"}),Object(h.jsx)(ee.a,{})]}):f.uid===c.uid?Object(h.jsxs)("button",{onClick:function(){S(),w(Object(h.jsx)(Ke,{}))},children:[Object(h.jsx)(J,{text:"settings",direction:"bottom"}),Object(h.jsx)(H.z,{})]}):!c.isAuthor&&f.friends.find((function(e){return e.uid===c.uid&&"added"===e.status}))?Object(h.jsxs)("button",{onClick:function(){return N("Are you sure you want to remove this person from friend list?","Yes, pretty sure","No-no-no, go away",(function(){!function(e,t){var n=e.friends.filter((function(e){return e.uid!==t.uid})),s=t.friends.filter((function(t){return t.uid!==e.uid}));C.collection("users").doc(e.uid).update({friends:n}),C.collection("users").doc(t.uid).update({friends:s})}(f,c),k()}))},children:[Object(h.jsx)(J,{text:"remove from friend list",direction:"bottom"}),Object(h.jsx)(H.E,{})]}):!c.isAuthor&&f.friends.find((function(e){return e.uid===c.uid&&"awaiting"===e.status}))?Object(h.jsxs)("button",{onClick:He,children:[Object(h.jsx)(J,{text:"waiting for response",direction:"bottom"}),Object(h.jsx)(ie.k,{style:{animation:"loading 1s infinite linear"}})]}):c.isAuthor?Object(h.jsxs)("button",{onClick:function(){return ze(c,f)},children:[Object(h.jsx)(J,{text:"subscribe",direction:"bottom"}),Object(h.jsx)(H.x,{})]}):Object(h.jsxs)("button",{onClick:function(){return He(c,f)},children:[Object(h.jsx)(J,{text:"add friend",direction:"bottom"}),Object(h.jsx)(H.F,{})]})}),Object(h.jsxs)("div",{className:"headerMoreBtn",ref:A,children:[Object(h.jsxs)("button",{onClick:r?function(){S(),w(Object(h.jsx)(Ze,{data:c}))}:function(){return v(!g)},children:[Object(h.jsx)(J,{text:"more",direction:"bottom"}),Object(h.jsx)(H.t,{})]}),g?Object(h.jsxs)("div",{className:"songItemMenuWindow",style:{top:"110%",bottom:"auto"},onClick:function(e){return e.stopPropagation()},children:[c.authors&&c.authors.find((function(e){return e.uid===f.uid}))||c.authors&&f.isAdmin?Object(h.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){S(),w(Object(h.jsx)(Fe,{playlist:c}))},children:[Object(h.jsx)(H.i,{}),"Edit"]}):null,Object(h.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){S(),w(Object(h.jsx)(de,{item:c,whatToShare:void 0!==c.authors?"playlist":"author"}))},children:[Object(h.jsx)(H.A,{}),"Share"]}),Object(h.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){S(),w(void 0!==c.authors?Object(h.jsx)(Je,{album:c}):Object(h.jsx)(_e,{author:c}))},children:[Object(h.jsx)(H.o,{}),"Info"]}),Object(h.jsxs)("div",{className:"songItemMenuWindowItem",children:[Object(h.jsx)(H.j,{}),"Flag"]})]}):null]})]}),f.uid===c.uid?Object(h.jsxs)("button",{onClick:O,children:[Object(h.jsx)(J,{text:"quit",direction:"bottom"}),Object(h.jsx)(x.e,{})]}):null]}),Object(h.jsx)("div",{className:"headerAuthorsImage",style:void 0===c.authors?{animation:"floatingBorderRadius 10s infinite ease-in-out",backgroundImage:"url(".concat(c.photoURL,")")}:{backgroundImage:"url(".concat(c.image,")")}}),Object(h.jsxs)("div",{className:"headerAuthorInfo",children:[Object(h.jsxs)("div",{className:"headerAuthorsName",children:[void 0!==c.authors?c.isAlbum?Object(h.jsx)("h5",{children:"Album"}):Object(h.jsx)("h5",{children:"Playlist"}):c.isAuthor?Object(h.jsx)("h5",{children:"Author"}):Object(h.jsxs)("h5",{children:["User ",void 0===c.authors&&I?Object(h.jsx)(Ye,{userUID:c.uid}):null]}),Object(h.jsxs)("div",{style:{display:"flex",alignItems:"center",margin:"2px 0 10px 0"},children:[Object(h.jsx)("h1",{children:c.displayName||c.name}),c.isVerified?Object(h.jsx)(Y.b,{style:{color:a[0]}}):null,c.isPrivate?Object(h.jsx)(ee.b,{}):null]})]}),void 0!==c.authors?Object(h.jsxs)("div",{className:"headerAuthorsImagesAndNames",children:[Object(h.jsx)(Z,{imagesList:j,borderColor:a[2]}),Object(h.jsx)("div",{className:"headerAuthors",children:i(d,", ")})]}):null,Object(h.jsxs)("div",{className:"headerListenersAndSubs",children:[Object(h.jsxs)("div",{className:"headerListenersAndSubsItem",children:[Object(h.jsx)(J,{text:(null!==(t=c.listens)&&void 0!==t?t:c.numberOfListenersPerMonth)+" listeners per month",style:{fontSize:"0.8em"}}),Object(h.jsx)("span",{children:$(null!==(n=c.listens)&&void 0!==n?n:c.numberOfListenersPerMonth)}),Object(h.jsx)(H.l,{})]}),Object(h.jsxs)("div",{className:"headerListenersAndSubsItem",children:[Object(h.jsx)(J,{text:c.subscribers+" subscribers",style:{fontSize:"0.8em"}}),Object(h.jsx)("span",{children:$(c.subscribers)}),Object(h.jsx)(H.F,{})]}),void 0!==c.creationDate?Object(h.jsx)("div",{className:"headerListenersAndSubsItem",children:Object(h.jsx)("span",{children:q(c.creationDate)})}):null]}),I?Object(h.jsx)(ae,{data:c,color:a[3]}):null]})]})},tt=function(){var e=Object(o.h)("/albums/:albumId"),t=Object(s.useState)([]),n=Object(l.a)(t,2),c=n[0],a=n[1],r=Object(s.useState)([]),i=Object(l.a)(r,2),u=i[0],b=i[1],f=e.params.albumId,O=Object(s.useState)([]),p=Object(l.a)(O,2),x=p[0],g=p[1],v=Object(s.useState)(!0),y=Object(l.a)(v,2),S=y[0],w=y[1],N=Object(o.g)();function k(){return(k=Object(j.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:C.collection("playlists").doc(f).onSnapshot((function(e){e.exists?(g(e.data()),b(e.data().imageColors)):N.push("/not-found")}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){!function(){k.apply(this,arguments)}()}),[f,C]),Object(s.useEffect)((function(){a([]),0!==x.length&&(x.songs.map(function(){var e=Object(j.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("songs").doc(t).get();case 2:n=e.sent.data(),a((function(e){return[].concat(Object(m.a)(e),[n])}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),w(!1))}),[x]),Object(h.jsx)("div",{className:"AlbumPage",style:{animation:"zoomIn .2s forwards"},children:S?Object(h.jsx)(re,{top:"50%"}):Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(et,{data:x,headerColors:u,setHeaderColors:b}),Object(h.jsx)(We,{listOfSongs:c,source:{source:"/albums/".concat(x.id),name:x.name,image:x.image,songsList:c},showSearch:!0,defaultSearchMode:"songs"})]})})},nt=function(){var e,t=R().currentUser,n=Object(s.useState)(""),c=Object(l.a)(n,2),a=c[0],r=c[1],i=Object(s.useState)(""),o=Object(l.a)(i,2),u=o[0],b=o[1],f=Object(s.useState)(""),O=Object(l.a)(f,2),p=O[0],x=O[1],g=Object(s.useState)([]),y=Object(l.a)(g,2),S=y[0],w=y[1],k=Object(s.useState)(t.isAdmin?[]:[{uid:t.uid,photoURL:t.photoURL,displayName:t.displayName}]),I=Object(l.a)(k,2),A=I[0],P=I[1],L=Object(s.useState)(t.isAdmin?"":(new Date).toString()),E=Object(l.a)(L,2),M=E[0],D=E[1],B=Object(s.useState)(""),U=Object(l.a)(B,2),W=U[0],F=U[1],z=Object(s.useState)([]),Y=Object(l.a)(z,2),V=Y[0],Q=Y[1],q=Object(s.useState)([]),K=Object(l.a)(q,2),X=K[0],G=K[1],J=Object(s.useState)(0),_=Object(l.a)(J,2),Z=_[0],$=_[1],ee=Object(s.useState)(0),te=Object(l.a)(ee,2),se=te[0],ce=te[1],ae=Object(s.useState)(!1),ie=Object(l.a)(ae,2),oe=ie[0],le=ie[1],de=Object(s.useState)(!1),he=Object(l.a)(de,2),fe=he[0],me=(he[1],Object(s.useState)("")),xe=Object(l.a)(me,2),ge=xe[0],ve=xe[1],ye=Object(s.useState)([]),Se=Object(l.a)(ye,2),we=Se[0],Ne=Se[1];function Ce(e){return ke.apply(this,arguments)}function ke(){return(ke=Object(j.a)(d.a.mark((function e(n){var s,c,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return le(!0),w([]),s=t.friends.map((function(e){if("added"===e.status)return e.uid})),c=t.isAdmin?C.collection("users").where("displayName","==",p):C.collection("users").where("uid","in",s).where("displayName","==",p),e.next=6,c.get();case 6:void 0!==(a=e.sent)&&(a.docs.forEach((function(e){w([].concat(Object(m.a)(S),[e.data()]))})),le(!1));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ie(e){var t=A.filter((function(t){return t.uid!==e.uid}));return P(t)}function Ae(){return(Ae=Object(j.a)(d.a.mark((function e(t,n,s){var c,a,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=t.target.files[0],ve(URL.createObjectURL(c)),a=N.ref(),r=a.child(n+c.name),e.next=6,r.put(c);case 6:return e.t0=s,e.next=9,r.getDownloadURL();case 9:e.t1=e.sent,(0,e.t0)(e.t1);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Pe(){return(Pe=Object(j.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),n=ne(),C.collection("playlists").doc(n).set({id:n,name:a,songs:X,authors:A,image:u,listens:0,creationDate:M,subscribers:0,isAlbum:Z,imageColors:we,isPrivate:!0===se}).then((function(){w([]),x(""),P([]),b(""),r(""),D(""),F(""),G([]),ce(0)})).catch((function(e){console.log(e)})),A.forEach(function(){var e=Object(j.a)(d.a.mark((function e(t){var s,c,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("users").doc(t.uid).get();case 2:s=e.sent,c=s.data(),(a=c.ownPlaylists).push(n),C.collection("users").doc(t.uid).update({ownPlaylists:a});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),C.collection("search").doc(n).set({place:"playlists",uid:n,variantsOfName:T(a)});case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(h.jsxs)("div",{className:"AddSong",children:[Object(h.jsx)(pe.a,{src:ge,getColors:function(e){return Ne(e)}}),Object(h.jsxs)("form",{onSubmit:function(e){return Pe.apply(this,arguments)},children:[Object(h.jsxs)("label",{children:[Object(h.jsx)("h3",{children:"Playlist name"}),Object(h.jsx)("input",{type:"text",placeholder:"Enter playlist name",value:a,onChange:function(e){return r(e.target.value)},required:!0})]}),Object(h.jsxs)("label",{children:[Object(h.jsx)("h3",{children:"Playlist authors"}),Object(h.jsx)("input",{type:"text",placeholder:"Enter author name",value:p,onChange:function(e){return x(e.target.value)},style:{marginBottom:"5px"},onKeyUp:function(){return t=Ce,clearTimeout(e),void(e=setTimeout(t,1e3));var t},onKeyDown:function(){return clearTimeout(e)}}),Object(h.jsx)("div",{className:"chosenAuthorsList",children:A.map((function(e){return Object(h.jsxs)("div",{className:"chosenAuthorItem",children:[Object(h.jsx)("span",{children:e.displayName}),Object(h.jsx)(H.I,{onClick:function(){return e.uid===t.uid?null:Ie(e)}})]})}))}),Object(h.jsx)("div",{className:"authorsResult",children:oe?Object(h.jsx)("div",{style:{position:"relative",width:"100%",height:"50px"},children:Object(h.jsx)(re,{})}):S.map((function(e,t){return Object(h.jsx)(v,{data:e,onClick:function(){return function(e){if(!A.some((function(t){return t.uid===e.uid})))return P((function(t){return[].concat(Object(m.a)(t),[{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL}])}));Ie(e)}(e)},style:A.includes(e.uid)?{background:"var(--green)"}:{}},t)}))})]}),Object(h.jsxs)("label",{children:[Object(h.jsx)("h3",{children:"Search for songs"}),Object(h.jsx)(ue,{value:W,setValue:F,setAllFoundSongs:Q,defaultSearchMode:"songs"}),Object(h.jsx)("div",{className:"chosenAuthorsList",children:X.map((function(e){return Object(h.jsxs)("div",{className:"chosenAuthorItem",children:[Object(h.jsx)("span",{children:e}),Object(h.jsx)(H.I,{onClick:function(){return function(e){var t=X.filter((function(t){return t!==e}));return G(t)}(e)}})]})}))}),Object(h.jsx)("div",{className:"authorsResult",children:fe?Object(h.jsx)("div",{style:{position:"relative",width:"100%",height:"50px"},children:Object(h.jsx)(re,{})}):V.map((function(e,t){return Object(h.jsx)(Oe,{song:e,listOfSongs:X,setListOfSongs:G})}))})]}),t.isAdmin||t.isAuthor?Object(h.jsxs)("div",{style:{display:"flex",justifyContent:"flex-start",margin:"15px 0"},children:[Object(h.jsx)(be,{label:"Playlist",onClick:function(){return $(0)},currentActive:Z,id:0}),Object(h.jsx)(be,{label:"Album",onClick:function(){return $(1)},currentActive:Z,id:1})]}):null,Object(h.jsxs)("div",{style:{display:"flex",justifyContent:"flex-start",margin:"15px 0"},children:[Object(h.jsx)(be,{label:"Not Private",onClick:function(){return ce(0)},currentActive:se,id:0}),Object(h.jsx)(be,{label:"Private",onClick:function(){return ce(1)},currentActive:se,id:1})]}),t.isAdmin||t.isAuthor?Object(h.jsxs)("label",{children:[Object(h.jsx)("h3",{children:"Release Date"}),Object(h.jsx)("input",{type:"date",name:"",id:"",value:M,onChange:function(e){return D(e.target.value)}})]}):null,Object(h.jsxs)("label",{className:"downloadFile",children:[Object(h.jsxs)("div",{className:"downloadPhoto",children:[Object(h.jsxs)("span",{className:"downloadBtnText",children:[Object(h.jsx)(je.d,{}),"Download playlist cover"]}),Object(h.jsx)("span",{className:"photoLoadLine",style:""!==u?{width:"100%"}:{}})]}),Object(h.jsx)("input",{type:"file",name:"",id:"",onChange:function(e){return function(e,t,n){return Ae.apply(this,arguments)}(e,"songsImages/",b)}})]}),Object(h.jsx)("button",{type:"submit",className:"addSongBtn",children:"Add playlist"})]})]})},st=function(e){var t=e.setErrorMessage,n=e.setImageLocalPath,s=e.downloadedPhoto,c=e.setDownloadedPhoto,a=e.place,r=e.btnText,i=void 0===r?"Download song cover":r;function o(){return(o=Object(j.a)(d.a.mark((function e(s,c,a){var r,i,o,l,u,j;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t(""),r=s.target.files[0],i=!1,"songsImages/"===c||"chatCovers/"===c?(console.log("image"),(o=[".jpg",".png",".jpeg"]).find((function(e){return r.name.substr(r.name.length-e.length,e.length)===e}))?i=!0:t("Format of your file is not valid. Download file with one of these: ".concat(o.map((function(e){return" "+e}))))):"songs/"===c&&(console.log("song"),(l=[".mp3",".mp4a",".flac",".wav",".wma"]).find((function(e){return r.name.substr(r.name.length-e.length,e.length)===e}))?i=!0:t("Format of your file is not valid. Download file with one of these: ".concat(l.map((function(e){return e}))))),!i){e.next=16;break}return console.log(r),n(URL.createObjectURL(r)),u=N.ref(),j=u.child(c+r.name),e.next=11,j.put(r);case 11:return e.t0=a,e.next=14,j.getDownloadURL();case 14:e.t1=e.sent,(0,e.t0)(e.t1);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(h.jsxs)("label",{className:"downloadFile",children:[Object(h.jsxs)("div",{className:"downloadPhoto",children:[Object(h.jsxs)("span",{className:"downloadBtnText",children:[Object(h.jsx)(je.d,{}),i]}),Object(h.jsx)("span",{className:"photoLoadLine",style:""!==s?{width:"100%"}:{}})]}),Object(h.jsx)("input",{type:"file",name:"",id:"",onChange:function(e){return function(e,t,n){return o.apply(this,arguments)}(e,a,c)}})]})},ct=function(e){var t=e.loading;return Object(h.jsx)("div",{className:"FullScreenLoading",style:t?{}:{opacity:"0",visibility:"hidden"},children:Object(h.jsx)("img",{loading:"lazy",src:"https://icon-library.com/images/spinner-icon-gif/spinner-icon-gif-28.jpg",alt:""})})},at=function(){var e=R().currentUser,t=Object(s.useState)(""),n=Object(l.a)(t,2),c=n[0],a=n[1],r=Object(s.useState)(""),i=Object(l.a)(r,2),o=i[0],u=i[1],b=Object(s.useState)(""),f=Object(l.a)(b,2),O=f[0],p=f[1],x=Object(s.useState)(""),g=Object(l.a)(x,2),y=g[0],S=g[1],w=Object(s.useState)([]),k=Object(l.a)(w,2),I=k[0],A=k[1],P=Object(s.useState)(e.isAdmin?[]:[{uid:e.uid,photoURL:e.photoURL,displayName:e.displayName}]),L=Object(l.a)(P,2),E=L[0],M=L[1],D=Object(s.useState)(""),B=Object(l.a)(D,2),U=B[0],W=B[1],F=Object(s.useState)(""),z=Object(l.a)(F,2),Y=z[0],V=z[1],Q=Object(s.useState)(""),q=Object(l.a)(Q,2),K=q[0],X=q[1],G=Object(s.useState)([]),J=Object(l.a)(G,2),_=J[0],Z=J[1],$=Object(s.useState)(!1),ee=Object(l.a)($,2),te=ee[0],se=(ee[1],Object(s.useState)("")),ce=Object(l.a)(se,2),ae=ce[0],ie=ce[1],oe=Object(s.useState)(!1),le=Object(l.a)(oe,2),de=le[0],be=le[1],he=Object(s.useState)(!1),fe=Object(l.a)(he,2),Oe=fe[0],me=fe[1];function xe(e){var t=E.filter((function(t){return t.uid!==e.uid}));return M(t)}function ge(){return(ge=Object(j.a)(d.a.mark((function e(t,n,s){var c,a,r,i,o,l;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ie(""),c=t.target.files[0],a=!1,"songsImages/"===n?(r=[".jpg",".png",".jpeg"]).find((function(e){return c.name.substr(c.name.length-e.length,e.length)===e}))?a=!0:ie("Format of your file is not valid. Download file with one of these: ".concat(r.map((function(e){return" "+e})))):"songs/"===n&&((i=[".mp3",".mp4a",".flac",".wav",".wma"]).find((function(e){return c.name.substr(c.name.length-e.length,e.length)===e}))?a=!0:ie("Format of your file is not valid. Download file with one of these: ".concat(i.map((function(e){return e}))))),!a){e.next=15;break}return X(URL.createObjectURL(c)),o=N.ref(),l=o.child(n+c.name),e.next=10,l.put(c);case 10:return e.t0=s,e.next=13,l.getDownloadURL();case 13:e.t1=e.sent,(0,e.t0)(e.t1);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ve(){return(ve=Object(j.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),me(!0),n=ne(),ie(""),0===c.length?ie("Song has to have some name"):0===E.length?ie("Song has to have at least 1 author"):0===o.length?ie("You didn't load song cover"):0===O.length?ie("You didn't load song file"):0===U.length?ie("You have to set release date for a song"):(C.collection("songs").doc(n).set({id:n,name:c,songSrc:O,authors:E,cover:o,listens:0,releaseDate:U,lyrics:Le(Y),imageColors:_}).then((function(){A([]),S(""),M([]),V([]),u(""),a(""),p(""),W(""),V([]),be(!0),Z([]),me(!1)})).catch((function(e){ie(e),me(!1)})),E.forEach(function(){var e=Object(j.a)(d.a.mark((function e(t){var s,c,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("users").doc(t.uid).get();case 2:s=e.sent,c=s.data(),(a=c.ownSongs).push(n),C.collection("users").doc(t.uid).update({ownSongs:a});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),C.collection("search").doc(n).set({place:"songs",uid:n,variantsOfName:T(c)}));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){de&&setTimeout((function(){be(!1)}),2e3)}),[de]),Object(h.jsxs)("div",{className:"AddSong",children:[Object(h.jsx)(ct,{loading:Oe}),Object(h.jsx)(pe.a,{src:K,getColors:function(e){return Z(e)}}),Object(h.jsxs)("form",{onSubmit:function(e){return ve.apply(this,arguments)},children:[Object(h.jsxs)("label",{children:[Object(h.jsx)("h3",{children:"Song name"}),Object(h.jsx)("input",{type:"text",placeholder:"Enter song name",value:c,onChange:function(e){return a(e.target.value)}})]}),Object(h.jsxs)("label",{children:[Object(h.jsx)("h3",{children:"Song authors"}),Object(h.jsx)(ue,{value:y,setValue:S,setResultAuthorList:A,defaultSearchMode:"authors"}),Object(h.jsx)("div",{className:"chosenAuthorsList",children:E.map((function(t){return Object(h.jsxs)("div",{className:"chosenAuthorItem",children:[Object(h.jsx)("span",{children:t.displayName}),Object(h.jsx)(H.I,{onClick:function(){(e.isAdmin||t.uid!==e.uid)&&xe(t)}})]})}))}),Object(h.jsx)("div",{className:"authorsResult",children:te?Object(h.jsx)("div",{style:{position:"relative",width:"100%",height:"50px"},children:Object(h.jsx)(re,{})}):I.map((function(e,t){return Object(h.jsx)(v,{data:e,onClick:function(){return function(e){if(!E.some((function(t){return t.uid===e.uid})))return M((function(t){return[].concat(Object(m.a)(t),[{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL}])}));xe(e)}(e)},style:E.includes(e.uid)?{background:"var(--green)"}:{}},t)}))})]}),Object(h.jsxs)("label",{children:[Object(h.jsx)("h3",{children:"Release Date"}),Object(h.jsx)("input",{type:"date",name:"",id:"",value:U,onChange:function(e){return W(e.target.value)}})]}),Object(h.jsx)(Pe,{errorMessage:ae}),Object(h.jsx)("div",{style:{width:"100%",display:"flex"},children:_.map((function(e,t){return Object(h.jsx)("input",{type:"color",value:e,style:{width:"100%",height:"60px",padding:"0",borderRadius:"0px"},onChange:function(e){!function(e,t){_[t]=e.target.value,Z(Object(m.a)(_))}(e,t)}})}))}),Object(h.jsx)(st,{setErrorMessage:ie,setImageLocalPath:X,downloadedPhoto:o,setDownloadedPhoto:u,place:"songsImages/"}),Object(h.jsxs)("label",{className:"downloadFile",children:[Object(h.jsxs)("div",{className:"downloadPhoto",children:[Object(h.jsxs)("span",{className:"downloadBtnText",children:[Object(h.jsx)(je.d,{}),"Download song file"]}),Object(h.jsx)("span",{className:"photoLoadLine",style:""!==O?{width:"100%"}:{}})]}),Object(h.jsx)("input",{type:"file",name:"",id:"",onChange:function(e){return function(e,t,n){return ge.apply(this,arguments)}(e,"songs/",p)}})]}),Object(h.jsx)("label",{children:Object(h.jsx)("textarea",{name:"",id:"",placeholder:"Add song lyrics",value:Y,onChange:function(e){return V(e.target.value)}})}),Object(h.jsx)("button",{type:"submit",className:"addSongBtn",children:de?"Song Successfully added. Congrats!":"Add song"})]})]})},rt=function(e){var t=e.pages,n=e.currentPage,s=e.setCurrentPage;return Object(h.jsx)("div",{className:"Slider",children:t.map((function(e,t){return Object(h.jsx)("div",{className:"sliderItem "+(t===n?"current":""),onClick:function(){return s(t)},children:e},t)}))})},it=function(e){var t=e.data,n=R().currentUser,c=Object(s.useState)(!1),a=Object(l.a)(c,2),r=a[0],i=a[1],o=Object(s.useState)(0),u=Object(l.a)(o,2),d=u[0],j=u[1],b=[Object(h.jsx)(at,{}),Object(h.jsx)(nt,{})];return(n.isAdmin||t.isAuthor)&&t.uid===n.uid?Object(h.jsxs)("div",{className:"AddSong",children:[Object(h.jsx)("button",{onClick:function(){return i(!r)},style:r?{background:"var(--red)"}:{},className:"openAddSongWindowBtn",children:Object(h.jsx)(H.w,{style:r?{transform:"rotate(45deg)"}:{}})}),Object(h.jsxs)("div",{className:"addSongWindow",style:r?{display:"flex"}:{},children:[Object(h.jsx)(rt,{pages:["Song","Playlist"],currentPage:d,setCurrentPage:j}),b[d]]})]}):null},ot=function(e){var t=e.person,n=e.addFriend,s=e.rejectFriend;return Object(h.jsxs)("div",{className:"FriendRequestItem",children:[Object(h.jsx)(i.b,{to:"/authors/".concat(t.uid),children:Object(h.jsxs)("div",{className:"friendRequestImageAndName",children:[Object(h.jsx)("div",{className:"requestImage",children:Object(h.jsx)("img",{loading:"lazy",src:t.photoURL,alt:""})}),Object(h.jsx)("h3",{children:t.displayName})]})}),Object(h.jsxs)("div",{className:"requestButtons",children:[Object(h.jsxs)("button",{style:{color:"var(--green)"},onClick:function(){return n(t.uid)},children:[Object(h.jsx)(H.c,{}),Object(h.jsx)("span",{children:"Add"})]}),Object(h.jsxs)("button",{style:{color:"var( --lightRed)"},onClick:function(){return s(t.uid)},children:[Object(h.jsx)(H.H,{}),Object(h.jsx)("span",{children:"Reject"})]})]})]})},lt=function(){var e=R().currentUser,t=Object(s.useState)([]),n=Object(l.a)(t,2),c=n[0],a=n[1];function r(t){var n=e.friends,s=c.find((function(e){return e.uid===t})).friends;n.find((function(e){return e.uid===t})).status="added",s.find((function(t){return t.uid===e.uid})).status="added",C.collection("users").doc(e.uid).update({friends:n}),C.collection("users").doc(t).update({friends:s}),a((function(e){return e.filter((function(e){return e.uid!==t}))}))}function i(t){var n=e.friends.filter((function(e){return e.uid!==t}));C.collection("users").doc(t).get().then((function(s){var c=s.data().friends.filter((function(t){return t.uid!==e.uid}));C.collection("users").doc(e.uid).update({friends:n}),C.collection("users").doc(t).update({friends:c}),a((function(e){return e.filter((function(e){return e.uid!==t}))}))}))}return Object(s.useEffect)((function(){!function(){var t=[];e.friends.forEach(function(){var n=Object(j.a)(d.a.mark((function n(s,c){var r;return d.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("requested"!==s.status){n.next=6;break}return n.next=3,C.collection("users").doc(s.uid).get();case 3:r=n.sent.data(),t.push(r),c===e.friends.length-1&&a(t);case 6:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())}()}),[JSON.stringify(e.friends)]),Object(h.jsx)("div",{children:c.map((function(e,t){return Object(h.jsx)(ot,{person:e,addFriend:r,rejectFriend:i},t)}))})},ut=function(e){var t=e.data,n=e.title,c=Object(s.useState)([]),a=Object(l.a)(c,2),r=a[0],i=a[1],o=Object(s.useState)(0),u=Object(l.a)(o,2),b=u[0],f=u[1],O=Object(s.useRef)(null),p=Object(s.useState)(!1),x=Object(l.a)(p,2),g=x[0],v=x[1];return Object(s.useEffect)((function(){r.length>0&&(O.current.scrollWidth>O.current.offsetWidth&&v(!0))}),[r]),Object(s.useEffect)((function(){i([]),i([]),t.friends.forEach(function(){var e=Object(j.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("added"!==t.status){e.next=5;break}return e.next=3,C.collection("users").doc(t.uid).get();case 3:n=e.sent.data(),i((function(e){return[].concat(Object(m.a)(e),[n])}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[t.uid]),r.length>0?Object(h.jsxs)("div",{className:"PersonTinyList",children:[n&&Object(h.jsx)("h2",{children:n}),Object(h.jsxs)("div",{style:{position:"relative"},children:[Object(h.jsx)("div",{className:"personTinyListWrapper",ref:O,onScroll:function(e){return f(e.target.scrollLeft)},children:r.map((function(e,t){return Object(h.jsx)(we,{person:e},e.uid)}))}),Object(h.jsxs)("div",{className:"authorsShiftButtons",children:[Object(h.jsx)("button",{onClick:function(){var e=O.current.scrollLeft;O.current.scrollLeft=e-200,f(e-200)},style:b<=0?{visibility:"hidden",opacity:"0"}:{},children:Object(h.jsx)(H.e,{})}),Object(h.jsx)("button",{onClick:function(){var e=O.current.scrollLeft;O.current.scrollLeft=e+200,f(e+200)},style:g&&O.current&&O.current.scrollWidth-O.current.offsetWidth!==b?{}:{visibility:"hidden",opacity:"0"},children:Object(h.jsx)(H.f,{})})]})]})]}):null},dt=function(){var e=Object(j.a)(d.a.mark((function e(t,n,s,c){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n([]),a=[],void 0!==t.ownPlaylists&&0!==t.ownPlaylists.length&&t.ownPlaylists.forEach(function(){var e=Object(j.a)(d.a.mark((function e(r,i){var o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("playlists").doc(r).get();case 2:(o=e.sent.data())&&(!o.isPrivate||t.uid===s&&o.isPrivate)&&a.push(o),i===t.ownPlaylists.length-1&&(a.sort((function(e,t){return new Date(t.creationDate).getTime()-new Date(e.creationDate).getTime()})),c(!1),n(a));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e)})));return function(t,n,s,c){return e.apply(this,arguments)}}(),jt=function(e,t,n){var c=F(),a=c.currentSongPlaylistSource,r=c.playSong,i=c.setCurrentSongQueue,o=c.setCurrentSong,l=c.setPlay,u=c.songRef,b=c.setCurrentSongInQueue,h=c.setCurrentSongPlaylistSource,f=R().currentUser;return Object(s.useEffect)((function(){if(t.length){var n={source:"/albums/".concat(e.id),name:e.name,image:e.image,songsList:t},s=t.map((function(e){return e.id}));i(t),b(0),o(t[0].id),u.current.play(),l(!0),h(n),C.collection("users").doc(f.uid).update({lastSongPlayed:t[0].id,lastQueue:{image:n.image,name:n.name,songsList:s,source:n.source}})}}),[t.length]),function(t){t.preventDefault(),a.name!==e.name?(n([]),0!==e.length&&e.songs.map(function(){var e=Object(j.a)(d.a.mark((function e(t){var s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("songs").doc(t).get();case 2:s=e.sent.data(),n((function(e){return[].concat(Object(m.a)(e),[s])}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())):r()}},bt=function(){return Object(h.jsxs)("div",{style:{textDecoration:"none"},className:"playlistWrapper",children:[Object(h.jsx)("div",{className:"playlistItem",style:{background:"var(--playlistsColor)",display:"flex",justifyContent:"center",alignItems:"center"},children:Object(h.jsx)("img",{loading:"lazy",src:b,alt:"",style:{width:"70px",height:"70px",filter:"grayscale(80%)"}})}),Object(h.jsx)("h4",{style:{display:"flex",alignItems:"center",margin:"5px 0"},children:"Playlist was deleted"})]})},ht=function(e){var t=e.playlist,n=void 0===t?null:t,c=e.listOfChosenAlbums,a=e.setListOfChosenAlbums,r=new Date(null===n||void 0===n?void 0:n.creationDate),o=X().isMobile,u=F(),d=u.currentSongPlaylistSource,j=u.play,b=Object(s.useState)([]),f=Object(l.a)(b,2),O=f[0],p=f[1],m=jt(n,O,p);return null!==n?Object(h.jsxs)(i.b,{to:"/albums/".concat(n.id),style:{textDecoration:"none"},className:"playlistWrapper",children:[Object(h.jsx)(g,{listOfChosenItems:c,setListOfChosenItems:a,itemId:n.id}),Object(h.jsxs)("div",{className:"playlistItem",style:{backgroundImage:"url(".concat(n.image,")")},children:[n.image?null:Object(h.jsx)("h1",{children:me(n.name,13)}),Object(h.jsx)("button",{onClick:m,children:d.name===n.name&&j?Object(h.jsx)(fe.b,{}):Object(h.jsx)(fe.c,{})})]}),Object(h.jsxs)("h4",{style:{display:"flex",alignItems:"center",margin:"5px 0"},children:[me(n.name,o?10:15),Object(h.jsx)("span",{style:{fontSize:".6em",opacity:.6,fontWeight:"500",marginLeft:"7px"},children:n.isAlbum?1===n.songs.length?"single":"album":"playlist"})]}),Object(h.jsx)("h5",{style:{margin:"5px 0"},children:r.getFullYear()})]}):Object(h.jsx)(bt,{})},ft=function(e){var t=e.listOfAlbums,n=e.title,c=void 0===n?"":n,a=e.loading,r=void 0===a||a,i=e.listOfChosenAlbums,o=e.setListOfChosenAlbums,u=Object(s.useState)(0),d=Object(l.a)(u,2),j=d[0],b=d[1],f=Object(s.useRef)(null),O=Object(s.useState)(!1),p=Object(l.a)(O,2),m=p[0],x=p[1];return Object(s.useEffect)((function(){t.length>0&&!r&&(f.current.scrollWidth>f.current.offsetWidth&&x(!0))}),[t]),t.length>0?r?Object(h.jsx)(re,{}):Object(h.jsxs)("div",{className:"AuthorsList",children:[0!==c.length?Object(h.jsx)("h2",{children:c}):null,Object(h.jsx)("div",{className:"authorsWrapper",ref:f,onScroll:function(e){return b(e.target.scrollLeft)},children:t.map((function(e,t){return Object(h.jsx)(ht,{playlist:e,listOfChosenAlbums:i,setListOfChosenAlbums:o},t)}))}),Object(h.jsxs)("div",{className:"authorsShiftButtons",children:[Object(h.jsx)("button",{onClick:function(){var e=f.current.scrollLeft;f.current.scrollLeft=e-220,b(e-220)},style:j<=0?{visibility:"hidden",opacity:"0"}:{},children:Object(h.jsx)(H.e,{})}),Object(h.jsx)("button",{onClick:function(){var e=f.current.scrollLeft;f.current.scrollLeft=e+220,b(e+220)},style:m&&f.current&&f.current.scrollWidth-f.current.offsetWidth!==j?{}:{visibility:"hidden",opacity:"0"},children:Object(h.jsx)(H.f,{})})]})]}):null},Ot=function(e){var t=e.authorsData,n=R().currentUser,c=Object(s.useState)([]),a=Object(l.a)(c,2),r=a[0],i=a[1],o=Object(s.useState)(!0),u=Object(l.a)(o,2),d=u[0],j=u[1];return Object(s.useEffect)((function(){dt(t,i,n.uid,j)}),[t.ownPlaylists]),Object(h.jsx)(ft,{listOfAlbums:r,title:n.isAuthor?"Albums":"Playlists",loading:d})};function pt(e,t,n){var s=[];e.forEach((function(e){var t=e.authors;0!==t.length&&s.push(t)})),s=s.flat();for(var c=new Set(s.map((function(e){return e.uid})).filter((function(e){return e!==t.uid}))),a=Array.from(c),r=[],i=0;i<a.length;i++)for(var o=0;o<s.length;o++)if(a[i]===s[o].uid){r.push(s[o]);break}return n(r),r}function mt(e,t){return xt.apply(this,arguments)}function xt(){return(xt=Object(j.a)(d.a.mark((function e(t,n){var s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0!==t&&void 0!==t.ownSongs&&0!==t.ownSongs.length&&(s=[],t.ownSongs.forEach(function(){var e=Object(j.a)(d.a.mark((function e(c,a){var r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("songs").doc(c).get();case 2:if(r=e.sent.data(),s.push(r),a!==t.ownSongs.length-1){e.next=6;break}return e.abrupt("return",pt(s,t,n));case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var gt=function(e){var t=e.data,n=e.listOfChosenAuthors,s=e.setListOfChosenAuthors;return Object(h.jsxs)(i.b,{to:"/authors/".concat(t.uid),className:"AuthorItemBig",children:[Object(h.jsx)(g,{listOfChosenItems:n,setListOfChosenItems:s,itemId:t.uid}),Object(h.jsxs)("div",{children:[Object(h.jsx)("div",{className:"AuthorItemBigImage",children:Object(h.jsx)("img",{loading:"lazy",src:t.photoURL,alt:""})}),Object(h.jsx)("h3",{children:t.displayName})]})]})},vt=function(e){var t=e.listOfAuthors,n=e.title,c=void 0===n?"":n,a=e.listOfChosenAuthors,r=e.setListOfChosenAuthors,i=Object(s.useState)(0),o=Object(l.a)(i,2),u=o[0],d=o[1],j=Object(s.useRef)(null),b=Object(s.useState)(!1),f=Object(l.a)(b,2),O=f[0],p=f[1];return Object(s.useEffect)((function(){t.length>0&&(j.current.scrollWidth>j.current.offsetWidth&&p(!0))}),[t]),t.length>0?Object(h.jsxs)("div",{className:"AuthorsList",children:[0!==c.length?Object(h.jsx)("h2",{children:c}):null,Object(h.jsx)("div",{className:"authorsWrapper",ref:j,onScroll:function(e){return d(e.target.scrollLeft)},children:t.map((function(e){return Object(h.jsx)(gt,{data:e,listOfChosenAuthors:a,setListOfChosenAuthors:r},e.uid)}))}),Object(h.jsxs)("div",{className:"authorsShiftButtons",children:[Object(h.jsx)("button",{onClick:function(){var e=j.current.scrollLeft;j.current.scrollLeft=e-200,d(e-200)},style:u<=0?{visibility:"hidden",opacity:"0"}:{},children:Object(h.jsx)(H.e,{})}),Object(h.jsx)("button",{onClick:function(){var e=j.current.scrollLeft;j.current.scrollLeft=e+200,d(e+200)},style:O&&null!==j.current&&j.current.scrollWidth-j.current.offsetWidth!==u?{}:{visibility:"hidden",opacity:"0"},children:Object(h.jsx)(H.f,{})})]})]}):null},yt=function(e){var t=e.data,n=Object(s.useState)([]),c=Object(l.a)(n,2),a=c[0],r=c[1];return Object(s.useEffect)((function(){mt(t,r)}),[t]),Object(h.jsx)(vt,{listOfAuthors:a,title:"Similar Authors"})};function St(e){var t=new Date(e.releaseDate);return(new Date).getTime()-t.getTime()<18144e5}var wt=function(e){e.authorId;var t=e.authorsData,n=(e.headerColors,Object(s.useState)([])),c=Object(l.a)(n,2),a=c[0],r=c[1],i=Object(s.useState)([]),o=Object(l.a)(i,2),u=o[0],b=o[1];function f(){return(f=Object(j.a)(d.a.mark((function e(){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r([]),n=[],t.isAuthor?void 0!==t.ownSongs&&0!==t.ownSongs.length&&t.ownSongs.forEach(function(){var e=Object(j.a)(d.a.mark((function e(s,c){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("songs").doc(s).get();case 2:a=e.sent.data(),n.push(a),St(a)&&!u.includes(a)&&b((function(e){return[].concat(Object(m.a)(e),[a])})),c===t.ownSongs.length-1&&(n.sort((function(e,t){return t.listens-e.listens})),r(n));case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()):t.addedSongs.forEach(function(){var e=Object(j.a)(d.a.mark((function e(s,c){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("songs").doc(s).get();case 2:a=e.sent.data(),n.unshift(a),c===t.addedSongs.length-1&&r(n);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){!function(){f.apply(this,arguments)}(),b([])}),[t.ownSongs]),t.isAuthor?Object(h.jsxs)("div",{className:"TopSongs",children:[Object(h.jsx)(We,{listOfSongs:u,source:{source:"/authors/".concat(t.uid),name:t.displayName,image:t.photoURL,songsList:u},isNewSong:!0}),Object(h.jsx)(We,{listOfSongs:a,source:{source:"/authors/".concat(t.uid),name:t.displayName,image:t.photoURL,songsList:a},title:"Popular Songs",showListens:!0,showCount:!0})]}):Object(h.jsx)(We,{listOfSongs:a,source:{source:"/authors/".concat(t.uid),name:t.displayName+"'s Library",image:t.photoURL,songsList:a},title:t.displayName+"'s Library",showListens:!0,showCount:!0})},Nt=(n(263),function(){var e=Object(o.h)("/authors/:authorId"),t=R().currentUser,n=Object(s.useState)([]),c=Object(l.a)(n,2),a=c[0],r=c[1],i=e.params.authorId,u=Object(s.useState)([]),b=Object(l.a)(u,2),f=b[0],O=b[1],p=Object(s.useState)(!0),m=Object(l.a)(p,2),x=m[0],g=m[1];function v(){return(v=Object(j.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:C.collection("users").doc(i).get().then((function(e){e.exists?(O(e.data()),r(e.data().imageColors),g(!1)):console.log("No such document!")})).catch((function(e){console.log("Error getting document:",e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){!function(){v.apply(this,arguments)}()}),[i]),Object(h.jsx)("div",{className:"AuthorPage",style:{animation:"zoomIn .2s forwards"},children:x?Object(h.jsx)(re,{}):Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(et,{data:f,headerColors:a,setHeaderColors:r}),t.uid===f.uid?Object(h.jsx)(lt,{}):null,Object(h.jsx)(it,{data:f}),Object(h.jsx)(wt,{author:i,authorsData:f,headerColors:a}),f.friends&&!f.isAuthor?Object(h.jsx)(ut,{data:f,title:"Friends"}):null,Object(h.jsx)(Ot,{authorsData:f,headerColors:a}),f.isAuthor?Object(h.jsx)(yt,{data:f}):null]})})}),Ct=function(e){var t=e.chatId,n=Object(s.useState)([]),c=Object(l.a)(n,2),a=c[0],r=c[1],i=Object(s.useState)(!0),o=Object(l.a)(i,2),u=o[0],b=o[1],f=Object(s.useState)(0),O=Object(l.a)(f,2),p=O[0],x=O[1],g=[Object(h.jsx)(We,{listOfSongs:a,source:{source:"/chat/".concat(t),name:"Chat with ".concat(t),image:"",songsList:a}}),Object(h.jsx)(vt,{listOfAuthors:a}),Object(h.jsx)(ft,{listOfAlbums:a,loading:u})];function v(e,t){return y.apply(this,arguments)}function y(){return(y=Object(j.a)(d.a.mark((function e(n,s){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("chats").doc(t).get();case 2:e.sent.data().messages.forEach((function(e){e[n].length>0&&e[n].forEach(function(){var e=Object(j.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:C.collection(s).doc(t).get().then((function(e){r((function(t){return[].concat(Object(m.a)(t),[e.data()])}))}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){switch(p){case 0:v("attachedSongs","songs").then((function(){return b(!1)}));break;case 1:v("attachedAuthors","users").then((function(){return b(!1)}));break;case 2:v("attachedAlbums","playlists").then((function(){return b(!1)}))}}),[p]),Object(s.useEffect)((function(){r([])}),[t]),console.log(a),Object(h.jsxs)("div",{className:"AttachmentList",children:[Object(h.jsx)(rt,{pages:["Songs","Authors","Playlists"],currentPage:p,setCurrentPage:function(e){x(e),b(!0),r([])}}),u?Object(h.jsx)(re,{}):a.length>0?g[p]:Object(h.jsx)("h2",{children:"Nothing here"})]})},kt=function(e,t,n,c,a,r,i,o){var l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:[];function u(){return b.apply(this,arguments)}function b(){return(b=Object(j.a)(d.a.mark((function s(){var l;return d.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(l=[],void 0!==n){s.next=15;break}if(void 0===r){s.next=9;break}return s.next=5,C.collection(t).where(r,i,o).get();case 5:s.sent.docs.forEach((function(e){l.push(e.data())})),s.next=13;break;case 9:return s.next=11,C.collection(t).get();case 11:s.sent.docs.forEach((function(e){l.push(e.data())}));case 13:s.next=18;break;case 15:return s.next=17,n.forEach(function(){var e=Object(j.a)(d.a.mark((function e(s,r){var i;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection(t).doc(s).get();case 2:i=e.sent.data(),l.push(i),r===n.length-1&&(void 0!==a?(l.sort(a),c(l)):c(l));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 17:e(!1);case 18:return s.abrupt("return",l);case 19:case"end":return s.stop()}}),s)})))).apply(this,arguments)}Object(s.useEffect)((function(){e(!0),c([]),u().then((function(t){void 0===n&&(c(t),e(!1))}))}),l)},It=n(62),At=function(e){var t=e.data,n=Object(s.useState)([]),c=Object(l.a)(n,2),a=c[0],r=c[1],i=Object(s.useState)(!0),o=Object(l.a)(i,2),u=o[0],b=o[1],f=Object(s.useState)(t.chatName),O=Object(l.a)(f,2),p=O[0],x=O[1],g=Object(s.useState)(t.chatImage),y=Object(l.a)(g,2),S=y[0],w=y[1],k=Object(s.useState)(""),I=Object(l.a)(k,2),A=I[0],P=I[1],L=Object(s.useState)(t.imageColors||[]),T=Object(l.a)(L,2),E=T[0],R=T[1],M=B().setContent,D=Object(s.useState)(0),U=Object(l.a)(D,2),W=U[0],F=U[1],z=Object(s.useState)(!1),V=Object(l.a)(z,2),Q=V[0],q=V[1];function K(){return(K=Object(j.a)(d.a.mark((function e(t,n,s){var c,a,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=t.target.files[0],P(URL.createObjectURL(c)),a=N.ref(),r=a.child(n+c.name),e.next=6,r.put(c);case 6:return e.t0=s,e.next=9,r.getDownloadURL();case 9:e.t1=e.sent,(0,e.t0)(e.t1);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return function(e,t,n,c){function a(){t.forEach(function(){var e=Object(j.a)(d.a.mark((function e(t){var s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("users").doc(t).get();case 2:s=e.sent.data(),n((function(e){return[].concat(Object(m.a)(e),[s])}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e(!1)}Object(s.useEffect)((function(){return e(!0),a(),function(){return a()}}),c)}(b,t.participants,r,[t.id]),Object(s.useEffect)((function(){p.trim()!==t.chatName.trim()||S!==t.chatImage?q(!0):q(!1)}),[p,S]),Object(s.useEffect)((function(){x(t.chatName)}),[t.id]),Object(h.jsxs)("div",{className:"ChatInfo",children:[Object(h.jsx)(pe.a,{src:A,getColors:function(e){return R(e)}}),Object(h.jsxs)("div",{className:"chatInfoImageAndName",children:[Object(h.jsxs)("div",{className:"chatInfoImage",children:[Object(h.jsxs)("label",{className:"changePhoto",children:[Object(h.jsx)(Ae.b,{}),"Change photo",Object(h.jsx)("input",{type:"file",style:{display:"none"},onChange:function(e){return function(e,t,n){return K.apply(this,arguments)}(e,"chatCovers/",w)}})]}),Object(h.jsx)("img",{loading:"lazy",src:S,alt:""})]}),Object(h.jsxs)("div",{children:[Object(h.jsx)("input",{type:"text",className:"standartInput",value:p,onChange:function(e){return x(e.target.value)}}),Object(h.jsxs)("div",{className:"chatInfoButtons",children:[Object(h.jsxs)("button",{className:"chatInfoButton",children:[Object(h.jsx)(H.z,{}),"Settings"]}),Object(h.jsxs)("button",{className:"chatInfoButton",onClick:function(){return M(Object(h.jsx)(Ct,{chatId:t.id}))},children:[Object(h.jsx)(Y.a,{}),me("Attachments",7)]}),Object(h.jsxs)("button",{className:"chatInfoButton",children:[Object(h.jsx)(It.b,{}),"Sound"]})]})]}),Q?Object(h.jsx)("button",{className:"standartButton",onClick:function(){C.collection("chats").doc(t.id).update({chatName:p,chatImage:S,imageColors:E})},children:"Update Chat"}):null]}),Object(h.jsx)("h4",{children:"Chat participants"}),Object(h.jsx)(rt,{pages:["All participants","Administrators"],currentPage:W,setCurrentPage:F}),u?Object(h.jsx)(re,{}):a.map((function(e){return 1!==W||t.admins.includes(e.uid)?Object(h.jsx)(v,{data:e},e.uid):void 0}))]})},Pt=function(e){var t=e.chatId,n=e.image,s=e.currentWallpaper;return Object(h.jsx)("div",{className:"WallpaperItem "+(n===s?"active":""),onClick:function(){C.collection("chats").doc(t).update({wallpaper:n})},style:"undefined"===n?{background:"var(--playlistsColor)"}:{},children:"undefined"!==n?Object(h.jsx)("img",{loading:"lazy",src:n,alt:""}):null})},Lt=function(e){var t=e.chatId,n=e.currentWallpaper,c=Object(s.useState)([]),a=Object(l.a)(c,2),r=a[0],i=a[1],o=Object(s.useState)(!0),u=Object(l.a)(o,2),d=u[0],j=u[1];return kt(j,"chatWallpapers",void 0,i),console.log(r),d?Object(h.jsx)(re,{}):Object(h.jsxs)("div",{className:"Wallpapers",children:[Object(h.jsx)("h2",{children:"Wallpapers"}),Object(h.jsxs)("div",{className:"wallpapreWrapper",children:[Object(h.jsx)(Pt,{chatId:t,image:"undefined"}),r.map((function(e,s){return Object(h.jsx)(Pt,{chatId:t,image:e.image,currentWallpaper:n},e.id)}))]})]})},Tt=function(e){var t=e.chatId,n=e.currentWallpaper,c=e.data,a=Object(s.useState)(),r=Object(l.a)(a,2),i=r[0],o=r[1],u=B(),d=u.toggleModal,j=u.setContent,b=Object(s.useRef)(null);return te(b,o),Object(h.jsxs)("div",{className:"ChatMoreBtn",ref:b,children:[Object(h.jsx)("button",{onClick:function(){return o(!i)},children:Object(h.jsx)(H.s,{})}),Object(h.jsxs)("div",{className:"chatHeaderMenuWindow",style:i?{}:{display:"none"},children:[c.participants.length>2?Object(h.jsxs)("div",{className:"chatHeaderMenuWindowItem",onClick:function(){d(),j(Object(h.jsx)(At,{data:c}))},children:[Object(h.jsx)(H.o,{}),Object(h.jsx)("span",{children:"Info"})]}):null,Object(h.jsxs)("div",{className:"chatHeaderMenuWindowItem",children:[Object(h.jsx)(H.y,{}),Object(h.jsx)("span",{children:"Search messages"})]}),Object(h.jsxs)("div",{className:"chatHeaderMenuWindowItem",onClick:function(){d(),j(Object(h.jsx)(Ct,{chatId:t}))},children:[Object(h.jsx)(H.k,{}),Object(h.jsx)("span",{children:"Attachments"})]}),Object(h.jsxs)("div",{className:"chatHeaderMenuWindowItem",onClick:function(){d(),j(Object(h.jsx)(Lt,{chatId:t,currentWallpaper:n}))},children:[Object(h.jsx)(H.n,{}),Object(h.jsx)("span",{children:"Change wallpaper"})]}),Object(h.jsxs)("div",{className:"chatHeaderMenuWindowItem",children:[Object(h.jsx)(H.B,{}),Object(h.jsx)("span",{children:"Delete chat"})]})]})]})},Et=function(e){var t=e.data,n=R().currentUser,c=B(),a=c.toggleModal,r=c.setContent,o=Object(s.useState)({}),u=Object(l.a)(o,2),b=u[0],f=u[1],O=Object(s.useState)(""===t.chatName?[]:t.imageColors),p=Object(l.a)(O,2),m=p[0],x=p[1];function g(){return(g=Object(j.a)(d.a.mark((function e(){var s,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=t.participants.find((function(e){return e!==n.uid})),e.next=3,C.collection("users").doc(s).get();case 3:c=e.sent.data(),f(c),x(c.imageColors);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){""===t.chatName&&function(){g.apply(this,arguments)}()}),[t.id]),Object(h.jsxs)("div",{className:"ChatHeader",style:m.length?{background:"linear-gradient(45deg, ".concat(m[0],", ").concat(m[1],")")}:{background:"linear-gradient(45deg, grey, lightgrey)"},children:[Object(h.jsx)(_,{}),2===t.participants.length?Object(h.jsxs)(i.b,{className:"chatHeaderImageAndName",to:"/authors/".concat(b.uid),children:[Object(h.jsx)("div",{className:"chatHeaderImage",children:Object(h.jsx)("img",{loading:"lazy",src:b.photoURL||t.chatImage,alt:""})}),Object(h.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center"},children:[Object(h.jsx)("h4",{children:b.displayName||t.chatName}),Object(h.jsx)(Ye,{userUID:b.uid})]})]}):Object(h.jsxs)("div",{className:"chatHeaderImageAndName",onClick:function(){a(),r(Object(h.jsx)(At,{data:t}))},children:[Object(h.jsx)("div",{className:"chatHeaderImage",children:Object(h.jsx)("img",{loading:"lazy",src:b.photoURL||t.chatImage,alt:""})}),Object(h.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center"},children:[Object(h.jsx)("h4",{children:b.displayName||t.chatName}),Object(h.jsx)(Ye,{userUID:b.uid})]})]}),Object(h.jsx)(Tt,{chatId:t.id,data:t,currentWallpaper:t.wallpaper})]})};function Rt(e){return e.attachedSongs.length?"Audio":e.attachedAlbums.length?"Album":e.attachedAuthors.length?"Author":e.inResponseToMessage&&e.inResponseToMessage.length?"Forwarded message":""}var Mt=function(e){var t=e.attachedItems,n=e.setAttachedItems,s=e.icon;return Object(h.jsx)("div",{className:"AttachedItemsInChatInput",children:t.map((function(e,c){return Object(h.jsxs)("div",{className:"attachedSongItem",children:[s,Object(h.jsx)("span",{children:e}),Object(h.jsx)("button",{className:"removeMessageFromResponse",onClick:function(){return function(e,t,n){t(e.filter((function(e){return e!==n})))}(t,n,e)},children:Object(h.jsx)(H.H,{})})]},e)}))})},Dt=function(e){var t=e.chatId,n=e.chatData,c=e.messageText,a=e.setMessageText,r=e.inResponseToMessage,i=e.setInResponseToMessage,o=e.otherMessages,u=R().currentUser,b=Object(s.useState)(!1),f=Object(l.a)(b,2),O=f[0],p=f[1],x=F(),g=x.yourSongs,v=x.yourAuthors,y=x.yourPlaylists,S=Object(s.useState)(""),w=Object(l.a)(S,2),N=w[0],k=w[1],I=Object(s.useState)(g),A=Object(l.a)(I,2),P=A[0],L=A[1],T=Object(s.useState)([]),E=Object(l.a)(T,2),M=(E[0],E[1],Object(s.useState)([])),D=Object(l.a)(M,2),B=D[0],U=D[1],W=Object(s.useState)([]),z=Object(l.a)(W,2),V=z[0],Q=z[1],q=Object(s.useState)([]),K=Object(l.a)(q,2),X=K[0],G=K[1],J=Object(s.useState)(y),_=Object(l.a)(J,2),Z=_[0],$=_[1],ne=Object(s.useState)(v),se=Object(l.a)(ne,2),ce=se[0],ae=se[1],re=Object(s.useState)([]),le=Object(l.a)(re,2),de=le[0],je=le[1],be=Object(s.useState)([]),he=Object(l.a)(be,2),fe=he[0],Oe=he[1],pe=Object(s.useRef)(null);function xe(){oe(t,n,u.uid,c,B,V,X,r),a(""),U([]),G([]),Q([]),i([]),p(!1)}return te(pe,p),Object(s.useEffect)((function(){0===N.length&&L(g)}),[N]),Object(s.useEffect)((function(){if(0===c.length)C.collection("chats").doc(t).update({typing:n.typing.filter((function(e){return e!==u.uid}))});else if(!n.typing.includes(u.uid)){var e=n.typing;e.push(u.uid),C.collection("chats").doc(t).update({typing:e})}}),[c]),Object(s.useEffect)((function(){je([]),r.forEach(function(){var e=Object(j.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("users").doc(o[t].sender).get();case 2:n=e.sent.data().displayName,je((function(e){return[].concat(Object(m.a)(e),[n])}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[r.length]),Object(s.useEffect)((function(){Oe([]),B.forEach(function(){var e=Object(j.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("songs").doc(t).get();case 2:n=e.sent.data().name,Oe((function(e){return[].concat(Object(m.a)(e),[n])}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[B.length]),Object(h.jsxs)("div",{className:"chatInput",style:O?{borderRadius:"0 0 var(--standartBorderRadius) var(--standartBorderRadius)",transition:".2s"}:{},ref:pe,children:[Object(h.jsx)("div",{className:"attachWindow",style:O?{height:"400px",opacity:"1"}:{},children:O?Object(h.jsxs)("div",{style:O?{maxHeight:"100%",overflowY:"auto"}:{display:"none"},children:[Object(h.jsx)(ue,{value:N,setValue:k,setAllFoundSongs:L,setResultPlaylists:$,setResultAuthorList:ae}),Object(h.jsx)(We,{listOfSongs:P,source:"no",listOfChosenSongs:B,setListOfSongs:U}),Object(h.jsx)(vt,{listOfAuthors:ce,listOfChosenAuthors:X,setListOfChosenAuthors:G}),Object(h.jsx)(ft,{listOfAlbums:Z,loading:!1,listOfChosenAlbums:V,setListOfChosenAlbums:Q})]}):null}),Object(h.jsxs)("div",{className:"inResponseArea",style:r.length||fe.length||X.length||V.length?{}:{height:"0",padding:"0",opacity:"0",top:"0",visibility:"hidden"},children:[Object(h.jsx)("div",{className:"responseMessages",children:r.map((function(e,t){return Object(h.jsxs)("div",{className:"responseItem",children:[Object(h.jsx)("h5",{style:o[e].sender===u.uid?{color:"var(--lightPurple)"}:{},children:de[t]}),Object(h.jsxs)("p",{children:[me(o[e].message,35),Object(h.jsx)("span",{style:{marginLeft:"5px",color:"var(--reallyLightBlue)"},children:Rt(o[e])})]}),Object(h.jsx)("button",{onClick:function(){return t=e,void i(r.filter((function(e){return e!==t})));var t},className:"removeMessageFromResponse",children:Object(h.jsx)(H.H,{})})]},e)}))}),Object(h.jsx)(Mt,{attachedItems:B,setAttachedItems:U,icon:Object(h.jsx)(ee.c,{})}),Object(h.jsx)(Mt,{attachedItems:X,setAttachedItems:G,icon:Object(h.jsx)(H.D,{})}),Object(h.jsx)(Mt,{attachedItems:V,setAttachedItems:Q,icon:Object(h.jsx)(ie.a,{})})]}),Object(h.jsxs)("div",{className:"attachAndEmojis",children:[Object(h.jsx)("div",{className:"attachBtn",children:Object(h.jsx)("button",{onClick:function(){p(!O)},children:Object(h.jsx)(Y.a,{})})}),Object(h.jsx)("input",{type:"text",style:{background:"var(--lightGrey)",border:"none",outline:"none",minHeight:"100%"},value:c,onChange:function(e){a(e.target.value)},onKeyUp:function(e){"Enter"===e.key&&xe()}})]}),Object(h.jsx)("button",{className:"sendBtn",onClick:function(){xe()},children:Object(h.jsx)(Ae.d,{})})]})},Bt=function(e){var t=e.date;return Object(h.jsx)("div",{className:"DateOnTop",children:q(t)})},Ut=n(81),Wt=n(48);function Ft(e){var t=Object(s.useState)(!1),n=Object(l.a)(t,2),c=n[0],a=n[1],r=new IntersectionObserver((function(e){var t=Object(l.a)(e,1)[0];return a(t.isIntersecting)}));return Object(s.useEffect)((function(){return r.observe(e.current),function(){r.disconnect()}}),[]),c}var zt=function(){return Object(h.jsx)("div",{className:"SongItem SongItemLoading",children:Object(h.jsxs)("div",{className:"songItemImageAndName",children:[Object(h.jsx)("div",{className:"songItemImage"}),Object(h.jsxs)("div",{className:"songItemNameAndAuthor",children:[Object(h.jsx)("div",{className:"songItemName"}),Object(h.jsx)("div",{className:"songItemAuthor"})]})]})})},Ht=function(e){var t=e.listOfSeen;return Object(h.jsx)("div",{className:"SeenByCircle",style:void 0!==t?t.length<=1?{opacity:"1",visibility:"visible"}:{}:null})},Yt=function(e){var t=e.messageData,n=e.chatId,c=e.scrollToMessageRef,a=e.setScrollToMessageId,r=e.scrollToMessageId,i=e.showPhoto,o=void 0===i||i,u=e.otherMessages,b=e.inResponseToMessageArr,f=e.setInResponseToMessageArr,O=R().currentUser,p=X(),x=p.isMobile,g=p.screenHeight,v=t.message,y=t.attachedAlbums,S=t.attachedSongs,w=t.attachedAuthors,N=t.sender,k=t.inResponseToMessage,I=t.id,A=t.sentTime,P=Object(s.useState)({}),L=Object(l.a)(P,2),T=L[0],E=L[1],M=q(A,2),D=Object(s.useState)([]),B=Object(l.a)(D,2),U=B[0],W=B[1],F=Object(s.useState)([]),z=Object(l.a)(F,2),H=z[0],Y=z[1],V=Object(s.useState)([]),Q=Object(l.a)(V,2),K=Q[0],G=Q[1],J=Object(s.useState)([]),_=Object(l.a)(J,2),Z=_[0],$=_[1],ee=Object(s.useState)([]),te=Object(l.a)(ee,2),ne=te[0],se=te[1],ce=Object(s.useRef)(),ae=Ft(ce),re=Object(s.useState)(0),oe=Object(l.a)(re,2),le=oe[0],ue=oe[1],de=Object(s.useState)(0),be=Object(l.a)(de,2),he=be[0],fe=be[1],Oe=Object(Wt.useSwipeable)({onSwiping:function(e){e.deltaX<0&&ue(e.deltaX)}});function pe(){return(pe=Object(j.a)(d.a.mark((function e(){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("users").doc(t.sender).get();case 2:n=e.sent.data(),E(n);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function me(e,t,n){return e.forEach(function(){var e=Object(j.a)(d.a.mark((function e(s){var c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection(t).doc(s).get();case 2:(c=e.sent).exists?n((function(e){return[].concat(Object(m.a)(e),[c.data()])})):n((function(e){return[].concat(Object(m.a)(e),[null])}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}function xe(){b.includes(I)||f((function(e){return[].concat(Object(m.a)(e),[I])}))}function ge(){var e;clearTimeout(e),fe(.2),e=setTimeout((function(){ue(0),fe(0)}),200)}Object(s.useEffect)((function(){if(void 0!==t.seenBy&&O.uid!==t.sender&&ae&&!t.seenBy.includes(O.uid)){var e=u;e[t.id].seenBy.push(O.uid),C.collection("chats").doc(n).update({messages:e})}}),[ae]),Object(s.useEffect)((function(){!function(){pe.apply(this,arguments)}(),me(S,"songs",W),me(w,"users",Y),me(y,"playlists",G),null!==k&&k.forEach(function(){var e=Object(j.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return $((function(e){return[].concat(Object(m.a)(e),[u[t]])})),e.next=3,C.collection("users").doc(u[t].sender).get();case 3:n=e.sent.data().displayName,se((function(e){return[n].concat(Object(m.a)(e))}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]),Object(s.useEffect)((function(){le<-160&&(ge(),xe())}),[le]);Ut.a,je.a,je.c;return Object(h.jsxs)("div",{className:"MessageItem "+(N===O.uid?"your":""),ref:I===r?c:function(e){Oe.ref(e),ce.current=e},style:ae?o?{paddingBottom:"15px",transform:"translateX(".concat(le,"px)"),transition:he}:{transform:"translateX(".concat(le,"px)"),transition:he}:{opacity:"0",visibility:"hidden"},onTouchEnd:ge,children:[Object(h.jsx)("div",{className:"messageItemImage",children:o?Object(h.jsx)("img",{loading:"lazy",src:T.photoURL,alt:""}):null}),Object(h.jsxs)("div",{className:"messageItemBody",style:I===r?{animation:"showResponseMessage .5s forwards"}:o?{borderRadius:"var(--standartBorderRadius2) var(--standartBorderRadius) var(--standartBorderRadius) 5px"}:{},children:[Object(h.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"5px"},children:[Object(h.jsx)("h5",{className:"messageUserName",children:T.displayName}),Object(h.jsx)("div",{style:{fontSize:".7em",opacity:".8",marginLeft:"10px"},children:M})]}),null!==k?Z.map((function(e,t){return Object(h.jsxs)("div",{className:"responseItem",onClick:function(){return a(e.id)},children:[Object(h.jsxs)("span",{style:{display:"flex",alignItems:"center"},children:[Object(h.jsx)("h5",{style:e.sender===O.uid?{color:"var(--lightPurple)"}:{},children:ne[t]}),Object(h.jsx)("div",{style:{fontSize:".7em",opacity:".8",marginLeft:"10px"},children:q(e.sentTime,2)})]}),Object(h.jsxs)("p",{children:[e.message,Object(h.jsx)("span",{style:{marginLeft:"5px",color:"var(--reallyLightBlue)"},children:Rt(e)})]})]})})):null,Object(h.jsxs)("div",{children:[Object(h.jsx)("p",{children:v}),U.map((function(e,t){return ae?Object(h.jsx)(De,{song:e,localIndex:t,position:g},t):Object(h.jsx)(zt,{})})),K.map((function(e,t){return Object(h.jsx)(ht,{playlist:e},t)})),H.map((function(e,t){return Object(h.jsx)(gt,{data:e},t)}))]})]}),Object(h.jsx)(Ht,{listOfSeen:t.seenBy}),Object(h.jsx)("button",{className:"respondToMessageBtn",onClick:xe,style:x?{opacity:-le/80}:{},children:Object(h.jsx)(ie.n,{})})]})},Vt=function(e){var t=e.message,n=e.index,c=e.messageList,a=e.chatId,r=e.inResponseToMessage,i=e.setInResponseToMessage,o=e.scrollToMessageRef,u=e.scrollToMessageId,d=e.setScrollToMessageId,j=e.setDateRefsArray,b=Object(s.useState)(!1),f=Object(l.a)(b,2),O=f[0],p=f[1],x=Object(s.useState)(!1),g=Object(l.a)(x,2),v=g[0],y=g[1],S=Object(s.useRef)(null);return Object(s.useEffect)((function(){(n===c.length-1||c[n+1].sender!==c[n].sender||q(c[n+1].sentTime)!==q(c[n].sentTime))&&p(!0),(0===n||q(c[n].sentTime)!==q(c[n-1].sentTime))&&y(!0)}),[]),Object(s.useEffect)((function(){null!==S.current&&j((function(e){return[].concat(Object(m.a)(e),[S])}))}),[v]),Object(h.jsxs)(h.Fragment,{children:[v?Object(h.jsx)("div",{ref:S,style:{width:"100%",display:"flex",justifyContent:"center",alignItems:"center",padding:"10px 0"},children:q(t.sentTime)}):null,Object(h.jsx)(Yt,{messageData:t,chatId:a,scrollToMessageRef:o,scrollToMessageId:u,setScrollToMessageId:d,showPhoto:O,otherMessages:c,inResponseToMessageArr:r,setInResponseToMessageArr:i},t.id)]})},Qt=function(e){var t=e.chatId,n=e.messageList,c=e.inResponseToMessage,a=e.setInResponseToMessage,r=e.messagesWindowRef,i=e.setDateRefsArray,o=Object(s.useRef)(null),u=Object(s.useState)(-1),d=Object(l.a)(u,2),j=d[0],b=d[1];return Object(s.useEffect)((function(){-1!==j&&(r.current.scrollTo(0,o.current.offsetTop-65<0?0:o.current.offsetTop-65),setTimeout((function(){b(-1)}),500))}),[j]),n.length?Object(h.jsx)(h.Fragment,{children:n.map((function(e,s){return Object(h.jsx)(Vt,{message:e,index:s,messageList:n,chatId:t,inResponseToMessage:c,setInResponseToMessage:a,scrollToMessageRef:o,scrollToMessageId:j,setScrollToMessageId:b,setDateRefsArray:i},e.id)}))}):null},qt=function(e){var t=e.typingPeople,n=Object(s.useState)([]),c=Object(l.a)(n,2),a=c[0],r=c[1],i=R().currentUser;return Object(s.useEffect)((function(){r([]),t.map(function(){var e=Object(j.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("users").doc(t).get();case 2:(n=e.sent.data()).uid!==i.uid&&r((function(e){return[].concat(Object(m.a)(e),[n])}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[t]),a.length>0?Object(h.jsxs)("div",{className:"typingWrapper",children:[Object(h.jsx)(Z,{imagesList:a.map((function(e){return e.photoURL})),borderColor:"var(--navItemColor)"}),Object(h.jsxs)("div",{className:"TypingAnimation",children:[Object(h.jsx)("span",{className:"typingCircle"}),Object(h.jsx)("span",{className:"typingCircle"}),Object(h.jsx)("span",{className:"typingCircle"})]})]}):null},Kt=function(e){var t=e.chatId,n=e.chatData,c=e.messageList,a=e.findTopDate,r=e.inResponseToMessage,i=e.setInResponseToMessage,o=e.setDateRefsArray,l=X(),u=l.screenHeight,d=l.isMobile,j=Object(s.useRef)(null);return Object(s.useEffect)((function(){!function(){var e,t,n,s=(null===(e=j.current)||void 0===e?void 0:e.scrollHeight)-(null===(t=j.current)||void 0===t?void 0:t.clientHeight);null===(n=j.current)||void 0===n||n.scrollTo(0,s)}()}),[c]),Object(h.jsxs)("div",{className:"chatMessagesWindow",ref:j,onScroll:a,style:{height:d?u-125+"px":u-170+"px"},children:[Object(h.jsx)(Qt,{chatId:t,messageList:c,inResponseToMessage:r,setInResponseToMessage:i,messagesWindowRef:j,setDateRefsArray:o}),Object(h.jsx)(qt,{typingPeople:n.typing})]})},Xt=function(){var e=Object(o.h)("/chat/:chatId"),t=(X().screenHeight,R().currentUser),n=e.params.chatId,c=Object(s.useState)(""),a=Object(l.a)(c,2),r=a[0],i=a[1],u=Object(s.useState)([]),d=Object(l.a)(u,2),j=d[0],b=d[1],f=Object(s.useState)([]),O=Object(l.a)(f,2),p=O[0],m=O[1],x=Object(o.g)(),g=function(e,t){var n=Object(s.useState)([]),c=Object(l.a)(n,2),a=c[0],r=c[1],i=Object(s.useState)([]),o=Object(l.a)(i,2),u=o[0],d=o[1],j=Object(s.useState)(!0),b=Object(l.a)(j,2),h=b[0],f=b[1],O=Object(s.useState)(""),p=Object(l.a)(O,2),m=p[0],x=p[1];return Object(s.useEffect)((function(){var t=C.collection("chats").doc(e).onSnapshot((function(e){r(e.data()),d(e.data().messages),x(e.data().messages.length?e.data().messages[0].sentTime:(new Date).toString()),f(!1)}));return function(){t()}}),[C,e]),[a,u,h,m,function(e){t.forEach((function(t){null!==t.current&&t.current.offsetTop-70<=e.target.scrollTop&&x(t.current.innerHTML)}))}]}(n,p),v=Object(l.a)(g,5),y=v[0],S=v[1],w=v[2],N=v[3],k=v[4];return Object(s.useEffect)((function(){void 0!==y.participants&&(y.participants.includes(t.uid)||x.push("/chat"))}),[y]),Object(h.jsxs)("div",{className:"DialoguePage",style:{height:"100%"},children:[w?Object(h.jsx)(re,{top:"50%"}):Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(Et,{data:y}),Object(h.jsx)(Bt,{date:N}),Object(h.jsx)(Kt,{chatId:n,chatData:y,messageList:S,findTopDate:k,setDateRefsArray:m,inResponseToMessage:j,setInResponseToMessage:b}),Object(h.jsx)(Dt,{chatId:n,chatData:y,messageText:r,setMessageText:i,inResponseToMessage:j,setInResponseToMessage:b,otherMessages:S})]}),"undefined"!==y.wallpaper?Object(h.jsx)("img",{loading:"lazy",src:y.wallpaper,className:"chatWallpaper",alt:""}):null]})},Gt=(n(264),function(){var e=Object(o.g)();return Object(h.jsxs)("div",{className:"PageNotFound",children:[Object(h.jsx)("img",{loading:"lazy",src:"https://i.pinimg.com/originals/b2/3d/f6/b23df649311586e74a8455c92eb3d76b.png",alt:""}),Object(h.jsx)("h2",{children:"Page not found"}),Object(h.jsx)("button",{className:"standartButton",onClick:function(){return e.push("/library")},children:"Back to library"})]})}),Jt="/login",_t="/signup",Zt="/home",$t="/library",en="/search",tn="/chat",nn=function(){return Object(h.jsxs)("div",{className:"BlurredBg",children:[Object(h.jsx)("div",{className:"circle circle1"}),Object(h.jsx)("div",{className:"circle circle2"}),Object(h.jsx)("div",{className:"circle circle3"}),Object(h.jsx)("div",{className:"circle circle4"}),Object(h.jsx)("div",{className:"circle circle5"})]})},sn=function(e){var t=e.title;return Object(h.jsxs)("div",{className:"titleAndLogo",children:[Object(h.jsx)("div",{className:"title",children:Object(h.jsx)("h1",{children:t})}),Object(h.jsx)("div",{className:"logo",children:Object(h.jsx)("img",{loading:"lazy",src:b,alt:""})})]})},cn=(n(265),n(266),function(){var e=Object(s.useState)([]),t=Object(l.a)(e,2),n=t[0],c=t[1],a=Object(s.useState)(0),r=Object(l.a)(a,2),i=r[0],o=r[1],u=Object(s.useState)(!0),b=Object(l.a)(u,2),f=b[0],O=b[1],p=Object(s.useState)({}),x=Object(l.a)(p,2),g=x[0],v=x[1],y=Object(s.useState)({}),S=Object(l.a)(y,2),w=S[0],N=S[1],I=Object(s.useState)({}),A=Object(l.a)(I,2),P=A[0],L=A[1];function T(e,t,n){return E.apply(this,arguments)}function E(){return(E=Object(j.a)(d.a.mark((function e(t,n,s){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection(n).orderBy(s,"desc").limit(1).get();case 2:a=e.sent.docs[0].data(),t(a),c((function(e){return[].concat(Object(m.a)(e),[a.imageColors[0]])})),"playlists"===n&&O(!1);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){T(v,"users","subscribers"),T(N,"songs","listens"),T(L,"playlists","listens")}),[]),Object(h.jsx)("div",{className:"MainBanner",style:{background:n[i]},children:f?Object(h.jsx)(re,{}):Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("div",{className:"slider",children:[Object(h.jsxs)("div",{className:"sliderItem "+(0===i?"current":""),style:{transform:"translateX(-".concat(100*i,"%)")},children:[Object(h.jsx)("h3",{children:"Most popular artist on platform"}),Object(h.jsx)(gt,{data:g})]}),Object(h.jsxs)("div",{className:"sliderItem "+(1===i?"current":""),style:{transform:"translateX(-".concat(100*i,"%)")},children:[Object(h.jsx)("h3",{children:"Most popular song on platform"}),Object(h.jsx)(De,{song:w,localIndex:0,showListens:!0})]}),Object(h.jsxs)("div",{className:"sliderItem "+(2===i?"current":""),style:{transform:"translateX(-".concat(100*i,"%)")},children:[Object(h.jsx)("h3",{children:"Most popular album on platform"}),Object(h.jsx)(ht,{playlist:P})]})]}),Object(h.jsxs)("div",{className:"sliderBtns",children:[Object(h.jsx)("button",{onClick:function(){return o(k(i-1,2,0))},children:Object(h.jsx)(ie.c,{})}),Object(h.jsx)("button",{onClick:function(){return o(k(i+1,2,0))},children:Object(h.jsx)(ie.d,{})})]})]})})}),an=function(){var e=F().yourAuthors,t=Object(s.useState)([]),n=Object(l.a)(t,2),c=n[0],a=n[1];return Object(s.useEffect)((function(){void 0!==e&&0!==e.length&&0===c.length&&function(){var t=[];e.forEach((function(e,n){e.ownSongs.forEach(function(){var e=Object(j.a)(d.a.mark((function e(n){var s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("songs").doc(n).get();case 2:St(s=e.sent.data())&&!t.includes(s.id)&&(a((function(e){return[].concat(Object(m.a)(e),[s])})),t.push(s.id));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}))}()}),[]),Object(h.jsx)("div",{children:Object(h.jsx)(We,{listOfSongs:c,source:{source:"/home",name:"New Songs",image:"",songsList:c},title:"New Songs",isNewSong:!0})})},rn=function(){var e=F().yourAuthors,t=Object(s.useState)([]),n=Object(l.a)(t,2),c=n[0],a=n[1],r=Object(s.useState)([]),i=Object(l.a)(r,2),o=i[0],u=i[1],d=R().currentUser;return Object(s.useEffect)((function(){void 0!==e&&e.forEach((function(e){mt(e,a)}))}),[]),Object(s.useEffect)((function(){c.forEach((function(e){var t=o.map((function(e){return e.uid}));d.addedAuthors.includes(e.uid)||t.includes(e.uid)||u((function(t){return[].concat(Object(m.a)(t),[e])}))}))}),[c]),Object(h.jsx)("div",{className:"RecommendedAuthors",children:Object(h.jsx)(vt,{listOfAuthors:o,title:"Recommended Authors"})})},on=function(e){var t=e.message,n=e.image,s=e.button;return Object(h.jsx)("div",{className:"importantMessage",children:Object(h.jsxs)("div",{children:[n?Object(h.jsx)("img",{loading:"lazy",src:n,alt:""}):null,Object(h.jsx)("h3",{children:t}),s||null]})})},ln=function(){var e=F().yourAuthors,t=R().currentUser,n=Object(s.useState)([]),c=Object(l.a)(n,2),a=c[0],r=c[1];return Object(s.useEffect)((function(){!function(){var n=[];e.forEach((function(e,s){e.ownSongs.forEach(function(){var e=Object(j.a)(d.a.mark((function e(s,c){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("songs").doc(s).get();case 2:a=e.sent.data(),!t.addedSongs.includes(s)&&!n.includes(a.id)&&c<=3&&(r((function(e){return[].concat(Object(m.a)(e),[a])})),n.push(a.id));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}))}()}),[]),Object(h.jsx)("div",{className:"RecommendedSongs",children:Object(h.jsx)(We,{listOfSongs:a,source:{source:"/home",name:"Recommended Songs",image:"",songsList:a},title:"Recommended Songs",displayIfEmpty:Object(h.jsx)(on,{message:"No songs recommended. Add favorite authors so we could know what to recommend",image:"https://i.pinimg.com/originals/b2/3d/f6/b23df649311586e74a8455c92eb3d76b.png"})})})},un=function(){var e=Object(s.useState)([]),t=Object(l.a)(e,2),n=t[0],c=t[1],a=Object(s.useState)(!0),r=Object(l.a)(a,2),i=r[0],o=r[1];return Object(s.useEffect)((function(){o(!0),C.collection("songs").orderBy("listens","desc").limit(15).get().then((function(e){e.docs.forEach((function(e){c((function(t){return[].concat(Object(m.a)(t),[e.data()])}))})),o(!1)}))}),[]),i?Object(h.jsx)(re,{}):Object(h.jsx)(We,{listOfSongs:n,source:{source:"/home",name:"Top 15 Songs",image:"https://media.istockphoto.com/vectors/fire-icon-illustration-for-design-stock-vector-vector-id931601050?k=6&m=931601050&s=170667a&w=0&h=fhRQfwwsW6aXK9OSDM-yj842SFFl2Q9ll6ch-xCK5es=",songsList:n},title:"Top 15 Songs",showListens:!0,showCount:!0})},dn=(n(267),n(268),n.p+"static/media/wave2.f62cb572.svg"),jn=function(e){var t=e.playlist,n=F(),c=n.setCurrentSongQueue,a=n.setCurrentSongPlaylistSource,r=n.playSong,o=n.setCurrentSongInQueue,u=n.setCurrentSong,b=n.currentSongPlaylistSource,f=n.songRef,O=n.setPlay,p=n.play,x=Object(s.useState)([]),g=Object(l.a)(x,2),v=g[0],y=g[1];return Object(s.useEffect)((function(){v.length&&(c(v),o(0),u(v[0].id),f.current.play(),O(!0),a({source:"/albums/".concat(t.id),name:t.name,image:t.image,songsList:v}))}),[v.length]),Object(h.jsx)(i.b,{to:"/albums/".concat(t.id),className:"playlistWrapper",children:Object(h.jsxs)("div",{className:"library playlistItem",style:{backgroundImage:"url(".concat(t.image,")")},children:[t.image?null:Object(h.jsxs)("h1",{children:[t.name.split(" ")[0][0],t.name.split(" ")[1][0]]}),Object(h.jsx)("h2",{style:{background:t.imageColors[2]},children:me(t.name,10)}),Object(h.jsx)("button",{onClick:function(e){e.preventDefault(),b.name!==t.name?0!==t.length&&t.songs.map(function(){var e=Object(j.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("songs").doc(t).get();case 2:n=e.sent.data(),y((function(e){return[].concat(Object(m.a)(e),[n])}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()):r()},children:b.name===t.name&&p?Object(h.jsx)(fe.b,{}):Object(h.jsx)(fe.c,{})})]})})},bn=function(e){return e<1990&&e>=1780?7:e<1780&&e>=1570?6:e<1570&&e>=1360?5:e<1360&&e>=1150?4:e<1150&&e>=1e3?3:e<1e3&&e>=892?6:e<892&&e>=754?5:e<754&&e>=614?4:e<614&&e>=464?3:2},hn=function(){var e=F(),t=e.yourSongs,n=e.yourPlaylists,c=(e.setYourSongs,R().currentUser),a=X().screenWidth,r=Object(s.useState)(bn(a)),i=Object(l.a)(r,2),o=i[0],u=i[1];return Object(s.useEffect)((function(){u(bn(a))}),[a]),Object(h.jsxs)("div",{className:"SongsPage",children:[Object(h.jsxs)("div",{className:"playLists",children:[Object(h.jsx)("div",{className:"playlistContent",children:n.length?n.map((function(e,t){if(t<o)return Object(h.jsx)(jn,{playlist:e},t)})):Object(h.jsx)("h3",{style:{position:"absolute",left:"50%",top:"40%",transform:"translate(-50%, -50%)"},children:"You don't have playlists"})}),Object(h.jsx)("div",{className:"playlistsBackground",children:Object(h.jsx)("img",{loading:"lazy",src:dn,alt:"erwerrnjeqjweqwqeqwewerbjfrwjfbewjerbh"})})]}),Object(h.jsx)("div",{className:"yourSongsList",children:Object(h.jsx)(We,{listOfSongs:t,source:{source:"/library",name:"Your Library",image:c.photoURL,songsList:t},showSearch:!0,displayIfEmpty:Object(h.jsx)("h3",{children:"Your library is empty"})})})]})},fn=function(){return Object(h.jsx)("div",{className:"CreatePlaylistPage",children:Object(h.jsx)(nt,{})})},On=function(){var e=F().yourPlaylists,t=B(),n=t.toggleModal,s=t.setContent;return Object(h.jsxs)("div",{className:"PlaylistsPage",children:[Object(h.jsxs)("button",{className:"createPlaylistBtn",onClick:function(){n(),s(Object(h.jsx)(fn,{}))},children:[Object(h.jsx)(ie.i,{}),"Create Playlist"]}),Object(h.jsx)("div",{className:"playlistsContainer",children:e&&e.map((function(e,t){return Object(h.jsx)(ht,{playlist:e},e.id)}))})]})},pn=function(){var e=F().yourAuthors;return Object(h.jsx)("div",{className:"AuthorsPage",children:Object(h.jsx)("div",{className:"authorsContainer",children:e.map((function(e){return Object(h.jsx)(gt,{data:e},e.uid)}))})})};var mn=function(e){var t=e.userUID,n=Object(s.useState)(!1),c=Object(l.a)(n,2),a=c[0],r=c[1];return Object(s.useEffect)((function(){var e=C.collection("users").doc(t).onSnapshot((function(e){if(void 0!==t){var n=(new Date).getTime()-3e5,s=e.data().online>n;r(s)}}));return function(){e()}}),[C,t]),a?Object(h.jsx)("div",{className:"onlineCircle"}):null},xn=function(e){var t=e.amountOfUnseen;return 0!==t?Object(h.jsx)("div",{className:"AmountOfUnseenMessages",children:t}):null},gn=n(82),vn=function(e){var t=e.messages,n=R().currentUser,c=Object(s.useState)(""),a=Object(l.a)(c,2),r=a[0],i=a[1],o=Object(s.useState)(!1),u=Object(l.a)(o,2),b=u[0],f=u[1],O=Object(s.useState)(""),p=Object(l.a)(O,2),m=p[0],x=p[1],g=[null,Object(h.jsx)(H.u,{}),Object(h.jsx)(ie.a,{}),Object(h.jsx)(H.D,{})],v=Object(s.useState)(0),y=Object(l.a)(v,2),S=y[0],w=y[1];function N(){return(N=Object(j.a)(d.a.mark((function e(){var n,s,c,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t){e.next=22;break}if(n=t[t.length-1],x((function(e){return e+n.message})),f(0!==n.message.length),!n.attachedSongs.length){e.next=10;break}return e.next=7,C.collection("songs").doc(n.attachedSongs[0]).get();case 7:s=e.sent.data().name,w(1),i((function(e){return e+s}));case 10:if(!n.attachedAlbums.length){e.next=16;break}return e.next=13,C.collection("playlists").doc(n.attachedAlbums[0]).get();case 13:(c=e.sent).exists?i((function(e){return e+c.data().name})):i((function(e){return e+"Deleted Album "})),w(2);case 16:if(!n.attachedAuthors.length){e.next=22;break}return e.next=19,C.collection("users").doc(n.attachedAuthors[0]).get();case 19:a=e.sent.data().displayName,w(3),i((function(e){return e+a}));case 22:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){!function(){N.apply(this,arguments)}()}),[]),Object(h.jsxs)("div",{className:"messageShowOutside",children:[t[t.length-1].sender===n.uid?Object(h.jsx)("span",{style:{marginRight:"5px"},children:"You:"}):null,me(m,30),b&&r.length?Object(h.jsx)(gn.a,{}):null,g[S],r,Object(h.jsx)(Ht,{listOfSeen:t[t.length-1].seenBy})]})},yn=function(e){var t=e.chatData,n=R().currentUser,c=t.chatName,a=t.chatImage,r=t.participants,o=t.messages,u=Object(s.useState)({}),b=Object(l.a)(u,2),f=b[0],O=b[1],p=Object(s.useState)(0),m=Object(l.a)(p,2),x=m[0],g=m[1];function v(){return(v=Object(j.a)(d.a.mark((function e(){var t,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.find((function(e){return e!==n.uid})),e.next=3,C.collection("users").doc(t).get();case 3:s=e.sent.data(),O(s);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){g(function(e,t){return e.reduce((function(e,n){return n.sender===t.uid||void 0===n.seenBy||n.seenBy.includes(t.uid)?e:(console.log("i'm here"),++e)}),0)}(o,n))}),[]),Object(s.useEffect)((function(){""===c&&function(){v.apply(this,arguments)}()}),[]),t?Object(h.jsx)(i.b,{to:"/chat/".concat(t.id),children:Object(h.jsxs)("div",{className:"ChatItem "+(x>0?"unseen":""),children:[Object(h.jsx)("div",{className:"chatItemImage",children:Object(h.jsx)("img",{loading:"lazy",src:a||f.photoURL,alt:""})}),Object(h.jsx)(mn,{userUID:f.uid}),Object(h.jsxs)("div",{style:{width:"100%"},children:[Object(h.jsxs)("h4",{style:{display:"flex",justifyContent:"space-between",width:"100%"},children:[Object(h.jsx)("span",{children:c||f.displayName}),Object(h.jsxs)("div",{children:[o.length?Object(h.jsx)("span",{style:{opacity:".6",fontWeight:"500",fontSize:".8em"},children:q(o[o.length-1].sentTime,t&&Date.now()-new Date(o[o.length-1].sentTime).getTime()>86e6?0:2)}):null,Object(h.jsx)(xn,{amountOfUnseen:x})]})]}),o.length?Object(h.jsx)("p",{style:o[o.length-1].sender!==n.uid?{color:"#fff"}:{},children:Object(h.jsx)(vn,{messages:o})}):null]})]})}):null},Sn=(n(269),function(){var e=R().currentUser,t=F().yourFriends,n=Object(s.useState)(""),c=Object(l.a)(n,2),a=c[0],r=c[1],i=Object(s.useState)(t),u=Object(l.a)(i,2),d=u[0],j=u[1],b=Object(s.useState)([]),f=Object(l.a)(b,2),O=f[0],p=f[1],x=Object(s.useState)(""),g=Object(l.a)(x,2),y=g[0],S=g[1],w=Object(s.useState)(""),N=Object(l.a)(w,2),C=N[0],k=N[1],I=Object(s.useState)(""),A=Object(l.a)(I,2),P=A[0],L=A[1],T=ne(),E=Object(o.g)(),M=Object(s.useState)(!1),D=Object(l.a)(M,2),B=D[0],U=D[1],W=Object(s.useState)(0),z=Object(l.a)(W,2),H=z[0],Y=z[1];return Object(s.useEffect)((function(){O.length>=1&&ce(O,e,U,Y)}),[O]),Object(h.jsxs)("div",{className:"CreateChat",children:[Object(h.jsx)(ue,{value:a,setValue:r,setResultAuthorList:j,focus:!0,inputText:"Search for friends",defaultSearchMode:"authors"}),d.map((function(e){return Object(h.jsx)(v,{data:e,chosenArray:O,setChosenArray:p})})),O.length>1&&B?Object(h.jsxs)("div",{children:[Object(h.jsx)("input",{type:"text",style:{marginBottom:"10px"},className:"standartInput",placeholder:"Enter chat name",value:C,onChange:function(e){return k(e.target.value)}}),Object(h.jsx)(st,{setErrorMessage:L,setImageLocalPath:function(){return null},downloadedPhoto:y,setDownloadedPhoto:S,place:"chatCovers/",btnText:"Download chat image"})]}):null,Object(h.jsx)(Pe,{errorMessage:P}),O.length>=1?Object(h.jsx)("button",{className:"addSongBtn",onClick:function(){B?(se([e.uid].concat(Object(m.a)(O)),T,C,y,[e.uid]),E.push("/chat/".concat(T))):E.push("/chat/".concat(H))},children:B?"Create Chat":"Go to chat"}):null]})}),wn=[{path:Jt,Component:function(){var e=R().login,t=Object(s.useState)(""),n=Object(l.a)(t,2),c=n[0],a=n[1],r=Object(s.useState)(""),o=Object(l.a)(r,2),u=o[0],b=o[1],f=Object(s.useState)(""),O=Object(l.a)(f,2),p=O[0],m=O[1],x=Object(s.useState)(!1),g=Object(l.a)(x,2),v=g[0],y=g[1],S=0!==c.length&&0!==u.length;function w(){return(w=Object(j.a)(d.a.mark((function t(n){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),S){t.next=3;break}return t.abrupt("return",m("One of your fields is totaly empty"));case 3:return t.next=5,e(c,u,m,y);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return Object(h.jsxs)("div",{className:"In-Up-Container",children:[Object(h.jsxs)("div",{className:"CentralPlate",children:[Object(h.jsx)(ct,{loading:v}),Object(h.jsx)(sn,{title:"Log In"}),Object(h.jsx)(Pe,{errorMessage:p}),Object(h.jsxs)("form",{onSubmit:function(e){return w.apply(this,arguments)},children:[Object(h.jsx)("input",{type:"email",placeholder:"Enter your Email",className:"emailInput",onChange:function(e){return a(e.target.value)}}),Object(h.jsx)("input",{type:"password",name:"",id:"",placeholder:"Enter your password",onChange:function(e){return b(e.target.value)}}),Object(h.jsxs)("div",{className:"inAndUpBtns",children:[Object(h.jsx)("button",{className:"upBtn",disabled:v,children:"Log In"}),Object(h.jsx)(i.b,{to:_t,children:Object(h.jsx)("button",{className:"inBtn",children:"Create new account"})})]})]})]}),Object(h.jsx)(nn,{})]})}},{path:_t,Component:function(){var e=Object(s.useState)(1),t=Object(l.a)(e,2),n=t[0],c=t[1],a=Object(s.useState)(""),r=Object(l.a)(a,2),o=r[0],u=r[1],b=Object(s.useState)(""),f=Object(l.a)(b,2),O=f[0],p=f[1],m=Object(s.useState)(""),x=Object(l.a)(m,2),g=x[0],v=x[1],y=Object(s.useState)(""),S=Object(l.a)(y,2),w=S[0],C=S[1],k=Object(s.useState)(!1),I=Object(l.a)(k,2),A=I[0],P=I[1],L=R().signup,T=Object(s.useState)(""),E=Object(l.a)(T,2),M=E[0],D=E[1],B=0!==o.length&&0!==O.length&&0!==g.length,U=Object(s.useState)(""),W=Object(l.a)(U,2),F=W[0],z=W[1],H=Object(s.useState)([]),Y=Object(l.a)(H,2),V=Y[0],Q=Y[1];function q(){return(q=Object(j.a)(d.a.mark((function e(t){var n,s,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.target.files[0],z(URL.createObjectURL(n)),s=N.ref(),c=s.child("usersImages/".concat(n.name)),e.next=6,c.put(n);case 6:return e.t0=D,e.next=9,c.getDownloadURL();case 9:e.t1=e.sent,(0,e.t0)(e.t1);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function K(){return(K=Object(j.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),B){e.next=3;break}return e.abrupt("return",C("One of your fields is totaly empty"));case 3:return e.next=5,L(o,g,O,n,M,V,C,P);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(h.jsxs)("div",{className:"In-Up-Container",children:[Object(h.jsx)(pe.a,{src:F,getColors:function(e){return Q(e)}}),Object(h.jsxs)("div",{className:"CentralPlate",children:[Object(h.jsx)(ct,{loading:A}),Object(h.jsx)(sn,{title:"Sign Up"}),w&&Object(h.jsx)("div",{className:"Alert",children:w}),Object(h.jsxs)("form",{onSubmit:function(e){return K.apply(this,arguments)},children:[Object(h.jsx)("input",{type:"email",placeholder:"Enter your Email",className:"emailInput",onChange:function(e){return u(e.target.value)}}),Object(h.jsx)("input",{type:"text",placeholder:"Enter your name",onChange:function(e){return v(e.target.value)}}),Object(h.jsx)("input",{type:"password",name:"",id:"",placeholder:"Create a password",onChange:function(e){return p(e.target.value)}}),Object(h.jsxs)("div",{style:{display:"flex",width:"100%",justifyContent:"center",margin:"5px 0 15px 0"},children:[Object(h.jsx)(be,{label:"User",onClick:function(){return c(0)},currentActive:n,id:0}),Object(h.jsx)(be,{label:"Author",onClick:function(){return c(1)},currentActive:n,id:1})]}),Object(h.jsxs)("label",{className:"downloadFile",children:[Object(h.jsxs)("div",{className:"downloadPhoto",children:[""===M?Object(h.jsxs)("span",{className:"downloadBtnText",children:[Object(h.jsx)(je.d,{}),"Download photo"]}):Object(h.jsx)("span",{className:"downloadBtnText",children:"Done"}),Object(h.jsx)("span",{className:"photoLoadLine",style:""!==M?{width:"100%"}:{}})]}),Object(h.jsx)("input",{type:"file",name:"",id:"",onChange:function(e){return q.apply(this,arguments)}})]}),Object(h.jsxs)("div",{className:"inAndUpBtns",children:[Object(h.jsx)("button",{className:"upBtn",type:"submit",disabled:A,children:"Sign Up"}),Object(h.jsx)(i.b,{to:Jt,children:Object(h.jsx)("button",{className:"inBtn",children:"Already have the account"})})]})]})]}),Object(h.jsx)(nn,{})]})}}],Nn=[{path:Zt,Component:function(){return Object(h.jsxs)("div",{style:{animation:"zoomIn .2s forwards"},className:"HomePage",children:[Object(h.jsx)(cn,{}),Object(h.jsx)(an,{}),Object(h.jsx)(un,{}),Object(h.jsx)(ln,{}),Object(h.jsx)(rn,{})]})}},{path:$t,Component:function(){var e=Object(s.useState)(0),t=Object(l.a)(e,2),n=t[0],c=t[1],a=[Object(h.jsx)(hn,{}),Object(h.jsx)(On,{}),Object(h.jsx)(pn,{})];return Object(h.jsxs)("div",{className:"LibraryPage",style:{animation:"zoomIn .2s forwards"},children:[Object(h.jsx)(rt,{pages:["Songs","Playlists","Authors"],currentPage:n,setCurrentPage:c}),a[n]]})}},{path:en,Component:function(){var e=Object(s.useState)(""),t=Object(l.a)(e,2),n=t[0],c=t[1],a=Object(s.useState)([]),r=Object(l.a)(a,2),i=r[0],o=r[1],u=Object(s.useState)([]),d=Object(l.a)(u,2),j=d[0],b=d[1],f=Object(s.useState)([]),O=Object(l.a)(f,2),p=O[0],m=O[1],x=Object(s.useState)(""),g=Object(l.a)(x,2),v=g[0],y=g[1];return Object(s.useEffect)((function(){o([]),b([]),m([])}),[n]),Object(s.useEffect)((function(){0!==i.length?y(i[0].imageColors[0]+"a6"):0!==j.length?y(j[0].imageColors[0]+"a6"):0!==p.length?y(p[0].imageColors[0]+"a6"):y("")}),[i,j,p]),Object(h.jsxs)("div",{className:"SearchPage",style:{animation:"zoomIn .2s forwards"},children:[Object(h.jsx)(ue,{value:n,setValue:c,allFoundSongs:i,setAllFoundSongs:o,setResultPlaylists:m,setResultAuthorList:b,focus:!0}),Object(h.jsx)(We,{listOfSongs:i,source:{source:"/search",name:"Search",image:"https://www.pngkey.com/png/full/87-872187_lupa-search-icon-white-png.png",songsList:i},title:"Songs",showListens:!0,displayIfEmpty:""}),Object(h.jsx)(vt,{listOfAuthors:j,title:"Authors"}),Object(h.jsx)(ft,{listOfAlbums:p,title:"Albums and Playlists",loading:!1}),Object(h.jsx)("div",{className:"colorfullShadow",style:{background:v}})]})}},{path:tn,Component:function(){var e=Object(s.useState)([]),t=Object(l.a)(e,2),n=t[0],c=t[1],a=B(),r=a.toggleModal,i=a.setContent,o=R().currentUser,u=Object(s.useState)(!0),d=Object(l.a)(u,2),j=d[0],b=d[1];return kt(b,"chats",o.chats,c,(function(e,t){if(t.messages.length&&e.messages.length)return new Date(t.messages[t.messages.length-1].sentTime).getTime()-new Date(e.messages[e.messages.length-1].sentTime).getTime()})),Object(h.jsxs)("div",{style:{animation:"zoomIn .2s forwards",minHeight:"100%"},children:[Object(h.jsx)("div",{style:{marginBottom:"10px",display:"flex",alignItems:"start",width:"100%"},children:Object(h.jsxs)("button",{className:"standartButton",onClick:function(){r(),i(Object(h.jsx)(Sn,{}))},children:[Object(h.jsx)(H.w,{}),"Create chat"]})}),j?Object(h.jsx)(re,{}):Object(h.jsx)("div",{className:"chatsWrapper",children:n.length?n.map((function(e,t){return Object(h.jsx)(yn,{chatData:e},t)})):Object(h.jsx)("h3",{children:"No chats"})})]})}}],Cn=function(){return Object(h.jsxs)(o.d,{children:[Object(h.jsx)(o.b,{path:"/authors/:authorId",component:Nt,exact:!0}),Object(h.jsx)(o.b,{path:"/albums/:albumId",component:tt,exact:!0}),Object(h.jsx)(o.b,{path:"/chat/:chatId",component:Xt,exact:!0}),Object(h.jsx)(o.b,{path:"/not-found",component:Gt,exact:!0}),Nn.map((function(e,t){var n=e.path,s=e.Component;return Object(h.jsx)(o.b,{path:n,component:s,exact:!0},t)})),Object(h.jsx)(o.a,{to:Zt})]})},kn=n(32),In=n(40);function An(e){return e%10===e?"0"+e:e}function Pn(e){return An(Math.floor(e/60))+":"+An(Math.floor(e%60))}var Ln=function(e){var t=e.inputRef,n=e.textLimit,s=void 0===n?18:n,c=e.linkToAuthors,a=void 0===c||c,r=F(),i=r.currentSongData,o=r.findLen,l=r.currentTime,u=r.changeCurrentTime,d=r.songDuration,j=r.setRepeatMode,b=r.repeatMode,f=r.play,O=r.prevSong,p=r.playSong,m=r.nextSong,x=r.setShuffleMode,g=r.shuffleMode,v=r.displayAuthors,y=r.name,S=r.authors,w=r.cover,N=r.inputRange;return-1!==i.id?Object(h.jsxs)("div",{className:"player",children:[Object(h.jsxs)("div",{className:"playerUpperSide",children:[Object(h.jsx)("div",{className:"songCover",children:Object(h.jsx)("img",{loading:"lazy",src:w,alt:""})}),Object(h.jsxs)("div",{className:"nameAndAuthors",children:[Object(h.jsx)("h2",{title:y.length>s?y:null,style:{overflow:"hidden"},children:Object(h.jsx)("div",{style:y.length>s?{animation:"outSideText 17s infinite",whiteSpace:"nowrap"}:{},children:y})}),Object(h.jsx)("h3",{style:{overflow:"hidden"},title:S.map((function(e){return" "+e.displayName})),children:a?Object(h.jsx)("div",{style:o()>s?{animation:"outSideText 17s infinite",whiteSpace:"nowrap"}:{},children:v()}):Object(h.jsx)("div",{children:xe(S," & ",33)})})]})]}),Object(h.jsxs)("div",{className:"controlPanel",children:[Object(h.jsx)("input",{type:"range",min:"0",ref:t,step:"1",value:l,onChange:function(e){u(e)},style:{background:"linear-gradient(to right, var(--themeColor2) ".concat(N,"%, #fff ").concat(N,"%)")}}),Object(h.jsxs)("div",{className:"startAndEndTime",children:[Object(h.jsx)("span",{children:Pn(l)}),Object(h.jsx)("span",{children:Pn(d)})]}),Object(h.jsxs)("div",{className:"btns",children:[Object(h.jsx)("button",{className:"shuffleBtn",onClick:function(){return x(k(g+1,1))},style:g?{background:"var(--reallyTransparentWhite)"}:{},children:Object(h.jsx)(In.b,{style:g?{color:"var(--themeColor)"}:{}})}),Object(h.jsx)("button",{onClick:O,children:Object(h.jsx)(kn.a,{})}),Object(h.jsx)("button",{onClick:p,children:f?Object(h.jsx)(kn.d,{}):Object(h.jsx)(kn.e,{})}),Object(h.jsx)("button",{onClick:m,children:Object(h.jsx)(kn.c,{})}),Object(h.jsxs)("button",{className:"repeatBtn",onClick:function(){return j(k(b+1,2))},style:b?{background:"var(--reallyTransparentWhite)"}:{},children:[Object(h.jsx)(In.a,{style:b?{color:"var(--themeColor)"}:{}}),Object(h.jsx)("span",{style:2===b?{opacity:1}:{}})]}),Object(h.jsx)(he,{play:f})]})]})]}):null},Tn=(n(270),[{id:0,icon:Object(h.jsx)(H.m,{}),title:"Home",link:Zt},{id:1,icon:Object(h.jsx)(ie.l,{}),title:"Library",link:$t},{id:2,icon:Object(h.jsx)(ie.m,{}),title:"Search",link:en},{id:3,icon:Object(h.jsx)(H.q,{}),title:"Chat",link:tn}]),En=function(e){var t=e.element,n=e.currentPage,s=e.setCurrentPage;return Object(h.jsx)(i.b,{to:t.link,className:"MobileControlBarItem",onClick:function(){return s(t.id)},style:t.id===n?{color:"var(--blue)"}:{},children:t.icon})},Rn=function(){var e=R().currentUser,t={icon:Object(h.jsx)(ie.p,{}),link:"/authors/".concat(e.uid)},n=Object(s.useState)((function(){var e=Tn.find((function(e,t){return console.log(window.location.hash),!!window.location.hash.includes(L(e.title))}));return void 0===e?0:e.id})),c=Object(l.a)(n,2),a=c[0],r=c[1];return Object(h.jsxs)("div",{className:"BottomControlBar",children:[Tn.map((function(e,t){return Object(h.jsx)(En,{element:e,currentPage:a,setCurrentPage:r},t)})),Object(h.jsx)(En,{element:t,currentPage:a,setCurrentPage:r})]})},Mn=function(){var e=F(),t=e.setOpenFullScreenPlayer,n=e.inputRange;return Object(h.jsxs)("div",{className:"FullBottomSide",children:[Object(h.jsxs)("span",{onClick:function(){return t(!0)},children:[Object(h.jsx)(Ln,{textLimit:25,linkToAuthors:!1}),Object(h.jsx)("span",{className:"mobileSongRange",style:{width:n+"%"}})]}),Object(h.jsx)(Rn,{})]})},Dn=function(e){var t=e.currentTime,n=e.timeSpan,s=e.id;return Object(h.jsx)("div",{className:"Loading",id:s,children:Object(h.jsx)("div",{className:"outer",style:{pointerEvents:"none"},children:Object(h.jsx)("div",{className:"inner",style:t/n<1?{width:t/n*100+"%"}:{width:"0%",opacity:"0"}})})})},Bn=function(e){var t=e.el,n=e.index,c=e.lyricsModeratorMode,a=e.karaokeModeratorTimes,r=e.setKaraokeModeratorTimes,i=e.setInputKaraokeTime,o=e.inputKaraokeTime,l=F(),u=l.currentSongData,d=l.currentParagraph,j=(l.displayAuthors,l.changeCurrentTime),b=l.play,f=l.currentTime,O=l.currentParagraphRef,p=l.lyrics,m=Object(s.useRef)(),x=Ft(d===n?O:m),g=d===n?{}:window.innerWidth>1e3?Math.abs(d-n)<2?{transform:"scale(.8) translateX(-58px)"}:{transform:"scale(.75) translateX(-78px)"}:Math.abs(d-n)<2?{transform:"scale(.8) translateX(-11.5%)"}:{transform:"scale(.75) translateX(-15.6%)"};function v(e,t){var n=a;if("down"===t)return n.splice(e+1,0,void 0),r(n),u.lyrics.splice(e+1,0,{startTime:"undefined",text:"@loading"});n.splice(e,0,void 0),r(n),u.lyrics.splice(e,0,{startTime:"undefined",text:"@loading"})}return Object(h.jsxs)("div",{className:"lyricsBlock",id:n,onClick:function(e){return j(e,t.startTime)},style:b&&d!==n&&x?Math.abs(d-n)<2?{opacity:.5}:{opacity:.1}:{},ref:d===n?O:m,children:[1===c?Object(h.jsxs)("div",{className:"lyricsBlockInput",children:[Object(h.jsxs)("span",{onClick:function(e){return e.stopPropagation()},children:[void 0!==a[n]&&0!==a[n].length?Object(h.jsx)(ie.b,{style:{background:"var(--themeColor3)",color:"var(--themeColor)"}}):Object(h.jsx)(H.I,{})," "]}),Object(h.jsx)("input",{type:"number",value:a[n]||o,onChange:function(e){return function(e,t){var n=a,s=e.target.value;n[t]=s,i(e.target.value),r(n)}(e,n)},onClick:function(e){return e.stopPropagation()}}),Object(h.jsxs)("div",{className:"addLyricsElementBtns",onClick:function(e){return e.stopPropagation()},children:[Object(h.jsx)("button",{onClick:function(){v(n,"up")},children:Object(h.jsx)(ie.o,{})}),Object(h.jsx)("button",{onClick:function(){v(n,"down")},children:Object(h.jsx)(ie.g,{})})]})]}):null,"@loading"===t.text?Object(h.jsx)(Dn,{currentTime:f-p[n].startTime,timeSpan:p[n+1].startTime-p[n].startTime,id:n}):"@end"===t.text?Object(h.jsx)(h.Fragment,{}):Object(h.jsx)("p",{id:n,style:g,children:t.text},n)]},n)},Un=[{id:0,icon:Object(h.jsx)(ie.n,{}),title:"Share",component:function(){var e=F().currentSongData,t=[Object(h.jsx)(Y.c,{}),Object(h.jsx)(kn.b,{}),Object(h.jsx)(kn.f,{}),Object(h.jsx)(kn.g,{}),Object(h.jsx)(je.b,{})];return Object(h.jsxs)("div",{className:"Share",children:[Object(h.jsxs)("button",{className:"shareCopyLink",children:[Object(h.jsx)(H.h,{}),"Copy link"]}),Object(h.jsx)("div",{className:"shareOnSocial",children:t.map((function(e,t){return Object(h.jsx)("div",{className:"shareSocialIcon",children:e},t)}))}),Object(h.jsx)("div",{className:"sharePeopleShort",children:Object(h.jsx)(de,{item:e,whatToShare:"song"})})]})}},{id:1,icon:Object(h.jsx)(ie.f,{}),title:"More",component:function(){R().currentUser;var e=F(),t=e.currentSongData,n=e.setRightSideCurrentPage;return Object(h.jsxs)("div",{className:"Options",children:[Object(h.jsx)("div",{className:"OptionItem",children:Object(h.jsx)(Se,{song:t})}),Object(h.jsxs)("div",{className:"OptionItem",onClick:function(){return n(4)},children:[Object(h.jsx)(ie.p,{}),"Go to author"]}),Object(h.jsxs)("div",{className:"OptionItem",onClick:function(){return n(5)},children:[Object(h.jsx)(Ae.c,{}),"Add to playlist"]}),Object(h.jsxs)("div",{className:"OptionItem",onClick:function(){return n(6)},children:[Object(h.jsx)(H.o,{}),"Info"]})]})}},{id:2,icon:Object(h.jsx)(In.c,{}),title:"Lyrics",component:function(){var e=F(),t=e.setIsThereKaraoke,n=e.currentSongData,c=e.setCurrentSongData,a=e.isThereKaraoke,r=e.currentParagraph,i=e.displayAuthors,o=(e.changeCurrentTime,e.play,e.currentTime,e.currentParagraphRef),u=(e.currentSong,e.lyrics),d=e.rightSideCurrentPage,j=e.openFullScreenPlayer,b=e.openMenu,f=R().currentUser,O=Object(s.useState)(0),p=Object(l.a)(O,2),m=p[0],x=p[1],g=Object(s.useState)([]),v=Object(l.a)(g,2),y=v[0],S=v[1],w=Object(s.useState)(0),N=Object(l.a)(w,2),k=N[0],I=N[1],A=Object(s.useState)(!1),P=Object(l.a)(A,2),L=P[0],T=P[1];function E(e,t){var n=y,s=e.target.value;n[t]=s,x(e.target.value),S(n)}function M(e,t){var s=y;if("down"===t)return s.splice(e+1,0,void 0),S(s),n.lyrics.splice(e+1,0,{startTime:"undefined",text:"@loading"});s.splice(e,0,void 0),S(s),n.lyrics.splice(e,0,{startTime:"undefined",text:"@loading"})}return Object(s.useEffect)((function(){a&&b&&2===d&&j&&o.current.scrollIntoView()}),[r]),Object(s.useEffect)((function(){u&&"undefined"!==u[0].startTime&&(u.forEach((function(e){y.push(e.startTime)})),T(!0))}),[]),Object(s.useEffect)((function(){var e,s=n;void 0!==s&&0!==m&&(s.lyrics.forEach((function(e,t){e.startTime=y[t]||"undefined"})),c(s),t(!0)),(null===(e=n.lyrics)||void 0===e?void 0:e.some((function(e){return"undefined"===e.startTime})))?T(!1):T(!0)}),[m]),u?Object(h.jsxs)("div",{className:"Lyrics",children:[f.isAdmin?Object(h.jsx)(rt,{pages:["Listen mode","Edit Mode"],currentPage:k,setCurrentPage:I}):null,a?u.map((function(e,t){return Object(h.jsx)(Bn,{el:e,index:t,lyricsModeratorMode:k,karaokeModeratorTimes:y,setKaraokeModeratorTimes:S,setInputKaraokeTime:x,inputKaraokeTime:E})})):u.map((function(e,t){return Object(h.jsxs)("div",{className:"lyricsBlock",children:[1===k?Object(h.jsxs)("div",{className:"lyricsBlockInput",children:[void 0!==y[t]&&0!==y[t].length?Object(h.jsx)(ie.b,{style:{background:"var(--themeColor3)",color:"var(--themeColor)"}}):Object(h.jsx)(H.I,{}),Object(h.jsx)("input",{type:"number",value:y[t]||m,onChange:function(e){return E(e,t)},onClick:function(e){return e.stopPropagation()}}),Object(h.jsxs)("div",{className:"addLyricsElementBtns",children:[Object(h.jsx)("button",{onClick:function(){return M(t,"up")},children:Object(h.jsx)(ie.o,{})}),Object(h.jsx)("button",{onClick:function(){return M(t,"down")},children:Object(h.jsx)(ie.g,{})})]})]}):null,Object(h.jsx)("p",{children:e.text})]},t)})),Object(h.jsxs)("h6",{className:"lyricsAuthors "+(r===u.length-1?"active":""),children:["Authors:  ",i()]}),1===k?Object(h.jsx)("button",{onClick:L?function(){C.collection("songs").doc(n.id).update({lyrics:n.lyrics})}:null,className:"updateLyricsBtn",style:L?{}:{opacity:.3},children:"Update Lyrics"}):null]}):Object(h.jsx)("h3",{children:"No lyrics"})}},{id:3,icon:Object(h.jsx)(It.a,{}),title:"Queue",component:function(){var e=F(),t=e.currentSongQueue,n=e.currentSongPlaylistSource,s=e.setOpenFullScreenPlayer;return Object(h.jsxs)("div",{className:"Queue",children:[Object(h.jsx)("div",{className:"queueNowIsPlaying",children:Object(h.jsxs)("h5",{style:{marginTop:2},children:["Now is playing:",Object(h.jsxs)(i.b,{onClick:function(){return s(!1)},to:n.source,className:"queueAlbumName",children:[Object(h.jsx)("div",{className:"queueImage",children:Object(h.jsx)("img",{loading:"lazy",src:n.image,alt:""})}),Object(h.jsx)("span",{children:me(n.name,25)})]})]})}),t.map((function(e,t){return Object(h.jsx)(De,{song:e,localIndex:t},t)}))]})}},{id:4,icon:null,title:"Go To Authors",component:Re},{id:5,icon:null,title:"Add to playlist",component:Ie},{id:6,icon:null,title:"Info",component:Ne}];function Wn(){var e=F(),t=e.imgColors,n=e.inputRef,a=e.rightSideCurrentPage,r=e.setRightSideCurrentPage,i=e.openFullScreenPlayer,o=e.setOpenFullScreenPlayer,u=e.lyrics,d=e.openMenu,j=e.setOpenMenu,b=X(),f=b.isMobile,p=(b.screenHeight,Object(s.useRef)(null)),m=Object(s.useState)(.05),x=Object(l.a)(m,2),g=x[0],v=x[1],y=Object(s.useState)(0),S=Object(l.a)(y,2),w=S[0],N=S[1],C=Object(s.useState)(0),I=Object(l.a)(C,2),A=I[0],P=I[1],L=Object(s.useState)(0),T=Object(l.a)(L,2),E=T[0],R=T[1],M=Object(s.useRef)(),D=c.a.useRef();te(D,j);var B=Object(Wt.useSwipeable)({onSwiping:function(e){e.deltaY>0&&P(e.deltaY)}}),U=c.a.useRef(),W=Object(Wt.useSwipeable)({onSwiping:function(e){e.event.stopPropagation(),(d&&0===M.current.scrollTop&&e.deltaY>0||!d&&e.deltaY<0)&&R(e.deltaY)},onSwipedLeft:function(){r(k(a+1,3))},onSwipedRight:function(){r(k(a-1,3))}});Object(s.useEffect)((function(){A>150&&o(!1)}),[A]),Object(s.useEffect)((function(){!d&&E<-100?(j(!0),R(0),N(.2)):d&&E>150?(j(!1),R(0),N(.2)):function(){var e;clearTimeout(e),N(0),e=setTimeout((function(){N(.2),R(0)}),300)}()}),[E]);function z(e){var t=Un[e].component;return Object(h.jsx)(t,{})}function Y(){return u&&0===u.length}function V(e){if(2===e.id&&Y())return null;N(.2),r(e.id),j(!0)}return Object(s.useEffect)((function(){0!==t.length&&(document.documentElement.style.setProperty("--themeColor",t[1]),document.documentElement.style.setProperty("--themeColor2",t[0]),document.documentElement.style.setProperty("--themeColor3",t[2]),document.documentElement.style.setProperty("--themeColor4",t[5]),document.documentElement.style.setProperty("--themeColorTransparent",t[0]+"6e"))}),[t]),Object(h.jsxs)("div",Object(O.a)(Object(O.a)({className:"bg",style:i?{top:0,opacity:1,visibility:"visible",zIndex:10,transform:"translateY(".concat(A,"px)"),borderRadius:"".concat(A<20?A:20,"px ").concat(A<20?A:20,"px 0 0"),transition:".4s opacity, ".concat(g,"s transform, .4s top, .4s visibility")}:{transform:"translateY(".concat(A,"px)"),transition:".4s opacity, ".concat(g,"s transform, .4s top, .4s visibility")},ref:function(e){B.ref(e),U.current=e}},B),{},{onTouchEnd:function(){var e;clearTimeout(e),v(.2),e=setTimeout((function(){P(0),v(0)}),100)},children:[Object(h.jsxs)("div",{className:"auroraWrapper",children:[Object(h.jsx)("div",{className:"auroraCircle"}),Object(h.jsx)("div",{className:"auroraCircle"}),Object(h.jsx)("div",{className:"auroraCircle"})]}),Object(h.jsx)("div",{className:"closeFullScreen",onClick:function(){o(!1)},children:window.innerWidth>1e3?Object(h.jsx)(fe.a,{}):Object(h.jsx)(H.r,{style:{opacity:.6}})}),Object(h.jsxs)("div",{className:"FullScreenPlayer",children:[Object(h.jsx)("div",{className:"leftSide",style:d?f?{opacity:.6,visibility:"visible",transform:"translateY(20px)",borderRadius:"10px",transition:".4s"}:null:{width:"100%"},children:Object(h.jsx)(Ln,{inputRef:n})}),window.innerWidth>1e3?Object(h.jsxs)("div",{className:"rightSideWrapper",style:d?{}:{transform:"translateX(calc(100% - 90px))",width:0},children:[Object(h.jsx)("button",{className:"menuBtn",style:d?{transform:"rotate(180deg)"}:{opacity:0,visibility:"hidden"},onClick:function(){return j(!d)},children:Object(h.jsx)(ie.c,{})}),Object(h.jsx)("div",{className:"rightSideControl",children:Un.map((function(e,t){return Object(h.jsx)("div",{className:"controlIcon",style:e.id===a&&d?{background:"var(--themeColor)"}:2===e.id&&Y()?{opacity:.4}:{},onClick:function(){return V(e)},children:e.icon},e.id)}))}),Object(h.jsx)("div",{className:"rightSide",ref:p,style:d?{}:{display:"none"},children:z(a)})]}):Object(h.jsxs)("div",Object(O.a)(Object(O.a)({className:"mobilePlayerMenu"},W),{},{ref:function(e){W.ref(e),D.current=e},style:d?{top:"calc(100% - calc(70vh + 55px) + ".concat(E,"px)"),transition:"".concat(w,"s")}:{top:"calc(100% - 55px + ".concat(E,"px)"),transition:"".concat(w,"s")},children:[Object(h.jsx)("div",{className:"mobilePlayerMenuClose",children:Object(h.jsx)(H.r,{style:{opacity:.6,width:"50px"},onClick:function(){return j(!d)}})}),Object(h.jsx)("div",{className:"controlIconsWrapper",children:Un.map((function(e,t){if(t<=3)return Object(h.jsx)("div",{className:"controlIcon",style:e.id===a&&d?{background:"var(--transparentWhite)"}:2===e.id&&Y()?{opacity:.4}:{},onClick:function(t){return V(e)},children:e.title},e.id)}))}),Object(h.jsx)("div",{className:"mobilePlayerMenuContent",ref:M,style:d?{}:{opacity:0},children:z(a)})]}))]})]}))}function Fn(e){var t=e.id,n=e.title,s=e.icon,c=e.link,a=e.currentPage,r=e.setCurrentPage;return Object(h.jsx)(i.b,{to:c,children:Object(h.jsxs)("div",{className:"NavigationItem "+(t===a?"active":""),onClick:function(){return r(t)},children:[Object(h.jsx)("div",{className:"icon",children:s}),Object(h.jsx)("b",{children:n})]})})}n(271);var zn=function(e){var t=e.index,n=e.friend,c=R().currentUser,a=Object(s.useState)(0),r=Object(l.a)(a,2),o=r[0],u=r[1],d=Object(s.useState)(!1),j=Object(l.a)(d,2),b=j[0],f=j[1],O=Object(s.useState)(""),p=Object(l.a)(O,2),m=p[0],x=p[1],g=F(),v=g.currentSong,y=g.currentSongData,S=Object(s.useState)(!1),w=Object(l.a)(S,2),N=w[0],C=w[1];return Object(s.useEffect)((function(){ce([n.uid],c,f,u)}),[]),Object(s.useEffect)((function(){(null===m||void 0===m?void 0:m.length)>0&&(C(!0),setTimeout((function(){x(""),C(!1)}),600))}),[m]),Object(h.jsxs)("div",{className:"person",id:n.uid,children:[Object(h.jsx)("img",{loading:"lazy",src:y.cover,alt:"",className:"sendSongImage "+m}),Object(h.jsxs)("div",{className:"personBtns",children:[Object(h.jsx)(i.b,{to:"/chat/".concat(o),children:Object(h.jsxs)("button",{onClick:function(){b&&se([c.uid,n.uid],o)},children:[Object(h.jsx)(J,{text:"chat"}),Object(h.jsx)(H.q,{})]})}),Object(h.jsx)(i.b,{to:"/authors/".concat(n.uid),children:Object(h.jsxs)("button",{children:[Object(h.jsx)(J,{text:"profile"}),Object(h.jsx)(H.D,{})]})}),Object(h.jsxs)("button",{onClick:function(){N||(le([n.uid],c,v,"song",""),x("sendAnimation"))},children:[Object(h.jsx)(J,{text:"share"}),Object(h.jsx)(ie.n,{})]})]}),Object(h.jsx)("div",{className:"pesronImg",style:{pointerEvents:"none"},children:Object(h.jsx)("img",{loading:"lazy",src:n.photoURL,alt:""})}),Object(h.jsx)(mn,{userUID:n.uid}),Object(h.jsx)("div",{className:"personName",style:{pointerEvents:"none"},children:n.displayName})]},t)},Hn=function(e){var t=e.playlist,n=B(),c=n.toggleModal,a=n.setContent,r=Object(s.useState)([]),u=Object(l.a)(r,2),d=u[0],j=u[1],b=jt(t,d,j),f=Ce(t.id),O=Object(l.a)(f,2),p=O[0],m=O[1],x=R().currentUser,g=Object(o.g)();return Object(h.jsxs)("div",{className:"TinyPlaylist",children:[Object(h.jsxs)("div",{className:"TinyPlaylistBtns",children:[t.authors.find((function(e){return e.uid===x.uid}))?Object(h.jsx)("button",{onClick:p,children:m?Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(J,{text:"remove song"}),Object(h.jsx)(H.c,{})]}):Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(J,{text:"add song"}),Object(h.jsx)(H.x,{})]})}):Object(h.jsxs)("button",{onClick:function(){c(),a(Object(h.jsx)(de,{item:t,whatToShare:"playlist"}))},children:[Object(h.jsx)(J,{text:"share"}),Object(h.jsx)(H.A,{})]}),Object(h.jsx)(i.b,{to:"/albums/".concat(t.id),children:Object(h.jsxs)("button",{children:[Object(h.jsx)(J,{text:"album"}),Object(h.jsx)(ie.a,{})]})}),Object(h.jsxs)("button",{onClick:b,children:[Object(h.jsx)(J,{text:"play"}),Object(h.jsx)(H.v,{})]})]}),Object(h.jsx)("div",{className:"TinyPlaylistImg",style:{backgroundImage:"url(".concat(t.image,")"),display:"inline-block",backgroundPosition:"center center",backgroundSize:"cover"},onClick:function(){return g.push("/albums/".concat(t.id))}}),Object(h.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[Object(h.jsx)("span",{children:me(t.name,13)}),Object(h.jsx)("span",{style:{fontSize:"0.8em",color:"grey",fontWeight:"500"},children:t.isAlbum?"album":"playlist"})]})]})},Yn=function(){return Object(h.jsx)("div",{className:"NotificationCircle"})},Vn=function(){var e=R().currentUser,t=F(),n=t.leftSideBarInputRef,c=t.setOpenFullScreenPlayer,a=t.currentSongData,r=t.yourFriends,o=t.yourPlaylists,u=B(),d=u.toggleModal,j=u.setContent,f=Object(s.useState)(0),O=Object(l.a)(f,2),p=O[0],m=O[1],x=Object(s.useState)((function(){var e=Tn.find((function(e,t){return!!window.location.hash.includes(L(e.title))}));return void 0===e?0:e.id})),g=Object(l.a)(x,2),v=g[0],y=g[1];return Object(h.jsxs)("div",{className:"LeftsideBar",children:[Object(h.jsxs)("div",{className:"logo",children:[Object(h.jsx)("img",{loading:"lazy",src:b,alt:""}),Object(h.jsx)("h3",{children:"Soundbubble"})]}),Object(h.jsx)("div",{className:"leftSideBarContainer",onClick:function(){return y(-1)},children:Object(h.jsx)(i.b,{to:"/authors/".concat(e.uid),children:Object(h.jsxs)("div",{className:"person",style:-1===v?{background:"var(--blue)"}:{},children:[e.friends.some((function(e){return"requested"===e.status}))?Object(h.jsx)(Yn,{}):null,Object(h.jsx)("div",{className:"pesronImg",children:Object(h.jsx)("img",{loading:"lazy",src:e.photoURL,alt:""})}),Object(h.jsx)("div",{className:"personName",children:me(e.displayName,15)})]})})}),Object(h.jsx)("div",{className:"NavigationPanel",children:Tn.map((function(e,t){var n=e.id,s=e.title,c=e.icon,a=e.link;return Object(h.jsx)(Fn,{id:n,title:s,icon:c,link:a,currentPage:v,setCurrentPage:y},t)}))}),Object(h.jsxs)("div",{className:"leftSideBarContainer friendsAndPlaylists",children:[Object(h.jsx)("span",{style:{display:p?"none":"block",animation:"scrollFromBottom .2s forwards"},children:r.length>0?Object(h.jsxs)(h.Fragment,{children:[r.map((function(e,t){return t<=2?Object(h.jsx)(zn,{index:e.uid,friend:e}):null})),Object(h.jsx)("h4",{className:"seeMoreBtn",onClick:function(){d(),j(Object(h.jsx)(de,{item:a,whatToShare:"song"}))},children:"See more"})]}):Object(h.jsx)("h4",{style:{alignSelf:"center",width:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:"No friends added"})}),Object(h.jsxs)("span",{style:{display:p?"block":"none",animation:"scrollFromTop .2s forwards"},children:[o.map((function(e,t){if(t<=2)return Object(h.jsx)(Hn,{playlist:e},e.id)})),Object(h.jsxs)("button",{className:"createPlaylistBtn",onClick:function(){d(),j(Object(h.jsx)(fn,{}))},style:{margin:"5px 0"},children:[Object(h.jsx)(ie.i,{}),"Create Playlist"]})]}),Object(h.jsxs)("div",{className:"upAndDownBtns",children:[Object(h.jsx)("button",{onClick:function(){return m(0)},style:p?{}:{opacity:"0.3"},children:Object(h.jsx)(H.g,{})}),Object(h.jsx)("button",{onClick:function(){return m(1)},style:p?{opacity:"0.3"}:{},children:Object(h.jsx)(H.d,{})})]})]}),Object(h.jsx)("div",{className:"leftSideBarContainer",children:-1===a.id?null:Object(h.jsxs)("div",{className:"littlePlayer",children:[Object(h.jsx)(Ln,{textLimit:15,inputRef:n}),Object(h.jsx)("div",{className:"fullScreenBtn",onClick:function(){return c(!0)},children:Object(h.jsx)(ie.j,{})})]})})]})},Qn=function(e){var t=Object.assign({},e),n=B(),c=n.openModal,a=n.setOpenModal,r=n.content,i=Object(s.useRef)(null),o=X().screenHeight;return te(i,a),Object(h.jsx)("div",{className:"modal_darkBg",style:c?{height:o}:{opacity:0,visibility:"hidden"},children:Object(h.jsx)("div",Object(O.a)(Object(O.a)({className:"ModalWindow"},t),{},{ref:i,style:c?{}:{opacity:0,visibility:"hidden",transform:"translateY(40px)"},children:r}))})},qn=(n(272),function(){var e=B(),t=e.isOpenConfirm,n=e.confirmContent,c=e.setIsOpenConfirm,a=(e.closeComfirm,Object(s.useRef)(null));return te(a,c),Object(h.jsx)("div",{className:"modal_darkBg confirm",style:t?{}:{opacity:0,visibility:"hidden"},children:Object(h.jsxs)("div",{className:"ConfirmWindow",ref:a,style:t?{}:{transform:"translateY(40px)"},children:[Object(h.jsx)("h3",{children:n.question}),Object(h.jsxs)("div",{className:"confirmButtons",children:[Object(h.jsx)("button",{onClick:n.onConfirm,className:"standartButton",children:n.confirmText}),Object(h.jsx)("button",{onClick:n.onReject,className:"standartButton",children:n.rejectText})]})]})})}),Kn=function(){var e=F(),t=e.songRef,n=e.loadSongData,c=e.playing,a=e.songSrc,r=e.openFullScreenPlayer,i=e.repeatMode,o=e.setPlay,u=e.prevSong,d=e.currentSongQueue,j=e.nextSong,b=e.updateListenCount,f=(e.currentSongInQueue,X()),O=f.isMobile,p=f.screenHeight,m=R(),x=m.currentUser,g=(m.setCurrentUser,Object(s.useState)(!0)),v=Object(l.a)(g,2),y=v[0],S=v[1];return Object(s.useEffect)((function(){var e=setInterval((function(){C.collection("users").doc(x.uid).update({online:(new Date).getTime()}),S(!y)}),3e5);return function(){return clearInterval(e)}}),[y]),Object(s.useEffect)((function(){C.collection("users").doc(x.uid).update({online:(new Date).getTime()})}),[]),Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("audio",{src:a,ref:t,onLoadedData:n,onTimeUpdate:c,onEnded:function(){return console.log("i workdfasd"),0===i?(t.current.pause(),o(!1),u()):1===i?1===d.length?(u(),b(),t.current.play()):j():(u(),b(),void t.current.play())}}),Object(h.jsxs)("div",{className:"Wrapper "+(r?"turnedOff":""),style:O?{height:p}:{height:"100vh"},children:[O?"chat"===window.location.hash.substr(2,4)&&window.location.hash.length>6?null:Object(h.jsx)(Mn,{}):Object(h.jsx)(Vn,{}),Object(h.jsx)("div",{className:"Content",children:Object(h.jsx)(Cn,{})}),Object(h.jsx)(Qn,{}),Object(h.jsx)(qn,{})]}),Object(h.jsx)(Wn,{})]})},Xn=function(){return R().currentUser.uid?Object(h.jsx)(o.d,{children:Object(h.jsx)(o.b,{path:"/",component:Kn})}):Object(h.jsxs)(o.d,{children:[wn.map((function(e,t){var n=e.path,s=e.Component;return Object(h.jsx)(o.b,{path:n,component:s,exact:!0},t)})),Object(h.jsx)(o.a,{to:Jt})]})};function Gn(){return Object(h.jsx)(i.a,{basename:"/",children:Object(h.jsx)(Xn,{})})}r.a.render(Object(h.jsx)(c.a.StrictMode,{children:Object(h.jsx)(G,{children:Object(h.jsx)(M,{children:Object(h.jsx)(U,{children:Object(h.jsx)(z,{children:Object(h.jsx)(Gn,{})})})})})}),document.getElementById("root"))},86:function(e,t,n){}},[[273,1,2]]]);
//# sourceMappingURL=main.47e55b4c.chunk.js.map