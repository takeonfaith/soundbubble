(this.webpackJsonpsoundbubble=this.webpackJsonpsoundbubble||[]).push([[0],{267:function(e,t,n){},268:function(e,t,n){},269:function(e,t,n){},270:function(e,t,n){},271:function(e,t,n){},272:function(e,t,n){},273:function(e,t,n){},274:function(e,t,n){},275:function(e,t,n){},276:function(e,t,n){},277:function(e,t,n){"use strict";n.r(t);var s=n(2),c=n.n(s),a=n(122),r=n.n(a),i=(n(91),n(13)),o=n(16),u=n(19),l=n(3),d=n(6),j=n.n(d),b=n(8),h=n(87);n(134),n(135),n(136),n(137);var f=h.a.initializeApp({apiKey:"AIzaSyBuDoETyUrO2RCDAlFMsW2uV-QmtCT8t6Y",authDomain:"soundbubble-27737.firebaseapp.com",projectId:"soundbubble-27737",storageBucket:"soundbubble-27737.appspot.com",messagingSenderId:"527274299416",appId:"1:527274299416:web:64b1ac2d05f4262df0736d",measurementId:"G-9TP9PEEV11"});h.a.analytics();var O=f.auth(),p=f.storage(),m=f.firestore(),x=n(128),g=n.p+"static/media/Logo3.fc53f4ac.svg",v=n(1),y=function(){return Object(v.jsx)("div",{className:"LoadingData",children:Object(v.jsx)("img",{loading:"lazy",src:g,alt:""})})};function S(e){return e.replace(/\s/g,"").replace(/\$/g,"s").replace(/[,'._/]/g,"").replace(/-/g,"").toLowerCase()}var w=function(e){for(var t=[],n=S(e),s=1;s<n.length+1;s++)t.push(n.substr(0,s));return t},C=c.a.createContext(),N=function(){return Object(s.useContext)(C)},k=function(e){var t=e.children,n=Object(s.useState)({}),c=Object(l.a)(n,2),a=c[0],r=c[1],i=Object(s.useState)(null),o=Object(l.a)(i,2),u=o[0],d=o[1],h=Object(s.useState)(!0),f=Object(l.a)(h,2),p=f[0],g=f[1],y=Object(s.useState)(""),S=Object(l.a)(y,2),N=S[0],k=S[1];Object(s.useEffect)((function(){if(null!==u)return m.collection("users").doc(u).onSnapshot((function(e){e.data()&&void 0===a.uid&&r(e.data())}))}),[m,u]),Object(s.useEffect)((function(){return O.onAuthStateChanged(function(){var e=Object(b.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t?d(t.uid):(d(null),r({}),g(!1));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]);var I={currentUser:a,setCurrentUser:r,login:function(e,t,n,s){return s(!0),O.signInWithEmailAndPassword(e,t).then().catch((function(e){n(e.message),s(!1)}))},signup:function(e,t,n,s,c,a,r,i){return i(!0),O.createUserWithEmailAndPassword(e,n).then((function(e){m.collection("users").doc(e.user.uid).set({uid:e.user.uid,displayName:t,photoURL:c||"https://images.fineartamerica.com/images/artworkimages/mediumlarge/1/music-icon-mohammed-jabir-ap.jpg",isAuthor:1===parseInt(s),isVerified:1===parseInt(s),numberOfListenersPerMonth:0,ownSongs:[],ownPlaylists:[],addedSongs:[],addedPlaylists:[],addedAuthors:[],lastSongPlayed:"",chats:[],friends:[],subscribers:0,regDate:x.a.firestore.FieldValue.serverTimestamp(),imageColors:a}),m.collection("search").doc(e.user.uid).set({place:"users",uid:e.user.uid,rank:0,variantsOfName:w(t)}),m.collection("searchHistory").doc(e.user.uid).set({history:[]}),m.collection("history").doc(e.user.uid).set({history:[]}),i(!1)})).catch((function(e){r(e.message)}))},logout:function(){return O.signOut()},loading:p,setLoading:g,searchValue:N,setSearchValue:k};return Object(v.jsx)(C.Provider,{value:I,children:t})},I=c.a.createContext(),A=function(){return Object(s.useContext)(I)},P=function(e){var t=e.children,n=Object(s.useState)(window.innerWidth),c=Object(l.a)(n,2),a=c[0],r=c[1],i=Object(s.useState)(window.innerHeight),o=Object(l.a)(i,2),u=o[0],d=o[1],j=Object(s.useState)(window.innerWidth<1e3),b=Object(l.a)(j,2),h=b[0],f=b[1];function O(){r(window.innerWidth),d(window.innerHeight),f(window.innerWidth<1e3)}Object(s.useEffect)((function(){return window.addEventListener("resize",O),function(){window.removeEventListener("resize",O)}}),[]);var p={screenWidth:a,screenHeight:u,isMobile:h};return Object(v.jsx)(I.Provider,{value:p,children:t})},L=n(32),M=n(14),E=n(9),T=n(41),R=function(e){var t=e.listOfChosenItems,n=e.setListOfChosenItems,s=e.itemId;return void 0!==t?Object(v.jsx)("div",{onClick:function(e){return e.preventDefault()},style:{width:"35px"},children:t.includes(s)?Object(v.jsx)("button",{type:"button",onClick:function(e){var c=t.filter((function(e){return e!==s}));n(c)},className:"addToListBtn",children:Object(v.jsx)(T.a,{style:{color:"var(--lightBlue)"}})}):Object(v.jsx)("button",{type:"button",onClick:function(){return n((function(e){return[].concat(Object(E.a)(e),[s])}))},className:"addToListBtn",children:Object(v.jsx)(T.b,{})})}):null};function B(e){return e%10===e?"0"+e:e}function D(e){var t=new Date(1970,0,1);return t.setSeconds(e),t}function U(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=["January","February","March","April","May","June","July","August","September","October","November","December"],s=isNaN(e)?new Date(e):e.seconds?D(e.seconds+10800):D(e/1e3+10800);return 0===t?n[s.getMonth()]+" "+s.getDate()+", "+s.getFullYear():1===t?n[s.getMonth()]+" "+s.getDate():2===t?B(s.getHours())+":"+B(s.getMinutes()):3===t?n[s.getMonth()]+" "+s.getDate()+", "+s.getFullYear()+" at "+B(s.getHours())+":"+B(s.getMinutes()):void 0}var F,W=function(e){var t=e.userUID,n=(Object(L.a)(e,["userUID"]),Object(s.useState)("")),c=Object(l.a)(n,2),a=c[0],r=c[1],i=Object(s.useState)(!1),o=Object(l.a)(i,2),u=o[0],d=o[1];return Object(s.useEffect)((function(){var e=m.collection("users").doc(t).onSnapshot((function(e){if(void 0!==t){var n=(new Date).getTime()-3e5,s=e.data().online>n;d(s),void 0===e.data().online?r("offline"):s||r("last seen "+U(e.data().online,3))}}));return function(){e()}}),[m,t]),u?Object(v.jsx)("span",{className:"is-online",children:"Online"}):Object(v.jsx)("span",{className:"is-not-online",children:a})},H=n(15),V=H.a.div(F||(F=Object(M.a)(["\n  position: absolute;\n  top: 50%;\n  right: 8px;\n  transform: translateY(-50%);\n"]))),z=function(e){var t=e.data,n=e.chosenArray,s=e.setChosenArray,c=e.lastSeen,a=void 0!==c&&c,r=e.rightButton,i=Object(L.a)(e,["data","chosenArray","setChosenArray","lastSeen","rightButton"]);return Object(v.jsxs)("div",Object(u.a)(Object(u.a)({className:"person"},i),{},{children:[Object(v.jsx)(R,{listOfChosenItems:n,setListOfChosenItems:s,itemId:t.uid}),Object(v.jsx)("div",{className:"personImg",children:Object(v.jsx)("img",{loading:"lazy",src:t.photoURL,alt:""})}),Object(v.jsx)("div",{className:"personName",children:t.displayName}),a&&Object(v.jsx)(W,{userUID:t.uid,className:"is-online"}),Object(v.jsx)(V,{children:r})]}))},Y=function(e,t){m.collection("history").doc(t.uid).get().then((function(n){var s=n.data().history;s[0]!==e&&s.unshift(e),s.length>30&&(s.length=30),m.collection("history").doc(t.uid).update({history:s})}))};function q(e){for(var t=[],n=new Array(e.length),s=0;s<e.length;){var c=Math.floor(Math.random()*e.length);t.includes(c)||(t.push(c),n[c]=e[s],s++)}return n}var Q=function(e,t,n,c){Object(s.useEffect)((function(){e.uid&&n&&t()}),[JSON.stringify(c)])};function G(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e>t?n:e<n?t:e}var K=function(e,t,n){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(e){return e},c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){return null},a=arguments.length>5?arguments[5]:void 0,r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;if(null===e||void 0===e?void 0:e.length){var i=e.map(function(){var e=Object(b.a)(j.a.mark((function e(n,s){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection(t).doc(n).get();case 2:return e.abrupt("return",e.sent.data());case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());Promise.all(i).then((function(e){var t=s(e);(null===t||void 0===t?void 0:t.length)>a&&(t.length=a),n(0===r?t:function(e){var n=[];return t.forEach((function(t){t&&(e.find((function(e){return e.id===t.id}))||n.push(t))})),[].concat(Object(E.a)(e),n)}),c()}))}},X=c.a.createContext(),J=function(){return Object(s.useContext)(X)},_=function(e){var t=e.children,n=Object(s.useState)(!1),c=Object(l.a)(n,2),a=c[0],r=c[1],i=Object(s.useState)(Object(v.jsx)("h1",{children:"Test"})),o=Object(l.a)(i,2),u=o[0],d=o[1],j=Object(s.useState)({isOpenned:!1,type:"success",message:"Action is successfully done!"}),b=Object(l.a)(j,2),h=b[0],f=b[1],O=Object(s.useState)(!1),p=Object(l.a)(O,2),m=p[0],x=p[1],g=Object(s.useState)({confirmText:"Confirm Action",rejectText:"Cancel",onConfirmL:function(){return null},onReject:function(){return null}}),y=Object(l.a)(g,2),S=y[0],w=y[1];function C(){x(!1)}var N={openModal:a,setOpenModal:r,toggleModal:function(){r(!a)},setContent:d,content:u,isOpenConfirm:m,setIsOpenConfirm:x,openConfirm:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Cancel",s=arguments.length>3?arguments[3]:void 0,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:C;x(!0),w({question:e,confirmText:t,rejectText:n,onConfirm:s,onReject:c})},closeConfirm:C,confirmContent:S,bottomMessage:h,openBottomMessage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Success",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e3;f({isOpenned:!0,type:t,message:e}),setTimeout((function(){f({isOpenned:!1,type:t,message:e})}),n)}};return Object(v.jsx)(X.Provider,{value:N,children:t})},$=Object(s.createContext)(null),Z=function(){return Object(s.useContext)($)},ee=function(e){var t=e.children,n=N(),c=n.currentUser,a=n.loading,r=n.setLoading,o=J().setOpenModal,u=Object(s.useState)([]),d=Object(l.a)(u,2),h=d[0],f=d[1],O=Object(s.useState)([]),p=Object(l.a)(O,2),x=p[0],g=p[1],S=Object(s.useState)([]),w=Object(l.a)(S,2),C=w[0],k=w[1],I=Object(s.useState)([]),A=Object(l.a)(I,2),P=A[0],L=A[1],M=Object(s.useState)([]),E=Object(l.a)(M,2),T=E[0],R=E[1],B=Object(s.useState)(-1),D=Object(l.a)(B,2),U=D[0],F=D[1],W=Object(s.useState)(0),H=Object(l.a)(W,2),V=H[0],X=H[1],_=Object(s.useState)({}),Z=Object(l.a)(_,2),ee=Z[0],te=Z[1],ne=Object(s.useState)(0),se=Object(l.a)(ne,2),ce=se[0],ae=se[1],re=Object(s.useState)({id:-1}),ie=Object(l.a)(re,2),oe=ie[0],ue=ie[1],le=Object(s.useState)([]),de=Object(l.a)(le,2),je=de[0],be=de[1],he=Object(s.useState)(!1),fe=Object(l.a)(he,2),Oe=fe[0],pe=fe[1],me=Object(s.useState)(0),xe=Object(l.a)(me,2),ge=xe[0],ve=xe[1],ye=Object(s.useState)(0),Se=Object(l.a)(ye,2),we=Se[0],Ce=Se[1],Ne=Object(s.useState)(1),ke=Object(l.a)(Ne,2),Ie=ke[0],Ae=ke[1],Pe=Object(s.useState)(0),Le=Object(l.a)(Pe,2),Me=Le[0],Ee=Le[1],Te=Object(s.useState)(0),Re=Object(l.a)(Te,2),Be=Re[0],De=Re[1],Ue=Object(s.useState)(!1),Fe=Object(l.a)(Ue,2),We=Fe[0],He=Fe[1],Ve=Object(s.useState)(!1),ze=Object(l.a)(Ve,2),Ye=ze[0],qe=ze[1],Qe=Object(s.useRef)(null),Ge=Object(s.useRef)(null),Ke=Object(s.useRef)(null),Xe=Object(s.useRef)(null),Je=Object(s.useState)(0),_e=Object(l.a)(Je,2),$e=_e[0],Ze=_e[1],et=Object(s.useState)(!1),tt=Object(l.a)(et,2),nt=tt[0],st=tt[1];function ct(){var e;K(null===c||void 0===c||null===(e=c.lastQueue)||void 0===e?void 0:e.songsList,"songs",R,(function(e){return e}),(function(){return X(c.lastQueue.songsList.findIndex((function(e){return e===c.lastSongPlayed})))}))}function at(){K(c.addedSongs.slice(0).reverse(),"songs",f,(function(e){return e}),ct)}function rt(){return it.apply(this,arguments)}function it(){return(it=Object(b.a)(j.a.mark((function e(){var t,n,s,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0!==c.uid&&(t={id:-1,name:"",songSrc:"",authors:[],cover:"",listens:0,releaseDate:"",lyrics:[],imageColors:[]},n=c.lastSongPlayed||c.addedSongs[0]||t.id,s=c.lastQueue||{source:"/library",name:"Your Library",image:c.photoURL,songsList:h}||[],F(n),te(s),-1!==n?(a=m.collection("songs").doc(n),a.get().then((function(e){if(e.exists){var t=e.data();ue(t),be(t.imageColors||[]),r(!1)}})).catch((function(e){console.log("Error getting document:",e),r(!1)}))):(ue(t),be([]),r(!1)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ot(){return(ot=Object(b.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:-1!==U?m.collection("songs").doc(U).get().then((function(e){if(e.exists){var t=e.data();be(t.imageColors||[]),ue(t)}})):rt();case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ut(){for(var e=0,t=oe.lyrics.length-1,n=parseFloat(parseFloat(Qe.current.currentTime).toFixed(1));e<=t;){var s=Math.floor((e+t)/2),c=parseFloat(parseFloat(oe.lyrics[s].startTime).toFixed(1)),a=s!==oe.lyrics.length-1?parseFloat(parseFloat(oe.lyrics[s+1].startTime).toFixed(1)):t;if("undefined"===oe.lyrics[s].startTime)return;if(n>=c&&n<=a){De(s);break}c<n?e=s+1:t=s-1}}function lt(){return(lt=Object(b.a)(j.a.mark((function e(){var t,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=G(V+1,T.length-1),e.next=3,m.collection("songs").doc(T[t].id).get();case 3:return e.next=5,e.sent.data().id;case 5:n=e.sent,Y(n,c),De(0),F(n),X(G(t,T.length-1)),m.collection("users").doc(c.uid).update({lastSongPlayed:n});case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function dt(){return(dt=Object(b.a)(j.a.mark((function e(){var t,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(ge>5)){e.next=5;break}return Qe.current.currentTime=0,ve(0),De(0),e.abrupt("return");case 5:return t=G(V-1,T.length-1),e.next=8,m.collection("songs").doc(T[t].id).get();case 8:return e.next=10,e.sent.data().id;case 10:n=e.sent,Y(n,c),De(0),F(n),X(G(t,T.length-1)),m.collection("users").doc(c.uid).update({lastSongPlayed:n});case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Q(c,at,c.addedSongs&&c.addedSongs.length!==h.length,[c.addedSongs]),Q(c,(function(){var e=[];c.ownPlaylists&&c.ownPlaylists.map((function(t,n){m.collection("playlists").doc(t).get().then((function(t){t.exists?(e.push(t.data()),n===c.ownPlaylists.length-1&&g(e)):console.log("No such document!")})).catch((function(e){console.log("Error getting document:",e)}))})),c.addedPlaylists&&c.addedPlaylists.map((function(t,n){m.collection("playlists").doc(t).get().then((function(t){t.exists?(e.push(t.data()),n===c.addedPlaylists.length-1&&g(e)):console.log("No such document!")})).catch((function(e){console.log("Error getting document:",e)}))}))}),c.ownPlaylists&&String(c.ownPlaylists.concat(c.addedPlaylists))!==String(x),[c.ownPlaylists]),Q(c,(function(){K(c.friends.filter((function(e){return"added"===e.status})).map((function(e){return e.uid})),"users",L)}),c.friends&&String(c.friends.filter((function(e){return"added"===e.status})))!==String(P),[c.friends]),Q(c,(function(){K(c.addedAuthors,"users",k)}),c.addedAuthors&&c.addedAuthors.length!==C.length,[c.addedAuthors]),Q(c,(function(){return ot.apply(this,arguments)}),c&&(-1===oe.id||U||c.lastSongPlayed),[U,c.lastSongPlayed]),Object(s.useEffect)((function(){void 0===c.uid&&(ue({id:-1}),F(-1),R([]),k([]),f([]),L([]),g([]))}),[c.uid]),Object(s.useEffect)((function(){var e;He((void 0===(e=oe.lyrics)||0!==e.length)&&(void 0===e||"undefined"!==e[0].startTime))}),[oe.lyrics]),Object(s.useEffect)((function(){if(!a)if(Me){var e=q(T);R(e),X(e.findIndex((function(e){return e.id===U})))}else R(ee.songsList),X(ee.songsList.findIndex((function(e){return e.id===U})))}),[Me]),Object(s.useEffect)((function(){De(0)}),[oe.id]),Object(s.useEffect)((function(){2===$e&&ut()}),[$e]),Object(s.useEffect)((function(){document.title=oe.name||"Soundbubble"}),[oe.name]),Object(v.jsx)($.Provider,{value:{yourSongs:h,setYourSongs:f,yourPlaylists:x,yourFriends:P,currentSongQueue:T,currentSongPlaylistSource:ee,setCurrentSongPlaylistSource:te,setCurrentSongQueue:R,setCurrentSongInQueue:X,play:Oe,setPlay:pe,songSrc:oe.songSrc,currentTime:ge,setCurrentTime:ve,songDuration:we,songRef:Qe,name:oe.name,authors:oe.authors,lyrics:oe.lyrics,cover:oe.cover,imgColors:je,setImgColors:be,currentSong:U,setCurrentSong:F,repeatMode:Ie,setRepeatMode:Ae,shuffleMode:Me,setShuffleMode:Ee,inputRef:Ke,leftSideBarInputRef:Xe,isThereKaraoke:We,rightSideCurrentPage:$e,currentParagraph:Be,currentParagraphRef:Ge,nextSong:function(){return lt.apply(this,arguments)},prevSong:function(){return dt.apply(this,arguments)},playSong:function(){Oe?Qe.current.pause():Qe.current.play(),pe(!Oe)},playing:function(e){ve(e.target.currentTime),We&&2===$e&&Ye&&nt&&function(){if(Be!==oe.lyrics.length-1&&parseFloat(oe.lyrics[Be+1].startTime)<=Qe.current.currentTime)De(Be+1)}(),ae(e.target.currentTime/we*100)},defineCurrentParagraph:ut,setRightSideCurrentPage:Ze,changeCurrentTime:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if("div"===e.target.localName||"p"===e.target.localName){if(void 0!==t)return ve(t),Qe.current.currentTime=t,ae(t/we*100),We&&2===$e&&Ye&&De(parseInt(e.target.id)),Qe.current.play(),void pe(!0)}else ve(e.target.value),Qe.current.currentTime=e.target.value,ae(e.target.value/we*100),We&&2===$e&&Ye&&ut()},displayAuthors:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oe.authors,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" & ";return e.map((function(n,s){return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(i.b,{to:"/authors/".concat(n.uid),onClick:function(e){e.stopPropagation(),qe(!1)},children:n.displayName},n.uid),s===e.length-1?"":t]})}))},displayAuthorsFull:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oe.authors;return e.map((function(e,t){return Object(v.jsx)(v.Fragment,{children:Object(v.jsx)(i.b,{to:"/authors/".concat(e.uid),onClick:function(e){e.stopPropagation(),qe(!1),o(!1)},children:Object(v.jsx)(z,{data:e})},e.uid)})}))},openFullScreenPlayer:Ye,setOpenFullScreenPlayer:qe,loadSongData:function(e){ve(e.target.currentTime),Ce(e.target.duration),Ke.current.max=e.target.duration,window.innerWidth>1e3&&(Xe.current.max=e.target.duration),ae(0),Oe?e.target.play():e.target.pause()},fetchYourSongs:at,setOpenMenu:st,openMenu:nt,currentSongData:oe,setCurrentSongData:ue,setIsThereKaraoke:He,setYourPlaylists:g,yourAuthors:C,setYourAuthors:k,inputRange:ce},children:a?Object(v.jsx)(y,{}):t})},te=n(11),ne=n(34),se=n(7),ce=n(51),ae=function(e,t){Object(s.useEffect)((function(){function n(n){e.current&&!e.current.contains(n.target)&&t(!1)}return document.addEventListener("mousedown",n),function(){document.removeEventListener("mousedown",n)}}),[e])},re=n(24),ie=n(50);function oe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;return e.substr(0,t)+(e.length>t?"...":"")}var ue=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" & ",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,s=null===e||void 0===e?void 0:e.map((function(e){return e.displayName})).join(t);return s?oe(s,n):""};function le(e){var t="";return e.forEach((function(e){t+=e.displayName})),t.length}function de(e){return e%10===e?"0"+e:e}function je(e){return de(Math.floor(e/60))+":"+de(Math.floor(e%60))}var be=function(e){var t=e.play;return Object(v.jsxs)("div",{className:"ColorCircles",style:t?{}:{opacity:0,transform:"scale(.95)"},children:[Object(v.jsx)("span",{className:"colorCircle"}),Object(v.jsx)("span",{className:"colorCircle"}),Object(v.jsx)("span",{className:"colorCircle"})]})},he=function(e){var t=e.inputRef,n=e.textLimit,s=void 0===n?18:n,c=e.linkToAuthors,a=void 0===c||c,r=Z(),i=r.currentSongData,o=r.currentTime,u=r.changeCurrentTime,l=r.songDuration,d=r.setRepeatMode,j=r.repeatMode,b=r.play,h=r.prevSong,f=r.playSong,O=r.nextSong,p=r.setShuffleMode,m=r.shuffleMode,x=r.displayAuthors,g=r.name,y=r.authors,S=r.cover,w=r.inputRange;return-1!==i.id?Object(v.jsxs)("div",{className:"player",children:[Object(v.jsxs)("div",{className:"playerUpperSide",children:[Object(v.jsx)("div",{className:"songCover",children:Object(v.jsx)("img",{loading:"lazy",src:S,alt:""})}),Object(v.jsxs)("div",{className:"nameAndAuthors",children:[Object(v.jsx)("h2",{title:g.length>s?g:null,style:{overflow:"hidden"},children:Object(v.jsx)("div",{style:g.length>s?{animation:"outSideText 17s infinite",whiteSpace:"nowrap"}:{},children:g})}),Object(v.jsx)("h3",{style:{overflow:"hidden"},title:y.map((function(e){return" "+e.displayName})),children:a?Object(v.jsx)("div",{style:le(i.authors)>s?{animation:"outSideText 17s infinite",whiteSpace:"nowrap"}:{},children:x()}):Object(v.jsx)("div",{children:ue(y," & ",33)})})]})]}),Object(v.jsxs)("div",{className:"controlPanel",children:[Object(v.jsx)("input",{type:"range",min:"0",ref:t,step:"1",value:o,onChange:function(e){u(e)},style:{background:"linear-gradient(to right, var(--themeColor2) ".concat(w,"%, #fff ").concat(w,"%)")}}),Object(v.jsxs)("div",{className:"startAndEndTime",children:[Object(v.jsx)("span",{children:je(o)}),Object(v.jsx)("span",{children:je(l)})]}),Object(v.jsxs)("div",{className:"btns",children:[Object(v.jsx)("button",{className:"shuffleBtn",onClick:function(){return p(G(m+1,1))},style:m?{background:"var(--reallyTransparentWhite)"}:{},children:Object(v.jsx)(ie.b,{style:m?{color:"var(--themeColor)"}:{}})}),Object(v.jsx)("button",{onClick:function(e){e.stopPropagation(),h()},children:Object(v.jsx)(re.a,{})}),Object(v.jsx)("button",{onClick:function(e){e.stopPropagation(),f()},children:b?Object(v.jsx)(re.e,{}):Object(v.jsx)(re.f,{})}),Object(v.jsx)("button",{onClick:function(e){e.stopPropagation(),O()},children:Object(v.jsx)(re.c,{})}),Object(v.jsxs)("button",{className:"repeatBtn",onClick:function(){return d(G(j+1,2))},style:j?{background:"var(--reallyTransparentWhite)"}:{},children:[Object(v.jsx)(ie.a,{style:j?{color:"var(--themeColor)"}:{}}),Object(v.jsx)("span",{style:2===j?{opacity:1}:{}})]}),Object(v.jsx)(be,{play:b})]})]})]}):null},fe=n(67),Oe=n(33),pe=function(e){var t=e.person,n=J().setOpenModal;return Object(v.jsx)(i.b,{to:"/authors/".concat(t.uid),children:Object(v.jsxs)("div",{className:"PersonTinyVerticalItem",onClick:function(){return n(!1)},children:[Object(v.jsx)("div",{className:"personTinyImage",children:Object(v.jsx)("img",{loading:"lazy",src:t.photoURL,alt:""})}),Object(v.jsx)("div",{className:"personTinyName",children:t.displayName})]})})};function me(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}var xe=function(){var e=Object(b.a)(j.a.mark((function e(t){var n,s,c,a,r,i=arguments;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=i.length>1&&void 0!==i[1]?i[1]:me(),s=i.length>2&&void 0!==i[2]?i[2]:"",c=i.length>3&&void 0!==i[3]?i[3]:"",a=i.length>4&&void 0!==i[4]?i[4]:[],r=i.length>5&&void 0!==i[5]?i[5]:[],m.collection("chats").doc(n).set({chatImage:c,chatName:s,id:n,messages:[],participants:t,wallpaper:"undefined",admins:t.length>2?a:[],typing:[],imageColors:r}),t.map(function(){var e=Object(b.a)(j.a.mark((function e(t){var s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(t).get();case 2:(s=e.sent.data().chats).push(n),m.collection("users").doc(t).update({chats:s});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ge=function(){var e=Object(b.a)(j.a.mark((function e(t,n,s,c){var a,r,i;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=!1,r=0,!n.chats){e.next=9;break}return e.next=5,m.collection("chats").where("participants","array-contains",n.uid).get();case 5:return e.sent.docs.forEach((function(e){var n=0;return t.every((function(t){return!!e.data().participants.includes(t)&&(n++,!0)})),n+1!==e.data().participants.length||n!==t.length||(a=!0,s(!1),c(e.data().id),r=e.data().id,!1)})),a||(i=me(),a=!0,s(!0),c(i),r=i),e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})));return function(t,n,s,c){return e.apply(this,arguments)}}(),ve=function(e,t,n,s){var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[],i=arguments.length>7?arguments[7]:void 0;if(0!==s.trim().length||0!==c.length||0!==a.length||0!==r.length){var o=(null===t||void 0===t?void 0:t.messages)||[];o.push({id:o.length,sender:n,message:s,sentTime:(new Date).toString(),inResponseToMessage:i||null,attachedSongs:c,attachedAlbums:a,attachedAuthors:r,seenBy:[n]}),m.collection("chats").doc(e).update({messages:o})}};function ye(e){var t=e.shareList,n=e.currentUser,s=e.itemId,c=e.whatToShare,a=e.messageText,r=void 0===a?"":a,i=e.setShouldCreate,o=void 0===i?function(){return null}:i,u=e.setFriendChatId,l=void 0===u?function(){return null}:u,d=e.setLoading,h=void 0===d?function(){return null}:d,f=e.setCompleted,O=void 0===f?function(){return null}:f;h(!0),O(!1),t.map(function(){var e=Object(b.a)(j.a.mark((function e(t){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=[{uid:t,status:"added"}].concat(Object(E.a)(n.friends.filter((function(e){return e.uid!==t})))),m.collection("users").doc(n.uid).update({friends:a}),Promise.resolve(ge([t],n,(function(){return null}),l)).then(function(){var e=Object(b.a)(j.a.mark((function e(a){var i;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("chats").doc(a).get();case 2:if(void 0===(i=e.sent.data())){e.next=17;break}e.t0=c,e.next="song"===e.t0?7:"playlist"===e.t0?9:"author"===e.t0?11:13;break;case 7:return ve(a,i,n.uid,r,[s]),e.abrupt("break",15);case 9:return ve(a,i,n.uid,r,[],[s]),e.abrupt("break",15);case 11:return ve(a,i,n.uid,r,[],[],[s]),e.abrupt("break",15);case 13:return ve(a,i,n.uid,r,[s]),e.abrupt("break",15);case 15:e.next=18;break;case 17:xe([n.uid,t],a).then(Object(b.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("chats").doc(a).get();case 2:i=e.sent.data(),o(!1),e.t0=c,e.next="song"===e.t0?7:"playlist"===e.t0?9:"author"===e.t0?11:13;break;case 7:return ve(a,i,n.uid,r,[s]),e.abrupt("break",15);case 9:return ve(a,i,n.uid,r,[],[s]),e.abrupt("break",15);case 11:return ve(a,i,n.uid,r,[],[],[s]),e.abrupt("break",15);case 13:return ve(a,i,n.uid,r,[s]),e.abrupt("break",15);case 15:case"end":return e.stop()}}),e)}))));case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(){h(!1),O(!0)}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}var Se,we,Ce,Ne,ke=function(e){var t=e.top,n=void 0===t?"20%":t;return Object(v.jsx)("div",{className:"LoadingCircle",style:{top:n},children:Object(v.jsx)("img",{loading:"lazy",src:"https://icon-library.com/images/spinner-icon-gif/spinner-icon-gif-28.jpg",alt:""})})},Ie=function(e,t,n,c,a,r,i,o,u){var d=Object(s.useState)(""),h=Object(l.a)(d,2),f=h[0],O=h[1],p=Object(s.useState)(!1),x=Object(l.a)(p,2),g=x[0],v=x[1],y=Object(s.useState)(!1),w=Object(l.a)(y,2),C=w[0],N=w[1],k=Object(s.useState)(e),I=Object(l.a)(k,2),A=I[0],P=I[1];function L(e,t){return M.apply(this,arguments)}function M(){return(M=Object(b.a)(j.a.mark((function e(s,i){var o,u,l,d,h=arguments;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=h.length>2&&void 0!==h[2]?h[2]:[],u=h.length>3?h[3]:void 0,l=[],d=S(s),e.next=6,m.collection("search").where("variantsOfName","array-contains",d).get();case 6:e.sent.docs.forEach(function(){var e=Object(b.a)(j.a.mark((function e(s){var d,b,h,f,p,x,g,y,S;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((d=s.data()).place!==i){e.next=20;break}return e.next=4,m.collection(d.place).doc(d.uid).get();case 4:if(b=e.sent.data(),void 0!==o&&o.length?o.map((function(e){return e.id||e.uid})).includes(d.uid)&&l.push(b):b.isPrivate||l.push(b),void 0!==a||0!==r||0===l.length){e.next=19;break}u(l),e.t0=d.place,e.next="songs"===e.t0?11:"users"===e.t0?13:"playlists"===e.t0?15:17;break;case 11:for(h=0;h<l.length;h++)f=b.authors,K(f.map((function(e){return e.uid})),"users",n,(function(e){return e.sort((function(e,t){return t.subscribers-e.subscribers}))}),void 0,void 0,1);return e.abrupt("break",19);case 13:for(p=0;p<l.length;p++)x=b.ownSongs,g=b.ownPlaylists,K(x,"songs",t,(function(e){return e.sort((function(e,t){return t.listens-e.listens}))}),(function(){return null}),3,1),K(g,"playlists",c,(function(e){return e.sort((function(e,t){return t.listens-e.listens}))}),(function(){return null}),3,1);return e.abrupt("break",19);case 15:for(y=0;y<l.length;y++)S=b.authors,K(S.map((function(e){return e.uid})),"users",n,(function(e){return e.sort((function(e,t){return t.subscribers-e.subscribers}))}),void 0,void 0,1);return e.abrupt("break",19);case 17:return O("Wrong search mode"),e.abrupt("break",19);case 19:0!==l.length&&(v(!1),N(!0),u(l));case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),v(!1),0===l.length&&(u([]),N(!1));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(s){if(0!==e.length){var l=null!==s&&void 0!==s?s:e;if(P(l),v(!0),N(!1),void 0===a)0!==r&&1!==r||(L(l,"songs",i,t),n([]),c([])),0!==r&&2!==r||(L(l,"users",o,n),t([]),c([])),0!==r&&3!==r||(L(l,"playlists",u,c),n([]),t([]));else switch(a){case"songs":L(l,"songs",i,t);break;case"playlists":L(l,"playlists",u,c);break;case"authors":L(l,"users",o,n);break;default:L(l,"songs",i,t)}}}return Object(s.useEffect)((function(){0===e.length&&(void 0!==i&&t(i),void 0!==o&&n(o),void 0!==u&&c(u),v(!1))}),[e]),Object(s.useEffect)((function(){E()}),[r]),{findSomething:E,message:f,loading:g,foundAnything:C,inputValue:A,setInputValue:P}},Ae=function(e,t){e&&m.collection("search").doc(t).get().then((function(e){var n=e.data().rank?e.data().rank+1:1;m.collection("search").doc(t).update({rank:n})}))},Pe=function(e){var t=e.length,n=e.setInputValue,s=e.setValue;return Object(v.jsxs)("div",{className:"searchBarElement",children:[Object(v.jsx)(se.y,{}),Object(v.jsx)("span",{onClick:function(){s(""),n("")},style:t?{}:{opacity:0,visibility:"hidden",cursor:"default"},children:Object(v.jsx)(se.H,{})})]})},Le=function(e){var t=e.text,n=e.searchMode,s=e.setSearchMode,c=e.index;return Object(v.jsx)("button",{onClick:function(){return s(c)},style:n===c?{background:"var(--lightBlue)"}:{},children:t})},Me=function(e){var t=e.defaultSearchMode,n=e.searchMode,s=e.setSearchMode;return Object(v.jsx)("div",{className:"searchFilters",style:void 0!==t?{display:"none"}:{},children:["All","Songs","Authors","Playlists"].map((function(e,t){return Object(v.jsx)(Le,{text:e,searchMode:n,setSearchMode:s,index:t})}))})},Ee=function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.length>0)){e.next=7;break}return e.next=3,m.collection("search").where("variantsOfName","array-contains",t).get();case 3:return n=e.sent.docs.map(function(){var e=Object(b.a)(j.a.mark((function e(t){var n,s,c,a,r,i,o,u,l;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.data(),s=n.place,c=n.uid,a=n.rank,e.next=3,m.collection(s).doc(c).get();case 3:return r=e.sent.data(),i=r.name,o=r.authors,u=r.displayName,l=r.isVerified,e.abrupt("return",{type:s,name:i||u,author:o?o[0].displayName:null,uid:c,rank:a||0,isVerified:null!==l&&void 0!==l&&l});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.abrupt("return",n);case 7:return e.abrupt("return",[]);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Te=function(e){var t={"\u0430":"f","\u0431":",","\u0432":"d","\u0433":"u","\u0434":"l","\u0435":"t","\u0451":"`","\u0436":";","\u0437":"p","\u0438":"b","\u0439":"q","\u043a":"r","\u043b":"k","\u043c":"v","\u043d":"y","\u043e":"j","\u043f":"g","\u0440":"h","\u0441":"c","\u0442":"n","\u0443":"e","\u0444":"a","\u0445":"[","\u0446":"w","\u0447":"x","\u0448":"i","\u0449":"o","\u044a":"]","\u044b":"s","\u044c":"m","\u044d":"'","\u044e":".","\u044f":"z"},n={f:"\u0430",",":"\u0431",d:"\u0432",u:"\u0433",l:"\u0434",t:"\u0435","`":"\u0451",";":"\u0436",p:"\u0437",b:"\u0438",q:"\u0439",r:"\u043a",k:"\u043b",v:"\u043c",y:"\u043d",j:"\u043e",g:"\u043f",h:"\u0440",c:"\u0441",n:"\u0442",e:"\u0443",a:"\u0444","[":"\u0445",w:"\u0446",x:"\u0447",i:"\u0448",o:"\u0449","]":"\u044a",s:"\u044b",m:"\u044c","'":"\u044d",".":"\u044e",z:"\u044f"};return t[e[0]]?e.split("").reduce((function(e,n){return e+t[n]}),""):e.split("").reduce((function(e,t){return e+n[t]}),"")},Re=function(e){var t=e.setCurrentHint,n=e.searchValue,c=e.inputFocused,a=e.setSearchHints;Object(s.useEffect)((function(){t(-1),0!==n.length&&c?Promise.resolve(Ee(S(n))).then((function(e){Promise.all(e).then((function(e){var t=e.sort((function(e,t){return t.rank-e.rank}));t.length?a(t.slice(0,10)):Promise.resolve(Ee(Te(S(n)))).then((function(e){Promise.all(e).then((function(e){var t=e.sort((function(e,t){return t.rank-e.rank}));a(t.slice(0,10))}))}))}))})):a([])}),[n,c])},Be=n(22),De=function(e){switch(e){case"songs":return Object(v.jsx)(se.u,{style:{color:"var(--reallyLightBlue)"}});case"playlists":return Object(v.jsx)(te.a,{style:{color:"var(--lightPurple)"}});case"users":return Object(v.jsx)(se.C,{style:{color:"var(--pink)"}});case"search":return Object(v.jsx)(se.y,{});default:return Object(v.jsx)(se.u,{})}},Ue=function(e){var t=e.name,n=e.author,s=e.isVerified,c=e.type,a=e.index,r=e.currentHint,i=e.setCurrentHint,o=e.findSomething,u=e.setInputFocused;return Object(v.jsxs)("div",{className:"search-hint-item"+(r===a?" current":""),onClick:function(){i(a),u(!1),o(t)},children:[De(c),Object(v.jsx)("span",{children:t}),n&&Object(v.jsx)("span",{className:"search-hint-item-author",children:n}),s?Object(v.jsx)(Be.b,{style:{width:"12px",height:"12px",opacity:.5,marginLeft:"10px"}}):null]})},Fe=function(e){var t=e.searchValue,n=e.searchHints,c=e.setSearchHints,a=e.currentHint,r=e.setCurrentHint,i=e.inputFocused,o=e.defaultSearchMode,l=e.findSomething,d=e.setInputFocused;return Re({setCurrentHint:r,searchValue:t,inputFocused:i,setSearchHints:c}),Object(v.jsxs)("div",{className:"search-hints",style:n.length?o?{transform:"translateY(0px)"}:{transform:"translateY(-35px)"}:{display:"none"},children:[Object(v.jsx)(Ue,{name:t,type:"search",index:-1,currentHint:a,setCurrentHint:r,findSomething:l,setInputFocused:d},-1),n.map((function(e,t){return Object(s.createElement)(Ue,Object(u.a)(Object(u.a)({},e),{},{currentHint:a,setCurrentHint:r,index:t,key:e.uid,findSomething:l,setInputFocused:d}))}))]})},We=function(e){var t,n,c=e.value,a=e.setValue,r=e.setAllFoundSongs,i=e.setResultPlaylists,o=e.setResultAuthorList,u=e.focus,d=void 0!==u&&u,j=e.defaultSearchMode,b=void 0===j?void 0:j,h=e.inputText,f=void 0===h?"Search for songs or for people":h,O=e.defaultSongsListValue,p=e.defaultAuthorsListValue,m=e.defaultPlaylistsListValue,x=e.background,g=Object(s.useState)(0),y=Object(l.a)(g,2),S=y[0],w=y[1],C=Object(s.useState)(-1),N=Object(l.a)(C,2),k=N[0],I=N[1],A=Object(s.useState)([]),P=Object(l.a)(A,2),L=P[0],M=P[1],E=Object(s.useState)(d),T=Object(l.a)(E,2),R=T[0],B=T[1],D=Object(s.useRef)(null),U=Ie(null!==(t=null===(n=L[k])||void 0===n?void 0:n.name)&&void 0!==t?t:c,r,o,i,b,S,O,p,m),F=U.findSomething,W=U.loading,H=U.foundAnything,V=U.inputValue,z=U.setInputValue;Object(s.useEffect)((function(){d&&D.current.focus()}),[]);return ae(D,B),Object(v.jsxs)("div",{style:{marginTop:"10px",width:"100%"},className:"searchBarWrapper",children:[Object(v.jsxs)("div",{className:"searchBar",ref:D,children:[Object(v.jsx)(Pe,{setInputValue:z,length:c.length,setValue:a}),Object(v.jsx)("input",{type:"text",onFocus:function(){return B(!0)},style:L.length?{borderRadius:"var(--standartBorderRadius) var(--standartBorderRadius) 0 0",background:!!x&&x}:{background:!!x&&x},placeholder:f,value:V,onChange:function(e){z(e.target.value),a(e.target.value)},onKeyDown:function(e){var t,n;(function(e){var t,n,s,a;if(R)switch(e.key){case"ArrowDown":I(G(k+1,L.length-1,-1)),z(null!==(t=null===(n=L[G(k+1,L.length-1,-1)])||void 0===n?void 0:n.name)&&void 0!==t?t:c);break;case"ArrowUp":I(G(k-1,L.length-1,-1)),z(null!==(s=null===(a=L[G(k-1,L.length-1,-1)])||void 0===a?void 0:a.name)&&void 0!==s?s:c)}}(e),"Enter"===e.key)&&(F(),Ae(null===(t=L[k])||void 0===t?void 0:t.name,null===(n=L[k])||void 0===n?void 0:n.uid),M([]))}}),Object(v.jsx)(Me,{defaultSearchMode:b,searchMode:S,setSearchMode:w}),Object(v.jsx)(Fe,{searchValue:c,currentHint:k,searchHints:L,setSearchHints:M,setCurrentHint:I,inputFocused:R,defaultSearchMode:b,findSomething:F,setInputFocused:B})]}),Object(v.jsx)("div",{className:"authorsResult",children:W?Object(v.jsx)("div",{style:{position:"relative",width:"100%",height:"50px",marginTop:"40px"},children:Object(v.jsx)(ke,{})}):H||0===c.length?null:Object(v.jsx)("h2",{children:"Not found"})})]})},He=H.a.button(Se||(Se=Object(M.a)(["\n  border: none;\n  color: var(--lightBlue);\n  background: var(--lightGrey);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 5px 10px;\n  border-radius: var(--standartBorderRadius3);\n  font-weight: 600;\n\n  svg {\n    margin-right: ",";\n    width: 16px;\n    height: 16px;\n  }\n"])),(function(e){return 0===e.textLen?"0":"5px"})),Ve=function(e){var t=e.text,n=void 0===t?"":t,s=e.icon,c=e.onClick,a=e.visible;return(void 0===a||a)&&Object(v.jsxs)(He,{onClick:c,textLen:n.length,children:[s,Object(v.jsx)("span",{children:n})]})},ze=H.a.div(we||(we=Object(M.a)(["\n  width: 100%;\n  position: relative;\n  margin: ",";\n\n  button {\n    position: absolute;\n    right: 8px;\n    top: 50%;\n    transform: translateY(-50%);\n  }\n"])),(function(e){return e.margin?"0 0 10px 0":0})),Ye=H.a.input(Ce||(Ce=Object(M.a)(["\n  width: 100%;\n  box-sizing: border-box;\n  padding: 12px;\n  border-radius: var(--standartBorderRadius);\n  border: none;\n  background: var(--leftSideBarColor);\n  outline: none;\n  color: #fff;\n  font-weight: 500;\n"]))),qe=function(e){var t=e.title,n=e.type,s=void 0===n?"text":n,c=e.value,a=e.setValue,r=e.placeholder,i=void 0===r?"":r,o=e.required,u=void 0!==o&&o;e.margin;return Object(v.jsxs)(v.Fragment,{children:[!!t&&Object(v.jsx)("h3",{children:t}),Object(v.jsxs)(ze,{margin:!0,children:[Object(v.jsx)(Ye,{value:c,onChange:function(e){return a(e.target.value)},placeholder:i,type:s,required:u}),Object(v.jsx)(Ve,{icon:Object(v.jsx)(se.H,{}),onClick:function(){return a("")},visible:!!c.length})]})]})},Qe=H.a.button(Ne||(Ne=Object(M.a)(["\n  width: 100%;\n  padding: 10px;\n  box-sizing: border-box;\n  opacity: ",';\n  background: var(--purpleAndBlueGrad);\n  color: #fff;\n  font-weight: bold;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  height: 40px;\n  border-radius: var(--standartBorderRadius3);\n  position: relative;\n  overflow: hidden;\n\n  @keyframes button-animation-in {\n    0% {\n      opacity: 0;\n      transform: scale(0.95);\n    }\n    50% {\n      opacity: 1;\n      transform: scale(1);\n    }\n    100% {\n      opacity: 0;\n      transform: scale(0.95);\n    }\n  }\n\n  @keyframes button-animation-out {\n    0% {\n      opacity: 0;\n      transform: scale(0.95);\n    }\n    100% {\n      opacity: 1;\n      transform: scale(1);\n    }\n  }\n\n  .inner-button {\n    z-index: 1;\n\n    .inner-button-success {\n      animation: button-animation-in 2s forwards;\n    }\n\n    .inner-button-text {\n      animation: button-animation-out 0.5s forwards;\n    }\n  }\n\n  &::before {\n    content: "";\n    position: absolute;\n    display: block;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    background: var(--green);\n    width: ',";\n    height: ",";\n    border-radius: 100%;\n    transition: 0.6s;\n    z-index: 0;\n  }\n\n  .LoadingCircle {\n    position: relative;\n    transform: none;\n    left: auto;\n    top: auto;\n    width: 30px;\n    height: 30px;\n\n    img {\n      width: 30px;\n      height: 30px;\n    }\n  }\n"])),(function(e){return e.isLoading||!e.isActive?.5:1}),(function(e){return e.completed?"2000px":"0"}),(function(e){return e.completed?"2000px":"0"})),Ge=function(e){var t=e.text,n=e.action,c=e.isLoading,a=e.completed,r=void 0!==a&&a,i=e.setCompleted,o=e.bottomMessage,u=e.isActive,l=void 0===u||u,d=J().openBottomMessage;return Object(s.useEffect)((function(){r&&(d(null!==o&&void 0!==o?o:void 0),setTimeout((function(){i(!1)}),2e3))}),[r]),Object(v.jsx)(Qe,{isLoading:c,className:"submit-button",completed:r,isActive:l,onClick:l?n:function(){return d("Nope","failure")},children:Object(v.jsx)("div",{className:"inner-button",children:r?Object(v.jsxs)("div",{className:"inner-button-success",children:[Object(v.jsx)(Be.b,{})," Done"]}):c?Object(v.jsx)(ke,{top:0}):Object(v.jsx)("div",{className:"inner-button-text",children:t})})})},Ke=function(e){var t=e.listOfPeople,n=e.title,s=e.chosenArray,c=e.setChosenArray,a=void 0===c?function(){return null}:c,r=e.lastSeen,i=void 0!==r&&r;return Object(v.jsxs)("div",{children:[n?Object(v.jsx)("h2",{style:{marginTop:"0",marginBottom:"7px"},children:n}):null,t.map((function(e){return Object(v.jsx)(z,{data:e,chosenArray:s,setChosenArray:a,lastSeen:i})}))]})},Xe=function(e){var t=e.item,n=e.whatToShare,c=void 0===n?"song":n,a=Z().yourFriends,r=Object(s.useState)([]),i=Object(l.a)(r,2),o=i[0],u=i[1],d=N().currentUser,j=Object(s.useState)(""),b=Object(l.a)(j,2),h=b[0],f=b[1],O=Object(s.useState)(!1),p=Object(l.a)(O,2),m=p[0],x=p[1],g=Object(s.useState)(!1),y=Object(l.a)(g,2),S=(y[0],y[1]),w=J(),C=w.toggleModal,k=(w.openBottomMessage,Object(s.useState)("")),I=Object(l.a)(k,2),A=I[0],P=I[1],L=Object(s.useState)([]),M=Object(l.a)(L,2),E=M[0],T=M[1];return a.length?Object(v.jsxs)("div",{className:"FriendsListToShareWith",children:[Object(v.jsxs)("div",{style:{maxHeight:"300px",overflowY:"hidden",display:"flex",flexDirection:"column"},children:[Object(v.jsx)(We,{value:A,setValue:P,setResultAuthorList:T,defaultAuthorsListValue:a,defaultSearchMode:"authors",inputText:"Search for friends"}),Object(v.jsx)("div",{style:{overflowY:"auto",maxHeight:"100%"},children:Object(v.jsx)(Ke,{listOfPeople:E,chosenArray:o,setChosenArray:u})})]}),Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(qe,{value:h,setValue:f,placeholder:"Your message"}),Object(v.jsx)(Ge,{text:"Share with ".concat(o.length," ").concat(o.length>1||0===o.length?"friends":"friend"),action:function(){ye({shareList:o,currentUser:d,itemId:"author"===c?t.uid:t.id,whatToShare:c,messageText:h,setLoading:S,setCompleted:x}),C()},completed:m,setCompleted:x,bottomMessage:"Message was sent",isActive:!!o.length})]})]}):Object(v.jsx)("h3",{style:{margin:0},children:"No friends added"})},Je=function(e){var t=e.text,n=void 0===t?"See more":t,s=Object(L.a)(e,["text"]);return Object(v.jsxs)("div",Object(u.a)(Object(u.a)({className:"SeeMoreRoundButton"},s),{},{children:[Object(v.jsx)("button",{children:Object(v.jsx)(se.b,{})}),Object(v.jsx)("span",{children:n})]}))},_e=function(e){var t=e.song,n=Z().currentSongData,c=J().setContent,a=Object(s.useState)(t||n),r=Object(l.a)(a,2),i=r[0],o=r[1],u=Z(),d=u.displayAuthors,h=u.yourFriends,f=Object(s.useState)([]),O=Object(l.a)(f,2),p=O[0],m=O[1],x=Object(s.useState)(!0),g=Object(l.a)(x,2),y=g[0],S=g[1];function w(){return(w=Object(b.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:S(!0),m([]),h.forEach((function(e){e.addedSongs.includes(i.id)&&m((function(t){return[].concat(Object(E.a)(t),[e])}))})),S(!1);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){void 0!==t&&o(t)}),[t&&t.id]),Object(s.useEffect)((function(){!function(){w.apply(this,arguments)}()}),[i.id]),Object(v.jsxs)("div",{className:"SongInfo",children:[Object(v.jsx)("div",{className:"songImage",style:{backgroundImage:"url(".concat(i.cover,")")}}),Object(v.jsxs)("div",{className:"songInfoContent",children:[Object(v.jsx)("h3",{style:{color:i.imageColors[0]},children:i.name}),Object(v.jsx)("span",{children:d(i.authors,", ")}),Object(v.jsxs)("div",{style:{display:"flex",alignItems:"center",opacity:"0.6",fontSize:".9em",position:"relative",marginTop:"5px"},className:"listensAndDate",children:[Object(v.jsxs)("p",{className:"infoListens",style:{marginRight:"15px",marginBottom:"0",position:"relative"},children:[i.listens," ",Object(v.jsx)(Oe.c,{})]}),Object(v.jsx)("span",{children:U(i.releaseDate)})]}),Object(v.jsx)("h4",{style:{margin:"10px 0"},children:p.length>0?"Friends that listen that song":"None of your friends listens this"}),y?Object(v.jsx)("div",{style:{position:"relative",height:"50px"},children:Object(v.jsx)(ke,{top:"50%"})}):Object(v.jsxs)("div",{style:{display:"flex"},children:[p.length>0?p.map((function(e,t){if(t<2)return Object(v.jsx)(pe,{person:e},e.uid)})):Object(v.jsx)("button",{className:"shareBtn",style:{minHeight:"35px",background:i.imageColors[0]},onClick:function(){c(Object(v.jsx)(Xe,{item:i,whatToShare:"song"}))},children:"Share"}),p.length>2?Object(v.jsx)(Je,{onClick:function(){return c(Object(v.jsx)(Ke,{listOfPeople:p,title:"Friends listen ".concat(t.name)}))}}):null]})]})]})},$e=function(e,t,n){var s={id:t,type:n};m.collection("searchHistory").doc(e).get().then((function(n){var c;(null===(c=n.data())||void 0===c?void 0:c.history)?n.data().history.find((function(e){return e.id===t}))||m.collection("searchHistory").doc(e).update({history:[s].concat(Object(E.a)(n.data().history.slice(0,15)))}):m.collection("searchHistory").doc(e).set({history:[s]})}))},Ze=function(e){var t=e.data,n=e.listOfChosenAuthors,s=e.setListOfChosenAuthors,c=e.shouldSaveSearchHistory,a=void 0!==c&&c,r=N().currentUser;return Object(v.jsxs)(i.b,{to:"/authors/".concat(t.uid),className:"AuthorItemBig",onClick:function(){a&&$e(r.uid,t.uid,"users")},children:[Object(v.jsx)(R,{listOfChosenItems:n,setListOfChosenItems:s,itemId:t.uid}),Object(v.jsxs)("div",{children:[Object(v.jsx)("div",{className:"AuthorItemBigImage",style:{backgroundImage:"url(".concat(t.photoURL,")")}}),Object(v.jsx)("h3",{children:t.displayName})]})]})},et=function(e){var t=e.listOfAuthors,n=e.title,c=void 0===n?"":n,a=e.listOfChosenAuthors,r=e.setListOfChosenAuthors,i=e.saveSearchHistory,o=Object(s.useState)(0),u=Object(l.a)(o,2),d=u[0],j=u[1],b=Object(s.useRef)(null),h=Object(s.useState)(!1),f=Object(l.a)(h,2),O=f[0],p=f[1];return Object(s.useEffect)((function(){t.length>0&&(b.current.scrollWidth>b.current.offsetWidth&&p(!0))}),[t]),t.length>0?Object(v.jsxs)("div",{className:"AuthorsList",children:[0!==c.length?Object(v.jsx)("h2",{children:c}):null,Object(v.jsx)("div",{className:"authorsWrapper",ref:b,onScroll:function(e){return j(e.target.scrollLeft)},children:t.map((function(e){return Object(v.jsx)(Ze,{data:e,listOfChosenAuthors:a,setListOfChosenAuthors:r,shouldSaveSearchHistory:i},e.uid)}))}),Object(v.jsxs)("div",{className:"authorsShiftButtons",children:[Object(v.jsx)("button",{onClick:function(){var e=b.current.scrollLeft;b.current.scrollLeft=e-200,j(e-200)},style:d<=0?{visibility:"hidden",opacity:"0"}:{},children:Object(v.jsx)(se.f,{})}),Object(v.jsx)("button",{onClick:function(){var e=b.current.scrollLeft;b.current.scrollLeft=e+200,j(e+200)},style:O&&null!==b.current&&b.current.scrollWidth-b.current.offsetWidth!==d?{}:{visibility:"hidden",opacity:"0"},children:Object(v.jsx)(se.g,{})})]})]}):null},tt=function(e,t){var n=Object(s.useState)([]),c=Object(l.a)(n,2),a=c[0],r=c[1],i=Object(s.useState)(!1),o=Object(l.a)(i,2),u=o[0],d=o[1],j=N().currentUser,b=Z().currentSong,h=t||b;return Object(s.useEffect)((function(){var t=m.collection("playlists").doc(e).onSnapshot((function(e){e.exists&&r(e.data().songs)}));return function(){return t()}}),[m]),Object(s.useEffect)((function(){d(a.includes(h))}),[a,h]),[function(){if(a.length>0&&void 0!==e){if(a.includes(h)){var t=a.filter((function(e){return e!==h}));return void m.collection("playlists").doc(e).update({songs:t})}var n=a;n.unshift(h),m.collection("playlists").doc(e).update({songs:n});var s=[e].concat(Object(E.a)(j.ownPlaylists.filter((function(t){return t!==e}))));m.collection("users").doc(j.uid).update({ownPlaylists:s})}},u]},nt=function(e){var t=e.text,n=e.direction,s=void 0===n?"top":n,c=Object(L.a)(e,["text","direction"]);return A().isMobile?null:Object(v.jsx)("div",Object(u.a)(Object(u.a)({className:"Hint "+s},c),{},{children:Object(v.jsx)("h5",{children:t})}))},st=function(e){var t=e.playlist,n=e.song,s=tt(t.id,n.id),c=Object(l.a)(s,2),a=c[0],r=c[1];return Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:a,children:[r?Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(nt,{text:"Remove ".concat(n.name," from playlist")}),Object(v.jsx)(se.d,{})]}):Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(nt,{text:'Add "'.concat(n.name,'" to playlist')}),Object(v.jsx)(se.x,{})]}),t.name]})},ct=function(e){var t=e.song,n=Z(),c=n.yourPlaylists,a=n.currentSongData,r=N().currentUser,i=Object(s.useState)(t||a),o=Object(l.a)(i,2),u=o[0],d=o[1];return Object(s.useEffect)((function(){(null===t||void 0===t?void 0:t.id)&&d(t)}),[null===t||void 0===t?void 0:t.id]),Object(v.jsx)("div",{className:"AddToPlaylists",children:Object(v.jsx)("div",{style:{display:"flex",flexDirection:"column"},children:c.length?c.map((function(e,t){if(r.ownPlaylists.includes(e.id))return Object(v.jsx)(st,{playlist:e,song:u})})):Object(v.jsx)("div",{className:"songItemMenuWindowItem",children:"No playlists created"})})})},at=n(25),rt=function(e,t,n,s){e.stopPropagation();var c=t.authors.map((function(e){return e.uid})),a=[];c.forEach((function(e){n.addedAuthors.includes(e)||a.push(e)}));var r=n.addedSongs;r.push(t.id),m.collection("users").doc(n.uid).update({addedSongs:r,addedAuthors:[].concat(a,Object(E.a)(n.addedAuthors))}),a.forEach(function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(t).get();case 2:n=e.sent.data().subscribers,n++,m.collection("users").doc(t).update({subscribers:n});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())};function it(e,t){return e.filter((function(e){return this.indexOf(e)<0}),t)}var ot=function(e,t,n,s){e.stopPropagation();var c=t.authors.map((function(e){return e.uid})),a=[],r=n.addedSongs.filter((function(e){return e!==t.id}));c.forEach((function(e){s.forEach((function(t){r.includes(t.id)&&t.authors.find((function(t){return t.uid===e}))&&a.push(e)}))}));var i=it(c,a),o=it(n.addedAuthors,i);m.collection("users").doc(n.uid).update({addedSongs:r,addedAuthors:o}),i.forEach(function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(t).get();case 2:n=e.sent.data().subscribers,n--,m.collection("users").doc(t).update({subscribers:n});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())};function ut(e){var t=e.song,n=N().currentUser,s=Z().yourSongs,c=J(),a=c.openConfirm,r=c.setOpenModal;return n.addedSongs.includes(t.id)?Object(v.jsxs)("span",{onClick:function(e){e.stopPropagation(),r(!1),a("You sure you want to delete this song from library?","Yes, delete it","No, just kidding",(function(e){return ot(e,t,n,s)}))},children:[Object(v.jsx)(se.G,{}),"Delete"]}):Object(v.jsxs)("span",{onClick:function(e){return rt(e,t,n)},children:[Object(v.jsx)(se.x,{}),"Add"]})}var lt=function(e){var t=e.errorMessage,n=J().openBottomMessage;return Object(s.useEffect)((function(){t&&n(t,"failure")}),[t]),t&&Object(v.jsx)("div",{className:"Alert",children:t})};function dt(e){for(var t=[],n=0,s=e+" ",c=0;c<s.length;c++)"\n"!==s[c]&&void 0!==s[c+1]||(t.push({startTime:"undefined",text:s.substr(n,c-n)}),n=c+1);return t}var jt=function(e){var t=e.song,n=N().currentUser,c=J().toggleModal,a=Object(s.useState)(t.name),r=Object(l.a)(a,2),i=r[0],o=r[1],u=Object(s.useState)(t.authors),d=Object(l.a)(u,2),h=d[0],f=d[1],O=Object(s.useState)(t.cover),p=Object(l.a)(O,2),x=p[0],g=p[1],y=Object(s.useState)(t.imageColors),S=Object(l.a)(y,2),w=S[0],C=S[1],k=Object(s.useState)(t.lyrics.map((function(e){return e.text})).join("\n")),I=Object(l.a)(k,2),A=I[0],P=I[1],L=Object(s.useState)([]),M=Object(l.a)(L,2),T=M[0],R=M[1],B=Object(s.useState)(""),D=Object(l.a)(B,2),U=D[0],F=D[1],W=Object(s.useState)(""),H=Object(l.a)(W,2),V=H[0],Y=H[1],q=Object(s.useState)(!1),Q=Object(l.a)(q,2),G=Q[0],K=Q[1],X=Object(s.useState)(!1),_=Object(l.a)(X,2),$=_[0],Z=_[1];function ee(e){var t=h.filter((function(t){return t.uid!==e.uid}));return f(t)}return Object(s.useEffect)((function(){o(t.name),f(t.authors),g(t.cover),C(t.imageColors),P(t.lyrics.map((function(e){return e.text})).join("\n"))}),[t.id]),Object(v.jsxs)("div",{children:[Object(v.jsxs)("div",{className:"SongInfo",style:{flexDirection:"column",marginBottom:"10px"},children:[Object(v.jsx)("h3",{children:"Song cover"}),Object(v.jsxs)("div",{style:{display:"flex"},children:[Object(v.jsx)("div",{children:Object(v.jsx)("img",{loading:"lazy",src:x,alt:"",className:"songImage"})}),Object(v.jsx)("div",{style:{background:"linear-gradient(-135deg, ".concat(w[0],", ").concat(w[5]),width:"100%",borderRadius:"var(--standartBorderRadius2)",display:"flex",justifyContent:"center",alignItems:"center"},children:Object(v.jsx)("h4",{style:{color:w[1]},children:i})})]})]}),Object(v.jsx)("div",{style:{width:"100%",display:"flex"},children:w.map((function(e,t){return Object(v.jsx)("input",{type:"color",value:e,style:{width:"100%",height:"60px",padding:"0",borderRadius:"0px"},onChange:function(e){!function(e,t){w[t]=e.target.value,C(Object(E.a)(w))}(e,t)}})}))}),Object(v.jsxs)("div",{children:[Object(v.jsx)("h3",{children:"Song name"}),Object(v.jsx)("input",{type:"text",className:"standartInput",value:i,onChange:function(e){return o(e.target.value)}})]}),Object(v.jsxs)("div",{children:[Object(v.jsx)("h3",{children:"Authors"}),Object(v.jsx)(We,{value:U,setValue:F,setResultAuthorList:R,defaultSearchMode:"authors"}),Object(v.jsx)("div",{className:"songAuthorsList",children:h.map((function(e){return Object(v.jsxs)("div",{className:"chosenAuthorItem",children:[Object(v.jsx)("span",{children:e.displayName}),Object(v.jsx)(se.H,{onClick:function(){(n.isAdmin||e.uid!==n.uid)&&ee(e)}})]})}))}),Object(v.jsx)("div",{className:"authorsResult",children:T.map((function(e,t){return Object(v.jsx)(z,{data:e,onClick:function(){return function(e){if(!h.some((function(t){return t.uid===e.uid})))return f((function(t){return[].concat(Object(E.a)(t),[{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL}])}));ee(e)}(e)},style:h.includes(e.uid)?{background:"var(--green)"}:{}},t)}))})]}),Object(v.jsxs)("div",{children:[Object(v.jsx)("h3",{children:"Lyrics"}),Object(v.jsx)("textarea",{type:"text",className:"standartInput",style:{height:"200px",fontWeight:"500"},value:A,onChange:function(e){return P(e.target.value)}})]}),Object(v.jsx)(lt,{errorMessage:V}),Object(v.jsx)(Ge,{text:"Update song",action:function(){if(0===i.length)Y("Name shouldn't be empty");else if(0===h.length)Y("Song has to have at least 1 author");else if(0===x.length)Y("Song has to have cover");else{if(K(!0),h.length>t.authors.length)h.filter((function(e){return!t.authors.find((function(t){return t.uid===e.uid}))})).forEach(function(){var e=Object(b.a)(j.a.mark((function e(n){var s,c,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(n.uid).get();case 2:s=e.sent,c=s.data(),(a=c.ownSongs).push(t.id),m.collection("users").doc(n.uid).update({ownSongs:a});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());else if(h.length<t.authors.length){t.authors.filter((function(e){return!h.find((function(t){return t.uid===e.uid}))})).forEach(function(){var e=Object(b.a)(j.a.mark((function e(n){var s,c,a,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(n.uid).get();case 2:s=e.sent,c=s.data(),a=c.ownSongs,r=a.filter((function(e){return e!==t.id})),m.collection("users").doc(n.uid).update({ownSongs:r});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}m.collection("songs").doc(t.id).update({name:i,authors:h,image:x,imageColors:w,lyrics:dt(A)}).then((function(){K(!1),Z(!0),c()}))}},isLoading:G,completed:$,setCompleted:Z,bottomMessage:"Song was updated"})]})},bt=function(e){var t=e.song,n=J().setContent,s=N().currentUser;return Object(v.jsxs)("div",{className:"SongItemMobileMoreWindow",children:[Object(v.jsxs)("div",{className:"simpleSongElement",style:{background:t.imageColors[0]},children:[Object(v.jsx)("div",{className:"simpleSongElementImage",children:Object(v.jsx)("img",{loading:"lazy",src:t.cover,alt:""})}),Object(v.jsx)("span",{children:t.name})]}),s.isAdmin?Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){n(Object(v.jsx)(jt,{song:t}))},children:[Object(v.jsx)(te.h,{}),"Edit"]}):null,Object(v.jsx)("div",{className:"songItemMenuWindowItem",children:Object(v.jsx)(ut,{song:t})}),Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){return n(Object(v.jsx)(ct,{song:t}))},children:[Object(v.jsx)(at.c,{}),"Add to playlist"]}),Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){n(Object(v.jsx)(Xe,{item:t,whatToShare:"song"}))},children:[Object(v.jsx)(se.A,{}),"Share"]}),Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){n(Object(v.jsx)(_e,{song:t}))},children:[Object(v.jsx)(se.o,{}),"Info"]}),Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){n(Object(v.jsx)(et,{listOfAuthors:t.authors,title:"Authors"}))},children:[Object(v.jsx)(se.F,{}),"Authors"]})]})},ht=function(e){var t=e.openMoreWindow,n=e.song,s=e.moreWindowPosRelativeToViewport,c=J(),a=c.toggleModal,r=c.setContent,i=c.openBottomMessage,o=N().currentUser,u=Z().setCurrentSongQueue;return t?Object(v.jsxs)("div",{className:"songItemMenuWindow",style:s>window.innerHeight/2+100?{top:"auto",bottom:"110%"}:{top:"110%",bottom:"auto"},onClick:function(e){return e.stopPropagation()},children:[o.isAdmin||n.authors.find((function(e){return e.uid===o.uid}))?Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){a(),r(Object(v.jsx)(jt,{song:n}))},children:[Object(v.jsx)(te.h,{}),"Edit"]}):null,Object(v.jsx)("div",{className:"songItemMenuWindowItem",children:Object(v.jsx)(ut,{song:n})}),Object(v.jsxs)("div",{className:"songItemMenuWindowItem",children:[Object(v.jsx)("div",{className:"songItemMenuWindow inner",children:Object(v.jsx)(ct,{song:n})}),Object(v.jsx)(at.c,{}),"Add to playlist ",Object(v.jsx)(at.a,{})]}),Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){a(),r(Object(v.jsx)(Xe,{item:n,whatToShare:"song"}))},children:[Object(v.jsx)(se.A,{}),"Share"]}),Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){a(),r(Object(v.jsx)(_e,{song:n}))},children:[Object(v.jsx)(se.o,{}),"Info"]}),Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){u((function(e){return[].concat(Object(E.a)(e),[n])})),i("Song was added to queue")},children:[Object(v.jsx)(te.k,{}),"Add to queue"]})]}):null},ft=function(e){var t=N(),n=t.currentUser,s=(t.setCurrentUser,Z().yourSongs),c=J(),a=c.openBottomMessage,r=c.openConfirm,i=c.closeConfirm;return[function(t){rt(t,e,n),a("".concat(oe(e.name,15)," added to your library"))},function(t){t.stopPropagation(),r('You sure you want to delete "'.concat(e.name,'" from library?'),"Yes, delete it","No, just kidding",(function(t){ot(t,e,n,s),i(),a("".concat(oe(e.name,15)," removed from your library"),"failure")}))}]},Ot=function(e){var t=e.song,n=N().currentUser,s=ft(t),c=Object(l.a)(s,2),a=c[0],r=c[1];return n.addedSongs.includes(t.id)?Object(v.jsxs)("button",{onClick:r,style:{position:"relative"},children:[Object(v.jsx)(nt,{text:"delete song"}),Object(v.jsx)(se.G,{})]}):Object(v.jsxs)("button",{onClick:a,style:{position:"relative"},children:[Object(v.jsx)(nt,{text:"add song"}),Object(v.jsx)(se.x,{})]})};function pt(e){return e<1e3?e:e<1e6?parseFloat(e/1e3).toFixed(1)+"K":e<1e9?parseFloat(e/1e6).toFixed(1)+"M":void 0}var mt=function(e){var t=e.showListens,n=e.isNewSong,s=e.song;return t?Object(v.jsxs)("span",{style:{display:"flex",alignItems:"center",opacity:.7,fontSize:".8em"},className:n?"newSongMarker":"",children:[pt(s.listens)," ",Object(v.jsx)(Oe.c,{})]}):n?Object(v.jsx)("span",{style:{display:"flex",alignItems:"center",fontSize:".7em"},className:"newSongMarker",children:"New"}):null},xt=Object(s.memo)((function(e){var t=e.song,n=e.localIndex,c=e.showListens,a=void 0!==c&&c,r=e.isNewSong,i=void 0!==r&&r,o=e.listOfChosenSongs,u=e.setListOfSongs,d=e.position,j=e.shouldSaveSearchHistory,b=void 0!==j&&j,h=Z(),f=h.setCurrentSong,O=h.currentSong,p=h.displayAuthors,x=h.play,g=h.songRef,y=h.setPlay,S=h.setCurrentSongInQueue,w=A().isMobile,C=Object(s.useState)(!1),k=Object(l.a)(C,2),I=k[0],P=k[1],L=Object(s.useState)(0),M=Object(l.a)(L,2),E=M[0],T=M[1],B=Object(s.useRef)(null),D=N().currentUser,U=J(),F=U.toggleModal,W=U.setContent;return ae(B,P),Object(v.jsxs)("div",{style:{display:"flex",alignItems:"center",width:"100%"},children:[Object(v.jsx)(R,{listOfChosenItems:o,setListOfChosenItems:u,itemId:t.id}),Object(v.jsxs)("div",{className:"SongItem "+(t.id===O&&x?"playingNow":""),onClick:function(){if(f(t.id),m.collection("users").doc(D.uid).update({lastSongPlayed:t.id}),S(n),t.id===O&&x)return g.current.pause(),void y(!1);g.current.play(),y(!0),b&&$e(D.uid,t.id,"songs"),Y(t.id,D)},ref:I?B:null,style:I?{background:"var(--playlistsColor)"}:{},children:[Object(v.jsxs)("div",{className:"songItemImageAndName",children:[Object(v.jsxs)("div",{className:"songItemImage",children:[Object(v.jsx)("div",{className:"songItemPlayOrPause",children:t.id===O&&x?null:Object(v.jsx)(ne.c,{})}),Object(v.jsxs)("div",{className:"playingAnimation",style:t.id===O&&x?{opacity:1,visibility:"visible"}:{},children:[Object(v.jsx)(ne.b,{}),Object(v.jsx)(be,{play:x})]}),Object(v.jsx)("img",{loading:"lazy",src:t.cover,alt:""})]}),Object(v.jsxs)("div",{className:"songItemNameAndAuthor",children:[Object(v.jsxs)("div",{className:"songItemName",style:{display:"flex",alignItems:"center"},children:[oe(t.name,w?17:30),Object(v.jsx)("span",{style:{marginLeft:"10px",fontWeight:"500"},children:Object(v.jsx)(mt,{showListens:a,isNewSong:i,song:t})})]}),w?Object(v.jsx)("div",{className:"songItemAuthor",children:ue(t.authors," & ",30)}):Object(v.jsx)("div",{className:"songItemAuthor",children:p(t.authors)})]})]}),Object(v.jsxs)("div",{className:"songItemMoreBtn",children:[Object(v.jsx)(Ot,{song:t}),Object(v.jsxs)("button",{onClick:w?function(e){e.stopPropagation(),F(),W(Object(v.jsx)(bt,{song:t}))}:function(e){e.stopPropagation(),P(!I),T(d||e.target.getBoundingClientRect().top)},children:[Object(v.jsx)(nt,{text:"more"}),Object(v.jsx)(se.t,{})]})]}),Object(v.jsx)(ht,{openMoreWindow:I,song:t,moreWindowPosRelativeToViewport:E})]})]})})),gt=n(66),vt=function(e){var t=e.pages,n=e.currentPage,s=e.setCurrentPage;return Object(v.jsx)("div",{className:"Slider",children:t.map((function(e,t){return Object(v.jsx)("div",{className:"sliderItem "+(t===n?"current":""),onClick:function(){return s(t)},children:e},t)}))})},yt=function(e){var t=e.currentTime,n=e.timeSpan,s=e.id;return Object(v.jsx)("div",{className:"Loading",id:s,children:Object(v.jsx)("div",{className:"outer",style:{pointerEvents:"none"},children:Object(v.jsx)("div",{className:"inner",style:t/n<1?{width:t/n*100+"%"}:{width:"0%",opacity:"0"}})})})};function St(e){var t=Object(s.useState)(!1),n=Object(l.a)(t,2),c=n[0],a=n[1],r=new IntersectionObserver((function(e){var t=Object(l.a)(e,1)[0];return a(t.isIntersecting)}));return Object(s.useEffect)((function(){return r.observe(e.current),function(){r.disconnect()}}),[]),c}var wt,Ct=function(e){var t=e.el,n=e.index,c=e.lyricsModeratorMode,a=e.karaokeModeratorTimes,r=e.setKaraokeModeratorTimes,i=e.setInputKaraokeTime,o=e.inputKaraokeTime,u=Z(),l=u.currentSongData,d=u.currentParagraph,j=(u.displayAuthors,u.changeCurrentTime),b=u.play,h=u.currentTime,f=u.currentParagraphRef,O=u.lyrics,p=Object(s.useRef)(),m=St(d===n?f:p),x=d===n?{}:window.innerWidth>1e3?Math.abs(d-n)<2?{transform:"scale(.8) translateX(-58px)"}:{transform:"scale(.75) translateX(-78px)"}:Math.abs(d-n)<2?{transform:"scale(.8) translateX(-11.5%)"}:{transform:"scale(.75) translateX(-15.6%)"};function g(e,t){var n=a;if("down"===t)return n.splice(e+1,0,void 0),r(n),l.lyrics.splice(e+1,0,{startTime:"undefined",text:"@loading"});n.splice(e,0,void 0),r(n),l.lyrics.splice(e,0,{startTime:"undefined",text:"@loading"})}return Object(v.jsxs)("div",{className:"lyricsBlock "+(m?"":"notVisible"),id:n,onClick:function(e){return j(e,t.startTime)},style:b?d===n?{}:Math.abs(d-n)<2?{opacity:.5}:{opacity:.1}:{},ref:d===n?f:p,children:[1===c?Object(v.jsxs)("div",{className:"lyricsBlockInput",children:[Object(v.jsxs)("span",{onClick:function(e){return e.stopPropagation()},children:[void 0!==a[n]&&0!==a[n].length?Object(v.jsx)(te.b,{style:{background:"var(--themeColor3)",color:"var(--themeColor)"}}):Object(v.jsx)(se.H,{})," "]}),Object(v.jsx)("input",{type:"number",value:a[n]||o,onChange:function(e){return function(e,t){var n=a,s=e.target.value;n[t]=s,i(e.target.value),r(n)}(e,n)},onClick:function(e){return e.stopPropagation()}}),Object(v.jsxs)("div",{className:"addLyricsElementBtns",onClick:function(e){return e.stopPropagation()},children:[Object(v.jsx)("button",{onClick:function(){g(n,"up")},children:Object(v.jsx)(te.p,{})}),Object(v.jsx)("button",{onClick:function(){g(n,"down")},children:Object(v.jsx)(te.g,{})})]})]}):null,"@loading"===t.text?Object(v.jsx)(yt,{currentTime:h-O[n].startTime,timeSpan:O[n+1].startTime-O[n].startTime,id:n}):"@end"===t.text?Object(v.jsx)(v.Fragment,{}):Object(v.jsx)("p",{id:n,style:x,children:t.text},n)]},n)},Nt=[{id:0,icon:Object(v.jsx)(te.o,{}),title:"Share",component:function(){var e=Z().currentSongData,t=[Object(v.jsx)(Be.c,{}),Object(v.jsx)(re.b,{}),Object(v.jsx)(re.i,{}),Object(v.jsx)(re.j,{}),Object(v.jsx)(gt.a,{})];return Object(v.jsxs)("div",{className:"Share",children:[Object(v.jsxs)("button",{className:"shareCopyLink",children:[Object(v.jsx)(se.i,{}),"Copy link"]}),Object(v.jsx)("div",{className:"shareOnSocial",children:t.map((function(e,t){return Object(v.jsx)("div",{className:"shareSocialIcon",children:e},t)}))}),Object(v.jsx)("div",{className:"sharePeopleShort",children:Object(v.jsx)(Xe,{item:e,whatToShare:"song"})})]})}},{id:1,icon:Object(v.jsx)(te.f,{}),title:"More",component:function(){var e=Z(),t=e.currentSongData,n=e.setRightSideCurrentPage;return Object(v.jsxs)("div",{className:"Options",children:[Object(v.jsx)("div",{className:"OptionItem",children:Object(v.jsx)(ut,{song:t})}),Object(v.jsxs)("div",{className:"OptionItem",onClick:function(){return n(4)},children:[Object(v.jsx)(te.q,{}),"Go to author"]}),Object(v.jsxs)("div",{className:"OptionItem",onClick:function(){return n(5)},children:[Object(v.jsx)(at.c,{}),"Add to playlist"]}),Object(v.jsxs)("div",{className:"OptionItem",onClick:function(){return n(6)},children:[Object(v.jsx)(se.o,{}),"Info"]})]})}},{id:2,icon:Object(v.jsx)(ie.c,{}),title:"Lyrics",component:function(){var e=Z(),t=e.setIsThereKaraoke,n=e.currentSongData,c=e.setCurrentSongData,a=e.isThereKaraoke,r=e.currentParagraph,i=e.displayAuthors,o=e.currentParagraphRef,u=e.lyrics,d=e.rightSideCurrentPage,j=e.openFullScreenPlayer,b=e.openMenu,h=N().currentUser,f=Object(s.useState)(0),O=Object(l.a)(f,2),p=O[0],x=O[1],g=Object(s.useState)([]),y=Object(l.a)(g,2),S=y[0],w=y[1],C=Object(s.useState)(0),k=Object(l.a)(C,2),I=k[0],A=k[1],P=Object(s.useState)(!1),L=Object(l.a)(P,2),M=L[0],E=L[1];function T(e,t){var n=S,s=e.target.value;n[t]=s,x(e.target.value),w(n)}function R(e,t){var s=S;if("down"===t)return s.splice(e+1,0,void 0),w(s),n.lyrics.splice(e+1,0,{startTime:"undefined",text:"@loading"});s.splice(e,0,void 0),w(s),n.lyrics.splice(e,0,{startTime:"undefined",text:"@loading"})}return Object(s.useEffect)((function(){a&&b&&2===d&&j&&o.current.scrollIntoView()}),[r]),Object(s.useEffect)((function(){u&&"undefined"!==u[0].startTime&&(u.forEach((function(e){S.push(e.startTime)})),E(!0))}),[]),Object(s.useEffect)((function(){var e,s=n;void 0!==s&&0!==p&&(s.lyrics.forEach((function(e,t){e.startTime=S[t]||"undefined"})),c(s),t(!0)),(null===(e=n.lyrics)||void 0===e?void 0:e.some((function(e){return"undefined"===e.startTime})))?E(!1):E(!0)}),[p]),u?Object(v.jsxs)("div",{className:"Lyrics",children:[h.isAdmin?Object(v.jsx)(vt,{pages:["Listen mode","Edit Mode"],currentPage:I,setCurrentPage:A}):null,a?u.map((function(e,t){return Object(v.jsx)(Ct,{el:e,index:t,lyricsModeratorMode:I,karaokeModeratorTimes:S,setKaraokeModeratorTimes:w,setInputKaraokeTime:x,inputKaraokeTime:T})})):u.map((function(e,t){return Object(v.jsxs)("div",{className:"lyricsBlock",children:[1===I?Object(v.jsxs)("div",{className:"lyricsBlockInput",children:[void 0!==S[t]&&0!==S[t].length?Object(v.jsx)(te.b,{style:{background:"var(--themeColor3)",color:"var(--themeColor)"}}):Object(v.jsx)(se.H,{}),Object(v.jsx)("input",{type:"number",value:S[t]||p,onChange:function(e){return T(e,t)},onClick:function(e){return e.stopPropagation()}}),Object(v.jsxs)("div",{className:"addLyricsElementBtns",children:[Object(v.jsx)("button",{onClick:function(){return R(t,"up")},children:Object(v.jsx)(te.p,{})}),Object(v.jsx)("button",{onClick:function(){return R(t,"down")},children:Object(v.jsx)(te.g,{})})]})]}):null,Object(v.jsx)("p",{children:e.text})]},t)})),Object(v.jsxs)("h6",{className:"lyricsAuthors "+(r===u.length-1?"active":""),children:["Authors: ",i()]}),1===I?Object(v.jsx)("button",{onClick:M?function(){m.collection("songs").doc(n.id).update({lyrics:n.lyrics})}:null,className:"updateLyricsBtn",style:M?{}:{opacity:.3},children:"Update Lyrics"}):null]}):Object(v.jsx)("h3",{children:"No lyrics"})}},{id:3,icon:Object(v.jsx)(fe.a,{}),title:"Queue",component:function(){var e=Z(),t=e.currentSongQueue,n=e.currentSongPlaylistSource,s=e.setOpenFullScreenPlayer;return Object(v.jsxs)("div",{className:"Queue",children:[Object(v.jsx)("div",{className:"queueNowIsPlaying",children:Object(v.jsxs)("h5",{style:{marginTop:2},children:["Now is playing:",Object(v.jsxs)(i.b,{onClick:function(){return s(!1)},to:n.source,className:"queueAlbumName",children:[Object(v.jsx)("div",{className:"queueImage",style:n.image?{}:{display:"none"},children:Object(v.jsx)("img",{loading:"lazy",src:n.image,alt:""})}),Object(v.jsx)("span",{children:oe(n.name,25)})]})]})}),t.map((function(e,t){return Object(v.jsx)(xt,{song:e,localIndex:t},t)}))]})}},{id:4,icon:null,title:"Go To Authors",component:et},{id:5,icon:null,title:"Add to playlist",component:ct},{id:6,icon:null,title:"Info",component:_e}];function kt(){var e=Z(),t=e.imgColors,n=e.inputRef,a=e.rightSideCurrentPage,r=e.setRightSideCurrentPage,i=e.openFullScreenPlayer,o=e.setOpenFullScreenPlayer,d=e.lyrics,j=e.openMenu,b=e.setOpenMenu,h=A(),f=h.isMobile,O=(h.screenHeight,h.screenWidth,Object(s.useRef)(null)),p=Object(s.useState)(.05),m=Object(l.a)(p,2),x=m[0],g=m[1],y=Object(s.useState)(0),S=Object(l.a)(y,2),w=S[0],C=S[1],N=Object(s.useState)(0),k=Object(l.a)(N,2),I=k[0],P=k[1],L=Object(s.useState)(0),M=Object(l.a)(L,2),E=M[0],T=M[1],R=Object(s.useRef)(),B=c.a.useRef();ae(B,b);var D=Object(ce.useSwipeable)({onSwiping:function(e){e.deltaY>0&&P(e.deltaY)}}),U=c.a.useRef(),F=Object(ce.useSwipeable)({onSwiping:function(e){e.event.stopPropagation(),(j&&0===R.current.scrollTop&&e.deltaY>0||!j&&e.deltaY<0)&&T(e.deltaY)},onSwipedLeft:function(){r(G(a+1,3))},onSwipedRight:function(){r(G(a-1,3))}});Object(s.useEffect)((function(){I>150&&o(!1)}),[I]),Object(s.useEffect)((function(){!j&&E<-100?(b(!0),T(0),C(.2)):j&&E>150?(b(!1),T(0),C(.2)):function(){var e;clearTimeout(e),C(0),e=setTimeout((function(){C(.2),T(0)}),300)}()}),[E]);function W(e){var t=Nt[e].component;return Object(v.jsx)(t,{})}function H(){return d&&0===d.length}function V(e){if(2===e.id&&H())return null;C(.2),r(e.id),b(!0)}return Object(s.useEffect)((function(){0!==t.length&&(document.documentElement.style.setProperty("--themeColor",t[1]),document.documentElement.style.setProperty("--themeColor2",t[0]),document.documentElement.style.setProperty("--themeColor3",t[2]),document.documentElement.style.setProperty("--themeColor4",t[5]),document.documentElement.style.setProperty("--themeColorTransparent",t[0]+"6e"))}),[t]),Object(v.jsxs)("div",Object(u.a)(Object(u.a)({className:"bg",style:i?{top:0,opacity:1,visibility:"visible",zIndex:10,transform:"translateY(".concat(I,"px)"),borderRadius:"".concat(I<20?I:20,"px ").concat(I<20?I:20,"px 0 0"),transition:".4s opacity, ".concat(x,"s transform, .4s top, .4s visibility")}:{transform:"translateY(".concat(I,"px)"),transition:".4s opacity, ".concat(x,"s transform, .4s top, .4s visibility")},ref:function(e){D.ref(e),U.current=e}},D),{},{onTouchEnd:function(){var e;clearTimeout(e),g(.2),e=setTimeout((function(){P(0),g(0)}),100)},children:[Object(v.jsx)("div",{className:"closeFullScreen",onClick:function(){o(!1)},children:window.innerWidth>1e3?Object(v.jsx)(ne.a,{}):Object(v.jsx)(se.r,{style:{opacity:.6}})}),Object(v.jsxs)("div",{className:"FullScreenPlayer",children:[Object(v.jsx)("div",{className:"leftSide",style:j?f?{opacity:.6,visibility:"visible",transform:"translateY(20px)",borderRadius:"10px",transition:".4s"}:null:{width:"100%"},children:Object(v.jsx)(he,{inputRef:n})}),window.innerWidth>1e3?Object(v.jsxs)("div",{className:"rightSideWrapper",style:j?{}:{transform:"translateX(calc(100% - 90px))",width:0},children:[Object(v.jsx)("button",{className:"menuBtn",style:j?{transform:"rotate(180deg)"}:{opacity:0,visibility:"hidden"},onClick:function(){return b(!j)},children:Object(v.jsx)(te.c,{})}),Object(v.jsx)("div",{className:"rightSideControl",children:Nt.map((function(e,t){return Object(v.jsx)("div",{className:"controlIcon",style:e.id===a&&j?{background:"var(--themeColor)"}:2===e.id&&H()?{opacity:.4}:{},onClick:function(){return V(e)},children:e.icon},e.id)}))}),Object(v.jsx)("div",{className:"rightSide",ref:O,style:j?{}:{display:"none"},children:W(a)})]}):Object(v.jsxs)("div",Object(u.a)(Object(u.a)({className:"mobilePlayerMenu"},F),{},{ref:function(e){F.ref(e),B.current=e},style:j?{top:"calc(100% - calc(70vh + 55px) + ".concat(E,"px)"),transition:"".concat(w,"s")}:{top:"calc(100% - 55px + ".concat(E,"px)"),transition:"".concat(w,"s")},children:[Object(v.jsx)("div",{className:"mobilePlayerMenuClose",children:Object(v.jsx)(se.r,{style:{opacity:.6,width:"50px"},onClick:function(){return b(!j)}})}),Object(v.jsx)("div",{className:"controlIconsWrapper",children:Nt.map((function(e,t){if(t<=3)return Object(v.jsx)("div",{className:"controlIcon",style:e.id===a&&j?{background:"var(--transparentWhite)"}:2===e.id&&H()?{opacity:.4}:{},onClick:function(t){return V(e)},children:e.title},e.id)}))}),Object(v.jsx)("div",{className:"mobilePlayerMenuContent",ref:R,style:j?{}:{opacity:0},children:W(a)})]}))]})]}))}var It,At,Pt=H.a.div(wt||(wt=Object(M.a)(["\n  border-radius: 100%;\n  width: 20px;\n  height: 20px;\n  font-size: 0.7em;\n  background: var(--red);\n  color: #fff;\n  font-weight: bold;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  position: absolute;\n  top: 50%;\n  right: 10px;\n  transform: translateY(-50%);\n"]))),Lt=function(e){var t=e.value;return!!t&&Object(v.jsx)(Pt,{className:"notification-circle",children:t})},Mt=n(28),Et=H.a.button(It||(It=Object(M.a)(['\n  width: 100%;\n  padding: 0;\n  box-sizing: border-box;\n  background: linear-gradient(45deg, #852de5, #5c38c1);\n  color: #fff;\n  font-weight: bold;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  height: 40px;\n  border-radius: var(--standartBorderRadius3);\n  position: relative;\n  overflow: hidden;\n  z-index: 2;\n  margin: 8px 0;\n\n  @keyframes button-animation-out {\n    0% {\n      opacity: 0;\n      transform: scale(0.9);\n    }\n    100% {\n      opacity: 1;\n      transform: scale(1);\n    }\n  }\n\n  .inner-button {\n    z-index: 1;\n    position: relative;\n    width: 100%;\n    height: 100%;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n\n    .inner-button-content {\n      width: 100%;\n      height: 100%;\n    }\n\n    .inner-button-success {\n      animation: button-animation-out 2s forwards;\n    }\n\n    .inner-button-text {\n      cursor: pointer;\n      width: 100%;\n      height: 100%;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n\n      svg {\n        margin-right: 7px;\n        width: 20px;\n        height: 20px;\n      }\n    }\n\n    .inner-button-download {\n      width: 100%;\n      background: red;\n\n      input[type="file"] {\n        /* display: none; */\n        width: 100%;\n        height: 100%;\n        position: absolute;\n        left: 50%;\n        top: 50%;\n        transform: translate(-50%, -50%);\n        display: none;\n      }\n    }\n  }\n\n  &::before {\n    content: "";\n    position: absolute;\n    display: block;\n    top: 50%;\n    left: 0%;\n    transform: translateY(-50%);\n    background: var(--green);\n    width: ',";\n    height: 100%;\n    transition: 0.6s;\n    z-index: 0;\n  }\n\n  .LoadingCircle {\n    position: relative;\n    transform: none;\n    left: auto;\n    top: auto;\n    width: 30px;\n    height: 30px;\n\n    img {\n      width: 30px;\n      height: 30px;\n    }\n  }\n"])),(function(e){return e.completed?"100%":"0"})),Tt=function(e){var t=e.title,n=void 0===t?"":t,c=e.text,a=e.place,r=e.setItemSrc,i=e.setImageLocalPath,o=J().openBottomMessage,u=Object(s.useState)(""),d=Object(l.a)(u,2),h=d[0],f=d[1],O=Object(s.useState)(!1),m=Object(l.a)(O,2),x=m[0],g=m[1],y=Object(s.useState)(!1),S=Object(l.a)(y,2),w=S[0],C=S[1];function N(){return(N=Object(b.a)(j.a.mark((function e(t,n,s){var c,a,r,o,u,l,d;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),f(""),g(!0),C(!1),c="songsImages/"===n||"usersImages/"===n||"chatCovers/"===n,a=t.target.files[0],r=!1,c?(o=[".jpg",".png",".jpeg"]).find((function(e){return a.name.substr(a.name.length-e.length,e.length)===e}))?r=!0:(f("Format of your file is not valid. Download file with one of these: ".concat(o.map((function(e){return" "+e})))),g(!1)):"songs/"===n&&((u=[".mp3",".mp4a",".flac",".wav",".wma"]).find((function(e){return a.name.substr(a.name.length-e.length,e.length)===e}))?r=!0:(f("Format of your file is not valid. Download file with one of these: ".concat(u.map((function(e){return e})))),g(!1))),!r){e.next=21;break}return c&&i(URL.createObjectURL(a)),l=p.ref(),d=l.child(n+a.name),e.next=14,d.put(a);case 14:return C(!0),g(!1),e.t0=s,e.next=19,d.getDownloadURL();case 19:e.t1=e.sent,(0,e.t0)(e.t1);case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){h.length&&o(h,"failure")}),[h]),Object(v.jsxs)(v.Fragment,{children:[!!n&&Object(v.jsx)("h3",{children:n}),Object(v.jsx)(Et,{completed:w,children:Object(v.jsx)("div",{className:"inner-button",children:w?Object(v.jsxs)("div",{className:"inner-button-success",children:[Object(v.jsx)(Be.b,{})," Done"]}):x?Object(v.jsx)(ke,{top:0}):Object(v.jsx)("div",{className:"inner-button-content",children:Object(v.jsxs)("label",{className:"inner-button-download",children:[Object(v.jsxs)("div",{className:"inner-button-text",children:[Object(v.jsx)(gt.b,{}),c]}),Object(v.jsx)("input",{type:"file",name:"",id:"",onChange:function(e){return function(e,t,n){return N.apply(this,arguments)}(e,a,r)}})]})})})})]})},Rt=function(e){var t=e.loading;return Object(v.jsx)("div",{className:"FullScreenLoading",style:t?{}:{opacity:"0",visibility:"hidden"},children:Object(v.jsx)("img",{loading:"lazy",src:"https://icon-library.com/images/spinner-icon-gif/spinner-icon-gif-28.jpg",alt:""})})},Bt=function(e){var t=e.currentActive,n=e.id,s=e.label,c=e.onClick;return Object(v.jsxs)("div",{className:"RadioBtn",id:n,onClick:c,children:[Object(v.jsx)("span",{className:"radioLabel",style:t===n?{color:"var(--blue)",opacity:1,fontWeight:"bold"}:{},children:s}),Object(v.jsx)("span",{className:"radioCircle",style:t===n?{background:"var(--blue)"}:{}})]})},Dt=function(){var e=N().currentUser,t=Object(s.useState)(""),n=Object(l.a)(t,2),c=n[0],a=n[1],r=Object(s.useState)(""),i=Object(l.a)(r,2),o=i[0],u=i[1],d=Object(s.useState)(""),h=Object(l.a)(d,2),f=h[0],O=h[1],p=Object(s.useState)([]),x=Object(l.a)(p,2),g=x[0],y=x[1],S=Object(s.useState)(e.isAdmin?[]:[{uid:e.uid,photoURL:e.photoURL,displayName:e.displayName}]),C=Object(l.a)(S,2),k=C[0],I=C[1],A=Object(s.useState)(e.isAdmin?"":(new Date).toString()),P=Object(l.a)(A,2),L=P[0],M=P[1],T=Object(s.useState)(""),R=Object(l.a)(T,2),B=R[0],D=R[1],U=Object(s.useState)([]),F=Object(l.a)(U,2),W=F[0],H=F[1],V=Object(s.useState)([]),Y=Object(l.a)(V,2),q=Y[0],Q=Y[1],G=Object(s.useState)(0),K=Object(l.a)(G,2),X=K[0],J=K[1],_=Object(s.useState)(0),$=Object(l.a)(_,2),Z=$[0],ee=$[1],te=Object(s.useState)(""),ne=Object(l.a)(te,2),ce=ne[0],ae=ne[1],re=Object(s.useState)([]),ie=Object(l.a)(re,2),oe=ie[0],ue=ie[1],le=Object(s.useState)(""),de=Object(l.a)(le,2),je=(de[0],de[1]),be=Object(s.useState)(!1),he=Object(l.a)(be,2),fe=he[0],Oe=he[1],pe=Object(s.useState)(!1),xe=Object(l.a)(pe,2),ge=xe[0],ve=xe[1];function ye(e){var t=k.filter((function(t){return t.uid!==e.uid}));return I(t)}function Se(){return(Se=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),n=me(),0===c.length?je("Playlist has to have some name"):0===k.length?je("Playlist has to have at least 1 author"):0===L.length?je("You have to set release date for a playlist"):(Oe(!0),m.collection("playlists").doc(n).set({id:n,name:c,songs:q,authors:k,image:o,listens:0,creationDate:L,subscribers:0,isAlbum:1===X,imageColors:oe,isPrivate:!0===Z}).then((function(){y([]),O(""),I([]),u(""),a(""),M(""),D(""),Q([]),ee(0),Oe(!1),ve(!0)})).catch((function(e){je(e),Oe(!1)})),k.forEach(function(){var e=Object(b.a)(j.a.mark((function e(t){var s,c,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(t.uid).get();case 2:s=e.sent,c=s.data(),(a=c.ownPlaylists).push(n),m.collection("users").doc(t.uid).update({ownPlaylists:a});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),m.collection("search").doc(n).set({place:"playlists",uid:n,rank:0,variantsOfName:w(c)}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(v.jsxs)("div",{className:"AddSong",children:[Object(v.jsx)(Rt,{loading:fe}),Object(v.jsx)(Mt.a,{src:ce,getColors:function(e){return ue(e)}}),Object(v.jsxs)("div",{children:[Object(v.jsx)(qe,{title:"Playlist name",value:c,setValue:a,placeholder:"Enter playlist name"}),Object(v.jsxs)("label",{children:[Object(v.jsx)("h3",{children:"Playlist authors"}),Object(v.jsx)(We,{value:f,setValue:O,setResultAuthorList:y,defaultSearchMode:"authors",inputText:"Search for authors"}),Object(v.jsx)("div",{className:"chosenAuthorsList",children:k.map((function(t){return Object(v.jsxs)("div",{className:"chosenAuthorItem",children:[Object(v.jsx)("span",{children:t.displayName}),Object(v.jsx)(se.H,{onClick:function(){return t.uid===e.uid?null:ye(t)}})]})}))}),Object(v.jsx)("div",{className:"authorsResult",children:g.map((function(e,t){return Object(v.jsx)(z,{data:e,onClick:function(){return function(e){if(!k.some((function(t){return t.uid===e.uid})))return I((function(t){return[].concat(Object(E.a)(t),[{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL}])}));ye(e)}(e)},style:k.includes(e.uid)?{background:"var(--green)"}:{}},t)}))})]}),Object(v.jsxs)("label",{children:[Object(v.jsx)("h3",{children:"Search for songs"}),Object(v.jsx)(We,{value:B,setValue:D,setAllFoundSongs:H,defaultSearchMode:"songs",inputText:"Search for songs"}),Object(v.jsx)("div",{className:"chosenAuthorsList",children:q.map((function(e){return Object(v.jsxs)("div",{className:"chosenAuthorItem",children:[Object(v.jsx)("span",{children:e}),Object(v.jsx)(se.H,{onClick:function(){return function(e){var t=q.filter((function(t){return t!==e}));return Q(t)}(e)}})]})}))}),Object(v.jsx)("div",{className:"authorsResult",children:W.map((function(e,t){return Object(v.jsx)(xt,{song:e,localIndex:t,listOfChosenSongs:q,setListOfSongs:Q})}))})]}),e.isAdmin||e.isAuthor?Object(v.jsxs)("div",{style:{display:"flex",justifyContent:"flex-start",margin:"15px 0"},children:[Object(v.jsx)(Bt,{label:"Playlist",onClick:function(){return J(0)},currentActive:X,id:0}),Object(v.jsx)(Bt,{label:"Album",onClick:function(){return J(1)},currentActive:X,id:1})]}):null,Object(v.jsxs)("div",{style:{display:"flex",justifyContent:"flex-start",margin:"15px 0"},children:[Object(v.jsx)(Bt,{label:"Not Private",onClick:function(){return ee(0)},currentActive:Z,id:0}),Object(v.jsx)(Bt,{label:"Private",onClick:function(){return ee(1)},currentActive:Z,id:1})]}),(e.isAdmin||e.isAuthor)&&Object(v.jsx)(qe,{title:"Release Date",type:"date",value:L,setValue:M,placeholder:"Enter release date"}),Object(v.jsx)(Tt,{text:"Download playlist cover",place:"songsImages/",setItemSrc:u,setImageLocalPath:ae}),Object(v.jsx)(Ge,{text:"Add playlists",action:function(e){return Se.apply(this,arguments)},isLoading:fe,completed:ge,setCompleted:ve,bottomMessage:"Playlist was uploaded to database"})]})]})},Ut=function(){return Object(v.jsx)("div",{className:"CreatePlaylistPage",children:Object(v.jsx)(Dt,{})})},Ft="/login",Wt="/signup",Ht="/home",Vt="/library",zt="/search",Yt="/chat",qt="/history",Qt=[{id:0,icon:Object(v.jsx)(se.m,{}),title:"Home",link:Ht},{id:1,icon:Object(v.jsx)(te.m,{}),title:"Library",link:Vt},{id:2,icon:Object(v.jsx)(te.n,{}),title:"Search",link:zt},{id:3,icon:Object(v.jsx)(se.q,{}),title:"Chat",link:Yt}],Gt=(n(267),H.a.div(At||(At=Object(M.a)(["\n  width: 100%;\n  border-radius: var(--standartBorderRadius);\n  background: var(--navItemColor);\n  color: #fff;\n  font-weight: bold;\n  min-height: 40px;\n  padding: 0.4px 5px;\n  box-sizing: border-box;\n  scroll-snap-type: y mandatory;\n  transition: 0.2s height;\n  position: relative;\n\n  &:hover {\n    a {\n      text-decoration: none;\n    }\n  }\n\n  .personName {\n    white-space: nowrap;\n    text-overflow: ellipsis;\n  }\n"]))));function Kt(e,t){return e.reduce((function(e,n){return n.sender===t.uid||void 0===n.seenBy||n.seenBy.includes(t.uid)?e:++e}),0)}var Xt=function(){var e=N().currentUser,t=Object(s.useState)(0),n=Object(l.a)(t,2),c=n[0],a=n[1];return Object(s.useEffect)((function(){var t=m.collection("chats").where("participants","array-contains",e.uid).onSnapshot((function(t){a(0),t.docs.map((function(t){var n=t.data();a((function(t){return t+Kt(n.messages,e)}))}))}));return function(){t()}}),[]),c};function Jt(e){var t=e.id,n=e.title,s=e.icon,c=e.link,a=e.currentPage,r=e.setCurrentPage,o=e.notificationValue;return Object(v.jsx)(i.b,{to:c,children:Object(v.jsxs)("div",{className:"NavigationItem "+(t===a?"active":""),onClick:function(){return r(t)},children:[Object(v.jsx)("div",{className:"icon",children:s}),Object(v.jsx)("b",{children:n}),Object(v.jsx)(Lt,{value:o})]})})}var _t,$t=function(e){var t=e.currentPage,n=e.setCurrentPage,s=Object(l.a)(Qt,4),c=s[0],a=s[1],r=s[2],i=s[3],o=Xt();return Object(v.jsxs)("div",{className:"NavigationPanel",children:[Object(v.jsx)(Jt,{id:c.id,title:c.title,icon:c.icon,link:c.link,currentPage:t,setCurrentPage:n},0),Object(v.jsx)(Jt,{id:a.id,title:a.title,icon:a.icon,link:a.link,currentPage:t,setCurrentPage:n},1),Object(v.jsx)(Jt,{id:r.id,title:r.title,icon:r.icon,link:r.link,currentPage:t,setCurrentPage:n},2),Object(v.jsx)(Jt,{id:i.id,title:i.title,icon:i.icon,link:i.link,currentPage:t,setCurrentPage:n,notificationValue:o},3)]})},Zt=function(e){var t=Object(s.useState)(!1),n=Object(l.a)(t,2),c=n[0],a=n[1];return Object(s.useEffect)((function(){var t=m.collection("users").doc(e).onSnapshot((function(t){if(void 0!==e){var n=(new Date).getTime()-3e5,s=t.data().online>n;a(s)}}));return function(){t()}}),[e]),c},en=function(e){var t=e.userUID;e.setIsOnline;return Zt(t)?Object(v.jsx)("div",{className:"onlineCircle"}):null},tn=H.a.div(_t||(_t=Object(M.a)(['\n  width: 10px;\n  height: 10px;\n  background: var(--red);\n  box-shadow: 0 0 10px var(--red);\n  border-radius: 100%;\n  position: relative;\n\n  @keyframes waveAnimation {\n    0% {\n      opacity: 0;\n      transform: scale(0.95);\n    }\n    60% {\n      opacity: 0.5;\n      transform: scale(2);\n    }\n    100% {\n      opacity: 0;\n      transform: scale(0.95);\n    }\n  }\n\n  &::after {\n    content: "";\n    width: 10px;\n    height: 10px;\n    background: var(--red);\n    filter: brightness(0.3);\n    border-radius: 100%;\n    animation: waveAnimation 1.5s infinite;\n    position: absolute;\n    top: 0;\n    left: 0;\n    z-index: -1;\n  }\n']))),nn=function(){return Object(v.jsx)(tn,{})},sn=function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("songs").doc(t).get();case 2:return n=e.sent.data(),e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),cn=function(e){var t=Object(s.useState)(),n=Object(l.a)(t,2),c=n[0],a=n[1],r=Z(),i=r.setCurrentSong,o=r.currentSong,u=r.play,d=r.songRef,j=r.setPlay,b=r.setCurrentSongInQueue,h=N().currentUser;return Object(s.useEffect)((function(){(null===e||void 0===e?void 0:e.lastSongPlayed)&&sn(e.lastSongPlayed).then((function(e){return a(e)}))}),[e.lastSongPlayed]),[c,function(){if(i(c.id),m.collection("users").doc(h.uid).update({lastSongPlayed:c.id}),b(0),c.id===o&&u)return d.current.pause(),void j(!1);d.current.play(),j(!0)}]},an=function(e){var t=e.index,n=e.friend,c=N().currentUser,a=J().openBottomMessage,r=Object(s.useState)(0),o=Object(l.a)(r,2),u=o[0],d=o[1],j=Object(s.useState)(!1),b=Object(l.a)(j,2),h=b[0],f=b[1],O=Object(s.useState)(""),p=Object(l.a)(O,2),m=p[0],x=p[1],g=Z(),y=g.currentSong,S=g.currentSongData,w=Object(s.useState)(!1),C=Object(l.a)(w,2),k=C[0],I=C[1],A=Zt(n.uid),P=cn(n),L=Object(l.a)(P,2),M=L[0],E=L[1];return Object(s.useEffect)((function(){ge([n.uid],c,f,d)}),[]),Object(s.useEffect)((function(){(null===m||void 0===m?void 0:m.length)>0&&(I(!0),setTimeout((function(){x(""),I(!1)}),600))}),[m]),Object(v.jsxs)("div",{className:"person",id:n.uid,children:[Object(v.jsx)("img",{loading:"lazy",src:S.cover,alt:"",className:"sendSongImage "+m}),Object(v.jsxs)("div",{className:"personBtns",children:[Object(v.jsx)(i.b,{to:"/chat/".concat(u),children:Object(v.jsxs)("button",{onClick:function(){h&&xe([c.uid,n.uid],u)},children:[Object(v.jsx)(nt,{text:"chat"}),Object(v.jsx)(se.q,{})]})}),Object(v.jsxs)("button",{onClick:E,children:[Object(v.jsx)(nt,{text:A?oe("".concat(null===M||void 0===M?void 0:M.name," | ").concat(null===M||void 0===M?void 0:M.authors[0].displayName)||"No song data",20):"last listened song"}),A?Object(v.jsx)(nn,{}):Object(v.jsx)(se.u,{})]}),Object(v.jsxs)("button",{onClick:function(){k||(ye({shareList:[n.uid],currentUser:c,itemId:y,whatToShare:"song",setShouldCreate:f,setFriendChatId:d}),x("sendAnimation"),a("".concat(S.name," was sent to ").concat(n.displayName)))},children:[Object(v.jsx)(nt,{text:"share"}),Object(v.jsx)(te.o,{})]})]}),Object(v.jsx)(i.b,{className:"personImg",to:"/authors/".concat(n.uid),children:Object(v.jsx)("img",{loading:"lazy",src:n.photoURL,alt:""})}),Object(v.jsx)(en,{userUID:n.uid}),Object(v.jsx)("div",{className:"personName",style:{pointerEvents:"none"},children:oe(n.displayName,12)})]},t)},rn=function(e,t,n){var c=Z(),a=c.currentSongPlaylistSource,r=c.playSong,i=c.setCurrentSongQueue,o=c.setCurrentSong,u=c.setPlay,l=c.songRef,d=c.setCurrentSongInQueue,h=c.setCurrentSongPlaylistSource,f=N().currentUser;return Object(s.useEffect)((function(){if(t.length){var n={source:"/albums/".concat(e.id),name:e.name,image:e.image,songsList:t},s=t.map((function(e){return e.id}));i(t),d(0),o(t[0].id),l.current.play(),u(!0),h(n),m.collection("users").doc(f.uid).update({lastSongPlayed:t[0].id,lastQueue:{image:n.image,name:n.name,songsList:s,source:n.source}})}}),[t.length]),function(t){t.preventDefault(),a.name!==e.name?(n([]),0!==e.length&&e.songs.map(function(){var e=Object(b.a)(j.a.mark((function e(t){var s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("songs").doc(t).get();case 2:s=e.sent.data(),n((function(e){return[].concat(Object(E.a)(e),[s])}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())):r()}},on=function(e){var t=e.playlist,n=J(),c=n.toggleModal,a=n.setContent,r=Object(s.useState)([]),u=Object(l.a)(r,2),d=u[0],j=u[1],b=rn(t,d,j),h=tt(t.id),f=Object(l.a)(h,2),O=f[0],p=f[1],m=N().currentUser,x=Object(o.g)();return Object(v.jsxs)("div",{className:"TinyPlaylist",children:[Object(v.jsxs)("div",{className:"TinyPlaylistBtns",children:[t.authors.find((function(e){return e.uid===m.uid}))?Object(v.jsx)("button",{onClick:O,children:p?Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(nt,{text:"remove song"}),Object(v.jsx)(se.d,{})]}):Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(nt,{text:"add song"}),Object(v.jsx)(se.x,{})]})}):Object(v.jsxs)("button",{onClick:function(){c(),a(Object(v.jsx)(Xe,{item:t,whatToShare:"playlist"}))},children:[Object(v.jsx)(nt,{text:"share"}),Object(v.jsx)(se.A,{})]}),Object(v.jsx)(i.b,{to:"/albums/".concat(t.id),children:Object(v.jsxs)("button",{children:[Object(v.jsx)(nt,{text:"album"}),Object(v.jsx)(te.a,{})]})}),Object(v.jsxs)("button",{onClick:b,children:[Object(v.jsx)(nt,{text:"play"}),Object(v.jsx)(se.v,{})]})]}),Object(v.jsx)("div",{className:"TinyPlaylistImg",style:{backgroundImage:"url(".concat(t.image,")"),display:"inline-block",backgroundPosition:"center center",backgroundSize:"cover",position:"relative"},onClick:function(){return x.push("/albums/".concat(t.id))},children:t.image?null:Object(v.jsx)(te.a,{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",width:"20px",height:"20px"}})}),Object(v.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[Object(v.jsx)("span",{children:oe(t.name,13)}),Object(v.jsx)("span",{style:{fontSize:"0.8em",color:"grey",fontWeight:"500"},children:t.isAlbum?"album":"playlist"})]})]})},un=function(){var e=N().currentUser,t=Object(s.useState)(0),n=Object(l.a)(t,2),c=n[0],a=n[1],r=Z(),o=r.leftSideBarInputRef,u=r.setOpenFullScreenPlayer,d=r.currentSongData,j=r.yourFriends,b=r.yourPlaylists,h=J(),f=h.toggleModal,O=h.setContent,p=Object(s.useState)(0),m=Object(l.a)(p,2),x=m[0],y=m[1],w=Object(s.useState)((function(){var e=Qt.find((function(e,t){return!!window.location.hash.includes(S(e.title))}));return void 0===e?-1:e.id})),C=Object(l.a)(w,2),k=C[0],I=C[1];return Object(s.useEffect)((function(){a(e.friends.reduce((function(e,t){return"requested"===t.status?e+1:e}),0))}),[JSON.stringify(e.friends)]),Object(v.jsxs)("div",{className:"LeftsideBar",children:[Object(v.jsxs)("div",{className:"logo",children:[Object(v.jsx)("img",{loading:"lazy",src:g,alt:""}),Object(v.jsx)("h3",{children:"Soundbubble"})]}),Object(v.jsx)(Gt,{onClick:function(){return I(-1)},children:Object(v.jsx)(i.b,{to:"/authors/".concat(e.uid),children:Object(v.jsxs)("div",{className:"person",style:-1===k?{background:"var(--blue)"}:{},children:[Object(v.jsx)(Lt,{value:c}),Object(v.jsx)("div",{className:"personImg",style:{backgroundImage:"url(".concat(e.photoURL,")")}}),Object(v.jsx)("div",{className:"personName",children:oe(e.displayName,11)})]})})}),Object(v.jsx)($t,{currentPage:k,setCurrentPage:I}),Object(v.jsxs)(Gt,{className:"leftSideBarContainer friendsAndPlaylists",children:[Object(v.jsx)("span",{style:{display:x?"none":"block",animation:"scrollFromBottom .2s forwards"},children:j.length>0?Object(v.jsxs)(v.Fragment,{children:[j.map((function(e,t){return t<=2?Object(v.jsx)(an,{index:e.uid,friend:e}):null})),Object(v.jsx)("h4",{className:"seeMoreBtn",onClick:function(){f(),O(Object(v.jsx)(Xe,{item:d,whatToShare:"song"}))},children:"See more"})]}):Object(v.jsx)("h4",{style:{alignSelf:"center",width:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:"No friends added"})}),Object(v.jsxs)("span",{style:{display:x?"block":"none",animation:"scrollFromTop .2s forwards"},children:[b.map((function(e,t){if(t<=2)return Object(v.jsx)(on,{playlist:e},e.id)})),Object(v.jsxs)("button",{className:"createPlaylistBtn",onClick:function(){f(),O(Object(v.jsx)(Ut,{}))},style:{margin:"5px 0"},children:[Object(v.jsx)(te.i,{}),"Create Playlist"]})]}),Object(v.jsxs)("div",{className:"upAndDownBtns",children:[Object(v.jsx)("button",{onClick:function(){return y(0)},style:x?{}:{opacity:"0.3"},children:Object(v.jsx)(se.h,{})}),Object(v.jsx)("button",{onClick:function(){return y(1)},style:x?{opacity:"0.3"}:{},children:Object(v.jsx)(se.e,{})})]})]}),Object(v.jsx)("div",{className:"leftSideBarContainer",children:-1===d.id?null:Object(v.jsxs)("div",{className:"littlePlayer",children:[Object(v.jsx)(he,{textLimit:15,inputRef:o}),Object(v.jsx)("div",{className:"fullScreenBtn",onClick:function(){return u(!0)},children:Object(v.jsx)(te.j,{})})]})})]})},ln=function(){var e=Z(),t=e.currentSongData,n=e.currentSongPlaylistSource,c=e.nextSong,a=e.prevSong,r=e.songRef,i=e.setPlay,o=function(){navigator.mediaSession.setPositionState({duration:r.current.duration,playbackRate:r.current.playbackRate,position:r.current.currentTime})};function u(){r.current.pause(),i(!1)}Object(s.useEffect)((function(){"mediaSession"in navigator&&-1!==t.id&&(navigator.mediaSession.metadata=new window.MediaMetadata({title:t.name,artist:ue(t.authors),album:n.name,artwork:[{src:t.cover,sizes:"512x512",type:"image/png"}]}),navigator.mediaSession.setActionHandler("play",(function(){r.current.play(),i(!0)})),navigator.mediaSession.setActionHandler("pause",u),navigator.mediaSession.setActionHandler("stop",u),navigator.mediaSession.setActionHandler("nexttrack",(function(){c(),o()})),navigator.mediaSession.setActionHandler("previoustrack",(function(){a(),o()})))}),[t.id])},dn=function(e){var t=e.func,n=e.lenOfList,s=e.maxLen,c=void 0===s?5:s,a=e.boolVal;return Object(v.jsx)("div",{onClick:n>c?t:null,className:"MoreBtn",style:n<=c?{display:"none"}:{},children:Object(v.jsx)("button",{style:a?{background:"var(--pink)",color:"#ff8db2"}:{},children:a?"Close":"More"})})},jn=function(e){var t=e.title,n=e.func,s=e.boolVal,c=e.lenOfList,a=e.maxLen,r=void 0===a?5:a,i=e.marginBottom,o=void 0===i?0:i;return 0!==c?Object(v.jsxs)("div",{className:"topTitle",style:{margin:"10px 0"},children:[Object(v.jsx)("h2",{style:{margin:o},children:t}),Object(v.jsx)(dn,{func:n,boolVal:s,lenOfList:c,maxLen:r})]}):null},bn=function(e){var t=e.listOfSongs,n=e.source,c=e.title,a=void 0===c?"":c,r=e.showListens,o=void 0!==r&&r,u=e.isNewSong,d=void 0!==u&&u,j=e.showCount,b=void 0!==j&&j,h=e.listOfChosenSongs,f=e.setListOfSongs,O=e.showSearch,p=void 0!==O&&O,x=e.displayIfEmpty,g=e.showhistory,y=void 0!==g&&g,S=e.saveSearchHistory,w=void 0!==S&&S,C=e.isHorizontal,k=void 0!==C&&C,I=Z(),A=I.setCurrentSongQueue,P=I.setCurrentSongPlaylistSource,L=(I.playSong,I.setCurrentSong,N().currentUser),M=Object(s.useState)(!1),E=Object(l.a)(M,2),T=E[0],R=E[1],B=Object(s.useState)(""),D=Object(l.a)(B,2),U=D[0],F=D[1],W=Object(s.useState)(t),H=Object(l.a)(W,2),V=H[0],z=H[1];return Object(s.useEffect)((function(){z(t)}),[t]),Object(v.jsxs)("div",{className:"SongList",onClick:function(){if("no"!==n&&0!==t.length){A(t),P(n);var e=t.map((function(e){return e.id}));m.collection("users").doc(L.uid).update({lastQueue:{image:n.image,name:n.name,songsList:e,source:n.source}})}},children:[0!==a.length?Object(v.jsx)(jn,{title:a,func:function(){return R(!T)},boolVal:T,lenOfList:t.length}):null,p?Object(v.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[Object(v.jsx)(We,{value:U,setValue:F,allFoundSongs:V,setAllFoundSongs:z,defaultSearchMode:"songs",defaultSongsListValue:t,inputText:"Search for songs",background:"#00000061"}),y?Object(v.jsx)(i.b,{to:qt,children:Object(v.jsx)("button",{className:"standartButton",style:{marginTop:"10px",marginBottom:"0",height:"44px",width:"44px",padding:"0",marginLeft:"6px",background:"var(--playlistsColor)"},children:Object(v.jsx)(re.d,{style:{marginRight:"0"}})})}):null]}):null,Object(v.jsx)("div",{className:"list-of-songs"+(k?" horizontal":""),children:V.map((function(e,t){return 0===a.length||T||t<5?Object(v.jsxs)("span",{className:"topSongItem",children:[b?Object(v.jsx)("h3",{style:{opacity:"0.7"},children:t+1}):null,Object(v.jsx)(xt,{song:e,localIndex:t,showListens:o,isNewSong:d,listOfChosenSongs:h,setListOfSongs:f,shouldSaveSearchHistory:w},e.id)]}):void 0}))}),Object(v.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:0===t.length?x:null})]})},hn=function(e){var t=e.playlist,n=N().currentUser,c=Object(s.useState)(t.name),a=Object(l.a)(c,2),r=a[0],i=a[1],o=Object(s.useState)(t.image),u=Object(l.a)(o,2),d=u[0],h=u[1],f=Object(s.useState)(""),O=Object(l.a)(f,2),p=O[0],x=O[1],g=Object(s.useState)([]),y=Object(l.a)(g,2),S=y[0],w=y[1],C=Object(s.useState)(t.authors),k=Object(l.a)(C,2),I=k[0],A=k[1],P=Object(s.useState)(t.creationDate),L=Object(l.a)(P,2),M=L[0],T=L[1],R=Object(s.useState)(""),B=Object(l.a)(R,2),D=B[0],U=B[1],F=Object(s.useState)([]),W=Object(l.a)(F,2),H=W[0],V=W[1],Y=Object(s.useState)(t.songs),q=Object(l.a)(Y,2),Q=q[0],G=q[1],K=Object(s.useState)(t.isAlbum?1:0),X=Object(l.a)(K,2),J=X[0],_=X[1],$=Object(s.useState)(t.isPrivate?1:0),Z=Object(l.a)($,2),ee=Z[0],te=Z[1],ne=Object(s.useState)(!1),ce=Object(l.a)(ne,2),ae=ce[0],re=(ce[1],Object(s.useState)(!1)),ie=Object(l.a)(re,2),oe=ie[0],ue=ie[1],le=Object(s.useState)(""),de=Object(l.a)(le,2),je=de[0],be=de[1],he=Object(s.useState)(t.imageColors),fe=Object(l.a)(he,2),Oe=fe[0],pe=fe[1],xe=Object(s.useState)(!1),ge=Object(l.a)(xe,2),ve=ge[0],ye=ge[1],Se=Object(s.useState)(!1),we=Object(l.a)(Se,2),Ce=we[0],Ne=we[1];function Ie(e){var t=I.filter((function(t){return t.uid!==e.uid}));return A(t)}function Ae(){return(Ae=Object(b.a)(j.a.mark((function e(n){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.preventDefault(),me(),I.length>t.authors.length?I.filter((function(e){return!t.authors.find((function(t){return t.uid===e.uid}))})).forEach(function(){var e=Object(b.a)(j.a.mark((function e(n){var s,c,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(n.uid).get();case 2:s=e.sent,c=s.data(),(a=c.ownPlaylists).push(t.id),m.collection("users").doc(n.uid).update({ownPlaylists:a});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()):I.length<t.authors.length&&t.authors.filter((function(e){return!I.find((function(t){return t.uid===e.uid}))})).forEach(function(){var e=Object(b.a)(j.a.mark((function e(n){var s,c,a,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(n.uid).get();case 2:s=e.sent,c=s.data(),a=c.ownPlaylists,r=a.filter((function(e){return e!==t.id})),m.collection("users").doc(n.uid).update({ownPlaylists:r});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),m.collection("playlists").doc(t.id).update({id:t.id,name:r,songs:Q,authors:I,image:d,listens:t.listens,creationDate:M,subscribers:t.subscribers,isAlbum:1===J,imageColors:Oe,isPrivate:1===ee}).then((function(){ye(!1),Ne(!0)}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){i(t.name),h(t.image),A(t.authors)}),[t.id]),Object(s.useEffect)((function(){0===D.length&&t.songs.map(function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("songs").doc(t).get();case 2:n=e.sent.data(),ue(!1),V((function(e){return[].concat(Object(E.a)(e),[n])}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[D]),Object(v.jsxs)("div",{className:"AddSong",children:[Object(v.jsx)(Mt.a,{src:je,getColors:function(e){return pe(e)}}),Object(v.jsx)(qe,{title:"Playlist name",value:r,setValue:i,placeholder:"Enter playlist name"}),Object(v.jsxs)("label",{children:[Object(v.jsx)("h3",{children:"Playlist authors"}),Object(v.jsx)(We,{value:p,setValue:x,setResultAuthorList:w,defaultSearchMode:"authors",inputText:"Search for authors"}),Object(v.jsx)("div",{className:"chosenAuthorsList",children:I.map((function(e){return Object(v.jsxs)("div",{className:"chosenAuthorItem",children:[Object(v.jsx)("span",{children:e.displayName}),Object(v.jsx)(se.H,{onClick:function(){return e.uid===n.uid?null:Ie(e)}})]})}))}),Object(v.jsx)("div",{className:"authorsResult",children:ae?Object(v.jsx)("div",{style:{position:"relative",width:"100%",height:"50px"},children:Object(v.jsx)(ke,{})}):S.map((function(e,t){return Object(v.jsx)(z,{data:e,onClick:function(){return function(e){if(!I.some((function(t){return t.uid===e.uid})))return A((function(t){return[].concat(Object(E.a)(t),[{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL}])}));Ie(e)}(e)},style:I.includes(e.uid)?{background:"var(--green)"}:{}},t)}))})]}),Object(v.jsxs)("label",{children:[Object(v.jsx)("h3",{children:"Search for songs"}),Object(v.jsx)(We,{value:D,setValue:U,setAllFoundSongs:V,defaultSearchMode:"songs",inputText:"Search for songs"}),Object(v.jsx)("div",{className:"authorsResult",children:oe?Object(v.jsx)("div",{style:{position:"relative",width:"100%",height:"50px"},children:Object(v.jsx)(ke,{})}):Object(v.jsx)(bn,{listOfSongs:H,source:"no",listOfChosenSongs:Q,setListOfSongs:G})})]}),n.isAdmin||n.isAuthor?Object(v.jsxs)("div",{style:{display:"flex",justifyContent:"flex-start",margin:"15px 0"},children:[Object(v.jsx)(Bt,{label:"Playlist",onClick:function(){return _(0)},currentActive:J,id:0}),Object(v.jsx)(Bt,{label:"Album",onClick:function(){return _(1)},currentActive:J,id:1})]}):null,Object(v.jsxs)("div",{style:{display:"flex",justifyContent:"flex-start",margin:"15px 0"},children:[Object(v.jsx)(Bt,{label:"Not Private",onClick:function(){return te(0)},currentActive:ee,id:0}),Object(v.jsx)(Bt,{label:"Private",onClick:function(){return te(1)},currentActive:ee,id:1})]}),(n.isAdmin||n.isAuthor)&&Object(v.jsx)(qe,{title:"Release Date",type:"date",value:M,setValue:T,placeholder:"Enter release date"}),Object(v.jsx)(Tt,{text:"Download playlist cover",place:"songsImages/",setItemSrc:h,setImageLocalPath:be}),Object(v.jsx)(Ge,{text:"Update playlist",action:function(e){return Ae.apply(this,arguments)},isLoading:ve,completed:Ce,setCompleted:Ne,bottomMessage:"Playlist was updated"})]})},fn=function(){var e=Object(b.a)(j.a.mark((function e(t,n){var s,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(n.uid).get();case 2:(s=e.sent.data().addedAuthors).push(t.uid),m.collection("users").doc(n.uid).update({addedAuthors:s}),c=t.subscribers,c++,m.collection("users").doc(t.uid).update({subscribers:c});case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();function On(e,t){var n=e.friends,s=t.friends;n.push({status:"requested",uid:t.uid}),s.push({status:"awaiting",uid:e.uid}),m.collection("users").doc(e.uid).update({friends:n}),m.collection("users").doc(t.uid).update({friends:s})}var pn=function(e,t){},mn=function(e){var t=e.data,n=e.color,c=N().currentUser,a=Object(s.useState)(!1),r=Object(l.a)(a,2),o=r[0],u=r[1],d=Object(s.useState)(0),j=Object(l.a)(d,2),b=j[0],h=j[1];return Object(s.useEffect)((function(){ge([t.uid],c,u,h)}),[t.uid]),Object(v.jsx)(i.b,{to:"/chat/".concat(b),style:{display:"block",width:"fit-content",textDecoration:"none"},children:Object(v.jsxs)("button",{onClick:function(){o&&xe([c.uid,t.uid],b)},style:{background:n},className:"ChatWithFriendButton",children:[Object(v.jsx)(se.q,{})," Messages"]})})},xn=n(127),gn=function(e){var t=e.data,n=e.loading,s=cn(t,n),c=Object(l.a)(s,2),a=c[0],r=c[1];return void 0!==a?Object(v.jsxs)("div",{className:"LastSongListened",onClick:r,children:[Object(v.jsx)(xn.a,{}),Object(v.jsx)("span",{children:a.name})]}):null},vn=function(e){var t=e.author,n=Object(s.useState)(t.displayName),c=Object(l.a)(n,2),a=c[0],r=c[1],i=Object(s.useState)(t.photoURL),o=Object(l.a)(i,2),u=o[0],d=o[1],h=Object(s.useState)(""),f=Object(l.a)(h,2),O=f[0],x=f[1],g=Object(s.useState)(t.imageColors),y=Object(l.a)(g,2),S=y[0],w=y[1];function C(){return(C=Object(b.a)(j.a.mark((function e(t,n,s){var c,a,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=t.target.files[0],x(URL.createObjectURL(c)),a=p.ref(),r=a.child(n+c.name),e.next=6,r.put(c);case 6:return e.t0=s,e.next=9,r.getDownloadURL();case 9:e.t1=e.sent,(0,e.t0)(e.t1);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(v.jsxs)("div",{className:"AddSong",children:[Object(v.jsx)(Mt.a,{src:O,getColors:function(e){return w(e)}}),Object(v.jsxs)("form",{onSubmit:function(e){return e.preventDefault()},children:[Object(v.jsx)("div",{style:{width:"100%",display:"flex",justifyContent:"center"},children:Object(v.jsx)("div",{className:"chatInfoImage",style:{backgroundImage:"url(".concat(u,")")},children:Object(v.jsxs)("label",{className:"changePhoto",children:[Object(v.jsx)(at.b,{}),"Change photo",Object(v.jsx)("input",{type:"file",style:{display:"none"},onChange:function(e){return function(e,t,n){return C.apply(this,arguments)}(e,"chatCovers/",d)}})]})})}),Object(v.jsxs)("label",{children:[Object(v.jsx)("h3",{children:"Your name"}),Object(v.jsx)("input",{type:"text",placeholder:"Enter your name",value:a,onChange:function(e){return r(e.target.value)},required:!0})]}),Object(v.jsx)("button",{type:"button",className:"addSongBtn",onClick:function(e){e.preventDefault(),m.collection("users").doc(t.uid).update({displayName:a,photoURL:u,imageColors:S})},children:"Update author"})]})]})},yn=function(){var e=Object(b.a)(j.a.mark((function e(t,n){var s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(n.uid).get();case 2:(s=e.sent.data().addedPlaylists).push(t.id),m.collection("users").doc(n.uid).update({addedPlaylists:s}),m.collection("playlists").doc(t.id).update({subscribers:++t.subscribers});case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Sn=function(){var e=Object(b.a)(j.a.mark((function e(t,n){var s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=n.addedPlaylists.filter((function(e){return e!==t.id})),m.collection("users").doc(n.uid).update({addedPlaylists:s}),m.collection("playlists").doc(t.id).update({subscribers:--t.subscribers});case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),wn=function(e){var t=Object(s.useState)([]),n=Object(l.a)(t,2),c=n[0],a=n[1],r=Object(s.useState)([]),i=Object(l.a)(r,2),o=i[0],u=i[1];function d(){return(d=Object(b.a)(j.a.mark((function t(){var n,s,c,r;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===(null===e||void 0===e?void 0:e.authors)){t.next=10;break}return n=e.authors.map((function(e){return e.uid})),t.next=4,m.collection("users").where("uid","in",n).get();case 4:s=t.sent,c=[],r=[],s.docs.forEach((function(e){c.push(e.data()),r.push(e.data().photoURL)})),a(c),u(r);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return Object(s.useEffect)((function(){!function(){d.apply(this,arguments)}()}),[null===e||void 0===e?void 0:e.id]),[c,o]},Cn=function(e){var t=e.color,n=void 0===t?"":t,s=Object(o.g)();return Object(v.jsx)("div",{className:"GoBackBtn",children:Object(v.jsxs)("button",{onClick:function(){return s.goBack()},style:n.length?{color:n}:{},children:[Object(v.jsx)(nt,{text:"go back",direction:"bottom"}),Object(v.jsx)(se.a,{})]})})},Nn=function(e){var t=e.album,n=J().setContent,c=Z().yourFriends,a=Object(s.useState)([]),r=Object(l.a)(a,2),i=r[0],o=r[1],u=Object(s.useState)(!0),d=Object(l.a)(u,2),h=d[0],f=d[1];function O(){return(O=Object(b.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f(!0),o([]),c.forEach((function(e){e.addedPlaylists.includes(t.id)&&o((function(t){return[].concat(Object(E.a)(t),[e])}))})),f(!1);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){!function(){O.apply(this,arguments)}()}),[t.uid]),Object(v.jsxs)("div",{className:"SongInfo",children:[Object(v.jsx)("div",{className:"songImage",style:{backgroundImage:"url(".concat(t.image,")")}}),Object(v.jsxs)("div",{className:"songInfoContent",children:[Object(v.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[Object(v.jsx)("span",{style:{opacity:".5",fontWeight:500,fontSize:".7em"},children:t.isAlbum?"Album":"Playlist"}),Object(v.jsx)("h3",{style:{color:t.imageColors[1]},children:t.name})]}),Object(v.jsxs)("div",{style:{display:"flex",opacity:"0.6",fontSize:".9em",position:"relative"},className:"listensAndDate",children:[Object(v.jsxs)("p",{className:"infoListens",style:{marginRight:"20px",position:"relative"},children:[t.listens,Object(v.jsx)(se.l,{})]}),Object(v.jsxs)("p",{className:"infoListens",style:{marginRight:"20px",position:"relative"},children:[t.subscribers," ",Object(v.jsx)(se.E,{})]}),Object(v.jsx)("span",{children:U(t.creationDate)})]}),Object(v.jsx)("h4",{style:{margin:"10px 0"},children:i.length>0?"Friends subscribed":"None of your friends subscribed"}),h?Object(v.jsx)("div",{style:{position:"relative",height:"50px"},children:Object(v.jsx)(ke,{top:"50%"})}):Object(v.jsx)("div",{style:{display:"flex"},children:i.length>0?Object(v.jsxs)(v.Fragment,{children:[i.map((function(e,t){if(t<2)return Object(v.jsx)(pe,{person:e},e.uid)})),i.length>2?Object(v.jsx)(Je,{onClick:function(){return n(Object(v.jsx)(Ke,{listOfPeople:i,title:"Friends subscribed to ".concat(t.name)}))}}):null]}):Object(v.jsx)("button",{className:"shareBtn",style:{minHeight:"35px",background:t.imageColors[0]},onClick:function(){n(Object(v.jsx)(Xe,{item:t,whatToShare:"playlist"}))},children:"Share"})})]})]})},kn=function(e){var t=e.author,n=J().setContent,c=Z().yourFriends,a=Object(s.useState)([]),r=Object(l.a)(a,2),i=r[0],o=r[1],u=Object(s.useState)(!0),d=Object(l.a)(u,2),h=d[0],f=d[1];function O(){return(O=Object(b.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f(!0),o([]),c.forEach((function(e){t.isAuthor?e.addedAuthors.includes(t.uid)&&o((function(t){return[].concat(Object(E.a)(t),[e])})):e.friends.find((function(e){return e.uid===t.uid}))&&o((function(t){return[].concat(Object(E.a)(t),[e])}))})),f(!1);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){!function(){O.apply(this,arguments)}()}),[t.uid]),Object(v.jsxs)("div",{className:"SongInfo",children:[Object(v.jsx)("div",{className:"songImage",style:{backgroundImage:"url(".concat(t.photoURL,")")}}),Object(v.jsxs)("div",{className:"songInfoContent",children:[Object(v.jsxs)("div",{style:{display:"flex",flexDirection:"column-reverse"},children:[Object(v.jsxs)("h3",{style:{color:t.imageColors[1]},children:[t.displayName,t.isVerified?Object(v.jsx)(Be.b,{style:{color:t.imageColors[0],width:"15px",height:"15px",marginLeft:"5px"}}):null]}),Object(v.jsx)("span",{style:{opacity:".5",fontWeight:500,fontSize:".7em"},children:t.isAuthor?"Author":"User"})]}),Object(v.jsxs)("div",{style:{display:"flex",opacity:"0.6",fontSize:".9em",position:"relative"},className:"listensAndDate",children:[Object(v.jsxs)("p",{className:"infoListens",style:{marginRight:"20px",position:"relative"},children:[t.numberOfListenersPerMonth,Object(v.jsx)(se.l,{})]}),Object(v.jsxs)("p",{className:"infoListens",style:{marginRight:"20px",position:"relative"},children:[t.subscribers," ",Object(v.jsx)(se.E,{})]}),Object(v.jsx)("span",{children:U(t.regDate)})]}),Object(v.jsx)("h4",{style:{margin:"10px 0"},children:i.length>0?"Friends subscribed":"None of your friends subscribed"}),h?Object(v.jsx)("div",{style:{position:"relative",height:"50px"},children:Object(v.jsx)(ke,{top:"50%"})}):Object(v.jsx)("div",{style:{display:"flex"},children:i.length>0?Object(v.jsxs)(v.Fragment,{children:[i.map((function(e,t){if(t<2)return Object(v.jsx)(pe,{person:e},e.uid)})),i.length>2?Object(v.jsx)(Je,{onClick:function(){return n(Object(v.jsx)(Ke,{listOfPeople:i,title:"Friends subscribed to ".concat(t.displayName)}))}}):null]}):Object(v.jsx)("button",{className:"shareBtn",style:{minHeight:"35px",background:t.imageColors[0]},onClick:function(){n(Object(v.jsx)(Xe,{item:t,whatToShare:"author"}))},children:"Share"})})]})]})},In=function(e){var t=e.data,n=J().setContent;return Object(v.jsxs)("div",{className:"AuthorMoreWindow",style:{top:"110%",bottom:"auto"},onClick:function(e){return e.stopPropagation()},children:[Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){n(Object(v.jsx)(Xe,{item:t,whatToShare:void 0!==t.authors?"playlist":"author"}))},children:[Object(v.jsx)(se.A,{}),"Share"]}),Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){n(void 0!==t.authors?Object(v.jsx)(Nn,{album:t}):Object(v.jsx)(kn,{author:t}))},children:[Object(v.jsx)(se.o,{}),"Info"]})]})},An=function(e){var t=e.imagesList,n=e.borderColor,s=void 0===n?"#fff":n;return Object(v.jsx)("div",{className:"SmallImages",style:{marginRight:-7*(t.length-1)},children:t.map((function(e,t){return Object(v.jsx)("div",{className:"smallImgContainer",style:{border:"3px solid ".concat(s),transform:"translateX(".concat(-15*t,"px)")},children:Object(v.jsx)("img",{loading:"lazy",src:e,alt:""})},t)}))})},Pn=function(e){var t,n,c=e.data,a=e.headerColors,r=A().isMobile,o=Z().displayAuthors,u=wn(c),d=Object(l.a)(u,2),j=d[0],b=d[1],h=N(),f=h.currentUser,O=h.logout,p=Object(s.useState)(!1),x=Object(l.a)(p,2),g=x[0],y=x[1],S=J(),w=S.toggleModal,C=S.setContent,k=S.openConfirm,I=S.closeConfirm,P=S.openBottomMessage,L=f.friends.find((function(e){return e.uid===c.uid&&"added"===e.status})),M=Object(s.useRef)(null);return ae(M,y),Object(v.jsxs)("div",{className:"Header",style:a.length?{background:"linear-gradient(45deg, ".concat(a[2],", ").concat(a[0],")")}:{background:"var(--yellowAndPinkGrad)"},children:[Object(v.jsxs)("div",{className:"headerBtns",style:{background:a[2]},children:[Object(v.jsx)(Cn,{}),Object(v.jsxs)("div",{style:{display:"flex"},children:[Object(v.jsx)("div",{className:"headerBackBtn",children:c.authors?f.ownPlaylists.includes(c.id)&&1===c.authors.length?Object(v.jsxs)("button",{onClick:function(){return k("Are you sure you want to DELETE this playlist forever?!","Yes, pretty sure","No, I Don't!",(function(){var e;e=c.id,m.collection("users").where("addedPlaylists","array-contains",e).get().then((function(t){t.docs.forEach((function(t){var n=t.data().addedPlaylists.filter((function(t){return t!==e}));m.collection("users").doc(t.data().uid).update({addedPlaylists:n})}))})),m.collection("users").where("ownPlaylists","array-contains",e).get().then((function(t){t.docs.forEach((function(t){var n=t.data().addedPlaylists.filter((function(t){return t!==e}));m.collection("users").doc(t.data().uid).update({ownPlaylists:n})}))})),m.collection("search").doc(e).delete().then((function(){m.collection("playlists").doc(e).delete()})),I(),P("Playlist ".concat(c.name," was deleted"))}))},children:[Object(v.jsx)(nt,{text:"delete playlist",direction:"bottom"}),Object(v.jsx)(se.B,{})]}):f.ownPlaylists.includes(c.id)?Object(v.jsxs)("button",{onClick:function(){return k("Are you sure you want to quit this playlist?","Yes, pretty sure","No, I Don't!",(function(){!function(e,t){m.collection("users").doc(t.uid).update({ownPlaylists:t.ownPlaylists.filter((function(t){return t!==e.id}))}),m.collection("playlists").doc(e.id).update({authors:e.authors.filter((function(e){return e.uid!==t.uid}))})}(c,f),I(),P("You left ".concat(c.name))}))},children:[Object(v.jsx)(nt,{text:"quit playlist",direction:"bottom"}),Object(v.jsx)(te.e,{})]}):f.addedPlaylists.includes(c.id)?Object(v.jsxs)("button",{onClick:function(){return k("Are you sure you want to remove this playlist from library?","Yes, pretty sure","No-no-no, go away",(function(){Sn(c,f),I(),P("Playlist was removed from library")}))},children:[Object(v.jsx)(nt,{text:"remove playlist from library",direction:"bottom"}),Object(v.jsx)(Oe.a,{})]}):Object(v.jsxs)("button",{onClick:function(){yn(c,f),P("Playlist ".concat(c.name," was added to library"))},children:[Object(v.jsx)(nt,{text:"add playlist",direction:"bottom"}),Object(v.jsx)(se.x,{})]}):f.addedAuthors.includes(c.uid)?Object(v.jsxs)("button",{onClick:function(){return pn(c,f)},children:[Object(v.jsx)(nt,{text:"delete author from library",direction:"bottom"}),Object(v.jsx)(Oe.a,{})]}):f.uid===c.uid?Object(v.jsx)(i.b,{to:"/settings",children:Object(v.jsxs)("button",{children:[Object(v.jsx)(nt,{text:"settings",direction:"bottom"}),Object(v.jsx)(se.z,{})]})}):!c.isAuthor&&f.friends.find((function(e){return e.uid===c.uid&&"added"===e.status}))?Object(v.jsxs)("button",{onClick:function(){return k("Are you sure you want to unfriend ".concat(c.displayName,"?"),"Yes, pretty sure","No-no-no, go away",(function(){!function(e,t){var n=e.friends.filter((function(e){return e.uid!==t.uid})),s=t.friends.filter((function(t){return t.uid!==e.uid}));m.collection("users").doc(e.uid).update({friends:n}),m.collection("users").doc(t.uid).update({friends:s})}(f,c),I(),P("".concat(c.displayName," was unfriended"))}))},children:[Object(v.jsx)(nt,{text:"remove from friend list",direction:"bottom"}),Object(v.jsx)(se.D,{})]}):!c.isAuthor&&f.friends.find((function(e){return e.uid===c.uid&&"awaiting"===e.status}))?Object(v.jsxs)("button",{onClick:On,children:[Object(v.jsx)(nt,{text:"waiting for response",direction:"bottom"}),Object(v.jsx)(te.l,{style:{animation:"loading 1s infinite linear"}})]}):c.isAuthor?Object(v.jsxs)("button",{onClick:function(){fn(c,f),P("".concat(c.displayName," was added to your library"))},children:[Object(v.jsx)(nt,{text:"subscribe",direction:"bottom"}),Object(v.jsx)(se.x,{})]}):Object(v.jsxs)("button",{onClick:function(){On(c,f),P("Friend request was sent to ".concat(c.displayName))},children:[Object(v.jsx)(nt,{text:"add friend",direction:"bottom"}),Object(v.jsx)(se.E,{})]})}),Object(v.jsxs)("div",{className:"headerMoreBtn",ref:M,children:[Object(v.jsxs)("button",{onClick:r?function(){w(),C(Object(v.jsx)(In,{data:c}))}:function(){return y(!g)},children:[Object(v.jsx)(nt,{text:"more",direction:"bottom"}),Object(v.jsx)(se.t,{})]}),g?Object(v.jsxs)("div",{className:"songItemMenuWindow",style:{top:"110%",bottom:"auto"},onClick:function(e){return e.stopPropagation()},children:[c.authors&&c.authors.find((function(e){return e.uid===f.uid}))||c.authors&&f.isAdmin?Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){w(),C(Object(v.jsx)(hn,{playlist:c}))},children:[Object(v.jsx)(se.j,{}),"Edit"]}):c.uid!==f.uid||c.isAuthor?null:Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){w(),C(Object(v.jsx)(vn,{author:c}))},children:[Object(v.jsx)(se.j,{}),"Edit"]}),Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){w(),C(Object(v.jsx)(Xe,{item:c,whatToShare:void 0!==c.authors?"playlist":"author"}))},children:[Object(v.jsx)(se.A,{}),"Share"]}),Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){w(),C(void 0!==c.authors?Object(v.jsx)(Nn,{album:c}):Object(v.jsx)(kn,{author:c}))},children:[Object(v.jsx)(se.o,{}),"Info"]})]}):null]})]}),f.uid===c.uid?Object(v.jsxs)("button",{onClick:function(){return k("Are you sure you want to quit?","Yes, pretty sure","No, I Don't!",(function(){O(),I()}))},children:[Object(v.jsx)(nt,{text:"quit",direction:"bottom"}),Object(v.jsx)(T.c,{})]}):null]}),Object(v.jsx)("div",{className:"headerAuthorsImage",style:void 0===c.authors?{animation:"floatingBorderRadius 10s infinite ease-in-out",backgroundImage:"url(".concat(c.photoURL,")"),position:"relative"}:{backgroundImage:"url(".concat(c.image,")"),position:"relative",backgroundColor:"var(--red)"},children:void 0===c.authors||c.image?null:Object(v.jsx)(te.a,{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",width:"60px",height:"60px"}})}),Object(v.jsxs)("div",{className:"headerAuthorInfo",children:[Object(v.jsxs)("div",{className:"headerAuthorsName",children:[void 0!==c.authors?c.isAlbum?Object(v.jsx)("h5",{children:"Album"}):Object(v.jsx)("h5",{children:"Playlist"}):c.isAuthor?Object(v.jsx)("h5",{children:"Author"}):Object(v.jsxs)("h5",{children:["User"," ",void 0===c.authors&&L?Object(v.jsx)(W,{userUID:c.uid}):null]}),Object(v.jsxs)("div",{style:{display:"flex",alignItems:"center",margin:"2px 0 10px 0"},children:[Object(v.jsx)(v.Fragment,{children:Object(v.jsx)("h1",{children:c.displayName||c.name})}),c.isVerified?Object(v.jsx)(Be.b,{style:{color:a[0]}}):null,c.isPrivate?Object(v.jsx)(Oe.b,{}):null,!!c.displayName&&L&&Object(v.jsx)(gn,{data:c,loading:!1})]})]}),void 0!==c.authors?Object(v.jsxs)("div",{className:"headerAuthorsImagesAndNames",children:[Object(v.jsx)(An,{imagesList:b,borderColor:a[2]}),Object(v.jsx)("div",{className:"headerAuthors",children:o(j,", ")})]}):null,Object(v.jsxs)("div",{className:"headerListenersAndSubs",children:[Object(v.jsxs)("div",{className:"headerListenersAndSubsItem",children:[Object(v.jsx)(nt,{text:(null!==(t=c.listens)&&void 0!==t?t:c.numberOfListenersPerMonth)+" listens",style:{fontSize:"0.8em"}}),Object(v.jsx)("span",{children:pt(null!==(n=c.listens)&&void 0!==n?n:c.numberOfListenersPerMonth)}),Object(v.jsx)(se.l,{})]}),Object(v.jsxs)("div",{className:"headerListenersAndSubsItem",children:[Object(v.jsx)(nt,{text:c.subscribers+" subscribers",style:{fontSize:"0.8em"}}),Object(v.jsx)("span",{children:pt(c.subscribers)}),Object(v.jsx)(se.E,{})]}),void 0!==c.creationDate?Object(v.jsxs)("div",{className:"headerListenersAndSubsItem",children:[Object(v.jsx)(nt,{text:"creation date",style:{fontSize:"0.8em"}}),Object(v.jsx)("span",{children:U(c.creationDate)})]}):null]}),L?Object(v.jsx)(mn,{data:c,color:a[3]}):null]})]})},Ln=function(e){var t=e.children,n=Object(L.a)(e,["children"]);return Object(v.jsx)("div",Object(u.a)(Object(u.a)({className:"content-container"},n),{},{children:t}))},Mn=function(){var e=Object(o.h)("/albums/:albumId"),t=Object(s.useState)([]),n=Object(l.a)(t,2),c=n[0],a=n[1],r=Object(s.useState)([]),i=Object(l.a)(r,2),u=i[0],d=i[1],h=e.params.albumId,f=Object(s.useState)([]),O=Object(l.a)(f,2),p=O[0],x=O[1],g=Object(s.useState)(!0),y=Object(l.a)(g,2),S=y[0],w=y[1],C=Object(o.g)();function N(){return(N=Object(b.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:m.collection("playlists").doc(h).onSnapshot((function(e){e.exists?(x(e.data()),d(e.data().imageColors)):C.push("/not-found")}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){!function(){N.apply(this,arguments)}()}),[h,m]),Object(s.useEffect)((function(){!function(){var e;(null===(e=p.songs)||void 0===e?void 0:e.length)?K(p.songs,"songs",a,(function(e){return e}),(function(){return w(!1)})):w(!1)}()}),[p]),Object(v.jsx)("div",{className:"AlbumPage",style:{animation:"zoomIn .2s forwards"},children:S?Object(v.jsx)(ke,{top:"50%"}):Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(Pn,{data:p,headerColors:u,setHeaderColors:d}),Object(v.jsxs)(Ln,{style:{display:"flex",flexDirection:"column",minHeight:"100%",borderRadius:"25px 25px 0 0",flex:"1 1 auto",position:"relative",overflow:"hidden",boxShadow:"0px 0px 100px #060606"},children:[Object(v.jsx)("div",{className:"content-background",style:{background:"linear-gradient(360deg, black, ".concat(u[0],")")}}),Object(v.jsx)(bn,{listOfSongs:c,source:{source:"/albums/".concat(p.id),name:p.name,image:p.image,songsList:c},showSearch:!0,defaultSearchMode:"songs"})]})]})})},En=function(){var e=N().currentUser,t=Object(s.useState)(""),n=Object(l.a)(t,2),c=n[0],a=n[1],r=Object(s.useState)(""),i=Object(l.a)(r,2),o=i[0],u=i[1],d=Object(s.useState)(""),h=Object(l.a)(d,2),f=h[0],O=h[1],p=Object(s.useState)(""),x=Object(l.a)(p,2),g=x[0],y=x[1],S=Object(s.useState)([]),C=Object(l.a)(S,2),k=C[0],I=C[1],A=Object(s.useState)(e.isAdmin?[]:[{uid:e.uid,photoURL:e.photoURL,displayName:e.displayName}]),P=Object(l.a)(A,2),L=P[0],M=P[1],T=Object(s.useState)(""),R=Object(l.a)(T,2),B=R[0],D=R[1],U=Object(s.useState)(""),F=Object(l.a)(U,2),W=F[0],H=F[1],V=Object(s.useState)(""),Y=Object(l.a)(V,2),q=Y[0],Q=Y[1],G=Object(s.useState)([]),K=Object(l.a)(G,2),X=K[0],J=K[1],_=Object(s.useState)(!1),$=Object(l.a)(_,2),Z=($[0],$[1],Object(s.useState)("")),ee=Object(l.a)(Z,2),te=(ee[0],ee[1]),ne=Object(s.useState)(!1),ce=Object(l.a)(ne,2),ae=ce[0],re=ce[1],ie=Object(s.useState)(!1),oe=Object(l.a)(ie,2),ue=oe[0],le=oe[1];function de(e){var t=L.filter((function(t){return t.uid!==e.uid}));return M(t)}function je(){return(je=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),n=me(),te(""),0===c.length?te("Song has to have some name"):0===L.length?te("Song has to have at least 1 author"):0===o.length?te("You didn't load song cover"):0===f.length?te("You didn't load song file"):0===B.length?te("You have to set release date for a song"):(le(!0),m.collection("songs").doc(n).set({id:n,name:c,songSrc:f,authors:L,cover:o,listens:0,releaseDate:B,lyrics:dt(W),imageColors:X}).then((function(){I([]),y(""),M([]),H([]),u(""),a(""),O(""),D(""),H([]),re(!0),J([]),le(!1)})).catch((function(e){te(e),le(!1)})),L.forEach(function(){var e=Object(b.a)(j.a.mark((function e(t){var s,c,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(t.uid).get();case 2:s=e.sent,c=s.data(),(a=c.ownSongs).push(n),m.collection("users").doc(t.uid).update({ownSongs:a});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),m.collection("search").doc(n).set({place:"songs",uid:n,rank:0,variantsOfName:w(c)}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(v.jsxs)("div",{className:"AddSong",children:[Object(v.jsx)(Rt,{loading:ue}),Object(v.jsx)(Mt.a,{src:q,getColors:function(e){return J(e)}}),Object(v.jsxs)("div",{children:[Object(v.jsx)(qe,{title:"Song name",value:c,setValue:a,placeholder:"Enter song name"}),Object(v.jsxs)("label",{children:[Object(v.jsx)("h3",{children:"Song authors"}),Object(v.jsx)(We,{value:g,setValue:y,setResultAuthorList:I,defaultSearchMode:"authors",inputText:"Search for authors"}),Object(v.jsx)("div",{className:"chosenAuthorsList",children:L.map((function(t){return Object(v.jsxs)("div",{className:"chosenAuthorItem",children:[Object(v.jsx)("span",{children:t.displayName}),Object(v.jsx)(se.H,{onClick:function(){(e.isAdmin||t.uid!==e.uid)&&de(t)}})]})}))}),Object(v.jsx)("div",{className:"authorsResult",children:k.map((function(e,t){return Object(v.jsx)(z,{data:e,onClick:function(){return function(e){if(!L.some((function(t){return t.uid===e.uid})))return M((function(t){return[].concat(Object(E.a)(t),[{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL}])}));de(e)}(e)},style:L.includes(e.uid)?{background:"var(--green)"}:{}},t)}))})]}),Object(v.jsx)(qe,{title:"Release Date",type:"date",value:B,setValue:D,placeholder:"Enter release date"}),Object(v.jsx)("div",{style:{width:"100%",display:"flex"},children:X.map((function(e,t){return Object(v.jsx)("input",{type:"color",value:e,style:{width:"100%",height:"60px",padding:"0",borderRadius:"0px"},onChange:function(e){!function(e,t){X[t]=e.target.value,J(Object(E.a)(X))}(e,t)}})}))}),Object(v.jsx)(Tt,{text:"Download song cover",place:"songsImages/",setItemSrc:u,setImageLocalPath:Q}),Object(v.jsx)(Tt,{text:"Download song file",place:"songs/",setItemSrc:O}),Object(v.jsx)("label",{children:Object(v.jsx)("textarea",{name:"",id:"",placeholder:"Add song lyrics",value:W,onChange:function(e){return H(e.target.value)}})}),Object(v.jsx)(Ge,{text:"Add song",action:function(e){return je.apply(this,arguments)},isLoading:ue,completed:ae,setCompleted:re,bottomMessage:"Song was uploaded to database"})]})]})},Tn=function(e){var t=e.data,n=N().currentUser,c=Object(s.useState)(!1),a=Object(l.a)(c,2),r=a[0],i=a[1],o=Object(s.useState)(0),u=Object(l.a)(o,2),d=u[0],j=u[1],b=[Object(v.jsx)(En,{}),Object(v.jsx)(Dt,{})];return(n.isAdmin||t.isAuthor)&&t.uid===n.uid?Object(v.jsxs)("div",{className:"AddSong",children:[Object(v.jsx)("button",{onClick:function(){return i(!r)},style:r?{background:"var(--red)"}:{},className:"openAddSongWindowBtn",children:Object(v.jsx)(se.w,{style:r?{transform:"rotate(45deg)"}:{}})}),Object(v.jsxs)("div",{className:"addSongWindow",style:r?{display:"flex"}:{},children:[Object(v.jsx)(vt,{pages:["Song","Playlist"],currentPage:d,setCurrentPage:j}),b[d]]})]}):null},Rn=function(e){var t=e.data,n=e.title,c=Object(s.useState)([]),a=Object(l.a)(c,2),r=a[0],i=a[1],o=Object(s.useState)(0),u=Object(l.a)(o,2),d=u[0],h=u[1],f=Object(s.useRef)(null),O=Object(s.useState)(!1),p=Object(l.a)(O,2),x=p[0],g=p[1];return Object(s.useEffect)((function(){r.length>0&&(f.current.scrollWidth>f.current.offsetWidth&&g(!0))}),[r]),Object(s.useEffect)((function(){i([]),i([]),t.friends.forEach(function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("added"!==t.status){e.next=5;break}return e.next=3,m.collection("users").doc(t.uid).get();case 3:n=e.sent.data(),i((function(e){return[].concat(Object(E.a)(e),[n])}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[t.uid]),r.length>0?Object(v.jsxs)("div",{className:"PersonTinyList",children:[n&&Object(v.jsx)("h2",{children:n}),Object(v.jsxs)("div",{style:{position:"relative"},children:[Object(v.jsx)("div",{className:"personTinyListWrapper",ref:f,onScroll:function(e){return h(e.target.scrollLeft)},children:r.map((function(e,t){return Object(v.jsx)(pe,{person:e},e.uid)}))}),Object(v.jsxs)("div",{className:"authorsShiftButtons",children:[Object(v.jsx)("button",{onClick:function(){var e=f.current.scrollLeft;f.current.scrollLeft=e-200,h(e-200)},style:d<=0?{visibility:"hidden",opacity:"0"}:{},children:Object(v.jsx)(se.f,{})}),Object(v.jsx)("button",{onClick:function(){var e=f.current.scrollLeft;f.current.scrollLeft=e+200,h(e+200)},style:x&&f.current&&f.current.scrollWidth-f.current.offsetWidth!==d?{}:{visibility:"hidden",opacity:"0"},children:Object(v.jsx)(se.g,{})})]})]})]}):null},Bn=function(){var e=Object(b.a)(j.a.mark((function e(t,n,s,c){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n([]),a=[],void 0!==t.ownPlaylists&&0!==t.ownPlaylists.length&&t.ownPlaylists.forEach(function(){var e=Object(b.a)(j.a.mark((function e(r,i){var o;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("playlists").doc(r).get();case 2:(o=e.sent.data())&&(!o.isPrivate||t.uid===s&&o.isPrivate)&&a.push(o),i===t.ownPlaylists.length-1&&(a.sort((function(e,t){return new Date(t.creationDate).getTime()-new Date(e.creationDate).getTime()})),c(!1),n(a));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e)})));return function(t,n,s,c){return e.apply(this,arguments)}}(),Dn=n(52),Un=function(){return Object(v.jsxs)("div",{style:{textDecoration:"none"},className:"playlistWrapper",children:[Object(v.jsx)("div",{className:"playlistItem",style:{background:"var(--playlistsColor)",display:"flex",justifyContent:"center",alignItems:"center"},children:Object(v.jsx)("img",{loading:"lazy",src:g,alt:"",style:{width:"70px",height:"70px",filter:"grayscale(80%)"}})}),Object(v.jsx)("h4",{style:{display:"flex",alignItems:"center",margin:"5px 0"},children:"Playlist was deleted"})]})},Fn=function(e){var t=e.playlist,n=void 0===t?null:t,c=e.listOfChosenAlbums,a=e.setListOfChosenAlbums,r=e.shouldSaveSearchHistory,o=new Date(null===n||void 0===n?void 0:n.creationDate),u=A().isMobile,d=N().currentUser,j=Z(),b=j.currentSongPlaylistSource,h=j.play,f=Object(s.useState)([]),O=Object(l.a)(f,2),p=O[0],m=O[1],x=rn(n,p,m);return null!==n?Object(v.jsxs)(i.b,{to:"/albums/".concat(n.id),style:{textDecoration:"none"},className:"playlistWrapper",onClick:function(){r&&$e(d.uid,n.id,"playlists")},children:[Object(v.jsx)(R,{listOfChosenItems:c,setListOfChosenItems:a,itemId:n.id}),Object(v.jsxs)("div",{className:"playlistItem",style:n.image?{backgroundImage:"url(".concat(n.image,")")}:{background:"var(--yellowAndPinkGrad)"},children:[n.image?null:Object(v.jsx)(te.a,{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",width:"60px",height:"60px"}}),u?null:Object(v.jsx)("button",{onClick:x,children:b.name===n.name&&h?Object(v.jsx)(Dn.b,{}):Object(v.jsx)(Dn.c,{})})]}),Object(v.jsxs)("h4",{style:{display:"flex",alignItems:"center",margin:"5px 0"},children:[oe(n.name,u?10:15),Object(v.jsx)("span",{style:{fontSize:".6em",opacity:.6,fontWeight:"500",marginLeft:"7px"},children:n.isAlbum?1===n.songs.length?"single":"album":"playlist"})]}),Object(v.jsx)("h5",{style:{margin:"5px 0"},children:o.getFullYear()})]}):Object(v.jsx)(Un,{})},Wn=function(e){var t=e.listOfAlbums,n=e.title,c=void 0===n?"":n,a=e.loading,r=void 0===a||a,i=e.listOfChosenAlbums,o=e.setListOfChosenAlbums,u=e.saveSearchHistory,d=Object(s.useState)(0),j=Object(l.a)(d,2),b=j[0],h=j[1],f=Object(s.useRef)(null),O=Object(s.useState)(!1),p=Object(l.a)(O,2),m=p[0],x=p[1];return Object(s.useEffect)((function(){t.length>0&&!r&&(f.current.scrollWidth>f.current.offsetWidth&&x(!0))}),[t]),t.length>0?r?Object(v.jsx)(ke,{}):Object(v.jsxs)("div",{className:"AuthorsList",children:[0!==c.length?Object(v.jsx)("h2",{children:c}):null,Object(v.jsx)("div",{className:"authorsWrapper",ref:f,onScroll:function(e){return h(e.target.scrollLeft)},children:t.map((function(e,t){return Object(v.jsx)(Fn,{playlist:e,listOfChosenAlbums:i,setListOfChosenAlbums:o,shouldSaveSearchHistory:u},t)}))}),Object(v.jsxs)("div",{className:"authorsShiftButtons",children:[Object(v.jsx)("button",{onClick:function(){var e=f.current.scrollLeft;f.current.scrollLeft=e-220,h(e-220)},style:b<=0?{visibility:"hidden",opacity:"0"}:{},children:Object(v.jsx)(se.f,{})}),Object(v.jsx)("button",{onClick:function(){var e=f.current.scrollLeft;f.current.scrollLeft=e+220,h(e+220)},style:m&&f.current&&f.current.scrollWidth-f.current.offsetWidth!==b?{}:{visibility:"hidden",opacity:"0"},children:Object(v.jsx)(se.g,{})})]})]}):null},Hn=function(e){var t=e.authorsData,n=N().currentUser,c=Object(s.useState)([]),a=Object(l.a)(c,2),r=a[0],i=a[1],o=Object(s.useState)(!0),u=Object(l.a)(o,2),d=u[0],j=u[1];return Object(s.useEffect)((function(){Bn(t,i,n.uid,j)}),[t.ownPlaylists]),Object(v.jsx)(Wn,{listOfAlbums:r,title:n.isAuthor?"Albums":"Playlists",loading:d})},Vn=function(e){var t=e.person,n=e.addFriend,s=e.rejectFriend;return Object(v.jsxs)("div",{className:"FriendRequestItem",children:[Object(v.jsx)(i.b,{to:"/authors/".concat(t.uid),children:Object(v.jsxs)("div",{className:"friendRequestImageAndName",children:[Object(v.jsx)("div",{className:"requestImage",children:Object(v.jsx)("img",{loading:"lazy",src:t.photoURL,alt:""})}),Object(v.jsx)("h3",{children:t.displayName})]})}),Object(v.jsxs)("div",{className:"requestButtons",children:[Object(v.jsxs)("button",{style:{color:"var(--green)"},onClick:function(){return n(t.uid)},children:[Object(v.jsx)(se.d,{}),Object(v.jsx)("span",{children:"Add"})]}),Object(v.jsxs)("button",{style:{color:"var( --lightRed)"},onClick:function(){return s(t.uid)},children:[Object(v.jsx)(se.G,{}),Object(v.jsx)("span",{children:"Reject"})]})]})]})},zn=function(){var e=N().currentUser,t=Object(s.useState)([]),n=Object(l.a)(t,2),c=n[0],a=n[1];return Object(s.useEffect)((function(){!function(){var t=[];e.friends.forEach(function(){var n=Object(b.a)(j.a.mark((function n(s,c){var r;return j.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("requested"!==s.status){n.next=6;break}return n.next=3,m.collection("users").doc(s.uid).get();case 3:r=n.sent.data(),t.push(r),c===e.friends.length-1&&a(t);case 6:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())}()}),[JSON.stringify(e.friends)]),[c,function(t){var n=e.friends,s=c.find((function(e){return e.uid===t})).friends;n.find((function(e){return e.uid===t})).status="added",s.find((function(t){return t.uid===e.uid})).status="added",m.collection("users").doc(e.uid).update({friends:n}),m.collection("users").doc(t).update({friends:s}),a((function(e){return e.filter((function(e){return e.uid!==t}))}))},function(t){var n=e.friends.filter((function(e){return e.uid!==t}));m.collection("users").doc(t).get().then((function(s){var c=s.data().friends.filter((function(t){return t.uid!==e.uid}));m.collection("users").doc(e.uid).update({friends:n}),m.collection("users").doc(t).update({friends:c}),a((function(e){return e.filter((function(e){return e.uid!==t}))}))}))}]},Yn=function(){var e=zn(),t=Object(l.a)(e,3),n=t[0],s=t[1],c=t[2];return Object(v.jsx)(v.Fragment,{children:n.map((function(e,t){return Object(v.jsx)(Vn,{person:e,addFriend:s,rejectFriend:c},t)}))})};function qn(e){var t=new Date(e.releaseDate);return(new Date).getTime()-t.getTime()<18144e5}var Qn=function(e){e.authorId;var t=e.authorsData,n=(e.headerColors,Object(s.useState)([])),c=Object(l.a)(n,2),a=c[0],r=c[1],i=Object(s.useState)([]),o=Object(l.a)(i,2),u=o[0],d=o[1];function h(){return(h=Object(b.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.isAuthor?K(t.ownSongs,"songs",r,(function(e){return e.forEach((function(e){qn(e)&&!u.includes(e)&&d((function(t){return[].concat(Object(E.a)(t),[e])}))})),e.sort((function(e,t){return t.listens-e.listens}))})):K(t.addedSongs.slice(0).reverse(),"songs",r);case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){!function(){h.apply(this,arguments)}(),d([])}),[t.ownSongs]),t.isAuthor?Object(v.jsxs)("div",{className:"TopSongs",children:[Object(v.jsx)(bn,{listOfSongs:u,source:{source:"/authors/".concat(t.uid),name:t.displayName,image:t.photoURL,songsList:u},isNewSong:!0}),Object(v.jsx)(bn,{listOfSongs:a,source:{source:"/authors/".concat(t.uid),name:t.displayName,image:t.photoURL,songsList:a},title:"Popular Songs",showListens:!0,showCount:!0,isHorizontal:!0})]}):Object(v.jsx)(bn,{listOfSongs:a,source:{source:"/authors/".concat(t.uid),name:t.displayName+"'s Library",image:t.photoURL,songsList:a},title:t.displayName+"'s Library",showListens:!0,showCount:!0,isHorizontal:!0})};function Gn(e,t,n){var s=[];e.forEach((function(e){var t=e.authors;0!==t.length&&s.push(t)})),s=s.flat();for(var c=new Set(s.map((function(e){return e.uid})).filter((function(e){return e!==t.uid}))),a=Array.from(c),r=[],i=0;i<a.length;i++)for(var o=0;o<s.length;o++)if(a[i]===s[o].uid){r.push(s[o]);break}return n(r),r}function Kn(e,t){return Xn.apply(this,arguments)}function Xn(){return(Xn=Object(b.a)(j.a.mark((function e(t,n){var s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0!==t&&void 0!==t.ownSongs&&0!==t.ownSongs.length&&(s=[],t.ownSongs.forEach(function(){var e=Object(b.a)(j.a.mark((function e(c,a){var r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("songs").doc(c).get();case 2:if(r=e.sent.data(),s.push(r),a!==t.ownSongs.length-1){e.next=6;break}return e.abrupt("return",Gn(s,t,n));case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Jn=function(e){var t=e.data,n=Object(s.useState)([]),c=Object(l.a)(n,2),a=c[0],r=c[1];return Object(s.useEffect)((function(){Kn(t,r)}),[t]),Object(v.jsx)(et,{listOfAuthors:a,title:"Similar Authors"})},_n=(n(268),function(){var e=Object(o.h)("/authors/:authorId"),t=N().currentUser,n=Object(s.useState)([]),c=Object(l.a)(n,2),a=c[0],r=c[1],i=e.params.authorId,u=Object(s.useState)([]),d=Object(l.a)(u,2),h=d[0],f=d[1],O=Object(s.useState)(!0),p=Object(l.a)(O,2),x=p[0],g=p[1],y=Object(o.g)(),S=J().openBottomMessage;function w(){return(w=Object(b.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:m.collection("users").doc(i).get().then((function(e){e.exists?(f(e.data()),r(e.data().imageColors),g(!1)):y.push("/not-found")})).catch((function(e){S("Failed to load author's data","failure")}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){!function(){w.apply(this,arguments)}()}),[i]),Object(v.jsx)(v.Fragment,{children:Object(v.jsx)("div",{className:"AuthorPage",style:{animation:"zoomIn .2s forwards"},children:x?Object(v.jsx)(ke,{}):Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(Pn,{data:h,headerColors:a,setHeaderColors:r}),Object(v.jsxs)(Ln,{style:{display:"flex",flexDirection:"column",minHeight:"100%",borderRadius:"25px 25px 0 0",flex:"auto",position:"relative",overflow:"hidden",boxShadow:"0px 0px 100px #060606"},children:[Object(v.jsx)("div",{className:"content-background",style:{background:"linear-gradient(360deg, black, ".concat(a[0],")")}}),t.uid===h.uid?Object(v.jsx)(Yn,{}):null,Object(v.jsx)(Tn,{data:h}),Object(v.jsx)(Qn,{author:i,authorsData:h,headerColors:a}),h.friends&&!h.isAuthor&&Object(v.jsx)(Rn,{data:h,title:"Friends"}),Object(v.jsx)(Hn,{authorsData:h,headerColors:a}),h.isAuthor?Object(v.jsx)(Jn,{data:h}):null]})]})})})}),$n=function(e){var t=e.amountOfUnseen;return 0!==t&&Object(v.jsx)("div",{className:"AmountOfUnseenMessages",children:t})},Zn=function(e){var t=e.listOfSeen;return Object(v.jsx)("div",{className:"SeenByCircle",style:void 0!==t?t.length<=1?{opacity:"1",visibility:"visible"}:{}:null})},es=function(e){var t=e.typingPeople,n=Object(s.useState)([]),c=Object(l.a)(n,2),a=c[0],r=c[1],i=N().currentUser;return Object(s.useEffect)((function(){r([]),t.map(function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(t).get();case 2:(n=e.sent.data()).uid!==i.uid&&r((function(e){return[].concat(Object(E.a)(e),[n])}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[t]),a.length>0?Object(v.jsxs)("div",{className:"typingWrapper",children:[Object(v.jsx)(An,{imagesList:a.map((function(e){return e.photoURL})),borderColor:"var(--navItemColor)"}),Object(v.jsxs)("div",{className:"TypingAnimation",children:[Object(v.jsx)("span",{className:"typingCircle"}),Object(v.jsx)("span",{className:"typingCircle"}),Object(v.jsx)("span",{className:"typingCircle"})]})]}):null},ts=function(e){var t=e.sender,n=e.isGroup,c=e.message,a=e.showUnseenCircle,r=void 0!==a&&a,i=e.messageLen,o=void 0===i?30:i,u=(e.chatId,e.typing),d=void 0!==u&&u,h=N().currentUser,f=Object(s.useState)(""),O=Object(l.a)(f,2),p=O[0],x=O[1],g=Object(s.useState)(!1),y=Object(l.a)(g,2),S=y[0],w=y[1],C=Object(s.useState)(""),k=Object(l.a)(C,2),I=k[0],A=k[1],P=[null,Object(v.jsx)(se.u,{}),Object(v.jsx)(te.a,{}),Object(v.jsx)(se.C,{})],L=Object(s.useState)(0),M=Object(l.a)(L,2),E=M[0],T=M[1];function R(){return(R=Object(b.a)(j.a.mark((function e(){var t,n,s,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(A(""),void 0===c){e.next=23;break}if(t=c,A((function(e){return e+t.message})),w(0!==t.message.length),!t.attachedSongs.length){e.next=11;break}return e.next=8,m.collection("songs").doc(t.attachedSongs[0]).get();case 8:n=e.sent.data().name,T(1),x((function(e){return e+n}));case 11:if(!t.attachedAlbums.length){e.next=17;break}return e.next=14,m.collection("playlists").doc(t.attachedAlbums[0]).get();case 14:(s=e.sent).exists?x((function(e){return e+s.data().name})):x((function(e){return e+"Deleted Album "})),T(2);case 17:if(!t.attachedAuthors.length){e.next=23;break}return e.next=20,m.collection("users").doc(t.attachedAuthors[0]).get();case 20:a=e.sent.data().displayName,T(3),x((function(e){return e+a}));case 23:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){!function(){R.apply(this,arguments)}()}),[c.id]),d?Object(v.jsx)(es,{typingPeople:[t.uid]}):Object(v.jsxs)("div",{className:"messageShowOutside",children:[Object(v.jsxs)("span",{style:c.sender===h.uid||t&&n?{marginRight:"5px"}:{},children:[" ","".concat(c.sender===h.uid?"You: ":n&&t?t.displayName+": ":"")]}),oe(I,o),S&&p.length?Object(v.jsx)(Dn.a,{}):null,P[E],p,r&&Object(v.jsx)(Zn,{listOfSeen:c.seenBy})]})},ns=function(e){var t=e.chatData,n=N().currentUser,c=t.chatName,a=t.chatImage,r=t.participants,o=Object(s.useState)({}),u=Object(l.a)(o,2),d=u[0],h=u[1],f=Object(s.useState)(0),O=Object(l.a)(f,2),p=O[0],x=O[1],g=Object(s.useState)(t.messages),y=Object(l.a)(g,2),S=y[0],w=y[1],C=Object(s.useState)(!1),k=Object(l.a)(C,2),I=k[0],A=k[1];function P(){return(P=Object(b.a)(j.a.mark((function e(){var t,s,a,i,o;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c){e.next=8;break}return t=r.find((function(e){return e!==n.uid})),e.next=4,m.collection("users").doc(t).get();case 4:s=e.sent.data(),h(s),e.next=13;break;case 8:return i=null===(a=S[S.length-1])||void 0===a?void 0:a.sender,e.next=11,m.collection("users").doc(i).get();case 11:o=e.sent.data(),h(o);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){m.collection("chats").doc(t.id).onSnapshot((function(e){w(e.data().messages),A(!!e.data().typing.length)}))}),[]),Object(s.useEffect)((function(){x(Kt(S,n))}),[]),Object(s.useEffect)((function(){!function(){P.apply(this,arguments)}()}),[]),t?Object(v.jsx)(i.b,{to:"/chat/".concat(t.id),children:Object(v.jsxs)("div",{className:"ChatItem "+(p>0?"unseen":""),children:[Object(v.jsx)("div",{className:"chatItemImage",children:Object(v.jsx)("img",{loading:"lazy",src:a||d.photoURL,alt:""})}),!c&&Object(v.jsx)(en,{userUID:d.uid}),Object(v.jsxs)("div",{style:{width:"100%"},children:[Object(v.jsxs)("h4",{style:{display:"flex",justifyContent:"space-between",width:"100%"},children:[Object(v.jsx)("span",{children:c||d.displayName}),Object(v.jsxs)("div",{children:[S.length?Object(v.jsx)("span",{style:{opacity:".6",fontWeight:"500",fontSize:".8em"},children:U(S[S.length-1].sentTime,t&&Date.now()-new Date(S[S.length-1].sentTime).getTime()>86e6?0:2)}):null,Object(v.jsx)($n,{amountOfUnseen:p})]})]}),S.length?Object(v.jsx)("p",{style:S[S.length-1].sender!==n.uid?{color:"#fff"}:{},children:Object(v.jsx)(ts,{sender:d,isGroup:c.length,message:S[S.length-1],showUnseenCircle:!0,typing:I})}):null]})]})}):null},ss=function(){var e=N().currentUser,t=J().toggleModal,n=Z().yourFriends,c=Object(s.useState)(""),a=Object(l.a)(c,2),r=a[0],i=a[1],u=Object(s.useState)(n),d=Object(l.a)(u,2),j=d[0],b=d[1],h=Object(s.useState)([]),f=Object(l.a)(h,2),O=f[0],p=f[1],m=Object(s.useState)(""),x=Object(l.a)(m,2),g=x[0],v=x[1],y=Object(s.useState)(""),S=Object(l.a)(y,2),w=S[0],C=S[1],k=Object(s.useState)(""),I=Object(l.a)(k,2),A=(I[0],I[1]),P=me(),L=Object(o.g)(),M=Object(s.useState)(!1),T=Object(l.a)(M,2),R=T[0],B=T[1],D=Object(s.useState)(0),U=Object(l.a)(D,2),F=U[0],W=U[1],H=Object(s.useState)(!1),V=Object(l.a)(H,2),z=V[0],Y=V[1];Object(s.useEffect)((function(){O.length>=1&&ge(O,e,B,W)}),[O]),Object(s.useEffect)((function(){0===w.length||0===O.length?Y(!1):Y(!0),A("")}),[O.length,w]);return{searchValue:r,setSearchValue:i,foundFriends:j,setFoundFriends:b,chosenFriends:O,setChosenFriends:p,chatName:w,setChatName:C,setChatCover:v,handleCreateChat:function(){R?z?xe([e.uid].concat(Object(E.a)(O)),P,w,g,[e.uid]).then((function(){L.push("/chat/".concat(P)),t()})):A("Chat has to have a name"):(L.push("/chat/".concat(F)),t())},shouldCreate:R,allowedToCreate:z}},cs=function(){var e=ss(),t=e.searchValue,n=e.setSearchValue,s=e.foundFriends,c=e.setFoundFriends,a=e.chosenFriends,r=e.setChosenFriends,i=e.chatName,o=e.setChatName,u=e.setChatCover,l=e.handleCreateChat,d=e.shouldCreate,j=e.allowedToCreate;return Object(v.jsxs)("div",{className:"CreateChat",children:[Object(v.jsx)(We,{value:t,setValue:n,setResultAuthorList:c,focus:!0,inputText:"Search for friends",defaultSearchMode:"authors"}),Object(v.jsx)(Ke,{listOfPeople:s,chosenArray:a,setChosenArray:r,lastSeen:!0}),a.length>1&&d&&Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(qe,{title:"Chat name",value:i,setValue:o,placeholder:"Enter chat name"}),Object(v.jsx)(Tt,{title:"Chat image",text:"Download chat image",place:"chatCovers/",setItemSrc:u,setImageLocalPath:function(){return null}})]}),Object(v.jsx)(Ge,{text:d?"Create Chat":"Go to chat",action:l,isActive:a.length>0&&(d&&j||!d)})]})},as=(n(269),function(){var e=Object(s.useState)([]),t=Object(l.a)(e,2),n=t[0],c=t[1],a=J(),r=a.toggleModal,i=a.setContent,o=N().currentUser,u=Object(s.useState)(!0),d=Object(l.a)(u,2),j=d[0],b=d[1];return Object(s.useEffect)((function(){K(o.chats,"chats",c,(function(e){return e.sort((function(e,t){if(e.messages.length&&t.messages.length)return new Date(t.messages[t.messages.length-1].sentTime).getTime()-new Date(e.messages[e.messages.length-1].sentTime).getTime()}))}),(function(){return b(!1)}))}),[]),Object(v.jsx)("div",{style:{animation:"zoomIn .2s forwards",minHeight:"100%"},children:Object(v.jsxs)(Ln,{children:[Object(v.jsx)("div",{style:{marginBottom:"10px",display:"flex",alignItems:"start",width:"100%"},children:Object(v.jsxs)("button",{className:"standartButton",onClick:function(){r(),i(Object(v.jsx)(cs,{}))},children:[Object(v.jsx)(se.w,{}),"Create chat"]})}),j?Object(v.jsx)(ke,{}):Object(v.jsx)("div",{className:"chatsWrapper",children:n.length?n.map((function(e,t){return Object(v.jsx)(ns,{chatData:e},t)})):Object(v.jsx)("h3",{children:"No chats"})})]})})}),rs=function(e){var t=e.date;return Object(v.jsx)("div",{className:"DateOnTop",children:U(t)})},is=function(e){var t=N().currentUser,n=Object(s.useState)({}),c=Object(l.a)(n,2),a=c[0],r=c[1],i=Object(s.useState)(e.chatName?[]:e.imageColors),o=Object(l.a)(i,2),u=o[0],d=o[1];function h(){return(h=Object(b.a)(j.a.mark((function n(){var s,c;return j.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s=e.participants.find((function(e){return e!==t.uid})),n.next=3,m.collection("users").doc(s).get();case 3:c=n.sent.data(),r(c),d(c.imageColors);case 6:case"end":return n.stop()}}),n)})))).apply(this,arguments)}return Object(s.useEffect)((function(){e.chatName.length||function(){h.apply(this,arguments)}()}),[e.id]),[a,u]},os=function(){var e=Object(b.a)(j.a.mark((function e(t,n){var s,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("chats").doc(t).get();case 2:s=e.sent.data(),c=s.participants.filter((function(e){return e!==n.uid})),ve(t,s,"soundbubble","".concat(n.displayName," left the chat")),m.collection("chats").doc(t).update({participants:c});case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),us=function(e){var t=e.chat,n=e.user,s=N().currentUser,c=J(),a=c.openConfirm,r=c.closeConfirm,i=c.setContent,o=s.uid===n.uid;return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(nt,{text:o?"quit chat":"kick"}),Object(v.jsx)(Ve,{onClick:function(){return a("Are you sure you want to ".concat(o?"leave":"kick ".concat(n.displayName," ")," from this chat?"),"Yes","No",(function(){os(t.id,n),r(),i(Object(v.jsx)(hs,{data:t}))}))},icon:o?Object(v.jsx)(se.p,{}):Object(v.jsx)(se.G,{})})]})},ls=function(e){var t=e.chatId,n=Object(s.useState)([]),c=Object(l.a)(n,2),a=c[0],r=c[1],i=Object(s.useState)(!0),o=Object(l.a)(i,2),u=o[0],d=o[1],h=Object(s.useState)(0),f=Object(l.a)(h,2),O=f[0],p=f[1],x=[Object(v.jsx)(bn,{listOfSongs:a,source:{source:"/chat/".concat(t),name:"Chat with ".concat(t),image:"",songsList:a}}),Object(v.jsx)(et,{listOfAuthors:a}),Object(v.jsx)(Wn,{listOfAlbums:a,loading:u})];function g(e,t){return y.apply(this,arguments)}function y(){return(y=Object(b.a)(j.a.mark((function e(n,s){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("chats").doc(t).get();case 2:e.sent.data().messages.forEach((function(e){e[n].length>0&&K(e[n],s,r,(function(e){return e}),(function(){return d(!1)}),void 0,1)}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){switch(O){case 0:g("attachedSongs","songs").then((function(){return d(!1)}));break;case 1:g("attachedAuthors","users").then((function(){return d(!1)}));break;case 2:g("attachedAlbums","playlists").then((function(){return d(!1)}))}}),[O]),Object(s.useEffect)((function(){r([])}),[t]),Object(v.jsxs)("div",{className:"AttachmentList",children:[Object(v.jsx)(vt,{pages:["Songs","Authors","Playlists"],currentPage:O,setCurrentPage:function(e){p(e),d(!0),r([])}}),u?Object(v.jsx)(ke,{}):a.length>0?x[O]:Object(v.jsx)("h2",{children:"Nothing here"})]})},ds=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"uid",s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return s?e.filter((function(e){return!t.includes(e[n])})):e.filter((function(e){return t.includes(e[n])}))},js=function(){var e=Object(b.a)(j.a.mark((function e(t,n,s,c){var a,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(!0),c(!1),e.next=4,m.collection("chats").doc(t).get();case 4:a=e.sent.data(),r=a.participants,n.forEach((function(e){return r.push(e.uid)})),m.collection("chats").doc(t).update({participants:r}),n.forEach((function(e){var n=e.uid,s=e.chats;m.collection("users").doc(n).update({chats:[].concat(Object(E.a)(s),[t])})})),ve(t,a,"soundbubble","".concat(n.map((function(e){return e.displayName}))," entered the chat")),s(!1),c(!0);case 12:case"end":return e.stop()}}),e)})));return function(t,n,s,c){return e.apply(this,arguments)}}(),bs=function(e){var t=e.chat,n=Z().yourFriends,c=Object(s.useState)(""),a=Object(l.a)(c,2),r=a[0],i=a[1],o=Object(s.useState)([]),u=Object(l.a)(o,2),d=u[0],j=u[1],b=Object(s.useState)(!1),h=Object(l.a)(b,2),f=h[0],O=h[1],p=Object(s.useState)(!1),m=Object(l.a)(p,2),x=m[0],g=m[1],y=ds(n,t.participants),S=Object(s.useState)([]),w=Object(l.a)(S,2),C=w[0],N=w[1];return Object(v.jsxs)("div",{children:[Object(v.jsx)(We,{value:r,setValue:i,setResultAuthorList:j,defaultSearchMode:"authors",defaultAuthorsListValue:y}),Object(v.jsx)(Ke,{listOfPeople:d,chosenArray:C,setChosenArray:N,lastSeen:!0}),!!C.length&&Object(v.jsx)(Ge,{text:"Add ".concat(C.length," friends"),action:function(){return js(t.id,ds(n,C,"uid",!1),O,g)},isLoading:f,completed:x,setCompleted:g,bottomMessage:"".concat(C.length," friends have been added to ").concat(t.chatName)})]})},hs=function(e){var t=e.data,n=N().currentUser,c=Object(s.useState)([]),a=Object(l.a)(c,2),r=a[0],i=a[1],o=Object(s.useState)(!0),u=Object(l.a)(o,2),d=u[0],h=u[1],f=Object(s.useState)(t.chatName),O=Object(l.a)(f,2),x=O[0],g=O[1],y=Object(s.useState)(t.chatImage),S=Object(l.a)(y,2),w=S[0],C=S[1],k=Object(s.useState)(""),I=Object(l.a)(k,2),A=I[0],P=I[1],L=Object(s.useState)(t.imageColors||[]),M=Object(l.a)(L,2),E=M[0],T=M[1],R=J().setContent,B=Object(s.useState)(0),D=Object(l.a)(B,2),U=D[0],F=D[1],W=Object(s.useState)(!1),H=Object(l.a)(W,2),V=H[0],Y=H[1];function q(){return(q=Object(b.a)(j.a.mark((function e(t,n,s){var c,a,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=t.target.files[0],P(URL.createObjectURL(c)),a=p.ref(),r=a.child(n+c.name),e.next=6,r.put(c);case 6:return e.t0=s,e.next=9,r.getDownloadURL();case 9:e.t1=e.sent,(0,e.t0)(e.t1);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){h(!0),K(t.participants,"users",i,(function(e){return e}),(function(){return h(!1)}))}),[t.id]),Object(s.useEffect)((function(){x.trim()!==t.chatName.trim()||w!==t.chatImage?Y(!0):Y(!1)}),[x,w]),Object(s.useEffect)((function(){g(t.chatName)}),[t.id]),Object(s.useEffect)((function(){g(t.chatName),C(t.chatImage)}),[t.chatName,t.chatImage]),Object(v.jsxs)("div",{className:"ChatInfo",children:[Object(v.jsx)(Mt.a,{src:A,getColors:function(e){return T(e)}}),Object(v.jsxs)("div",{className:"chatInfoImageAndName",children:[Object(v.jsxs)("div",{className:"chatInfoImage",children:[Object(v.jsxs)("label",{className:"changePhoto",children:[Object(v.jsx)(at.b,{}),"Change photo",Object(v.jsx)("input",{type:"file",style:{display:"none"},onChange:function(e){return function(e,t,n){return q.apply(this,arguments)}(e,"chatCovers/",C)}})]}),Object(v.jsx)("img",{loading:"lazy",src:w,alt:""})]}),Object(v.jsxs)("div",{children:[Object(v.jsx)(qe,{value:x,setValue:g,placeholder:"Enter chat name",required:!0}),Object(v.jsxs)("div",{className:"chatInfoButtons",children:[Object(v.jsxs)("button",{className:"chatInfoButton",children:[Object(v.jsx)(se.z,{}),"Settings"]}),Object(v.jsxs)("button",{className:"chatInfoButton",onClick:function(){return R(Object(v.jsx)(ls,{chatId:t.id}))},children:[Object(v.jsx)(Be.a,{}),oe("Attachments",7)]}),Object(v.jsxs)("button",{className:"chatInfoButton",children:[Object(v.jsx)(fe.b,{}),"Sound"]})]})]}),V?Object(v.jsx)("button",{className:"standartButton",onClick:function(){m.collection("chats").doc(t.id).update({chatName:x,chatImage:w,imageColors:E})},children:"Update Chat"}):null]}),Object(v.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[Object(v.jsx)("h4",{children:"Chat participants"}),Object(v.jsx)(Ve,{text:"Add",icon:Object(v.jsx)(se.E,{}),onClick:function(){return R(Object(v.jsx)(bs,{chat:t}))}})]}),Object(v.jsx)(vt,{pages:["All participants","Administrators"],currentPage:U,setCurrentPage:F}),d?Object(v.jsx)(ke,{}):r.map((function(e){return 1!==U?Object(v.jsx)(z,{data:e,lastSeen:!0,rightButton:e.uid===n.uid?Object(v.jsx)(us,{chat:t,user:n}):t.admins.includes(n.uid)?Object(v.jsx)(us,{chat:t,user:e}):null},e.uid):t.admins.includes(e.uid)?Object(v.jsx)(z,{data:e,lastSeen:!0},e.uid):void 0}))]})},fs=function(e){var t=e.chatId,n=e.image,s=e.currentWallpaper;return Object(v.jsx)("div",{className:"WallpaperItem "+(n===s?"active":""),onClick:function(){m.collection("chats").doc(t).update({wallpaper:n})},style:"undefined"===n?{background:"var(--playlistsColor)"}:{},children:"undefined"!==n?Object(v.jsx)("img",{loading:"lazy",src:n,alt:""}):null})},Os=function(e){var t=e.chatId,n=e.currentWallpaper,c=Object(s.useState)([]),a=Object(l.a)(c,2),r=a[0],i=a[1],o=Object(s.useState)(!0),u=Object(l.a)(o,2),d=u[0];return function(e,t,n,c,a,r,i,o){var u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:[];function l(){return d.apply(this,arguments)}function d(){return(d=Object(b.a)(j.a.mark((function s(){var u;return j.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(u=[],void 0!==n){s.next=15;break}if(void 0===r){s.next=9;break}return s.next=5,m.collection(t).where(r,i,o).get();case 5:s.sent.docs.forEach((function(e){u.push(e.data())})),s.next=13;break;case 9:return s.next=11,m.collection(t).get();case 11:s.sent.docs.forEach((function(e){u.push(e.data())}));case 13:s.next=18;break;case 15:return s.next=17,n.forEach(function(){var e=Object(b.a)(j.a.mark((function e(s,r){var i;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection(t).doc(s).get();case 2:i=e.sent.data(),u.push(i),r===n.length-1&&(void 0!==a?(u.sort(a),c(u)):c(u));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 17:e(!1);case 18:return s.abrupt("return",u);case 19:case"end":return s.stop()}}),s)})))).apply(this,arguments)}Object(s.useEffect)((function(){e(!0),c([]),l().then((function(t){void 0===n&&(c(t),e(!1))}))}),u)}(u[1],"chatWallpapers",void 0,i),d?Object(v.jsx)(ke,{}):Object(v.jsxs)("div",{className:"Wallpapers",children:[Object(v.jsx)("h2",{children:"Wallpapers"}),Object(v.jsxs)("div",{className:"wallpapreWrapper",children:[Object(v.jsx)(fs,{chatId:t,image:"undefined"}),r.map((function(e,s){return Object(v.jsx)(fs,{chatId:t,image:e.image,currentWallpaper:n},e.id)}))]})]})},ps=function(e){var t=e.chatId,n=e.currentWallpaper,c=e.data,a=Object(s.useState)(),r=Object(l.a)(a,2),i=r[0],o=r[1],u=J(),d=u.toggleModal,j=u.setContent,b=Object(s.useRef)(null);return ae(b,o),Object(v.jsxs)("div",{className:"ChatMoreBtn",ref:b,children:[Object(v.jsx)("button",{onClick:function(){return o(!i)},children:Object(v.jsx)(se.s,{})}),Object(v.jsxs)("div",{className:"chatHeaderMenuWindow",style:i?{}:{display:"none"},children:[c.participants.length>2?Object(v.jsxs)("div",{className:"chatHeaderMenuWindowItem",onClick:function(){d(),j(Object(v.jsx)(hs,{data:c}))},children:[Object(v.jsx)(se.o,{}),Object(v.jsx)("span",{children:"Info"})]}):null,Object(v.jsxs)("div",{className:"chatHeaderMenuWindowItem",onClick:function(){d(),j(Object(v.jsx)(ls,{chatId:t}))},children:[Object(v.jsx)(se.k,{}),Object(v.jsx)("span",{children:"Attachments"})]}),Object(v.jsxs)("div",{className:"chatHeaderMenuWindowItem",onClick:function(){d(),j(Object(v.jsx)(Os,{chatId:t,currentWallpaper:n}))},children:[Object(v.jsx)(se.n,{}),Object(v.jsx)("span",{children:"Change wallpaper"})]})]})]})},ms=function(e){var t=e.data,n=J(),s=n.toggleModal,c=n.setContent,a=is(t),r=Object(l.a)(a,2),o=r[0],u=r[1];return Object(v.jsxs)("div",{className:"ChatHeader",style:(null===u||void 0===u?void 0:u.length)?{background:"linear-gradient(45deg, ".concat(u[0],", ").concat(u[1],")")}:{},children:[Object(v.jsx)(Cn,{}),0===t.chatName.length?Object(v.jsxs)(i.b,{className:"chatHeaderImageAndName",to:"/authors/".concat(o.uid),children:[Object(v.jsx)("div",{className:"chatHeaderImage",style:{backgroundImage:"url(".concat(o.photoURL||t.chatImage,")")}}),Object(v.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center"},children:[Object(v.jsx)("h4",{children:o.displayName||t.chatName}),Object(v.jsx)(W,{userUID:o.uid})]})]}):Object(v.jsxs)("div",{className:"chatHeaderImageAndName",onClick:function(){s(),c(Object(v.jsx)(hs,{data:t}))},children:[Object(v.jsx)("div",{className:"chatHeaderImage",style:{backgroundImage:"url(".concat(o.photoURL||t.chatImage,")")}}),Object(v.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center"},children:[Object(v.jsx)("h4",{children:o.displayName||t.chatName}),Object(v.jsx)(W,{userUID:o.uid})]})]}),Object(v.jsx)(ps,{chatId:t.id,data:t,currentWallpaper:t.wallpaper})]})};function xs(e){return e.attachedSongs.length?"Audio":e.attachedAlbums.length?"Album":e.attachedAuthors.length?"Author":e.inResponseToMessage&&e.inResponseToMessage.length?"Forwarded message":""}var gs,vs,ys,Ss,ws,Cs,Ns,ks,Is,As,Ps=function(e){var t=e.attachedItems,n=e.setAttachedItems,s=e.icon;return Object(v.jsx)("div",{className:"AttachedItemsInChatInput",children:t.map((function(e,c){return Object(v.jsxs)("div",{className:"attachedSongItem",children:[s,Object(v.jsx)("span",{children:e}),Object(v.jsx)("button",{className:"removeMessageFromResponse",onClick:function(){return function(e,t,n){t(e.filter((function(e){return e!==n})))}(t,n,e)},children:Object(v.jsx)(se.G,{})})]},e)}))})},Ls=function(e){var t=e.chatId,n=e.chatData,c=e.messageText,a=e.setMessageText,r=e.inResponseToMessage,i=e.setInResponseToMessage,o=e.otherMessages,u=N().currentUser,d=Object(s.useState)(!1),h=Object(l.a)(d,2),f=h[0],O=h[1],p=Z(),x=p.yourSongs,g=p.yourAuthors,y=p.yourPlaylists,S=Object(s.useState)(""),w=Object(l.a)(S,2),C=w[0],k=w[1],I=Object(s.useState)(x),A=Object(l.a)(I,2),P=A[0],L=A[1],M=Object(s.useState)([]),T=Object(l.a)(M,2),R=T[0],B=T[1],D=Object(s.useState)([]),U=Object(l.a)(D,2),F=U[0],W=U[1],H=Object(s.useState)([]),V=Object(l.a)(H,2),z=V[0],Y=V[1],q=Object(s.useState)(y),Q=Object(l.a)(q,2),G=Q[0],K=Q[1],X=Object(s.useState)(g),J=Object(l.a)(X,2),_=J[0],$=J[1],ee=Object(s.useState)([]),ne=Object(l.a)(ee,2),ce=ne[0],re=ne[1],ie=Object(s.useState)([]),ue=Object(l.a)(ie,2),le=ue[0],de=ue[1],je=Object(s.useRef)(null);function be(){ve(t,n,u.uid,c,R,F,z,r),a(""),B([]),Y([]),W([]),i([]),O(!1)}return ae(je,O),Object(s.useEffect)((function(){0===C.length&&L(x)}),[C]),Object(s.useEffect)((function(){if(0===c.length)m.collection("chats").doc(t).update({typing:n.typing.filter((function(e){return e!==u.uid}))});else if(!n.typing.includes(u.uid)){var e=n.typing;e.push(u.uid),m.collection("chats").doc(t).update({typing:e})}}),[c]),Object(s.useEffect)((function(){re([]),r.forEach(function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(o[t].sender).get();case 2:n=e.sent.data().displayName,re((function(e){return[].concat(Object(E.a)(e),[n])}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[r.length]),Object(s.useEffect)((function(){de([]),R.forEach(function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("songs").doc(t).get();case 2:n=e.sent.data().name,de((function(e){return[].concat(Object(E.a)(e),[n])}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[R.length]),Object(v.jsxs)("div",{className:"chatInput",style:f?{borderRadius:"0 0 var(--standartBorderRadius) var(--standartBorderRadius)",transition:".2s"}:{},ref:je,children:[Object(v.jsx)("div",{className:"attachWindow",style:f?{height:"400px",opacity:"1"}:{},children:f?Object(v.jsxs)("div",{style:f?{maxHeight:"100%",overflow:"hidden",display:"flex",flexDirection:"column"}:{display:"none"},children:[Object(v.jsx)(We,{value:C,setValue:k,setAllFoundSongs:L,setResultPlaylists:K,setResultAuthorList:$}),Object(v.jsxs)("div",{style:{height:"100%",overflowY:"auto"},children:[Object(v.jsx)(bn,{listOfSongs:P,source:"no",listOfChosenSongs:R,setListOfSongs:B}),Object(v.jsx)(et,{listOfAuthors:_,listOfChosenAuthors:z,setListOfChosenAuthors:Y}),Object(v.jsx)(Wn,{listOfAlbums:G,loading:!1,listOfChosenAlbums:F,setListOfChosenAlbums:W})]})]}):null}),Object(v.jsxs)("div",{className:"inResponseArea",style:r.length||le.length||z.length||F.length?{}:{height:"0",padding:"0",opacity:"0",top:"0",visibility:"hidden"},children:[Object(v.jsx)("div",{className:"responseMessages",children:r.map((function(e,t){return Object(v.jsxs)("div",{className:"responseItem",children:[Object(v.jsx)("h5",{style:o[e].sender===u.uid?{color:"var(--lightPurple)"}:{},children:ce[t]}),Object(v.jsxs)("p",{children:[oe(o[e].message,35),Object(v.jsx)("span",{style:{marginLeft:"5px",color:"var(--reallyLightBlue)"},children:xs(o[e])})]}),Object(v.jsx)("button",{onClick:function(){return t=e,void i(r.filter((function(e){return e!==t})));var t},className:"removeMessageFromResponse",children:Object(v.jsx)(se.G,{})})]},e)}))}),Object(v.jsx)(Ps,{attachedItems:R,setAttachedItems:B,icon:Object(v.jsx)(Oe.c,{})}),Object(v.jsx)(Ps,{attachedItems:z,setAttachedItems:Y,icon:Object(v.jsx)(se.C,{})}),Object(v.jsx)(Ps,{attachedItems:F,setAttachedItems:W,icon:Object(v.jsx)(te.a,{})})]}),Object(v.jsxs)("div",{className:"attachAndEmojis",children:[Object(v.jsx)("div",{className:"attachBtn",children:Object(v.jsx)("button",{onClick:function(){O(!f)},children:Object(v.jsx)(Be.a,{})})}),Object(v.jsx)("input",{type:"text",style:{background:"var(--lightGrey)",border:"none",outline:"none",minHeight:"100%"},value:c,onChange:function(e){a(e.target.value)},onKeyDown:function(e){"Enter"===e.key&&be()}})]}),Object(v.jsx)("button",{className:"sendBtn",onClick:function(){be()},children:Object(v.jsx)(at.d,{})})]})},Ms=function(e,t,n){var c=Object(s.useRef)(),a=St(c),r=N().currentUser;return Object(s.useEffect)((function(){if(void 0!==t.seenBy&&r.uid!==t.sender&&a&&!t.seenBy.includes(r.uid)){var s=n;s[t.id].seenBy.push(r.uid),m.collection("chats").doc(e).update({messages:s})}}),[a]),[c,a]},Es=function(){return Object(v.jsx)("div",{className:"SongItem SongItemLoading",children:Object(v.jsxs)("div",{className:"songItemImageAndName",children:[Object(v.jsx)("div",{className:"songItemImage"}),Object(v.jsxs)("div",{className:"songItemNameAndAuthor",children:[Object(v.jsx)("div",{className:"songItemName"}),Object(v.jsx)("div",{className:"songItemAuthor"})]})]})})},Ts=function(e){var t=e.messageData,n=e.chatId,c=e.scrollToMessageRef,a=e.setScrollToMessageId,r=e.scrollToMessageId,i=e.showPhoto,o=void 0===i||i,u=e.otherMessages,d=e.inResponseToMessageArr,h=e.setInResponseToMessageArr,f=N().currentUser,O=A(),p=O.isMobile,x=O.screenHeight,g=t.message,y=t.attachedAlbums,S=t.attachedSongs,w=t.attachedAuthors,C=t.sender,k=t.inResponseToMessage,I=t.id,P=t.sentTime,L=Object(s.useState)({}),M=Object(l.a)(L,2),T=M[0],R=M[1],B=U(P,2),D=Object(s.useState)([]),F=Object(l.a)(D,2),W=F[0],H=F[1],V=Object(s.useState)([]),z=Object(l.a)(V,2),Y=z[0],q=z[1],Q=Object(s.useState)([]),G=Object(l.a)(Q,2),K=G[0],X=G[1],J=Object(s.useState)([]),_=Object(l.a)(J,2),$=_[0],Z=_[1],ee=Object(s.useState)([]),ne=Object(l.a)(ee,2),se=ne[0],ae=ne[1],re=Ms(n,t,u),ie=Object(l.a)(re,2),oe=ie[0],ue=ie[1],le=Object(s.useState)(0),de=Object(l.a)(le,2),je=de[0],be=de[1],he=Object(s.useState)(0),fe=Object(l.a)(he,2),Oe=fe[0],pe=fe[1],me=Object(ce.useSwipeable)({onSwiping:function(e){e.deltaX<0&&be(e.deltaX)}});function xe(){return(xe=Object(b.a)(j.a.mark((function e(){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(t.sender).get();case 2:n=e.sent.data(),R(n);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ge(e,t,n){return e.forEach(function(){var e=Object(b.a)(j.a.mark((function e(s){var c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection(t).doc(s).get();case 2:(c=e.sent).exists?n((function(e){return[].concat(Object(E.a)(e),[c.data()])})):n((function(e){return[].concat(Object(E.a)(e),[null])}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}function ve(){d.includes(I)||h((function(e){return[].concat(Object(E.a)(e),[I])}))}function ye(){var e;clearTimeout(e),pe(.2),e=setTimeout((function(){be(0),pe(0)}),200)}return Object(s.useEffect)((function(){!function(){xe.apply(this,arguments)}(),ge(S,"songs",H),ge(w,"users",q),ge(y,"playlists",X),null!==k&&k.forEach(function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Z((function(e){return[].concat(Object(E.a)(e),[u[t]])})),e.next=3,m.collection("users").doc(u[t].sender).get();case 3:n=e.sent.data().displayName,ae((function(e){return[n].concat(Object(E.a)(e))}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]),Object(s.useEffect)((function(){je<-160&&(ye(),ve())}),[je]),Object(v.jsxs)("div",{className:"MessageItem "+(C===f.uid?"your":""),ref:I===r?c:function(e){me.ref(e),oe.current=e},style:o?{paddingBottom:"15px",transform:"translateX(".concat(je,"px)"),transition:Oe}:{transform:"translateX(".concat(je,"px)"),transition:Oe},onTouchEnd:ye,children:[Object(v.jsx)("div",{className:"messageItemImage",children:o?Object(v.jsx)("img",{loading:"lazy",src:T.photoURL,alt:""}):null}),Object(v.jsxs)("div",{className:"messageItemBody",style:I===r?{animation:"showResponseMessage .5s forwards"}:o?{borderRadius:"var(--standartBorderRadius2) var(--standartBorderRadius) var(--standartBorderRadius) 5px"}:{},children:[Object(v.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"5px"},children:[Object(v.jsx)("h5",{className:"messageUserName",children:T.displayName}),Object(v.jsx)("div",{style:{fontSize:".7em",opacity:".8",marginLeft:"10px"},children:B})]}),null!==k?$.map((function(e,t){return Object(v.jsxs)("div",{className:"responseItem",onClick:function(){return a(e.id)},children:[Object(v.jsxs)("span",{style:{display:"flex",alignItems:"center"},children:[Object(v.jsx)("h5",{style:e.sender===f.uid?{color:"var(--lightPurple)"}:{},children:se[t]}),Object(v.jsx)("div",{style:{fontSize:".7em",opacity:".8",marginLeft:"10px"},children:U(e.sentTime,2)})]}),Object(v.jsxs)("p",{children:[e.message,Object(v.jsx)("span",{style:{marginLeft:"5px",color:"var(--reallyLightBlue)"},children:xs(e)})]})]})})):null,Object(v.jsxs)("div",{children:[Object(v.jsx)("p",{children:g}),W.map((function(e,t){return ue?Object(v.jsx)(xt,{song:e,localIndex:t,position:x},t):Object(v.jsx)(Es,{})})),K.map((function(e,t){return Object(v.jsx)(Fn,{playlist:e},t)})),Y.map((function(e,t){return Object(v.jsx)(Ze,{data:e},t)}))]})]}),Object(v.jsx)(Zn,{listOfSeen:t.seenBy}),Object(v.jsx)("button",{className:"respondToMessageBtn",onClick:ve,style:p?{opacity:-je/80}:{},children:Object(v.jsx)(te.o,{})})]})},Rs=function(e){var t=e.message,n=e.index,c=e.messageList,a=e.chatId,r=e.inResponseToMessage,i=e.setInResponseToMessage,o=e.scrollToMessageRef,u=e.scrollToMessageId,d=e.setScrollToMessageId,j=e.setDateRefsArray,b=Object(s.useState)(!1),h=Object(l.a)(b,2),f=h[0],O=h[1],p=Object(s.useState)(!1),m=Object(l.a)(p,2),x=m[0],g=m[1],y=Object(s.useRef)(null);return Object(s.useEffect)((function(){(n===c.length-1||c[n+1].sender!==c[n].sender||U(c[n+1].sentTime)!==U(c[n].sentTime))&&O(!0),(0===n||U(c[n].sentTime)!==U(c[n-1].sentTime))&&g(!0)}),[]),Object(s.useEffect)((function(){null!==y.current&&j((function(e){return[].concat(Object(E.a)(e),[y])}))}),[x]),Object(v.jsxs)(v.Fragment,{children:[x?Object(v.jsx)("div",{ref:y,style:{width:"100%",display:"flex",justifyContent:"center",alignItems:"center",padding:"10px 0"},children:U(t.sentTime)}):null,Object(v.jsx)(Ts,{messageData:t,chatId:a,scrollToMessageRef:o,scrollToMessageId:u,setScrollToMessageId:d,showPhoto:f,otherMessages:c,inResponseToMessageArr:r,setInResponseToMessageArr:i},t.id)]})},Bs=H.a.div(gs||(gs=Object(M.a)(["\n  width: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  opacity: 0.5;\n"]))),Ds=function(e){var t=e.chatId,n=e.message,s=e.messageList,c=Ms(t,n,s),a=Object(l.a)(c,2),r=a[0];a[1];return Object(v.jsx)(Bs,{ref:r,children:n.message})},Us=function(e){var t=e.chatId,n=e.messageList,c=e.inResponseToMessage,a=e.setInResponseToMessage,r=e.messagesWindowRef,i=e.setDateRefsArray,o=Object(s.useRef)(null),u=Object(s.useState)(-1),d=Object(l.a)(u,2),j=d[0],b=d[1];return Object(s.useEffect)((function(){-1!==j&&(r.current.scrollTo(0,o.current.offsetTop-65<0?0:o.current.offsetTop-65),setTimeout((function(){b(-1)}),500))}),[j]),n.length?Object(v.jsx)(v.Fragment,{children:n.map((function(e,s){return"soundbubble"!==e.sender?Object(v.jsx)(Rs,{message:e,index:s,messageList:n,chatId:t,inResponseToMessage:c,setInResponseToMessage:a,scrollToMessageRef:o,scrollToMessageId:j,setScrollToMessageId:b,setDateRefsArray:i},e.id):Object(v.jsx)(Ds,{chatId:t,message:e,messageList:n})}))}):null},Fs=function(e){var t=e.chatId,n=e.chatData,c=e.messageList,a=e.findTopDate,r=e.inResponseToMessage,i=e.setInResponseToMessage,o=e.setDateRefsArray,u=A(),l=u.screenHeight,d=u.isMobile,j=Object(s.useRef)(null);return Object(s.useEffect)((function(){setTimeout((function(){!function(){var e,t,n,s=(null===(e=j.current)||void 0===e?void 0:e.scrollHeight)-(null===(t=j.current)||void 0===t?void 0:t.clientHeight);null===(n=j.current)||void 0===n||n.scrollTo(0,s)}()}),200)}),[c]),Object(v.jsxs)("div",{className:"chatMessagesWindow",ref:j,onScroll:a,style:{height:d?l-125+"px":l-105+"px"},children:[Object(v.jsx)(Us,{chatId:t,messageList:c,inResponseToMessage:r,setInResponseToMessage:i,messagesWindowRef:j,setDateRefsArray:o}),Object(v.jsx)(es,{typingPeople:n.typing})]})},Ws=function(){var e=Object(o.h)("/chat/:chatId"),t=N().currentUser,n=e.params.chatId,c=Object(s.useState)(""),a=Object(l.a)(c,2),r=a[0],i=a[1],u=Object(s.useState)([]),d=Object(l.a)(u,2),j=d[0],b=d[1],h=Object(s.useState)([]),f=Object(l.a)(h,2),O=f[0],p=f[1],x=Object(o.g)(),g=function(e,t){var n=Object(s.useState)(null),c=Object(l.a)(n,2),a=c[0],r=c[1],i=Object(s.useState)([]),o=Object(l.a)(i,2),u=o[0],d=o[1],j=Object(s.useState)(!0),b=Object(l.a)(j,2),h=b[0],f=b[1],O=Object(s.useState)(""),p=Object(l.a)(O,2),x=p[0],g=p[1];return Object(s.useEffect)((function(){var t=m.collection("chats").doc(e).onSnapshot((function(e){var t,n;r(e.data()),d(null===(t=e.data())||void 0===t?void 0:t.messages),g((null===(n=e.data())||void 0===n?void 0:n.messages.length)?e.data().messages[0].sentTime:(new Date).toString()),f(!1)}));return function(){t()}}),[m,e]),[a,u,h,x,function(e){t.forEach((function(t){null!==t.current&&t.current.offsetTop-70<=e.target.scrollTop&&g(t.current.innerHTML)}))}]}(n,O),y=Object(l.a)(g,5),S=y[0],w=y[1],C=y[2],k=y[3],I=y[4];return Object(s.useEffect)((function(){void 0===S?x.push("/not-found"):void 0!==(null===S||void 0===S?void 0:S.participants)&&(S.participants.includes(t.uid)||x.push("/chat"))}),[S]),null!==S&&void 0!==S?Object(v.jsxs)("div",{className:"DialoguePage",style:{height:"100%"},children:[C?Object(v.jsx)(ke,{top:"50%"}):Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(ms,{data:S}),Object(v.jsx)(rs,{date:k}),Object(v.jsx)(Fs,{chatId:n,chatData:S,messageList:w,findTopDate:I,setDateRefsArray:p,inResponseToMessage:j,setInResponseToMessage:b}),Object(v.jsx)(Ls,{chatId:n,chatData:S,messageText:r,setMessageText:i,inResponseToMessage:j,setInResponseToMessage:b,otherMessages:w})]}),"undefined"!==(null===S||void 0===S?void 0:S.wallpaper)?Object(v.jsx)("img",{loading:"lazy",src:S.wallpaper,className:"chatWallpaper",alt:""}):null]}):null},Hs=function(){var e=Object(s.useState)([]),t=Object(l.a)(e,2),n=t[0],c=t[1],a=Object(s.useState)([]),r=Object(l.a)(a,2),i=r[0],o=r[1],u=N().currentUser;return Object(s.useEffect)((function(){m.collection("history").doc(u.uid).onSnapshot((function(e){c(e.data().history)}))}),[m]),Object(s.useEffect)((function(){K(n,"songs",o)}),[n]),Object(v.jsx)("div",{className:"HistoryPage",style:{animation:"zoomIn .2s forwards"},children:Object(v.jsxs)(Ln,{children:[Object(v.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[Object(v.jsx)(Cn,{}),Object(v.jsx)("h2",{style:{margin:"0px",marginLeft:"8px"},children:"History"})]}),Object(v.jsx)(bn,{listOfSongs:i,source:{source:"/history",name:"History",image:"https://www.seekpng.com/png/full/781-7815113_history-icon-white-png.png",songsList:i},showCount:!0,showSearch:!0,displayIfEmpty:"Nothing here"})]})})},Vs=function(){var e=Object(s.useState)([]),t=Object(l.a)(e,2),n=t[0],c=t[1],a=Object(s.useState)(0),r=Object(l.a)(a,2),i=r[0],o=r[1],u=Object(s.useState)(!0),d=Object(l.a)(u,2),h=d[0],f=d[1],O=Object(s.useState)({}),p=Object(l.a)(O,2),x=p[0],g=p[1],y=Object(s.useState)({}),S=Object(l.a)(y,2),w=S[0],C=S[1],N=Object(s.useState)({}),k=Object(l.a)(N,2),I=k[0],A=k[1];function P(e,t,n){return L.apply(this,arguments)}function L(){return(L=Object(b.a)(j.a.mark((function e(t,n,s){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection(n).orderBy(s,"desc").limit(1).get();case 2:a=e.sent.docs[0].data(),t(a),c((function(e){return[].concat(Object(E.a)(e),[a.imageColors[0]])})),"playlists"===n&&f(!1);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){P(g,"users","subscribers"),P(C,"songs","listens"),P(A,"playlists","listens")}),[]),Object(v.jsx)("div",{className:"MainBanner",style:{background:n[i]},children:h?Object(v.jsx)(ke,{}):Object(v.jsxs)(v.Fragment,{children:[Object(v.jsxs)("div",{className:"slider",children:[Object(v.jsxs)("div",{className:"sliderItem "+(0===i?"current":""),style:{transform:"translateX(-".concat(100*i,"%)")},children:[Object(v.jsx)("h3",{children:"Most popular artist on platform"}),Object(v.jsx)(Ze,{data:x})]}),Object(v.jsxs)("div",{className:"sliderItem "+(1===i?"current":""),style:{transform:"translateX(-".concat(100*i,"%)")},children:[Object(v.jsx)("h3",{children:"Most popular song on platform"}),Object(v.jsx)(xt,{song:w,localIndex:0,showListens:!0})]}),Object(v.jsxs)("div",{className:"sliderItem "+(2===i?"current":""),style:{transform:"translateX(-".concat(100*i,"%)")},children:[Object(v.jsx)("h3",{children:"Most popular album on platform"}),Object(v.jsx)(Fn,{playlist:I})]})]}),Object(v.jsxs)("div",{className:"sliderBtns",children:[Object(v.jsx)("button",{onClick:function(){return o(G(i-1,2,0))},children:Object(v.jsx)(te.c,{})}),Object(v.jsx)("button",{onClick:function(){return o(G(i+1,2,0))},children:Object(v.jsx)(te.d,{})})]})]})})},zs=function(){var e=Z().yourAuthors,t=Object(s.useState)([]),n=Object(l.a)(t,2),c=n[0],a=n[1];return Object(s.useEffect)((function(){void 0!==e&&0!==e.length&&0===c.length&&function(){var t=[];e.forEach((function(e,n){e.ownSongs.forEach(function(){var e=Object(b.a)(j.a.mark((function e(n){var s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("songs").doc(n).get();case 2:qn(s=e.sent.data())&&!t.includes(s.id)&&(a((function(e){return[].concat(Object(E.a)(e),[s])})),t.push(s.id));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}))}()}),[]),Object(v.jsx)("div",{children:Object(v.jsx)(bn,{listOfSongs:c,source:{source:"/home",name:"New Songs",image:"",songsList:c},title:"New Songs",isNewSong:!0})})},Ys=function(){var e=Z().yourAuthors,t=Object(s.useState)([]),n=Object(l.a)(t,2),c=n[0],a=n[1],r=Object(s.useState)([]),i=Object(l.a)(r,2),o=i[0],u=i[1],d=N().currentUser;return Object(s.useEffect)((function(){void 0!==e&&e.forEach((function(e){Kn(e,a)}))}),[]),Object(s.useEffect)((function(){c.forEach((function(e){var t=o.map((function(e){return e.uid}));d.addedAuthors.includes(e.uid)||t.includes(e.uid)||u((function(t){return[].concat(Object(E.a)(t),[e])}))}))}),[c]),Object(v.jsx)("div",{className:"RecommendedAuthors",children:Object(v.jsx)(et,{listOfAuthors:o,title:"Recommended Authors"})})},qs=function(e){var t=e.message,n=e.image,s=e.button;return Object(v.jsx)("div",{className:"importantMessage",children:Object(v.jsxs)("div",{children:[n?Object(v.jsx)("img",{loading:"lazy",src:n,alt:""}):null,Object(v.jsx)("h3",{children:t}),s||null]})})},Qs=function(){var e=Z().yourAuthors,t=N().currentUser,n=Object(s.useState)([]),c=Object(l.a)(n,2),a=c[0],r=c[1];return Object(s.useEffect)((function(){!function(){var n=[];e.forEach((function(e,s){e.ownSongs.forEach(function(){var e=Object(b.a)(j.a.mark((function e(s,c){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("songs").doc(s).get();case 2:a=e.sent.data(),!t.addedSongs.includes(s)&&!n.includes(a.id)&&c<=3&&(r((function(e){return[].concat(Object(E.a)(e),[a])})),n.push(a.id));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}))}()}),[]),Object(v.jsx)("div",{className:"RecommendedSongs",children:Object(v.jsx)(bn,{listOfSongs:a,source:{source:"/home",name:"Recommended Songs",image:"",songsList:a},title:"Recommended Songs",displayIfEmpty:Object(v.jsx)(qs,{message:"No songs recommended. Add favorite authors so we could know what to recommend",image:"https://i.pinimg.com/originals/b2/3d/f6/b23df649311586e74a8455c92eb3d76b.png"})})})},Gs=function(){var e=Object(s.useState)([]),t=Object(l.a)(e,2),n=t[0],c=t[1],a=Object(s.useState)(!0),r=Object(l.a)(a,2),i=r[0],o=r[1];return Object(s.useEffect)((function(){o(!0),m.collection("songs").orderBy("listens","desc").limit(15).get().then((function(e){e.docs.forEach((function(e){c((function(t){return[].concat(Object(E.a)(t),[e.data()])}))})),o(!1)}))}),[]),i?Object(v.jsx)(ke,{}):Object(v.jsx)(bn,{listOfSongs:n,source:{source:"/home",name:"Top 15 Songs",image:"https://media.istockphoto.com/vectors/fire-icon-illustration-for-design-stock-vector-vector-id931601050?k=6&m=931601050&s=170667a&w=0&h=fhRQfwwsW6aXK9OSDM-yj842SFFl2Q9ll6ch-xCK5es=",songsList:n},title:"Top 15 Songs",showListens:!0,showCount:!0})},Ks=(n(270),function(){return Object(v.jsxs)("div",{style:{animation:"zoomIn .2s forwards"},className:"HomePage",children:[Object(v.jsx)(Vs,{}),Object(v.jsxs)(Ln,{children:[Object(v.jsx)(zs,{}),Object(v.jsx)(Gs,{}),Object(v.jsx)(Qs,{}),Object(v.jsx)(Ys,{})]})]})}),Xs=(n(271),function(e){return e<1990&&e>=1780?7:e<1780&&e>=1570?6:e<1570&&e>=1360?5:e<1360&&e>=1150?4:e<1150&&e>=1e3?3:e<1e3&&e>=892?6:e<892&&e>=754?5:e<754&&e>=614?4:e<614&&e>=464?3:2}),Js=n.p+"static/media/wave2.f62cb572.svg",_s=function(e){var t=e.playlist,n=Z(),c=n.currentSongPlaylistSource,a=n.play,r=A().isMobile,o=Object(s.useState)([]),u=Object(l.a)(o,2),d=u[0],j=u[1],b=rn(t,d,j);return Object(v.jsx)(i.b,{to:"/albums/".concat(t.id),className:"playlistWrapper",children:Object(v.jsxs)("div",{className:"library playlistItem",style:{backgroundImage:"url(".concat(t.image,")")},children:[Object(v.jsx)("h2",{style:{background:t.imageColors[2]},children:oe(t.name,10)}),t.image?null:Object(v.jsx)(te.a,{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",width:"60px",height:"60px"}}),r?null:Object(v.jsx)("button",{onClick:b,children:c.name===t.name&&a?Object(v.jsx)(ne.b,{}):Object(v.jsx)(ne.c,{})})]})})},$s=function(){var e=Z(),t=e.yourSongs,n=e.yourPlaylists,c=N().currentUser,a=A().screenWidth,r=Object(s.useState)(Xs(a)),i=Object(l.a)(r,2),o=i[0],u=i[1];return Object(s.useEffect)((function(){u(Xs(a))}),[a]),Object(v.jsxs)("div",{className:"SongsPage",children:[Object(v.jsxs)("div",{className:"playLists",children:[Object(v.jsx)("div",{className:"playlistContent",children:n.length?n.map((function(e,t){if(t<o)return Object(v.jsx)(_s,{playlist:e},t)})):Object(v.jsx)("h3",{style:{position:"absolute",left:"50%",top:"40%",transform:"translate(-50%, -50%)"},children:"You don't have playlists"})}),Object(v.jsx)("div",{className:"playlistsBackground",children:Object(v.jsx)("img",{loading:"lazy",src:Js,alt:"wave"})})]}),Object(v.jsx)("div",{className:"yourSongsList",children:Object(v.jsx)(bn,{listOfSongs:t,source:{source:"/library",name:"Your Library",image:c.photoURL,songsList:t},showSearch:!0,showhistory:!0,displayIfEmpty:Object(v.jsx)("h3",{children:"Your library is empty"})})})]})},Zs=function(){var e=Z().yourPlaylists,t=Object(s.useState)(e),n=Object(l.a)(t,2),c=n[0],a=n[1],r=J(),i=r.toggleModal,o=r.setContent,u=Object(s.useState)(""),d=Object(l.a)(u,2),j=d[0],b=d[1];return Object(v.jsx)("div",{className:"PlaylistsPage",children:Object(v.jsxs)(Ln,{children:[Object(v.jsxs)("div",{style:{display:"flex"},className:"searchAndCreatePlaylist",children:[Object(v.jsx)(We,{value:j,setValue:b,setResultPlaylists:a,defaultSearchMode:"playlists",defaultPlaylistsListValue:e}),Object(v.jsxs)("button",{className:"createPlaylistBtn",onClick:function(){i(),o(Object(v.jsx)(Ut,{}))},children:[Object(v.jsx)(te.i,{}),"Create Playlist"]})]}),Object(v.jsx)("div",{className:"playlistsContainer",children:c&&c.map((function(e,t){return Object(v.jsx)(Fn,{playlist:e},e.id)}))})]})})},ec=function(){var e=Z().yourAuthors,t=Object(s.useState)(""),n=Object(l.a)(t,2),c=n[0],a=n[1],r=Object(s.useState)(e),i=Object(l.a)(r,2),o=i[0],u=i[1];return Object(v.jsx)("div",{className:"AuthorsPage",children:Object(v.jsxs)(Ln,{children:[Object(v.jsx)(We,{value:c,setValue:a,setResultAuthorList:u,defaultSearchMode:"authors",defaultAuthorsListValue:e}),Object(v.jsx)("div",{className:"authorsContainer",children:o.map((function(e){return Object(v.jsx)(Ze,{data:e},e.uid)}))})]})})},tc=function(){var e=Object(s.useState)(0),t=Object(l.a)(e,2),n=t[0],c=t[1],a=[Object(v.jsx)($s,{}),Object(v.jsx)(Zs,{}),Object(v.jsx)(ec,{})];return Object(v.jsxs)("div",{className:"LibraryPage",style:{animation:"zoomIn .2s forwards"},children:[Object(v.jsx)(vt,{pages:["Songs","Playlists","Authors"],currentPage:n,setCurrentPage:c}),a[n]]})},nc=function(){return Object(v.jsxs)("div",{className:"BlurredBg",children:[Object(v.jsx)("div",{className:"circle circle1"}),Object(v.jsx)("div",{className:"circle circle2"}),Object(v.jsx)("div",{className:"circle circle3"}),Object(v.jsx)("div",{className:"circle circle4"}),Object(v.jsx)("div",{className:"circle circle5"})]})},sc=function(e){var t=e.title;return Object(v.jsxs)("div",{className:"titleAndLogo",children:[Object(v.jsx)("div",{className:"title",children:Object(v.jsx)("h1",{children:t})}),Object(v.jsx)("div",{className:"logo",children:Object(v.jsx)("img",{loading:"lazy",src:g,alt:""})})]})},cc=function(){var e=N().login,t=Object(s.useState)(""),n=Object(l.a)(t,2),c=n[0],a=n[1],r=Object(s.useState)(""),o=Object(l.a)(r,2),u=o[0],d=o[1],h=Object(s.useState)(""),f=Object(l.a)(h,2),O=f[0],p=f[1],m=Object(s.useState)(!1),x=Object(l.a)(m,2),g=x[0],y=x[1],S=0!==c.length&&0!==u.length;function w(){return(w=Object(b.a)(j.a.mark((function t(n){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),S){t.next=3;break}return t.abrupt("return",p("One of your fields is totaly empty"));case 3:return t.next=5,e(c,u,p,y);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return Object(v.jsxs)("div",{className:"In-Up-Container",children:[Object(v.jsxs)("div",{className:"CentralPlate",children:[Object(v.jsx)(Rt,{loading:g}),Object(v.jsx)(sc,{title:"Log In"}),Object(v.jsx)(lt,{errorMessage:O}),Object(v.jsxs)("div",{className:"inner-plate-content",children:[Object(v.jsx)(qe,{type:"email",placeholder:"Enter your email",value:c,setValue:a,margin:!0}),Object(v.jsx)(qe,{type:"password",placeholder:"Enter your password",value:u,setValue:d,margin:!0}),Object(v.jsxs)("div",{className:"inAndUpBtns",children:[Object(v.jsx)("button",{className:"upBtn",disabled:g,onClick:function(e){return w.apply(this,arguments)},children:"Log In"}),Object(v.jsx)(i.b,{to:Wt,children:Object(v.jsx)("button",{className:"inBtn",children:"Create new account"})})]})]})]}),Object(v.jsx)(nc,{})]})},ac=H.a.div(vs||(vs=Object(M.a)(["\n  max-height: 500px;\n  width: 1000px;\n  overflow-y: auto;\n\n  .lyricsBlock {\n    padding: 10px;\n    box-sizing: border-box;\n    font-size: 1.8em;\n    font-weight: 700;\n    margin: 10px 0;\n    user-select: none;\n    cursor: pointer;\n    border-radius: var(--standartBorderRadius2);\n\n    &:hover {\n      background: #ffffff5c;\n    }\n  }\n"]))),rc=function(e){var t=e.song;return Object(v.jsx)(ac,{children:t.lyrics.map((function(e,t){return Object(v.jsx)("div",{className:"lyricsBlock",children:e.text})}))})},ic=H.a.div(ys||(ys=Object(M.a)(["\n  width: 100%;\n  max-width: 800px;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n\n  .song-image {\n    width: 300px;\n    height: 300px;\n    background-size: cover;\n    background-position: center center;\n    border-radius: var(--standartBorderRadius);\n  }\n"]))),oc=function(e){var t=e.song;return Object(v.jsxs)(ic,{children:[Object(v.jsx)("div",{className:"song-image",style:{backgroundImage:"url(".concat(t.cover,")")}}),Object(v.jsx)("h3",{children:t.name})]})},uc=Object(H.a)(Ln)(Ss||(Ss=Object(M.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n  background: ",";\n\n  h2 {\n    margin: 0;\n  }\n\n  .image-and-lyrics {\n    display: flex;\n    align-items: center;\n  }\n"])),(function(e){var t=e.colors;return"linear-gradient(45deg, ".concat(t[2],", ").concat(t[3],");")})),lc=function(){var e=Object(s.useState)("3e35c47f-2186-4dea-a415-55616c525874"),t=Object(l.a)(e,2),n=t[0],c=(t[1],Object(s.useState)(null)),a=Object(l.a)(c,2),r=a[0],i=a[1];return Object(s.useEffect)((function(){m.collection("songs").doc(n).get().then((function(e){i(e.data())}))}),[]),!!r&&Object(v.jsx)(uc,{colors:r.imageColors,children:Object(v.jsxs)("div",{children:[Object(v.jsxs)("div",{className:"image-and-lyrics",children:[Object(v.jsx)(oc,{song:r}),Object(v.jsx)(rc,{song:r})]}),Object(v.jsx)("div",{})]})})},dc=(n(272),function(){var e=Object(o.g)();return Object(v.jsxs)("div",{className:"PageNotFound",children:[Object(v.jsx)("img",{loading:"lazy",src:"https://i.pinimg.com/originals/b2/3d/f6/b23df649311586e74a8455c92eb3d76b.png",alt:""}),Object(v.jsx)("h2",{children:"Page not found"}),Object(v.jsx)("button",{className:"standartButton",onClick:function(){return e.push("/library")},children:"Back to library"})]})}),jc=function(){var e=Object(s.useState)([]),t=Object(l.a)(e,2),n=t[0],c=t[1],a=Object(s.useState)([]),r=Object(l.a)(a,2),i=r[0],o=r[1],u=Object(s.useState)([]),d=Object(l.a)(u,2),h=d[0],f=d[1],O=N().currentUser;return Object(s.useEffect)((function(){m.collection("searchHistory").doc(O.uid).get().then((function(e){var t;(null===(t=e.data())||void 0===t?void 0:t.history)&&e.data().history.forEach(function(){var e=Object(b.a)(j.a.mark((function e(t){var n,s,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,s=t.type,e.next=3,m.collection(s).doc(n).get();case 3:a=e.sent.data(),e.t0=s,e.next="songs"===e.t0?7:"playlists"===e.t0?9:"users"===e.t0?11:13;break;case 7:return c((function(e){return[].concat(Object(E.a)(e),[a])})),e.abrupt("break",14);case 9:return o((function(e){return[].concat(Object(E.a)(e),[a])})),e.abrupt("break",14);case 11:return f((function(e){return[].concat(Object(E.a)(e),[a])})),e.abrupt("break",14);case 13:return e.abrupt("break",14);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}))}),[]),[n,i,h]},bc=function(){var e=N().searchValue,t=jc(),n=Object(l.a)(t,3),s=n[0],c=n[1],a=n[2];return e?null:Object(v.jsxs)("div",{className:"search-history",style:{animation:"zoomIn .2s forwards"},children:[Object(v.jsx)(bn,{listOfSongs:s,source:{source:"/search",name:"Search",image:"https://www.pngkey.com/png/full/87-872187_lupa-search-icon-white-png.png",songsList:s},title:"Search history",showListens:!0,displayIfEmpty:"",isHorizontal:!0}),Object(v.jsx)(et,{listOfAuthors:a}),Object(v.jsx)(Wn,{listOfAlbums:c,loading:!1})]})},hc=(n(273),function(){var e=N(),t=e.searchValue,n=e.setSearchValue,c=Object(s.useState)([]),a=Object(l.a)(c,2),r=a[0],i=a[1],o=Object(s.useState)([]),u=Object(l.a)(o,2),d=u[0],j=u[1],b=Object(s.useState)([]),h=Object(l.a)(b,2),f=h[0],O=h[1],p=Object(s.useState)(""),m=Object(l.a)(p,2),x=m[0],g=m[1];return Object(s.useEffect)((function(){i([]),j([]),O([])}),[t]),Object(s.useEffect)((function(){0!==r.length?g(r[0].imageColors[0]+"a6"):0!==d.length?g(d[0].imageColors[0]+"a6"):0!==f.length?g(f[0].imageColors[0]+"a6"):g("")}),[r,d,f]),Object(v.jsx)("div",{className:"SearchPage",style:{animation:"zoomIn .2s forwards"},children:Object(v.jsxs)(Ln,{children:[Object(v.jsx)(We,{value:t,setValue:n,allFoundSongs:r,setAllFoundSongs:i,setResultPlaylists:O,setResultAuthorList:j,focus:!0}),Object(v.jsx)(bc,{}),Object(v.jsx)(bn,{listOfSongs:r,source:{source:"/search",name:"Search",image:"https://www.pngkey.com/png/full/87-872187_lupa-search-icon-white-png.png",songsList:r},title:"Songs",showListens:!0,saveSearchHistory:!0,displayIfEmpty:"",isHorizontal:!0}),Object(v.jsx)(et,{listOfAuthors:d,title:"Authors",saveSearchHistory:!0}),Object(v.jsx)(Wn,{listOfAlbums:f,title:"Albums and Playlists",loading:!1,saveSearchHistory:!0}),Object(v.jsx)("div",{className:"colorfullShadow",style:{background:x}})]})})}),fc=function(){return Object(v.jsx)("div",{children:"Account"})},Oc=function(e){var t=e.boolValue,n=e.setBoolValue;return Object(v.jsx)("div",{className:"SwitchToggle",onClick:function(){return n(!t)},children:Object(v.jsx)("div",{className:"switchInnerCircle",style:t?{transform:"translateX(100%)",background:"var(--green)"}:{}})})},pc=H.a.div(ws||(ws=Object(M.a)(['\n  width: 100%;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  cursor: pointer;\n  transition: 0.2s;\n  padding: 20px 50px;\n  box-sizing: border-box;\n  position: relative;\n\n  &::after {\n    content: "";\n    position: absolute;\n    width: 100%;\n    height: 2px;\n    bottom: 0;\n    left: 0%;\n    /* transform: translateX(-50%); */\n    background: #313131;\n  }\n\n  .icon-and-text {\n    display: flex;\n    align-items: center;\n    justify-content: flex-start;\n    user-select: none;\n\n    svg {\n      margin-right: 7px;\n      width: 20px;\n      height: 20px;\n    }\n  }\n\n  &:hover {\n    background: var(--leftSideBarColor);\n  }\n']))),mc=function(e){var t=e.icon,n=e.text,c=e.action,a=Object(s.useState)(!1),r=Object(l.a)(a,2),i=r[0],o=r[1],u=function(e){o(e),e&&c&&c()};return Object(v.jsxs)(pc,{onClick:function(){return u(!i)},children:[Object(v.jsxs)("div",{className:"icon-and-text",children:[t,n]}),Object(v.jsx)(Oc,{boolValue:i,setBoolValue:u})]})},xc=function(){return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(mc,{icon:Object(v.jsx)(se.c,{}),text:"\u0423\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f"}),Object(v.jsx)(mc,{icon:Object(v.jsx)(se.c,{}),text:"\u0423\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f"}),Object(v.jsx)(mc,{icon:Object(v.jsx)(se.c,{}),text:"\u0423\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f"}),Object(v.jsx)(mc,{icon:Object(v.jsx)(se.c,{}),text:"\u0423\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f"}),Object(v.jsx)(mc,{icon:Object(v.jsx)(se.c,{}),text:"\u0423\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f"})]})},gc=function(){return Object(v.jsx)("div",{children:"Music"})},vc=H.a.div(Cs||(Cs=Object(M.a)(["\n  width: 85%;\n  height: 100px;\n  border-radius: 5px;\n"]))),yc=function(e){var t=e.currentPage,n=[Object(v.jsx)(fc,{}),Object(v.jsx)(gc,{}),Object(v.jsx)(xc,{})];return Object(v.jsx)(vc,{children:n[t]})},Sc=H.a.button(Ns||(Ns=Object(M.a)(["\n  width: 100%;\n  display: flex;\n  align-items: center;\n  cursor: pointer;\n  /* transition: 0.1s; */\n  padding: 10px;\n  box-sizing: border-box;\n  background: ",";\n  color: #fff;\n  font-weight: 600;\n\n  svg {\n    margin-right: 7px;\n    width: 16px;\n    height: 16px;\n  }\n  /* \n  &:hover {\n    background: var(--leftSideBarColor);\n  } */\n"])),(function(e){return e.isActive?"var(--lightBlue)":"transparent"})),wc=function(e){var t=e.icon,n=e.text,s=e.onClick,c=e.isActive;return Object(v.jsxs)(Sc,{onClick:s,isActive:c,children:[t,n]})},Cc=H.a.div(ks||(ks=Object(M.a)(["\n  width: 15%;\n  border-radius: 5px;\n  overflow: hidden;\n  background: var(--leftSideBarColor);\n"]))),Nc=function(e){var t=e.currentPage,n=e.setCurrentPage;return Object(v.jsxs)(Cc,{children:[Object(v.jsx)(wc,{icon:Object(v.jsx)(se.C,{}),text:"Account",onClick:function(){return n(0)},isActive:0===t}),Object(v.jsx)(wc,{icon:Object(v.jsx)(te.m,{}),text:"Music",onClick:function(){return n(1)},isActive:1===t}),Object(v.jsx)(wc,{icon:Object(v.jsx)(se.q,{}),text:"Chat",onClick:function(){return n(2)},isActive:2===t}),Object(v.jsx)(wc,{icon:Object(v.jsx)(te.m,{}),text:"Music",onClick:function(){return n(3)},isActive:3===t})]})},kc=H.a.div(Is||(Is=Object(M.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: flex-start;\n"]))),Ic=function(){var e=Object(s.useState)(0),t=Object(l.a)(e,2),n=t[0],c=t[1];return Object(v.jsxs)(Ln,{children:[Object(v.jsx)("h2",{children:"Settings"}),Object(v.jsxs)(kc,{children:[Object(v.jsx)(Nc,{setCurrentPage:c,currentPage:n}),Object(v.jsx)(yc,{currentPage:n})]})]})},Ac=(n(274),[{path:Ft,Component:cc},{path:Wt,Component:function(){var e=Object(s.useState)(1),t=Object(l.a)(e,2),n=t[0],c=t[1],a=Object(s.useState)(""),r=Object(l.a)(a,2),o=r[0],u=r[1],d=Object(s.useState)(""),h=Object(l.a)(d,2),f=h[0],O=h[1],p=Object(s.useState)(""),m=Object(l.a)(p,2),x=m[0],g=m[1],y=Object(s.useState)(""),S=Object(l.a)(y,2),w=S[0],C=S[1],k=Object(s.useState)(!1),I=Object(l.a)(k,2),A=I[0],P=I[1],L=N().signup,M=Object(s.useState)(""),E=Object(l.a)(M,2),T=E[0],R=E[1],B=0!==o.length&&0!==f.length&&0!==x.length,D=Object(s.useState)(""),U=Object(l.a)(D,2),F=U[0],W=U[1],H=Object(s.useState)([]),V=Object(l.a)(H,2),z=V[0],Y=V[1];function q(){return(q=Object(b.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),B){e.next=3;break}return e.abrupt("return",C("One of your fields is totaly empty"));case 3:return e.next=5,L(o,x,f,n,T,z,C,P);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(v.jsxs)("div",{className:"In-Up-Container",children:[Object(v.jsx)(Mt.a,{src:F,getColors:function(e){return Y(e)}}),Object(v.jsxs)("div",{className:"CentralPlate",children:[Object(v.jsx)(Rt,{loading:A}),Object(v.jsx)(sc,{title:"Sign Up"}),w&&Object(v.jsx)("div",{className:"Alert",children:w}),Object(v.jsxs)("div",{className:"inner-plate-content",children:[Object(v.jsx)(qe,{type:"email",placeholder:"Enter your email",value:o,setValue:u,margin:!0}),Object(v.jsx)(qe,{type:"text",placeholder:"Enter your name",value:x,setValue:g,margin:!0}),Object(v.jsx)(qe,{type:"password",placeholder:"Create password",value:f,setValue:O,margin:!0}),Object(v.jsxs)("div",{style:{display:"flex",width:"100%",justifyContent:"center",margin:"5px 0 15px 0"},children:[Object(v.jsx)(Bt,{label:"User",onClick:function(){return c(0)},currentActive:n,id:0}),Object(v.jsx)(Bt,{label:"Author",onClick:function(){return c(1)},currentActive:n,id:1})]}),Object(v.jsx)(Tt,{text:"Download photo",place:"usersImages/",setItemSrc:R,setImageLocalPath:W}),Object(v.jsxs)("div",{className:"inAndUpBtns",children:[Object(v.jsx)("button",{className:"upBtn",type:"submit",disabled:A,onClick:function(e){return q.apply(this,arguments)},children:"Sign Up"}),Object(v.jsx)(i.b,{to:Ft,children:Object(v.jsx)("button",{className:"inBtn",children:"Already registered"})})]})]})]}),Object(v.jsx)(nc,{})]})}}]),Pc=[{path:Ht,Component:Ks},{path:Vt,Component:tc},{path:zt,Component:hc},{path:Yt,Component:as},{path:"/not-found",Component:dc},{path:"/chat/:chatId",Component:Ws},{path:"/albums/:albumId",Component:Mn},{path:"/authors/:authorId",Component:_n},{path:qt,Component:Hs},{path:"/settings",Component:Ic},{path:"/lyrics-editing",Component:lc}],Lc=function(){return Object(v.jsxs)(o.d,{children:[Pc.map((function(e,t){var n=e.path,s=e.Component;return Object(v.jsx)(o.b,{path:n,component:s,exact:!0},n)})),Object(v.jsx)(o.a,{to:Ht})]})},Mc=function(){var e,t=Object(s.useState)([]),n=Object(l.a)(t,2),c=n[0],a=n[1],r=N().currentUser,i=Object(o.h)("/chat/:chatId"),u=null===i||void 0===i||null===(e=i.params)||void 0===e?void 0:e.chatId;return Object(s.useEffect)((function(){var e={},t=m.collection("chats").where("participants","array-contains",r.uid).onSnapshot((function(t){a((function(n){var s=Object(E.a)(n);return t.docChanges().map(function(){var t=Object(b.a)(j.a.mark((function t(n){var c,a,i,o,l,d;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:c=n.doc.data(),u!==c.id&&("added"===n.type?e[c.id]=c.messages.length:"modified"===n.type&&c.messages.length&&e[c.id]&&c.messages.length!==e[c.id]&&(a=c.id,i=c.chatName,o=c.chatImage,l=c.messages,d=l[l.length-1],d.sender!==r.uid&&!d.seenBy.includes(r.uid)&&(s.push({chatId:a,chatName:i,chatImage:o,message:l[l.length-1],userId:l[l.length-1].sender}),e[a]+=1)));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),s}))}));return function(){t()}}),[u]),Object(s.useEffect)((function(){c.length&&setTimeout((function(){a((function(e){return e.slice(1,e.length)}))}),4700)}),[c.length]),[c,a]},Ec=(n(275),n(276),function(e){var t=e.element,n=e.currentPage,s=e.setCurrentPage;return Object(v.jsx)(i.b,{to:t.link,className:"MobileControlBarItem",onClick:function(){return s(t.id)},style:t.id===n?{color:"var(--blue)"}:{},children:t.icon})}),Tc=function(){var e=N().currentUser,t={icon:Object(v.jsx)(te.q,{}),link:"/authors/".concat(e.uid)},n=Object(s.useState)((function(){var e=Qt.find((function(e,t){return!!window.location.hash.includes(S(e.title))}));return void 0===e?0:e.id})),c=Object(l.a)(n,2),a=c[0],r=c[1];return Object(v.jsxs)("div",{className:"BottomControlBar",children:[Qt.map((function(e,t){return Object(v.jsx)(Ec,{element:e,currentPage:a,setCurrentPage:r},t)})),Object(v.jsx)(Ec,{element:t,currentPage:a,setCurrentPage:r})]})},Rc=function(){var e=Z(),t=e.setOpenFullScreenPlayer,n=e.inputRange;return Object(v.jsxs)("div",{className:"FullBottomSide",children:[Object(v.jsxs)("span",{onClick:function(){return t(!0)},style:{display:"block",position:"relative"},children:[Object(v.jsx)(he,{textLimit:25,linkToAuthors:!1}),Object(v.jsx)("span",{className:"mobileSongRange",style:{width:n+"%"}})]}),Object(v.jsx)(Tc,{})]})},Bc=n.p+"static/media/notification.cdade1f4.mp3",Dc=H.a.div(As||(As=Object(M.a)(["\n  color: #fff;\n  padding: 20px;\n  box-sizing: border-box;\n  border-radius: var(--standartBorderRadius2);\n  background: #000000b9;\n  position: absolute;\n  bottom: 20px;\n  right: 20px;\n  transition: 0.2s;\n  transform: translateY(\n    ","\n  );\n  opacity: ",";\n  width: 250px;\n  height: 90px;\n\n  a {\n    text-decoration: none;\n  }\n\n  &:hover {\n    background: #1f1f1fb3;\n  }\n\n  .image-and-name {\n    display: flex;\n    justify-content: flex-start;\n    align-items: center;\n    font-weight: bold;\n\n    img {\n      width: 25px;\n      height: 25px;\n      border-radius: 100%;\n      margin-right: 7px;\n    }\n  }\n\n  .message {\n    margin-top: 10px;\n    display: flex;\n    white-space: nowrap;\n    overflow: hidden;\n  }\n"])),(function(e){var t=e.show,n=e.index;return t?"-".concat(90*n+10*n,"px"):"90px"}),(function(e){return e.show?"1":"0"})),Uc=function(e){var t=e.chatId,n=e.chatName,c=e.chatImage,a=e.message,r=e.userId,o=e.index,u=(e.notifsLen,Object(s.useState)(null)),d=Object(l.a)(u,2),j=d[0],b=d[1],h=Object(s.useState)(!1),f=Object(l.a)(h,2),O=f[0],p=f[1];return Object(s.useEffect)((function(){m.collection("users").doc(r).get().then((function(e){p(!0),new Audio(Bc).play(),b(e.data()),setTimeout((function(){p(!1)}),4500)}))}),[]),Object(v.jsx)(Dc,{show:O,index:o,children:Object(v.jsxs)(i.b,{to:"/chat/".concat(t),children:[Object(v.jsxs)("div",{className:"image-and-name",children:[Object(v.jsx)("img",{src:(null===c||void 0===c?void 0:c.length)?c:null===j||void 0===j?void 0:j.photoURL,alt:""}),n.length?n:null===j||void 0===j?void 0:j.displayName]}),Object(v.jsx)("div",{className:"message",children:Object(v.jsx)(ts,{sender:j,isGroup:n.length,message:a,messageLen:20})})]})})},Fc=function(){var e=J(),t=e.isOpenConfirm,n=e.confirmContent,c=e.setIsOpenConfirm,a=(e.closeConfirm,Object(s.useRef)(null));return ae(a,c),Object(v.jsx)("div",{className:"modal_darkBg confirm",style:t?{}:{opacity:0,visibility:"hidden"},children:Object(v.jsxs)("div",{className:"ConfirmWindow",ref:a,style:t?{}:{transform:"translateY(40px)"},children:[Object(v.jsx)("h3",{children:n.question}),Object(v.jsxs)("div",{className:"confirmButtons",children:[Object(v.jsx)("button",{onClick:n.onConfirm,className:"standartButton",children:n.confirmText}),Object(v.jsx)("button",{onClick:n.onReject,className:"standartButton",children:n.rejectText})]})]})})},Wc=function(){var e=J().bottomMessage,t=function(){switch(e.type){case"success":return{light:"#69e985",dark:"#12321ce6"};case"failure":return{light:"#f4546a",dark:"#581921d8"};default:return{light:"#69e985",dark:"#12321ce6"}}};return Object(v.jsxs)("div",{className:"bottom-message ".concat(e.isOpenned?"openned":""),style:{background:t().dark,color:t().light},children:[function(){switch(e.type){case"success":return Object(v.jsx)(re.g,{});case"failure":return Object(v.jsx)(re.h,{});default:return Object(v.jsx)(re.g,{})}}(),Object(v.jsx)("span",{children:e.message})]})},Hc=function(e){var t=Object.assign({},e),n=J(),c=n.openModal,a=n.setOpenModal,r=n.content,i=Object(s.useRef)(null),o=A().screenHeight;return ae(i,a),Object(v.jsx)("div",{className:"modal_darkBg",style:c?{height:o}:{opacity:0,visibility:"hidden"},children:Object(v.jsx)("div",Object(u.a)(Object(u.a)({className:"ModalWindow"},t),{},{ref:i,style:c?{}:{opacity:0,visibility:"hidden",transform:"translateY(40px)"},children:r}))})},Vc=function(){var e=Z(),t=e.songRef,n=e.loadSongData,c=e.playing,a=e.songSrc,r=e.openFullScreenPlayer,i=e.repeatMode,o=e.setPlay,d=e.prevSong,h=e.currentSongQueue,f=e.nextSong,O=A(),p=O.isMobile,x=O.screenHeight,g=N().currentUser,y=Object(s.useState)(!0),S=Object(l.a)(y,2),w=S[0],C=S[1],k=Mc(),I=Object(l.a)(k,2),P=I[0],L=I[1];ln();var M=function(){var e=Object(s.useRef)(),t=Z(),n=t.currentSongData,c=t.currentSongPlaylistSource,a=t.songDuration,r=t.play;function i(){-1!==n.id&&(e.current=setTimeout(Object(b.a)(j.a.mark((function e(){var t,s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("songs").doc(n.id).get();case 2:t=e.sent.data().listens,++t,m.collection("songs").doc(n.id).update({listens:t}),"albums"===c.source.substr(1,6)&&(s=c.source.substr(8,c.source.length-8),m.collection("playlists").doc(s).get().then((function(e){var t=e.data().listens;t++,m.collection("playlists").doc(s).update({listens:t})}))),n.authors.forEach(function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(t.uid).get();case 2:n=e.sent.data().numberOfListenersPerMonth,++n,m.collection("users").doc(t.uid).update({numberOfListenersPerMonth:n});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 7:case"end":return e.stop()}}),e)}))),1e3*a*.5))}return Object(s.useEffect)((function(){clearTimeout(e.current),r&&i()}),[r,n.id]),i}();return Object(s.useEffect)((function(){var e=setInterval((function(){m.collection("users").doc(g.uid).update({online:(new Date).getTime()}),C(!w)}),3e5);return function(){return clearInterval(e)}}),[w]),Object(s.useEffect)((function(){m.collection("users").doc(g.uid).update({online:(new Date).getTime()})}),[]),Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)("audio",{src:a,ref:t,onLoadedData:n,onTimeUpdate:c,onEnded:function(){return 0===i?(t.current.pause(),o(!1),d()):1===i?1===h.length?(d(),M(),t.current.play()):f():(d(),M(),void t.current.play())}}),Object(v.jsxs)("div",{className:"Wrapper "+(r?"turnedOff":""),style:p?{height:x}:{height:"100vh"},children:[p?"chat"===window.location.hash.substr(2,4)&&window.location.hash.length>6?null:Object(v.jsx)(Rc,{}):Object(v.jsx)(un,{}),Object(v.jsx)("div",{className:"Content",children:Object(v.jsx)(Lc,{})}),Object(v.jsx)(Wc,{}),Object(v.jsx)(Hc,{}),Object(v.jsx)(Fc,{}),P.map((function(e,t){return Object(v.jsx)(Uc,Object(u.a)(Object(u.a)({},e),{},{index:t,notifsLen:P.length,setNotifications:L}))}))]}),Object(v.jsx)(kt,{})]})},zc=function(){return N().currentUser.uid?Object(v.jsx)(o.d,{children:Object(v.jsx)(o.b,{path:"/",component:Vc})}):Object(v.jsxs)(o.d,{children:[Ac.map((function(e,t){var n=e.path,s=e.Component;return Object(v.jsx)(o.b,{path:n,component:s,exact:!0},t)})),Object(v.jsx)(o.a,{to:Ft})]})};function Yc(){return Object(v.jsx)(i.a,{basename:"/",children:Object(v.jsx)(zc,{})})}r.a.render(Object(v.jsx)(c.a.StrictMode,{children:Object(v.jsx)(P,{children:Object(v.jsx)(k,{children:Object(v.jsx)(_,{children:Object(v.jsx)(ee,{children:Object(v.jsx)(Yc,{})})})})})}),document.getElementById("root"))},91:function(e,t,n){}},[[277,1,2]]]);
//# sourceMappingURL=main.2ddb0679.chunk.js.map