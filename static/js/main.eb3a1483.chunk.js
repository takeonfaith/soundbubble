(this.webpackJsonpsoundbubble=this.webpackJsonpsoundbubble||[]).push([[0],{267:function(e,t,n){},268:function(e,t,n){},269:function(e,t,n){},270:function(e,t,n){},271:function(e,t,n){},272:function(e,t,n){},273:function(e,t,n){},274:function(e,t,n){},275:function(e,t,n){},276:function(e,t,n){},277:function(e,t,n){"use strict";n.r(t);var s=n(2),c=n.n(s),a=n(122),r=n.n(a),i=(n(91),n(13)),o=n(16),u=n(6),l=n.n(u),d=n(8),j=n(3),b=n(128),h=n(87);n(136),n(137),n(138),n(139);var f=h.a.initializeApp({apiKey:"AIzaSyBuDoETyUrO2RCDAlFMsW2uV-QmtCT8t6Y",authDomain:"soundbubble-27737.firebaseapp.com",projectId:"soundbubble-27737",storageBucket:"soundbubble-27737.appspot.com",messagingSenderId:"527274299416",appId:"1:527274299416:web:64b1ac2d05f4262df0736d",measurementId:"G-9TP9PEEV11"});h.a.analytics();var O=f.auth(),p=f.storage(),m=f.firestore();function g(e){return e.replace(/\s/g,"").replace(/\$/g,"s").replace(/[,'._/]/g,"").replace(/-/g,"").toLowerCase()}var x=function(e){for(var t=[],n=g(e),s=1;s<n.length+1;s++)t.push(n.substr(0,s));return t},v=n(1),y=c.a.createContext(),S=function(){return Object(s.useContext)(y)},w=function(e){var t=e.children,n=Object(s.useState)({}),c=Object(j.a)(n,2),a=c[0],r=c[1],i=Object(s.useState)(null),o=Object(j.a)(i,2),u=o[0],h=o[1],f=Object(s.useState)(!0),p=Object(j.a)(f,2),g=p[0],S=p[1],w=Object(s.useState)(""),C=Object(j.a)(w,2),N=C[0],k=C[1];Object(s.useEffect)((function(){if(null!==u)return m.collection("users").doc(u).onSnapshot((function(e){e.data()&&void 0===a.uid&&r(e.data())}))}),[m,u]),Object(s.useEffect)((function(){return O.onAuthStateChanged(function(){var e=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t?h(t.uid):(h(null),r({}),S(!1));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]);var I={currentUser:a,setCurrentUser:r,login:function(e,t,n,s){return s(!0),O.signInWithEmailAndPassword(e,t).then().catch((function(e){n(e.message),s(!1)}))},signup:function(e,t,n,s,c,a,r,i){return i(!0),O.createUserWithEmailAndPassword(e,n).then((function(e){m.collection("users").doc(e.user.uid).set({uid:e.user.uid,displayName:t,photoURL:c||"https://images.fineartamerica.com/images/artworkimages/mediumlarge/1/music-icon-mohammed-jabir-ap.jpg",isAuthor:1===parseInt(s),isVerified:1===parseInt(s),numberOfListenersPerMonth:0,ownSongs:[],ownPlaylists:[],addedSongs:[],addedPlaylists:[],addedAuthors:[],lastSongPlayed:"",chats:[],friends:[],subscribers:0,regDate:b.a.firestore.FieldValue.serverTimestamp(),imageColors:a}),m.collection("search").doc(e.user.uid).set({place:"users",uid:e.user.uid,rank:0,variantsOfName:x(t)}),m.collection("searchHistory").doc(e.user.uid).set({history:[]}),m.collection("history").doc(e.user.uid).set({history:[]}),i(!1)})).catch((function(e){r(e.message)}))},logout:function(){return O.signOut()},loading:g,setLoading:S,searchValue:N,setSearchValue:k};return Object(v.jsx)(y.Provider,{value:I,children:t})},C="/login",N="/signup",k="/home",I="/library",A="/search",P="/chat",L="/history",M=function(e){var t=e.top,n=void 0===t?"20%":t;return Object(v.jsx)("div",{className:"LoadingCircle",style:{top:n},children:Object(v.jsx)("img",{loading:"lazy",src:"https://icon-library.com/images/spinner-icon-gif/spinner-icon-gif-28.jpg",alt:""})})},T=n(24),R=n.p+"static/media/Logo3.fc53f4ac.svg",E=function(){return Object(v.jsx)("div",{className:"LoadingData",children:Object(v.jsx)("img",{loading:"lazy",src:R,alt:""})})},B=function(e,t){m.collection("history").doc(t.uid).get().then((function(n){var s=n.data().history;s[0]!==e&&s.unshift(e),s.length>30&&(s.length=30),m.collection("history").doc(t.uid).update({history:s})}))},D=n(19),F=n(33),U=n(14),W=n(9),H=n(48),V=function(e){var t=e.listOfChosenItems,n=e.setListOfChosenItems,s=e.itemId;return void 0!==t?Object(v.jsx)("div",{onClick:function(e){return e.preventDefault()},style:{width:"35px"},children:t.includes(s)?Object(v.jsx)("button",{type:"button",onClick:function(e){var c=t.filter((function(e){return e!==s}));n(c)},className:"addToListBtn",children:Object(v.jsx)(H.a,{style:{color:"var(--lightBlue)"}})}):Object(v.jsx)("button",{type:"button",onClick:function(){return n((function(e){return[].concat(Object(W.a)(e),[s])}))},className:"addToListBtn",children:Object(v.jsx)(H.b,{})})}):null},z=n(15);function Y(e){return e%10===e?"0"+e:e}function q(e){var t=new Date(1970,0,1);return t.setSeconds(e),t}function Q(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=["January","February","March","April","May","June","July","August","September","October","November","December"],s=isNaN(e)?new Date(e):e.seconds?q(e.seconds+10800):q(e/1e3+10800);return 0===t?n[s.getMonth()]+" "+s.getDate()+", "+s.getFullYear():1===t?n[s.getMonth()]+" "+s.getDate():2===t?Y(s.getHours())+":"+Y(s.getMinutes()):3===t?n[s.getMonth()]+" "+s.getDate()+", "+s.getFullYear()+" at "+Y(s.getHours())+":"+Y(s.getMinutes()):void 0}var G,K=function(e){var t=e.userUID,n=(Object(F.a)(e,["userUID"]),Object(s.useState)("")),c=Object(j.a)(n,2),a=c[0],r=c[1],i=Object(s.useState)(!1),o=Object(j.a)(i,2),u=o[0],l=o[1];return Object(s.useEffect)((function(){var e=m.collection("users").doc(t).onSnapshot((function(e){if(void 0!==t){var n=(new Date).getTime()-3e5,s=e.data().online>n;l(s),void 0===e.data().online?r("offline"):s||r("last seen "+Q(e.data().online,3))}}));return function(){e()}}),[m,t]),u?Object(v.jsx)("span",{className:"is-online",children:"Online"}):Object(v.jsx)("span",{className:"is-not-online",children:a})},X=z.a.div(G||(G=Object(U.a)(["\n  position: absolute;\n  top: 50%;\n  right: 8px;\n  transform: translateY(-50%);\n"]))),J=function(e){var t=e.data,n=e.chosenArray,s=e.setChosenArray,c=e.lastSeen,a=void 0!==c&&c,r=e.rightButton,i=Object(F.a)(e,["data","chosenArray","setChosenArray","lastSeen","rightButton"]);return Object(v.jsxs)("div",Object(D.a)(Object(D.a)({className:"person"},i),{},{children:[Object(v.jsx)(V,{listOfChosenItems:n,setListOfChosenItems:s,itemId:t.uid}),Object(v.jsx)("div",{className:"personImg",children:Object(v.jsx)("img",{loading:"lazy",src:t.photoURL,alt:""})}),Object(v.jsx)("div",{className:"personName",children:t.displayName}),a&&Object(v.jsx)(K,{userUID:t.uid,className:"is-online"}),Object(v.jsx)(X,{children:r})]}))};function _(e){for(var t=[],n=new Array(e.length),s=0;s<e.length;){var c=Math.floor(Math.random()*e.length);t.includes(c)||(t.push(c),n[c]=e[s],s++)}return n}function $(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e>t?n:e<n?t:e}var Z,ee,te,ne,se=function(e,t,n){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(e){return e},c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){return null},a=arguments.length>5?arguments[5]:void 0,r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;if(null===e||void 0===e?void 0:e.length){var i=e.map(function(){var e=Object(d.a)(l.a.mark((function e(n,s){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection(t).doc(n).get();case 2:return e.abrupt("return",e.sent.data());case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());Promise.all(i).then((function(e){var t=s(e);(null===t||void 0===t?void 0:t.length)>a&&(t.length=a),n(0===r?t:function(e){var n=[];return t.forEach((function(t){t&&(e.find((function(e){return e.id===t.id}))||n.push(t))})),[].concat(Object(W.a)(e),n)}),c()}))}},ce=function(e,t,n,c){Object(s.useEffect)((function(){e.uid&&n&&t()}),[JSON.stringify(c)])},ae=c.a.createContext(),re=function(){return Object(s.useContext)(ae)},ie=function(e){var t=e.children,n=Object(s.useState)(!1),c=Object(j.a)(n,2),a=c[0],r=c[1],i=Object(s.useState)(Object(v.jsx)("h1",{children:"Test"})),o=Object(j.a)(i,2),u=o[0],l=o[1],d=Object(s.useState)({isOpenned:!1,type:"success",message:"Action is successfully done!"}),b=Object(j.a)(d,2),h=b[0],f=b[1],O=Object(s.useState)(!1),p=Object(j.a)(O,2),m=p[0],g=p[1],x=Object(s.useState)({confirmText:"Confirm Action",rejectText:"Cancel",onConfirmL:function(){return null},onReject:function(){return null}}),y=Object(j.a)(x,2),S=y[0],w=y[1];function C(){g(!1)}var N={openModal:a,setOpenModal:r,toggleModal:function(){r(!a)},setContent:l,content:u,isOpenConfirm:m,setIsOpenConfirm:g,openConfirm:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Cancel",s=arguments.length>3?arguments[3]:void 0,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:C;g(!0),w({question:e,confirmText:t,rejectText:n,onConfirm:s,onReject:c})},closeConfirm:C,confirmContent:S,bottomMessage:h,openBottomMessage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Success",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e3;f({isOpenned:!0,type:t,message:e}),setTimeout((function(){f({isOpenned:!1,type:t,message:e})}),n)}};return Object(v.jsx)(ae.Provider,{value:N,children:t})},oe=Object(s.createContext)(null),ue=function(){return Object(s.useContext)(oe)},le=function(e){var t=e.children,n=S(),c=n.currentUser,a=n.loading,r=n.setLoading,o=re().setOpenModal,u=Object(s.useState)([]),b=Object(j.a)(u,2),h=b[0],f=b[1],O=Object(s.useState)([]),p=Object(j.a)(O,2),g=p[0],x=p[1],y=Object(s.useState)([]),w=Object(j.a)(y,2),C=w[0],N=w[1],k=Object(s.useState)([]),I=Object(j.a)(k,2),A=I[0],P=I[1],L=Object(s.useState)([]),M=Object(j.a)(L,2),T=M[0],R=M[1],D=Object(s.useState)(-1),F=Object(j.a)(D,2),U=F[0],W=F[1],H=Object(s.useState)(0),V=Object(j.a)(H,2),z=V[0],Y=V[1],q=Object(s.useState)({}),Q=Object(j.a)(q,2),G=Q[0],K=Q[1],X=Object(s.useState)(0),Z=Object(j.a)(X,2),ee=Z[0],te=Z[1],ne=Object(s.useState)({id:-1}),ae=Object(j.a)(ne,2),ie=ae[0],ue=ae[1],le=Object(s.useState)([]),de=Object(j.a)(le,2),je=de[0],be=de[1],he=Object(s.useState)(!1),fe=Object(j.a)(he,2),Oe=fe[0],pe=fe[1],me=Object(s.useState)(0),ge=Object(j.a)(me,2),xe=ge[0],ve=ge[1],ye=Object(s.useState)(0),Se=Object(j.a)(ye,2),we=Se[0],Ce=Se[1],Ne=Object(s.useState)(1),ke=Object(j.a)(Ne,2),Ie=ke[0],Ae=ke[1],Pe=Object(s.useState)(0),Le=Object(j.a)(Pe,2),Me=Le[0],Te=Le[1],Re=Object(s.useState)(0),Ee=Object(j.a)(Re,2),Be=Ee[0],De=Ee[1],Fe=Object(s.useState)(!1),Ue=Object(j.a)(Fe,2),We=Ue[0],He=Ue[1],Ve=Object(s.useState)(!1),ze=Object(j.a)(Ve,2),Ye=ze[0],qe=ze[1],Qe=Object(s.useRef)(null),Ge=Object(s.useRef)(null),Ke=Object(s.useRef)(null),Xe=Object(s.useRef)(null),Je=Object(s.useState)(0),_e=Object(j.a)(Je,2),$e=_e[0],Ze=_e[1],et=Object(s.useState)(!1),tt=Object(j.a)(et,2),nt=tt[0],st=tt[1];function ct(){var e;se(null===c||void 0===c||null===(e=c.lastQueue)||void 0===e?void 0:e.songsList,"songs",R,(function(e){return e}),(function(){return Y(c.lastQueue.songsList.findIndex((function(e){return e===c.lastSongPlayed})))}))}function at(){se(c.addedSongs.slice(0).reverse(),"songs",f,(function(e){return e}),ct)}function rt(){return it.apply(this,arguments)}function it(){return(it=Object(d.a)(l.a.mark((function e(){var t,n,s,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0!==c.uid&&(t={id:-1,name:"",songSrc:"",authors:[],cover:"",listens:0,releaseDate:"",lyrics:[],imageColors:[]},n=c.lastSongPlayed||c.addedSongs[0]||t.id,s=c.lastQueue||{source:"/library",name:"Your Library",image:c.photoURL,songsList:h}||[],W(n),K(s),-1!==n?(a=m.collection("songs").doc(n),a.get().then((function(e){if(e.exists){var t=e.data();ue(t),be(t.imageColors||[]),r(!1)}})).catch((function(e){console.log("Error getting document:",e),r(!1)}))):(ue(t),be([]),r(!1)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ot(){return(ot=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:-1!==U?m.collection("songs").doc(U).get().then((function(e){if(e.exists){var t=e.data();be(t.imageColors||[]),ue(t)}})):rt();case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ut(){for(var e=0,t=ie.lyrics.length-1,n=parseFloat(parseFloat(Qe.current.currentTime).toFixed(1));e<=t;){var s=Math.floor((e+t)/2),c=parseFloat(parseFloat(ie.lyrics[s].startTime).toFixed(1)),a=s!==ie.lyrics.length-1?parseFloat(parseFloat(ie.lyrics[s+1].startTime).toFixed(1)):t;if("undefined"===ie.lyrics[s].startTime)return;if(n>=c&&n<=a){De(s);break}c<n?e=s+1:t=s-1}}function lt(){return(lt=Object(d.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=$(z+1,T.length-1),e.next=3,m.collection("songs").doc(T[t].id).get();case 3:return e.next=5,e.sent.data().id;case 5:n=e.sent,B(n,c),De(0),W(n),Y($(t,T.length-1)),m.collection("users").doc(c.uid).update({lastSongPlayed:n});case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function dt(){return(dt=Object(d.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(xe>5)){e.next=5;break}return Qe.current.currentTime=0,ve(0),De(0),e.abrupt("return");case 5:return t=$(z-1,T.length-1),e.next=8,m.collection("songs").doc(T[t].id).get();case 8:return e.next=10,e.sent.data().id;case 10:n=e.sent,B(n,c),De(0),W(n),Y($(t,T.length-1)),m.collection("users").doc(c.uid).update({lastSongPlayed:n});case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return ce(c,at,c.addedSongs&&c.addedSongs.length!==h.length,[c.addedSongs]),ce(c,(function(){var e=[];c.ownPlaylists&&c.ownPlaylists.map((function(t,n){m.collection("playlists").doc(t).get().then((function(t){t.exists?(e.push(t.data()),n===c.ownPlaylists.length-1&&x(e)):console.log("No such document!")})).catch((function(e){console.log("Error getting document:",e)}))})),c.addedPlaylists&&c.addedPlaylists.map((function(t,n){m.collection("playlists").doc(t).get().then((function(t){t.exists?(e.push(t.data()),n===c.addedPlaylists.length-1&&x(e)):console.log("No such document!")})).catch((function(e){console.log("Error getting document:",e)}))}))}),c.ownPlaylists&&String(c.ownPlaylists.concat(c.addedPlaylists))!==String(g),[c.ownPlaylists]),ce(c,(function(){se(c.friends.filter((function(e){return"added"===e.status})).map((function(e){return e.uid})),"users",P)}),c.friends&&String(c.friends.filter((function(e){return"added"===e.status})))!==String(A),[c.friends]),ce(c,(function(){se(c.addedAuthors,"users",N)}),c.addedAuthors&&c.addedAuthors.length!==C.length,[c.addedAuthors]),ce(c,(function(){return ot.apply(this,arguments)}),c&&(-1===ie.id||U||c.lastSongPlayed),[U,c.lastSongPlayed]),Object(s.useEffect)((function(){void 0===c.uid&&(ue({id:-1}),W(-1),R([]),N([]),f([]),P([]),x([]))}),[c.uid]),Object(s.useEffect)((function(){var e;He((void 0===(e=ie.lyrics)||0!==e.length)&&(void 0===e||"undefined"!==e[0].startTime))}),[ie.lyrics]),Object(s.useEffect)((function(){if(!a)if(Me){var e=_(T);R(e),Y(e.findIndex((function(e){return e.id===U})))}else R(G.songsList),Y(G.songsList.findIndex((function(e){return e.id===U})))}),[Me]),Object(s.useEffect)((function(){De(0)}),[ie.id]),Object(s.useEffect)((function(){2===$e&&ut()}),[$e]),Object(s.useEffect)((function(){document.title=ie.name||"Soundbubble"}),[ie.name]),Object(v.jsx)(oe.Provider,{value:{yourSongs:h,setYourSongs:f,yourPlaylists:g,yourFriends:A,currentSongQueue:T,currentSongPlaylistSource:G,setCurrentSongPlaylistSource:K,setCurrentSongQueue:R,setCurrentSongInQueue:Y,play:Oe,setPlay:pe,songSrc:ie.songSrc,currentTime:xe,setCurrentTime:ve,songDuration:we,songRef:Qe,name:ie.name,authors:ie.authors,lyrics:ie.lyrics,cover:ie.cover,imgColors:je,setImgColors:be,currentSong:U,setCurrentSong:W,repeatMode:Ie,setRepeatMode:Ae,shuffleMode:Me,setShuffleMode:Te,inputRef:Ke,leftSideBarInputRef:Xe,isThereKaraoke:We,rightSideCurrentPage:$e,currentParagraph:Be,currentParagraphRef:Ge,nextSong:function(){return lt.apply(this,arguments)},prevSong:function(){return dt.apply(this,arguments)},playSong:function(){Oe?Qe.current.pause():Qe.current.play(),pe(!Oe)},playing:function(e){ve(e.target.currentTime),We&&2===$e&&Ye&&nt&&function(){if(Be!==ie.lyrics.length-1&&parseFloat(ie.lyrics[Be+1].startTime)<=Qe.current.currentTime)De(Be+1)}(),te(e.target.currentTime/we*100)},defineCurrentParagraph:ut,setRightSideCurrentPage:Ze,changeCurrentTime:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if("div"===e.target.localName||"p"===e.target.localName){if(void 0!==t)return ve(t),Qe.current.currentTime=t,te(t/we*100),We&&2===$e&&Ye&&De(parseInt(e.target.id)),Qe.current.play(),void pe(!0)}else ve(e.target.value),Qe.current.currentTime=e.target.value,te(e.target.value/we*100),We&&2===$e&&Ye&&ut()},displayAuthors:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie.authors,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" & ";return e.map((function(n,s){return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(i.b,{to:"/authors/".concat(n.uid),onClick:function(e){e.stopPropagation(),qe(!1)},children:n.displayName},n.uid),s===e.length-1?"":t]})}))},displayAuthorsFull:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie.authors;return e.map((function(e,t){return Object(v.jsx)(v.Fragment,{children:Object(v.jsx)(i.b,{to:"/authors/".concat(e.uid),onClick:function(e){e.stopPropagation(),qe(!1),o(!1)},children:Object(v.jsx)(J,{data:e})},e.uid)})}))},openFullScreenPlayer:Ye,setOpenFullScreenPlayer:qe,loadSongData:function(e){ve(e.target.currentTime),Ce(e.target.duration),Ke.current.max=e.target.duration,window.innerWidth>1e3&&(Xe.current.max=e.target.duration),te(0),Oe?e.target.play():e.target.pause()},fetchYourSongs:at,setOpenMenu:st,openMenu:nt,currentSongData:ie,setCurrentSongData:ue,setIsThereKaraoke:He,setYourPlaylists:x,yourAuthors:C,setYourAuthors:N,inputRange:ee},children:a?Object(v.jsx)(E,{}):t})},de=n(11),je=n(7),be=n(25),he=z.a.button(Z||(Z=Object(U.a)(["\n  border: none;\n  color: var(--lightBlue);\n  background: var(--lightGrey);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 5px 10px;\n  border-radius: var(--standartBorderRadius3);\n  font-weight: 600;\n\n  svg {\n    margin-right: ",";\n    width: 16px;\n    height: 16px;\n  }\n"])),(function(e){return 0===e.textLen?"0":"5px"})),fe=function(e){var t=e.text,n=void 0===t?"":t,s=e.icon,c=e.onClick,a=e.visible;return(void 0===a||a)&&Object(v.jsxs)(he,{onClick:c,textLen:n.length,children:[s,Object(v.jsx)("span",{children:n})]})},Oe=z.a.div(ee||(ee=Object(U.a)(["\n  width: 100%;\n  position: relative;\n  margin: ",";\n\n  button {\n    position: absolute;\n    right: 8px;\n    top: 50%;\n    transform: translateY(-50%);\n  }\n"])),(function(e){return e.margin?"0 0 10px 0":0})),pe=z.a.input(te||(te=Object(U.a)(["\n  width: 100%;\n  box-sizing: border-box;\n  padding: 12px;\n  border-radius: var(--standartBorderRadius);\n  border: none;\n  background: var(--leftSideBarColor);\n  outline: none;\n  color: #fff;\n  font-weight: 500;\n"]))),me=function(e){var t=e.title,n=e.type,s=void 0===n?"text":n,c=e.value,a=e.setValue,r=e.placeholder,i=void 0===r?"":r,o=e.required,u=void 0!==o&&o;e.margin;return Object(v.jsxs)(v.Fragment,{children:[!!t&&Object(v.jsx)("h3",{children:t}),Object(v.jsxs)(Oe,{margin:!0,children:[Object(v.jsx)(pe,{value:c,onChange:function(e){return a(e.target.value)},placeholder:i,type:s,required:u}),Object(v.jsx)(fe,{icon:Object(v.jsx)(je.H,{}),onClick:function(){return a("")},visible:!!c.length})]})]})},ge=n(23),xe=z.a.button(ne||(ne=Object(U.a)(["\n  width: 100%;\n  padding: 10px;\n  box-sizing: border-box;\n  opacity: ",';\n  background: var(--purpleAndBlueGrad);\n  color: #fff;\n  font-weight: bold;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  height: 40px;\n  border-radius: var(--standartBorderRadius3);\n  position: relative;\n  overflow: hidden;\n\n  @keyframes button-animation-in {\n    0% {\n      opacity: 0;\n      transform: scale(0.95);\n    }\n    50% {\n      opacity: 1;\n      transform: scale(1);\n    }\n    100% {\n      opacity: 0;\n      transform: scale(0.95);\n    }\n  }\n\n  @keyframes button-animation-out {\n    0% {\n      opacity: 0;\n      transform: scale(0.95);\n    }\n    100% {\n      opacity: 1;\n      transform: scale(1);\n    }\n  }\n\n  .inner-button {\n    z-index: 1;\n\n    .inner-button-success {\n      animation: button-animation-in 2s forwards;\n    }\n\n    .inner-button-text {\n      animation: button-animation-out 0.5s forwards;\n    }\n  }\n\n  &::before {\n    content: "";\n    position: absolute;\n    display: block;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    background: var(--green);\n    width: ',";\n    height: ",";\n    border-radius: 100%;\n    transition: 0.6s;\n    z-index: 0;\n  }\n\n  .LoadingCircle {\n    position: relative;\n    transform: none;\n    left: auto;\n    top: auto;\n    width: 30px;\n    height: 30px;\n\n    img {\n      width: 30px;\n      height: 30px;\n    }\n  }\n"])),(function(e){return e.isLoading||!e.isActive?.5:1}),(function(e){return e.completed?"2000px":"0"}),(function(e){return e.completed?"2000px":"0"})),ve=function(e){var t=e.text,n=e.action,c=e.isLoading,a=e.completed,r=void 0!==a&&a,i=e.setCompleted,o=e.bottomMessage,u=e.isActive,l=void 0===u||u,d=re().openBottomMessage;return Object(s.useEffect)((function(){r&&(d(null!==o&&void 0!==o?o:void 0),setTimeout((function(){i(!1)}),2e3))}),[r]),Object(v.jsx)(xe,{isLoading:c,className:"submit-button",completed:r,isActive:l,onClick:l?n:function(){return d("Nope","failure")},children:Object(v.jsx)("div",{className:"inner-button",children:r?Object(v.jsxs)("div",{className:"inner-button-success",children:[Object(v.jsx)(ge.b,{})," Done"]}):c?Object(v.jsx)(M,{top:0}):Object(v.jsx)("div",{className:"inner-button-text",children:t})})})},ye=function(e,t,n,c,a,r,i,o,u){var b=Object(s.useState)(""),h=Object(j.a)(b,2),f=h[0],O=h[1],p=Object(s.useState)(!1),x=Object(j.a)(p,2),v=x[0],y=x[1],S=Object(s.useState)(!1),w=Object(j.a)(S,2),C=w[0],N=w[1],k=Object(s.useState)(e),I=Object(j.a)(k,2),A=I[0],P=I[1];function L(e,t){return M.apply(this,arguments)}function M(){return(M=Object(d.a)(l.a.mark((function e(s,i){var o,u,j,b,h=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=h.length>2&&void 0!==h[2]?h[2]:[],u=h.length>3?h[3]:void 0,j=[],b=g(s),e.next=6,m.collection("search").where("variantsOfName","array-contains",b).get();case 6:e.sent.docs.forEach(function(){var e=Object(d.a)(l.a.mark((function e(s){var d,b,h,f,p,g,x,v,S;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((d=s.data()).place!==i){e.next=20;break}return e.next=4,m.collection(d.place).doc(d.uid).get();case 4:if(b=e.sent.data(),void 0!==o&&o.length?o.map((function(e){return e.id||e.uid})).includes(d.uid)&&j.push(b):b.isPrivate||j.push(b),void 0!==a||0!==r||0===j.length){e.next=19;break}u(j),e.t0=d.place,e.next="songs"===e.t0?11:"users"===e.t0?13:"playlists"===e.t0?15:17;break;case 11:for(h=0;h<j.length;h++)f=b.authors,se(f.map((function(e){return e.uid})),"users",n,(function(e){return e.sort((function(e,t){return t.subscribers-e.subscribers}))}),void 0,void 0,1);return e.abrupt("break",19);case 13:for(p=0;p<j.length;p++)g=b.ownSongs,x=b.ownPlaylists,se(g,"songs",t,(function(e){return e.sort((function(e,t){return t.listens-e.listens}))}),(function(){return null}),3,1),se(x,"playlists",c,(function(e){return e.sort((function(e,t){return t.listens-e.listens}))}),(function(){return null}),3,1);return e.abrupt("break",19);case 15:for(v=0;v<j.length;v++)S=b.authors,se(S.map((function(e){return e.uid})),"users",n,(function(e){return e.sort((function(e,t){return t.subscribers-e.subscribers}))}),void 0,void 0,1);return e.abrupt("break",19);case 17:return O("Wrong search mode"),e.abrupt("break",19);case 19:0!==j.length&&(y(!1),N(!0),u(j));case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),y(!1),0===j.length&&(u([]),N(!1));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function T(s){if(0!==e.length){var l=null!==s&&void 0!==s?s:e;if(P(l),y(!0),N(!1),void 0===a)0!==r&&1!==r||(L(l,"songs",i,t),n([]),c([])),0!==r&&2!==r||(L(l,"users",o,n),t([]),c([])),0!==r&&3!==r||(L(l,"playlists",u,c),n([]),t([]));else switch(a){case"songs":L(l,"songs",i,t);break;case"playlists":L(l,"playlists",u,c);break;case"authors":L(l,"users",o,n);break;default:L(l,"songs",i,t)}}}return Object(s.useEffect)((function(){0===e.length&&(void 0!==i&&t(i),void 0!==o&&n(o),void 0!==u&&c(u),y(!1))}),[e]),Object(s.useEffect)((function(){T()}),[r]),{findSomething:T,message:f,loading:v,foundAnything:C,inputValue:A,setInputValue:P}},Se=function(e,t){e&&m.collection("search").doc(t).get().then((function(e){var n=e.data().rank?e.data().rank+1:1;m.collection("search").doc(t).update({rank:n})}))},we=function(e){var t=e.length,n=e.setInputValue,s=e.setValue;return Object(v.jsxs)("div",{className:"searchBarElement",children:[Object(v.jsx)(je.y,{}),Object(v.jsx)("span",{onClick:function(){s(""),n("")},style:t?{}:{opacity:0,visibility:"hidden",cursor:"default"},children:Object(v.jsx)(je.H,{})})]})},Ce=function(e){var t=e.text,n=e.searchMode,s=e.setSearchMode,c=e.index;return Object(v.jsx)("button",{onClick:function(){return s(c)},style:n===c?{background:"var(--lightBlue)"}:{},children:t})},Ne=function(e){var t=e.defaultSearchMode,n=e.searchMode,s=e.setSearchMode;return Object(v.jsx)("div",{className:"searchFilters",style:void 0!==t?{display:"none"}:{},children:["All","Songs","Authors","Playlists"].map((function(e,t){return Object(v.jsx)(Ce,{text:e,searchMode:n,setSearchMode:s,index:t})}))})},ke=function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.length>0)){e.next=7;break}return e.next=3,m.collection("search").where("variantsOfName","array-contains",t).get();case 3:return n=e.sent.docs.map(function(){var e=Object(d.a)(l.a.mark((function e(t){var n,s,c,a,r,i,o,u,d;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.data(),s=n.place,c=n.uid,a=n.rank,e.next=3,m.collection(s).doc(c).get();case 3:return r=e.sent.data(),i=r.name,o=r.authors,u=r.displayName,d=r.isVerified,e.abrupt("return",{type:s,name:i||u,author:o?o[0].displayName:null,uid:c,rank:a||0,isVerified:null!==d&&void 0!==d&&d});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.abrupt("return",n);case 7:return e.abrupt("return",[]);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ie=function(e){var t={"\u0430":"f","\u0431":",","\u0432":"d","\u0433":"u","\u0434":"l","\u0435":"t","\u0451":"`","\u0436":";","\u0437":"p","\u0438":"b","\u0439":"q","\u043a":"r","\u043b":"k","\u043c":"v","\u043d":"y","\u043e":"j","\u043f":"g","\u0440":"h","\u0441":"c","\u0442":"n","\u0443":"e","\u0444":"a","\u0445":"[","\u0446":"w","\u0447":"x","\u0448":"i","\u0449":"o","\u044a":"]","\u044b":"s","\u044c":"m","\u044d":"'","\u044e":".","\u044f":"z"},n={f:"\u0430",",":"\u0431",d:"\u0432",u:"\u0433",l:"\u0434",t:"\u0435","`":"\u0451",";":"\u0436",p:"\u0437",b:"\u0438",q:"\u0439",r:"\u043a",k:"\u043b",v:"\u043c",y:"\u043d",j:"\u043e",g:"\u043f",h:"\u0440",c:"\u0441",n:"\u0442",e:"\u0443",a:"\u0444","[":"\u0445",w:"\u0446",x:"\u0447",i:"\u0448",o:"\u0449","]":"\u044a",s:"\u044b",m:"\u044c","'":"\u044d",".":"\u044e",z:"\u044f"};return t[e[0]]?e.split("").reduce((function(e,n){return e+t[n]}),""):e.split("").reduce((function(e,t){return e+n[t]}),"")},Ae=function(e){var t=e.setCurrentHint,n=e.searchValue,c=e.inputFocused,a=e.setSearchHints;Object(s.useEffect)((function(){t(-1),0!==n.length&&c?Promise.resolve(ke(g(n))).then((function(e){Promise.all(e).then((function(e){var t=e.sort((function(e,t){return t.rank-e.rank}));t.length?a(t.slice(0,10)):Promise.resolve(ke(Ie(g(n)))).then((function(e){Promise.all(e).then((function(e){var t=e.sort((function(e,t){return t.rank-e.rank}));a(t.slice(0,10))}))}))}))})):a([])}),[n,c])},Pe=function(e){switch(e){case"songs":return Object(v.jsx)(je.u,{style:{color:"var(--reallyLightBlue)"}});case"playlists":return Object(v.jsx)(de.a,{style:{color:"var(--lightPurple)"}});case"users":return Object(v.jsx)(je.C,{style:{color:"var(--pink)"}});case"search":return Object(v.jsx)(je.y,{});default:return Object(v.jsx)(je.u,{})}},Le=function(e){var t=e.name,n=e.author,s=e.isVerified,c=e.type,a=e.index,r=e.currentHint,i=e.setCurrentHint,o=e.findSomething,u=e.setInputFocused;return Object(v.jsxs)("div",{className:"search-hint-item"+(r===a?" current":""),onClick:function(){i(a),u(!1),o(t)},children:[Pe(c),Object(v.jsx)("span",{children:t}),n&&Object(v.jsx)("span",{className:"search-hint-item-author",children:n}),s?Object(v.jsx)(ge.b,{style:{width:"12px",height:"12px",opacity:.5,marginLeft:"10px"}}):null]})},Me=function(e){var t=e.searchValue,n=e.searchHints,c=e.setSearchHints,a=e.currentHint,r=e.setCurrentHint,i=e.inputFocused,o=e.defaultSearchMode,u=e.findSomething,l=e.setInputFocused;return Ae({setCurrentHint:r,searchValue:t,inputFocused:i,setSearchHints:c}),Object(v.jsxs)("div",{className:"search-hints",style:n.length?o?{transform:"translateY(0px)"}:{transform:"translateY(-35px)"}:{display:"none"},children:[Object(v.jsx)(Le,{name:t,type:"search",index:-1,currentHint:a,setCurrentHint:r,findSomething:u,setInputFocused:l},-1),n.map((function(e,t){return Object(s.createElement)(Le,Object(D.a)(Object(D.a)({},e),{},{currentHint:a,setCurrentHint:r,index:t,key:e.uid,findSomething:u,setInputFocused:l}))}))]})},Te=function(e,t){Object(s.useEffect)((function(){function n(n){e.current&&!e.current.contains(n.target)&&t(!1)}return document.addEventListener("mousedown",n),function(){document.removeEventListener("mousedown",n)}}),[e])},Re=function(e){var t,n,c=e.value,a=e.setValue,r=e.setAllFoundSongs,i=e.setResultPlaylists,o=e.setResultAuthorList,u=e.focus,l=void 0!==u&&u,d=e.defaultSearchMode,b=void 0===d?void 0:d,h=e.inputText,f=void 0===h?"Search for songs or for people":h,O=e.defaultSongsListValue,p=e.defaultAuthorsListValue,m=e.defaultPlaylistsListValue,g=e.background,x=Object(s.useState)(0),y=Object(j.a)(x,2),S=y[0],w=y[1],C=Object(s.useState)(-1),N=Object(j.a)(C,2),k=N[0],I=N[1],A=Object(s.useState)([]),P=Object(j.a)(A,2),L=P[0],T=P[1],R=Object(s.useState)(l),E=Object(j.a)(R,2),B=E[0],D=E[1],F=Object(s.useRef)(null),U=ye(null!==(t=null===(n=L[k])||void 0===n?void 0:n.name)&&void 0!==t?t:c,r,o,i,b,S,O,p,m),W=U.findSomething,H=U.loading,V=U.foundAnything,z=U.inputValue,Y=U.setInputValue;Object(s.useEffect)((function(){l&&F.current.focus()}),[]);return Te(F,D),Object(v.jsxs)("div",{style:{marginTop:"10px",width:"100%"},className:"searchBarWrapper",children:[Object(v.jsxs)("div",{className:"searchBar",ref:F,children:[Object(v.jsx)(we,{setInputValue:Y,length:c.length,setValue:a}),Object(v.jsx)("input",{type:"text",onFocus:function(){return D(!0)},style:L.length?{borderRadius:"var(--standartBorderRadius) var(--standartBorderRadius) 0 0",background:!!g&&g}:{background:!!g&&g},placeholder:f,value:z,onChange:function(e){Y(e.target.value),a(e.target.value)},onKeyDown:function(e){var t,n;(function(e){var t,n,s,a;if(B)switch(e.key){case"ArrowDown":I($(k+1,L.length-1,-1)),Y(null!==(t=null===(n=L[$(k+1,L.length-1,-1)])||void 0===n?void 0:n.name)&&void 0!==t?t:c);break;case"ArrowUp":I($(k-1,L.length-1,-1)),Y(null!==(s=null===(a=L[$(k-1,L.length-1,-1)])||void 0===a?void 0:a.name)&&void 0!==s?s:c)}}(e),"Enter"===e.key)&&(W(),Se(null===(t=L[k])||void 0===t?void 0:t.name,null===(n=L[k])||void 0===n?void 0:n.uid),T([]))}}),Object(v.jsx)(Ne,{defaultSearchMode:b,searchMode:S,setSearchMode:w}),Object(v.jsx)(Me,{searchValue:c,currentHint:k,searchHints:L,setSearchHints:T,setCurrentHint:I,inputFocused:B,defaultSearchMode:b,findSomething:W,setInputFocused:D})]}),Object(v.jsx)("div",{className:"authorsResult",children:H?Object(v.jsx)("div",{style:{position:"relative",width:"100%",height:"50px",marginTop:"40px"},children:Object(v.jsx)(M,{})}):V||0===c.length?null:Object(v.jsx)("h2",{children:"Not found"})})]})};function Ee(e){for(var t=[],n=0,s=e+" ",c=0;c<s.length;c++)"\n"!==s[c]&&void 0!==s[c+1]||(t.push({startTime:"undefined",text:s.substr(n,c-n)}),n=c+1);return t}var Be=function(e){var t=re(),n=t.toggleModal,c=t.openBottomMessage,a=Object(s.useState)(e.name),r=Object(j.a)(a,2),i=r[0],o=r[1],u=Object(s.useState)(e.authors),b=Object(j.a)(u,2),h=b[0],f=b[1],O=Object(s.useState)(e.cover),p=Object(j.a)(O,2),g=p[0],x=p[1],v=Object(s.useState)(e.imageColors),y=Object(j.a)(v,2),S=y[0],w=y[1],C=Object(s.useState)(e.lyrics.map((function(e){return e.text})).join("\n")),N=Object(j.a)(C,2),k=N[0],I=N[1],A=Object(s.useState)([]),P=Object(j.a)(A,2),L=P[0],M=P[1],T=Object(s.useState)(""),R=Object(j.a)(T,2),E=R[0],B=R[1],D=Object(s.useState)(""),F=Object(j.a)(D,2),U=F[0],H=F[1],V=Object(s.useState)(!1),z=Object(j.a)(V,2),Y=z[0],q=z[1],Q=Object(s.useState)(!1),G=Object(j.a)(Q,2),K=G[0],X=G[1];function J(e){var t=h.filter((function(t){return t.uid!==e.uid}));return f(t)}return Object(s.useEffect)((function(){o(e.name),f(e.authors),x(e.cover),w(e.imageColors),I(e.lyrics.map((function(e){return e.text})).join("\n"))}),[e.id]),Object(s.useEffect)((function(){U&&c(U,"failure")}),[U]),{songCover:g,songName:i,setSongName:o,imageColors:S,manuallyChangeColor:function(e,t){S[t]=e.target.value,w(Object(W.a)(S))},searchValue:E,setSearchValue:B,foundAuthors:L,setFoundAuthors:M,songAuthors:h,removeAuthorFromList:J,addAuthor:function(e){if(!h.some((function(t){return t.uid===e.uid})))return f((function(t){return[].concat(Object(W.a)(t),[{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL}])}));J(e)},lyrics:k,setLyrics:I,updateSong:function(){if(0===i.length)H("Name shouldn't be empty");else if(0===h.length)H("Song has to have at least 1 author");else if(0===g.length)H("Song has to have cover");else{if(q(!0),h.length>e.authors.length)h.filter((function(t){return!e.authors.find((function(e){return e.uid===t.uid}))})).forEach(function(){var t=Object(d.a)(l.a.mark((function t(n){var s,c,a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.collection("users").doc(n.uid).get();case 2:s=t.sent,c=s.data(),(a=c.ownSongs).push(e.id),m.collection("users").doc(n.uid).update({ownSongs:a});case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());else if(h.length<e.authors.length){e.authors.filter((function(e){return!h.find((function(t){return t.uid===e.uid}))})).forEach(function(){var t=Object(d.a)(l.a.mark((function t(n){var s,c,a,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.collection("users").doc(n.uid).get();case 2:s=t.sent,c=s.data(),a=c.ownSongs,r=a.filter((function(t){return t!==e.id})),m.collection("users").doc(n.uid).update({ownSongs:r});case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}m.collection("songs").doc(e.id).update({name:i,authors:h,image:g,imageColors:S,lyrics:Ee(k)}).then((function(){q(!1),X(!0),n()}))}},loading:Y,completed:K,setCompleted:X}},De=function(e){var t=e.song,n=S().currentUser,s=Be(t),c=s.songCover,a=s.songName,r=s.setSongName,i=s.imageColors,o=s.manuallyChangeColor,u=s.searchValue,l=s.setSearchValue,d=s.foundAuthors,j=s.setFoundAuthors,b=s.songAuthors,h=s.removeAuthorFromList,f=s.addAuthor,O=s.lyrics,p=s.setLyrics,m=s.updateSong,g=s.loading,x=s.completed,y=s.setCompleted;return Object(v.jsxs)("div",{children:[Object(v.jsxs)("div",{className:"SongInfo",style:{flexDirection:"column",marginBottom:"10px"},children:[Object(v.jsx)("h3",{children:"Song cover"}),Object(v.jsxs)("div",{style:{display:"flex"},children:[Object(v.jsx)("div",{children:Object(v.jsx)("img",{loading:"lazy",src:c,alt:"",className:"songImage"})}),Object(v.jsx)("div",{style:{background:"linear-gradient(-135deg, ".concat(i[0],", ").concat(i[5]),width:"100%",height:"200px",borderRadius:"var(--standartBorderRadius2)",display:"flex",justifyContent:"center",alignItems:"center"},children:Object(v.jsx)("h4",{style:{color:i[1]},children:a})})]})]}),Object(v.jsx)("div",{style:{width:"100%",display:"flex"},children:i.map((function(e,t){return Object(v.jsx)("input",{type:"color",value:e,style:{width:"100%",height:"60px",padding:"0",borderRadius:"0px"},onChange:function(e){o(e,t)}})}))}),Object(v.jsx)(me,{title:"Song name",value:a,setValue:r,placeholder:"Enter song name",required:!0}),Object(v.jsxs)("div",{children:[Object(v.jsx)("h3",{children:"Authors"}),Object(v.jsx)(Re,{value:u,setValue:l,setResultAuthorList:j,defaultSearchMode:"authors"}),Object(v.jsx)("div",{className:"songAuthorsList",children:b.map((function(e){return Object(v.jsxs)("div",{className:"chosenAuthorItem",children:[Object(v.jsx)("span",{children:e.displayName}),Object(v.jsx)(je.H,{onClick:function(){(n.isAdmin||e.uid!==n.uid)&&h(e)}})]})}))}),Object(v.jsx)("div",{className:"authorsResult",children:d.map((function(e,t){return Object(v.jsx)(J,{data:e,onClick:function(){return f(e)},style:b.includes(e.uid)?{background:"var(--green)"}:{}},t)}))})]}),Object(v.jsxs)("div",{children:[Object(v.jsx)("h3",{children:"Lyrics"}),Object(v.jsx)("textarea",{type:"text",className:"standartInput",style:{height:"200px",fontWeight:"500"},value:O,onChange:function(e){return p(e.target.value)}})]}),Object(v.jsx)(ve,{text:"Update song",action:m,isLoading:g,completed:x,setCompleted:y,bottomMessage:"Song was updated"})]})},Fe=function(e,t,n,s){e.stopPropagation();var c=t.authors.map((function(e){return e.uid})),a=[];c.forEach((function(e){n.addedAuthors.includes(e)||a.push(e)}));var r=n.addedSongs;r.push(t.id),m.collection("users").doc(n.uid).update({addedSongs:r,addedAuthors:[].concat(a,Object(W.a)(n.addedAuthors))}),a.forEach(function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(t).get();case 2:n=e.sent.data().subscribers,n++,m.collection("users").doc(t).update({subscribers:n});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())};function Ue(e,t){return e.filter((function(e){return this.indexOf(e)<0}),t)}var We=function(e,t,n,s){e.stopPropagation();var c=t.authors.map((function(e){return e.uid})),a=[],r=n.addedSongs.filter((function(e){return e!==t.id}));c.forEach((function(e){s.forEach((function(t){r.includes(t.id)&&t.authors.find((function(t){return t.uid===e}))&&a.push(e)}))}));var i=Ue(c,a),o=Ue(n.addedAuthors,i);m.collection("users").doc(n.uid).update({addedSongs:r,addedAuthors:o}),i.forEach(function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(t).get();case 2:n=e.sent.data().subscribers,n--,m.collection("users").doc(t).update({subscribers:n});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())};function He(e){var t=e.song,n=S().currentUser,s=ue().yourSongs,c=re(),a=c.openConfirm,r=c.setOpenModal;return n.addedSongs.includes(t.id)?Object(v.jsxs)("span",{onClick:function(e){e.stopPropagation(),r(!1),a("You sure you want to delete this song from library?","Yes, delete it","No, just kidding",(function(e){return We(e,t,n,s)}))},children:[Object(v.jsx)(je.G,{}),"Delete"]}):Object(v.jsxs)("span",{onClick:function(e){return Fe(e,t,n)},children:[Object(v.jsx)(je.x,{}),"Add"]})}var Ve=function(e,t){var n=Object(s.useState)([]),c=Object(j.a)(n,2),a=c[0],r=c[1],i=Object(s.useState)(!1),o=Object(j.a)(i,2),u=o[0],l=o[1],d=S().currentUser,b=ue().currentSong,h=t||b;return Object(s.useEffect)((function(){var t=m.collection("playlists").doc(e).onSnapshot((function(e){e.exists&&r(e.data().songs)}));return function(){return t()}}),[m]),Object(s.useEffect)((function(){l(a.includes(h))}),[a,h]),[function(){if(a.length>0&&void 0!==e){if(a.includes(h)){var t=a.filter((function(e){return e!==h}));return void m.collection("playlists").doc(e).update({songs:t})}var n=a;n.unshift(h),m.collection("playlists").doc(e).update({songs:n});var s=[e].concat(Object(W.a)(d.ownPlaylists.filter((function(t){return t!==e}))));m.collection("users").doc(d.uid).update({ownPlaylists:s})}},u]},ze=c.a.createContext(),Ye=function(){return Object(s.useContext)(ze)},qe=function(e){var t=e.children,n=Object(s.useState)(window.innerWidth),c=Object(j.a)(n,2),a=c[0],r=c[1],i=Object(s.useState)(window.innerHeight),o=Object(j.a)(i,2),u=o[0],l=o[1],d=Object(s.useState)(window.innerWidth<1e3),b=Object(j.a)(d,2),h=b[0],f=b[1];function O(){r(window.innerWidth),l(window.innerHeight),f(window.innerWidth<1e3)}Object(s.useEffect)((function(){return window.addEventListener("resize",O),function(){window.removeEventListener("resize",O)}}),[]);var p={screenWidth:a,screenHeight:u,isMobile:h};return Object(v.jsx)(ze.Provider,{value:p,children:t})},Qe=function(e){var t=e.text,n=e.direction,s=void 0===n?"top":n,c=Object(F.a)(e,["text","direction"]);return Ye().isMobile?null:Object(v.jsx)("div",Object(D.a)(Object(D.a)({className:"Hint "+s},c),{},{children:Object(v.jsx)("h5",{children:t})}))},Ge=function(e){var t=e.playlist,n=e.song,s=Ve(t.id,n.id),c=Object(j.a)(s,2),a=c[0],r=c[1];return Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:a,children:[r?Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(Qe,{text:"Remove ".concat(n.name," from playlist")}),Object(v.jsx)(je.d,{})]}):Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(Qe,{text:'Add "'.concat(n.name,'" to playlist')}),Object(v.jsx)(je.x,{})]}),t.name]})},Ke=function(e){var t=e.song,n=ue(),c=n.yourPlaylists,a=n.currentSongData,r=S().currentUser,i=Object(s.useState)(t||a),o=Object(j.a)(i,2),u=o[0],l=o[1];return Object(s.useEffect)((function(){(null===t||void 0===t?void 0:t.id)&&l(t)}),[null===t||void 0===t?void 0:t.id]),Object(v.jsx)("div",{className:"AddToPlaylists",children:Object(v.jsx)("div",{style:{display:"flex",flexDirection:"column"},children:c.length?c.map((function(e,t){if(r.ownPlaylists.includes(e.id))return Object(v.jsx)(Ge,{playlist:e,song:u})})):Object(v.jsx)("div",{className:"songItemMenuWindowItem",children:"No playlists created"})})})},Xe=n(30),Je=function(e){var t=e.person,n=re().setOpenModal;return Object(v.jsx)(i.b,{to:"/authors/".concat(t.uid),children:Object(v.jsxs)("div",{className:"PersonTinyVerticalItem",onClick:function(){return n(!1)},children:[Object(v.jsx)("div",{className:"personTinyImage",children:Object(v.jsx)("img",{loading:"lazy",src:t.photoURL,alt:""})}),Object(v.jsx)("div",{className:"personTinyName",children:t.displayName})]})})},_e=function(e){var t=e.text,n=void 0===t?"See more":t,s=Object(F.a)(e,["text"]);return Object(v.jsxs)("div",Object(D.a)(Object(D.a)({className:"SeeMoreRoundButton"},s),{},{children:[Object(v.jsx)("button",{children:Object(v.jsx)(je.b,{})}),Object(v.jsx)("span",{children:n})]}))},$e=function(e){var t=e.listOfPeople,n=e.restriction,s=void 0===n?null:n,c=e.title,a=e.chosenArray,r=e.setChosenArray,i=void 0===r?function(){return null}:r,o=e.lastSeen,u=void 0!==o&&o;return Object(v.jsxs)("div",{children:[c?Object(v.jsx)("h2",{style:{marginTop:"0",marginBottom:"7px"},children:c}):null,s?t.slice(0,s).map((function(e){return Object(v.jsx)(J,{data:e,chosenArray:a,setChosenArray:i,lastSeen:u})})):t.map((function(e){return Object(v.jsx)(J,{data:e,chosenArray:a,setChosenArray:i,lastSeen:u})}))]})};function Ze(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}var et=function(){var e=Object(d.a)(l.a.mark((function e(t){var n,s,c,a,r,i=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=i.length>1&&void 0!==i[1]?i[1]:Ze(),s=i.length>2&&void 0!==i[2]?i[2]:"",c=i.length>3&&void 0!==i[3]?i[3]:"",a=i.length>4&&void 0!==i[4]?i[4]:[],r=i.length>5&&void 0!==i[5]?i[5]:[],m.collection("chats").doc(n).set({chatImage:c,chatName:s,id:n,messages:[],participants:t,wallpaper:"undefined",admins:t.length>2?a:[],typing:[],imageColors:r}),t.map(function(){var e=Object(d.a)(l.a.mark((function e(t){var s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(t).get();case 2:(s=e.sent.data().chats).push(n),m.collection("users").doc(t).update({chats:s});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),tt=function(){var e=Object(d.a)(l.a.mark((function e(t,n,s,c){var a,r,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=!1,r=0,!n.chats){e.next=9;break}return e.next=5,m.collection("chats").where("participants","array-contains",n.uid).get();case 5:return e.sent.docs.forEach((function(e){var n=0;return t.every((function(t){return!!e.data().participants.includes(t)&&(n++,!0)})),n+1!==e.data().participants.length||n!==t.length||(a=!0,s(!1),c(e.data().id),r=e.data().id,!1)})),a||(i=Ze(),a=!0,s(!0),c(i),r=i),e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})));return function(t,n,s,c){return e.apply(this,arguments)}}(),nt=function(e,t,n,s){var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[],i=arguments.length>7?arguments[7]:void 0;if(0!==s.trim().length||0!==c.length||0!==a.length||0!==r.length){var o=(null===t||void 0===t?void 0:t.messages)||[];o.push({id:o.length,sender:n,message:s,sentTime:(new Date).toString(),inResponseToMessage:i||null,attachedSongs:c,attachedAlbums:a,attachedAuthors:r,seenBy:[n]}),m.collection("chats").doc(e).update({messages:o})}};function st(e){var t=e.shareList,n=e.currentUser,s=e.itemId,c=e.whatToShare,a=e.messageText,r=void 0===a?"":a,i=e.setShouldCreate,o=void 0===i?function(){return null}:i,u=e.setFriendChatId,j=void 0===u?function(){return null}:u,b=e.setLoading,h=void 0===b?function(){return null}:b,f=e.setCompleted,O=void 0===f?function(){return null}:f;h(!0),O(!1),t.map(function(){var e=Object(d.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=[{uid:t,status:"added"}].concat(Object(W.a)(n.friends.filter((function(e){return e.uid!==t})))),m.collection("users").doc(n.uid).update({friends:a}),Promise.resolve(tt([t],n,(function(){return null}),j)).then(function(){var e=Object(d.a)(l.a.mark((function e(a){var i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("chats").doc(a).get();case 2:if(void 0===(i=e.sent.data())){e.next=17;break}e.t0=c,e.next="song"===e.t0?7:"playlist"===e.t0?9:"author"===e.t0?11:13;break;case 7:return nt(a,i,n.uid,r,[s]),e.abrupt("break",15);case 9:return nt(a,i,n.uid,r,[],[s]),e.abrupt("break",15);case 11:return nt(a,i,n.uid,r,[],[],[s]),e.abrupt("break",15);case 13:return nt(a,i,n.uid,r,[s]),e.abrupt("break",15);case 15:e.next=18;break;case 17:et([n.uid,t],a).then(Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("chats").doc(a).get();case 2:i=e.sent.data(),o(!1),e.t0=c,e.next="song"===e.t0?7:"playlist"===e.t0?9:"author"===e.t0?11:13;break;case 7:return nt(a,i,n.uid,r,[s]),e.abrupt("break",15);case 9:return nt(a,i,n.uid,r,[],[s]),e.abrupt("break",15);case 11:return nt(a,i,n.uid,r,[],[],[s]),e.abrupt("break",15);case 13:return nt(a,i,n.uid,r,[s]),e.abrupt("break",15);case 15:case"end":return e.stop()}}),e)}))));case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(){h(!1),O(!0)}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}var ct=function(e){var t=e.item,n=e.whatToShare,c=void 0===n?"song":n,a=ue().yourFriends,r=Object(s.useState)([]),i=Object(j.a)(r,2),o=i[0],u=i[1],l=S().currentUser,d=Object(s.useState)(""),b=Object(j.a)(d,2),h=b[0],f=b[1],O=Object(s.useState)(!1),p=Object(j.a)(O,2),m=p[0],g=p[1],x=Object(s.useState)(!1),y=Object(j.a)(x,2),w=y[0],C=y[1],N=re().toggleModal,k=Object(s.useState)(""),I=Object(j.a)(k,2),A=I[0],P=I[1],L=Object(s.useState)([]),M=Object(j.a)(L,2),T=M[0],R=M[1];return a.length?Object(v.jsxs)("div",{className:"FriendsToShareWith",children:[Object(v.jsxs)("div",{style:{maxHeight:"300px",overflowY:"hidden",display:"flex",flexDirection:"column"},children:[Object(v.jsx)(Re,{value:A,setValue:P,setResultAuthorList:R,defaultAuthorsListValue:a,defaultSearchMode:"authors",inputText:"Search for friends"}),Object(v.jsx)("div",{style:{overflowY:"auto",maxHeight:"100%"},children:Object(v.jsx)($e,{listOfPeople:T,chosenArray:o,setChosenArray:u})})]}),Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(me,{value:h,setValue:f,placeholder:"Your message"}),Object(v.jsx)(ve,{text:"Share with ".concat(o.length," ").concat(o.length>1||0===o.length?"friends":"friend"),action:function(){st({shareList:o,currentUser:l,itemId:"author"===c?t.uid:t.id,whatToShare:c,messageText:h,setLoading:C,setCompleted:g}),N()},isLoading:w,completed:m,setCompleted:g,bottomMessage:"Message was sent",isActive:!!o.length})]})]}):Object(v.jsx)("h3",{style:{margin:0},children:"No friends added"})},at=function(e){var t=e.song,n=ue().currentSongData,c=re().setContent,a=Object(s.useState)(t||n),r=Object(j.a)(a,2),i=r[0],o=r[1],u=ue(),b=u.displayAuthors,h=u.yourFriends,f=Object(s.useState)([]),O=Object(j.a)(f,2),p=O[0],m=O[1],g=Object(s.useState)(!0),x=Object(j.a)(g,2),y=x[0],S=x[1];function w(){return(w=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:S(!0),m([]),h.forEach((function(e){e.addedSongs.includes(i.id)&&m((function(t){return[].concat(Object(W.a)(t),[e])}))})),S(!1);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){void 0!==t&&o(t)}),[t&&t.id]),Object(s.useEffect)((function(){!function(){w.apply(this,arguments)}()}),[i.id]),Object(v.jsxs)("div",{className:"SongInfo",children:[Object(v.jsx)("div",{className:"songImage",style:{backgroundImage:"url(".concat(i.cover,")")}}),Object(v.jsxs)("div",{className:"songInfoContent",children:[Object(v.jsx)("h3",{style:{color:i.imageColors[0]},children:i.name}),Object(v.jsx)("span",{children:b(i.authors,", ")}),Object(v.jsxs)("div",{style:{display:"flex",alignItems:"center",opacity:"0.6",fontSize:".9em",position:"relative",marginTop:"5px"},className:"listensAndDate",children:[Object(v.jsxs)("p",{className:"infoListens",style:{marginRight:"15px",marginBottom:"0",position:"relative"},children:[i.listens," ",Object(v.jsx)(Xe.c,{})]}),Object(v.jsx)("span",{children:Q(i.releaseDate)})]}),Object(v.jsx)("h4",{style:{margin:"10px 0"},children:p.length>0?"Friends that listen that song":"None of your friends listens this"}),y?Object(v.jsx)("div",{style:{position:"relative",height:"50px"},children:Object(v.jsx)(M,{top:"50%"})}):Object(v.jsxs)("div",{style:{display:"flex"},children:[p.length>0?p.map((function(e,t){if(t<2)return Object(v.jsx)(Je,{person:e},e.uid)})):Object(v.jsx)("button",{className:"shareBtn",style:{minHeight:"35px",background:i.imageColors[0]},onClick:function(){c(Object(v.jsx)(ct,{item:i,whatToShare:"song"}))},children:"Share"}),p.length>2?Object(v.jsx)(_e,{onClick:function(){return c(Object(v.jsx)($e,{listOfPeople:p,title:"Friends listen ".concat(t.name)}))}}):null]})]})]})},rt=function(e){var t=e.openMoreWindow,n=e.song,s=e.moreWindowPosRelativeToViewport,c=re(),a=c.toggleModal,r=c.setContent,i=c.openBottomMessage,o=S().currentUser,u=ue().setCurrentSongQueue;return t?Object(v.jsxs)("div",{className:"songItemMenuWindow",style:s>window.innerHeight/2+100?{top:"auto",bottom:"110%"}:{top:"110%",bottom:"auto"},onClick:function(e){return e.stopPropagation()},children:[o.isAdmin||n.authors.find((function(e){return e.uid===o.uid}))?Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){a(),r(Object(v.jsx)(De,{song:n}))},children:[Object(v.jsx)(de.h,{}),"Edit"]}):null,Object(v.jsx)("div",{className:"songItemMenuWindowItem",children:Object(v.jsx)(He,{song:n})}),Object(v.jsxs)("div",{className:"songItemMenuWindowItem",children:[Object(v.jsx)("div",{className:"songItemMenuWindow inner",children:Object(v.jsx)(Ke,{song:n})}),Object(v.jsx)(be.c,{}),"Add to playlist ",Object(v.jsx)(be.a,{})]}),Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){a(),r(Object(v.jsx)(ct,{item:n,whatToShare:"song"}))},children:[Object(v.jsx)(je.A,{}),"Share"]}),Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){a(),r(Object(v.jsx)(at,{song:n}))},children:[Object(v.jsx)(je.o,{}),"Info"]}),Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){u((function(e){return[].concat(Object(W.a)(e),[n])})),i("Song was added to queue")},children:[Object(v.jsx)(de.k,{}),"Add to queue"]})]}):null},it=function(e,t,n){var s={id:t,type:n};m.collection("searchHistory").doc(e).get().then((function(n){var c;(null===(c=n.data())||void 0===c?void 0:c.history)?n.data().history.find((function(e){return e.id===t}))||m.collection("searchHistory").doc(e).update({history:[s].concat(Object(W.a)(n.data().history.slice(0,15)))}):m.collection("searchHistory").doc(e).set({history:[s]})}))},ot=function(e){var t=e.song,n=e.position,c=e.localIndex,a=e.shouldSaveSearchHistory,r=ue(),i=r.setCurrentSong,o=r.currentSong,u=r.play,l=r.songRef,d=r.setPlay,b=r.setCurrentSongInQueue,h=Object(s.useState)(!1),f=Object(j.a)(h,2),O=f[0],p=f[1],g=Object(s.useState)(0),x=Object(j.a)(g,2),v=x[0],y=x[1],w=Object(s.useRef)(null),C=S().currentUser;return Te(w,p),{openSongItemMoreWindow:function(e){e.stopPropagation(),p(!O),y(n||e.target.getBoundingClientRect().top)},chooseSongItem:function(){if(i(t.id),m.collection("users").doc(C.uid).update({lastSongPlayed:t.id}),b(c),t.id===o&&u)return l.current.pause(),void d(!1);l.current.play(),d(!0),a&&it(C.uid,t.id,"songs"),B(t.id,C)},moreWindowPosRelativeToViewport:v,openMoreWindow:O,currentItemRef:w}},ut=n(50),lt=function(e){var t=e.play;return Object(v.jsxs)("div",{className:"ColorCircles",style:t?{}:{opacity:0,transform:"scale(.95)"},children:[Object(v.jsx)("span",{className:"colorCircle"}),Object(v.jsx)("span",{className:"colorCircle"}),Object(v.jsx)("span",{className:"colorCircle"})]})};function dt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;return e.substr(0,t)+(e.length>t?"...":"")}var jt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" & ",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,s=null===e||void 0===e?void 0:e.map((function(e){return e.displayName})).join(t);return s?dt(s,n):""};function bt(e){return e<1e3?e:e<1e6?parseFloat(e/1e3).toFixed(1)+"K":e<1e9?parseFloat(e/1e6).toFixed(1)+"M":void 0}var ht,ft=function(e){var t=e.showListens,n=e.isNewSong,s=e.song;return t?Object(v.jsxs)("span",{style:{display:"flex",alignItems:"center",opacity:.7,fontSize:".8em"},className:n?"newSongMarker":"",children:[bt(s.listens)," ",Object(v.jsx)(Xe.c,{})]}):n?Object(v.jsx)("span",{style:{display:"flex",alignItems:"center",fontSize:".7em"},className:"newSongMarker",children:"New"}):null},Ot=function(e){var t=e.song,n=e.currentSong,s=e.play,c=e.isMobile,a=e.showListens,r=e.displayAuthors,i=e.isNewSong,o=Ye().screenWidth;return Object(v.jsxs)("div",{className:"songItemImageAndName",children:[Object(v.jsxs)("div",{className:"songItemImage",children:[Object(v.jsx)("div",{className:"songItemPlayOrPause",children:t.id===n&&s?null:Object(v.jsx)(ut.c,{})}),Object(v.jsxs)("div",{className:"playingAnimation",style:t.id===n&&s?{opacity:1,visibility:"visible"}:{},children:[Object(v.jsx)(ut.b,{}),Object(v.jsx)(lt,{play:s})]}),Object(v.jsx)("img",{loading:"lazy",src:t.cover,alt:""})]}),Object(v.jsxs)("div",{className:"songItemNameAndAuthor",children:[Object(v.jsxs)("div",{className:"songItemName",style:{display:"flex",alignItems:"center"},children:[dt(t.name,c?17:30),Object(v.jsx)("span",{style:{marginLeft:"10px",fontWeight:"500"},children:Object(v.jsx)(ft,{showListens:a,isNewSong:i,song:t})})]}),c?Object(v.jsx)("div",{className:"songItemAuthor",style:{maxWidth:o-180},children:jt(t.authors," & ",130)}):Object(v.jsx)("div",{className:"songItemAuthor",children:r(t.authors)})]})]})},pt=function(e){var t=e.listOfAuthors,n=ue().displayAuthorsFull;return Object(v.jsx)("div",{className:"rightSideAuthorsList",children:Object(v.jsx)("div",{className:"rightSideAuthorsListCentralBlock",children:n(t)})})},mt=function(e){var t=e.song,n=re().setContent,s=S().currentUser;return Object(v.jsxs)("div",{className:"SongItemMobileMoreWindow",children:[Object(v.jsxs)("div",{className:"simpleSongElement",style:{background:t.imageColors[0]},children:[Object(v.jsx)("div",{className:"simpleSongElementImage",children:Object(v.jsx)("img",{loading:"lazy",src:t.cover,alt:""})}),Object(v.jsx)("span",{children:t.name})]}),s.isAdmin?Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){n(Object(v.jsx)(De,{song:t}))},children:[Object(v.jsx)(de.h,{}),"Edit"]}):null,Object(v.jsx)("div",{className:"songItemMenuWindowItem",children:Object(v.jsx)(He,{song:t})}),Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){return n(Object(v.jsx)(Ke,{song:t}))},children:[Object(v.jsx)(be.c,{}),"Add to playlist"]}),Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){n(Object(v.jsx)(ct,{item:t,whatToShare:"song"}))},children:[Object(v.jsx)(je.A,{}),"Share"]}),Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){n(Object(v.jsx)(at,{song:t}))},children:[Object(v.jsx)(je.o,{}),"Info"]}),Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){n(Object(v.jsx)(pt,{listOfAuthors:t.authors,title:"Authors"}))},children:[Object(v.jsx)(je.F,{}),"Authors"]})]})},gt=function(e){var t=S(),n=t.currentUser,s=(t.setCurrentUser,ue().yourSongs),c=re(),a=c.openBottomMessage,r=c.openConfirm,i=c.closeConfirm;return[function(t){Fe(t,e,n),a("".concat(dt(e.name,15)," added to your library"))},function(t){t.stopPropagation(),r('You sure you want to delete "'.concat(e.name,'" from library?'),"Yes, delete it","No, just kidding",(function(t){We(t,e,n,s),i(),a("".concat(dt(e.name,15)," removed from your library"),"failure")}))}]},xt=function(e){var t=e.song,n=S().currentUser,s=gt(t),c=Object(j.a)(s,2),a=c[0],r=c[1];return n.addedSongs.includes(t.id)?Object(v.jsxs)("button",{onClick:r,style:{position:"relative"},children:[Object(v.jsx)(Qe,{text:"delete song"}),Object(v.jsx)(je.G,{})]}):Object(v.jsxs)("button",{onClick:a,style:{position:"relative"},children:[Object(v.jsx)(Qe,{text:"add song"}),Object(v.jsx)(je.x,{})]})},vt=function(e){var t=e.song,n=e.isMobile,s=e.openSongItemMoreWindow,c=re(),a=c.toggleModal,r=c.setContent;return Object(v.jsxs)("div",{className:"songItemMoreBtn",children:[Object(v.jsx)(xt,{song:t}),Object(v.jsxs)("button",{onClick:n?function(e){e.stopPropagation(),a(),r(Object(v.jsx)(mt,{song:t}))}:s,children:[Object(v.jsx)(Qe,{text:"more"}),Object(v.jsx)(je.t,{})]})]})},yt=Object(s.memo)((function(e){var t=e.song,n=e.localIndex,s=e.showListens,c=void 0!==s&&s,a=e.isNewSong,r=void 0!==a&&a,i=e.listOfChosenSongs,o=e.setListOfSongs,u=e.position,l=e.shouldSaveSearchHistory,d=void 0!==l&&l,j=Ye().isMobile,b=ue(),h=b.currentSong,f=b.displayAuthors,O=b.play,p=ot({song:t,position:u,localIndex:n,shouldSaveSearchHistory:d}),m=p.openSongItemMoreWindow,g=p.chooseSongItem,x=p.moreWindowPosRelativeToViewport,y=p.openMoreWindow,S=p.currentItemRef;return Object(v.jsxs)("div",{style:{display:"flex",alignItems:"center",width:"100%"},children:[Object(v.jsx)(V,{listOfChosenItems:i,setListOfChosenItems:o,itemId:t.id}),Object(v.jsxs)("div",{className:"SongItem "+(t.id===h&&O?"playingNow":""),onClick:g,ref:y?S:null,style:y?{background:"var(--playlistsColor)"}:{},children:[Object(v.jsx)(Ot,{song:t,currentSong:h,play:O,isMobile:j,showListens:c,displayAuthors:f,isNewSong:r}),Object(v.jsx)(vt,{song:t,isMobile:j,openSongItemMoreWindow:m}),Object(v.jsx)(rt,{openMoreWindow:y,song:t,moreWindowPosRelativeToViewport:x})]})]})})),St=function(e){var t=e.func,n=e.lenOfList,s=e.maxLen,c=void 0===s?5:s,a=e.boolVal;return Object(v.jsx)("div",{onClick:n>c?t:null,className:"MoreBtn",style:n<=c?{display:"none"}:{},children:Object(v.jsx)("button",{style:a?{background:"var(--pink)",color:"#ff8db2"}:{},children:a?"Close":"More"})})},wt=function(e){var t=e.title,n=e.func,s=e.boolVal,c=e.lenOfList,a=e.maxLen,r=void 0===a?5:a,i=e.marginBottom,o=void 0===i?0:i;return 0!==c?Object(v.jsxs)("div",{className:"topTitle",style:{margin:"10px 0"},children:[Object(v.jsx)("h2",{style:{margin:o},children:t}),Object(v.jsx)(St,{func:n,boolVal:s,lenOfList:c,maxLen:r})]}):null},Ct=function(e){var t=e.listOfSongs,n=e.source,c=e.title,a=void 0===c?"":c,r=e.showListens,o=void 0!==r&&r,u=e.isNewSong,l=void 0!==u&&u,d=e.showCount,b=void 0!==d&&d,h=e.listOfChosenSongs,f=e.setListOfSongs,O=e.showSearch,p=void 0!==O&&O,g=e.displayIfEmpty,x=e.showhistory,y=void 0!==x&&x,w=e.saveSearchHistory,C=void 0!==w&&w,N=e.isHorizontal,k=void 0!==N&&N,I=ue(),A=I.setCurrentSongQueue,P=I.setCurrentSongPlaylistSource,M=(I.playSong,I.setCurrentSong,S().currentUser),R=Object(s.useState)(!1),E=Object(j.a)(R,2),B=E[0],D=E[1],F=Object(s.useState)(""),U=Object(j.a)(F,2),W=U[0],H=U[1],V=Object(s.useState)(t),z=Object(j.a)(V,2),Y=z[0],q=z[1];return Object(s.useEffect)((function(){q(t)}),[t]),Object(v.jsxs)("div",{className:"SongList",onClick:function(){if("no"!==n&&0!==t.length){A(t),P(n);var e=t.map((function(e){return e.id}));m.collection("users").doc(M.uid).update({lastQueue:{image:n.image,name:n.name,songsList:e,source:n.source}})}},children:[0!==a.length?Object(v.jsx)(wt,{title:a,func:function(){return D(!B)},boolVal:B,lenOfList:t.length}):null,p?Object(v.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[Object(v.jsx)(Re,{value:W,setValue:H,allFoundSongs:Y,setAllFoundSongs:q,defaultSearchMode:"songs",defaultSongsListValue:t,inputText:"Search for songs",background:"#00000061"}),y?Object(v.jsx)(i.b,{to:L,children:Object(v.jsx)("button",{className:"standartButton",style:{marginTop:"10px",marginBottom:"0",height:"44px",width:"44px",padding:"0",marginLeft:"6px",background:"var(--playlistsColor)"},children:Object(v.jsx)(T.d,{style:{marginRight:"0"}})})}):null]}):null,Object(v.jsx)("div",{className:"list-of-songs"+(k?" horizontal":""),children:Y.map((function(e,t){return 0===a.length||B||t<5?Object(v.jsxs)("span",{className:"topSongItem",children:[b?Object(v.jsx)("h3",{style:{opacity:"0.7"},children:t+1}):null,Object(v.jsx)(yt,{song:e,localIndex:t,showListens:o,isNewSong:l,listOfChosenSongs:h,setListOfSongs:f,shouldSaveSearchHistory:C},e.id)]}):void 0}))}),Object(v.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:0===t.length?g:null})]})},Nt=function(e){var t=Object(s.useState)([]),n=Object(j.a)(t,2),c=n[0],a=n[1],r=Object(s.useState)([]),i=Object(j.a)(r,2),o=i[0],u=i[1];function b(){return(b=Object(d.a)(l.a.mark((function t(){var n,s,c,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===(null===e||void 0===e?void 0:e.authors)){t.next=10;break}return n=e.authors.map((function(e){return e.uid})),t.next=4,m.collection("users").where("uid","in",n).get();case 4:s=t.sent,c=[],r=[],s.docs.forEach((function(e){c.push(e.data()),r.push(e.data().photoURL)})),a(c),u(r);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return Object(s.useEffect)((function(){!function(){b.apply(this,arguments)}()}),[null===e||void 0===e?void 0:e.id]),[c,o]},kt=function(e){var t=e.imagesList,n=e.borderColor,s=void 0===n?"#fff":n;return Object(v.jsx)("div",{className:"SmallImages",style:{marginRight:-7*(t.length-1)},children:t.map((function(e,t){return Object(v.jsx)("div",{className:"smallImgContainer",style:{border:"3px solid ".concat(s),transform:"translateX(".concat(-15*t,"px)")},children:Object(v.jsx)("img",{loading:"lazy",src:e,alt:""})},t)}))})},It=function(e){var t=e.data,n=e.color,c=S().currentUser,a=Object(s.useState)(!1),r=Object(j.a)(a,2),o=r[0],u=r[1],l=Object(s.useState)(0),d=Object(j.a)(l,2),b=d[0],h=d[1];return Object(s.useEffect)((function(){tt([t.uid],c,u,h)}),[t.uid]),Object(v.jsx)(i.b,{to:"/chat/".concat(b),style:{display:"block",width:"fit-content",textDecoration:"none"},children:Object(v.jsxs)("button",{onClick:function(){o&&et([c.uid,t.uid],b)},style:{background:n},className:"ChatWithFriendButton",children:[Object(v.jsx)(je.q,{})," Messages"]})})},At=n(127),Pt=function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("songs").doc(t).get();case 2:return n=e.sent.data(),e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Lt=function(e){var t=Object(s.useState)(),n=Object(j.a)(t,2),c=n[0],a=n[1],r=ue(),i=r.setCurrentSong,o=r.currentSong,u=r.play,l=r.songRef,d=r.setPlay,b=r.setCurrentSongInQueue,h=S().currentUser;return Object(s.useEffect)((function(){(null===e||void 0===e?void 0:e.lastSongPlayed)&&Pt(e.lastSongPlayed).then((function(e){return a(e)}))}),[e.lastSongPlayed]),[c,function(){if(i(c.id),m.collection("users").doc(h.uid).update({lastSongPlayed:c.id}),b(0),c.id===o&&u)return l.current.pause(),void d(!1);l.current.play(),d(!0)}]},Mt=function(e){var t=e.data,n=e.loading,s=Lt(t,n),c=Object(j.a)(s,2),a=c[0],r=c[1];return void 0!==a?Object(v.jsxs)("div",{className:"LastSongListened",onClick:r,children:[Object(v.jsx)(At.a,{}),Object(v.jsx)("span",{children:a.name})]}):null},Tt=function(){var e=Object(d.a)(l.a.mark((function e(t,n){var s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(n.uid).get();case 2:(s=e.sent.data().addedPlaylists).push(t.id),m.collection("users").doc(n.uid).update({addedPlaylists:s}),m.collection("playlists").doc(t.id).update({subscribers:++t.subscribers});case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Rt=function(){var e=Object(d.a)(l.a.mark((function e(t,n){var s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=n.addedPlaylists.filter((function(e){return e!==t.id})),m.collection("users").doc(n.uid).update({addedPlaylists:s}),m.collection("playlists").doc(t.id).update({subscribers:--t.subscribers});case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Et=function(e){var t=e.color,n=void 0===t?"":t,s=Object(o.g)();return Object(v.jsx)("div",{className:"GoBackBtn",children:Object(v.jsxs)("button",{onClick:function(){return s.goBack()},style:n.length?{color:n}:{},children:[Object(v.jsx)(Qe,{text:"go back",direction:"bottom"}),Object(v.jsx)(je.a,{})]})})},Bt=function(e){var t=e.album,n=re().setContent,c=ue().yourFriends,a=Object(s.useState)([]),r=Object(j.a)(a,2),i=r[0],o=r[1],u=Object(s.useState)(!0),b=Object(j.a)(u,2),h=b[0],f=b[1];function O(){return(O=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f(!0),o([]),c.forEach((function(e){e.addedPlaylists.includes(t.id)&&o((function(t){return[].concat(Object(W.a)(t),[e])}))})),f(!1);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){!function(){O.apply(this,arguments)}()}),[t.uid]),Object(v.jsxs)("div",{className:"SongInfo",children:[Object(v.jsx)("div",{className:"songImage",style:{backgroundImage:"url(".concat(t.image,")")}}),Object(v.jsxs)("div",{className:"songInfoContent",children:[Object(v.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[Object(v.jsx)("span",{style:{opacity:".5",fontWeight:500,fontSize:".7em"},children:t.isAlbum?"Album":"Playlist"}),Object(v.jsx)("h3",{style:{color:t.imageColors[1]},children:t.name})]}),Object(v.jsxs)("div",{style:{display:"flex",opacity:"0.6",fontSize:".9em",position:"relative"},className:"listensAndDate",children:[Object(v.jsxs)("p",{className:"infoListens",style:{marginRight:"20px",position:"relative"},children:[t.listens,Object(v.jsx)(je.l,{})]}),Object(v.jsxs)("p",{className:"infoListens",style:{marginRight:"20px",position:"relative"},children:[t.subscribers," ",Object(v.jsx)(je.E,{})]}),Object(v.jsx)("span",{children:Q(t.creationDate)})]}),Object(v.jsx)("h4",{style:{margin:"10px 0"},children:i.length>0?"Friends subscribed":"None of your friends subscribed"}),h?Object(v.jsx)("div",{style:{position:"relative",height:"50px"},children:Object(v.jsx)(M,{top:"50%"})}):Object(v.jsx)("div",{style:{display:"flex"},children:i.length>0?Object(v.jsxs)(v.Fragment,{children:[i.map((function(e,t){if(t<2)return Object(v.jsx)(Je,{person:e},e.uid)})),i.length>2?Object(v.jsx)(_e,{onClick:function(){return n(Object(v.jsx)($e,{listOfPeople:i,title:"Friends subscribed to ".concat(t.name)}))}}):null]}):Object(v.jsx)("button",{className:"shareBtn",style:{minHeight:"35px",background:t.imageColors[0]},onClick:function(){n(Object(v.jsx)(ct,{item:t,whatToShare:"playlist"}))},children:"Share"})})]})]})},Dt=n(28),Ft=n(66),Ut=z.a.button(ht||(ht=Object(U.a)(['\n  width: 100%;\n  padding: 0;\n  box-sizing: border-box;\n  background: linear-gradient(45deg, #852de5, #5c38c1);\n  color: #fff;\n  font-weight: bold;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  height: 40px;\n  border-radius: var(--standartBorderRadius3);\n  position: relative;\n  overflow: hidden;\n  z-index: 2;\n  margin: 8px 0;\n\n  @keyframes button-animation-out {\n    0% {\n      opacity: 0;\n      transform: scale(0.9);\n    }\n    100% {\n      opacity: 1;\n      transform: scale(1);\n    }\n  }\n\n  .inner-button {\n    z-index: 1;\n    position: relative;\n    width: 100%;\n    height: 100%;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n\n    .inner-button-content {\n      width: 100%;\n      height: 100%;\n    }\n\n    .inner-button-success {\n      animation: button-animation-out 2s forwards;\n    }\n\n    .inner-button-text {\n      cursor: pointer;\n      width: 100%;\n      height: 100%;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n\n      svg {\n        margin-right: 7px;\n        width: 20px;\n        height: 20px;\n      }\n    }\n\n    .inner-button-download {\n      width: 100%;\n      background: red;\n\n      input[type="file"] {\n        /* display: none; */\n        width: 100%;\n        height: 100%;\n        position: absolute;\n        left: 50%;\n        top: 50%;\n        transform: translate(-50%, -50%);\n        display: none;\n      }\n    }\n  }\n\n  &::before {\n    content: "";\n    position: absolute;\n    display: block;\n    top: 50%;\n    left: 0%;\n    transform: translateY(-50%);\n    background: var(--green);\n    width: ',";\n    height: 100%;\n    transition: 0.6s;\n    z-index: 0;\n  }\n\n  .LoadingCircle {\n    position: relative;\n    transform: none;\n    left: auto;\n    top: auto;\n    width: 30px;\n    height: 30px;\n\n    img {\n      width: 30px;\n      height: 30px;\n    }\n  }\n"])),(function(e){return e.completed?"100%":"0"})),Wt=function(e){var t=e.title,n=void 0===t?"":t,c=e.text,a=e.place,r=e.setItemSrc,i=e.setImageLocalPath,o=re().openBottomMessage,u=Object(s.useState)(""),b=Object(j.a)(u,2),h=b[0],f=b[1],O=Object(s.useState)(!1),m=Object(j.a)(O,2),g=m[0],x=m[1],y=Object(s.useState)(!1),S=Object(j.a)(y,2),w=S[0],C=S[1];function N(){return(N=Object(d.a)(l.a.mark((function e(t,n,s){var c,a,r,o,u,d,j;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),f(""),x(!0),C(!1),c="songsImages/"===n||"usersImages/"===n||"chatCovers/"===n,a=t.target.files[0],r=!1,c?(o=[".jpg",".png",".jpeg"]).find((function(e){return a.name.substr(a.name.length-e.length,e.length)===e}))?r=!0:(f("Format of your file is not valid. Download file with one of these: ".concat(o.map((function(e){return" "+e})))),x(!1)):"songs/"===n&&((u=[".mp3",".mp4a",".flac",".wav",".wma"]).find((function(e){return a.name.substr(a.name.length-e.length,e.length)===e}))?r=!0:(f("Format of your file is not valid. Download file with one of these: ".concat(u.map((function(e){return e})))),x(!1))),!r){e.next=21;break}return c&&i(URL.createObjectURL(a)),d=p.ref(),j=d.child(n+a.name),e.next=14,j.put(a);case 14:return C(!0),x(!1),e.t0=s,e.next=19,j.getDownloadURL();case 19:e.t1=e.sent,(0,e.t0)(e.t1);case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){h.length&&o(h,"failure")}),[h]),Object(v.jsxs)(v.Fragment,{children:[!!n&&Object(v.jsx)("h3",{children:n}),Object(v.jsx)(Ut,{completed:w,children:Object(v.jsx)("div",{className:"inner-button",children:w?Object(v.jsxs)("div",{className:"inner-button-success",children:[Object(v.jsx)(ge.b,{})," Done"]}):g?Object(v.jsx)(M,{top:0}):Object(v.jsx)("div",{className:"inner-button-content",children:Object(v.jsxs)("label",{className:"inner-button-download",children:[Object(v.jsxs)("div",{className:"inner-button-text",children:[Object(v.jsx)(Ft.b,{}),c]}),Object(v.jsx)("input",{type:"file",name:"",id:"",onChange:function(e){return function(e,t,n){return N.apply(this,arguments)}(e,a,r)}})]})})})})]})},Ht=function(e){var t=e.currentActive,n=e.id,s=e.label,c=e.onClick;return Object(v.jsxs)("div",{className:"RadioBtn",id:n,onClick:c,children:[Object(v.jsx)("span",{className:"radioLabel",style:t===n?{color:"var(--blue)",opacity:1,fontWeight:"bold"}:{},children:s}),Object(v.jsx)("span",{className:"radioCircle",style:t===n?{background:"var(--blue)"}:{}})]})},Vt=function(e){var t=e.playlist,n=S().currentUser,c=Object(s.useState)(t.name),a=Object(j.a)(c,2),r=a[0],i=a[1],o=Object(s.useState)(t.image),u=Object(j.a)(o,2),b=u[0],h=u[1],f=Object(s.useState)(""),O=Object(j.a)(f,2),p=O[0],g=O[1],x=Object(s.useState)([]),y=Object(j.a)(x,2),w=y[0],C=y[1],N=Object(s.useState)(t.authors),k=Object(j.a)(N,2),I=k[0],A=k[1],P=Object(s.useState)(t.creationDate),L=Object(j.a)(P,2),T=L[0],R=L[1],E=Object(s.useState)(""),B=Object(j.a)(E,2),D=B[0],F=B[1],U=Object(s.useState)([]),H=Object(j.a)(U,2),V=H[0],z=H[1],Y=Object(s.useState)(t.songs),q=Object(j.a)(Y,2),Q=q[0],G=q[1],K=Object(s.useState)(t.isAlbum?1:0),X=Object(j.a)(K,2),_=X[0],$=X[1],Z=Object(s.useState)(t.isPrivate?1:0),ee=Object(j.a)(Z,2),te=ee[0],ne=ee[1],se=Object(s.useState)(!1),ce=Object(j.a)(se,2),ae=ce[0],re=(ce[1],Object(s.useState)(!1)),ie=Object(j.a)(re,2),oe=ie[0],ue=ie[1],le=Object(s.useState)(""),de=Object(j.a)(le,2),be=de[0],he=de[1],fe=Object(s.useState)(t.imageColors),Oe=Object(j.a)(fe,2),pe=Oe[0],ge=Oe[1],xe=Object(s.useState)(!1),ye=Object(j.a)(xe,2),Se=ye[0],we=ye[1],Ce=Object(s.useState)(!1),Ne=Object(j.a)(Ce,2),ke=Ne[0],Ie=Ne[1];function Ae(e){var t=I.filter((function(t){return t.uid!==e.uid}));return A(t)}function Pe(){return(Pe=Object(d.a)(l.a.mark((function e(n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.preventDefault(),Ze(),I.length>t.authors.length?I.filter((function(e){return!t.authors.find((function(t){return t.uid===e.uid}))})).forEach(function(){var e=Object(d.a)(l.a.mark((function e(n){var s,c,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(n.uid).get();case 2:s=e.sent,c=s.data(),(a=c.ownPlaylists).push(t.id),m.collection("users").doc(n.uid).update({ownPlaylists:a});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()):I.length<t.authors.length&&t.authors.filter((function(e){return!I.find((function(t){return t.uid===e.uid}))})).forEach(function(){var e=Object(d.a)(l.a.mark((function e(n){var s,c,a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(n.uid).get();case 2:s=e.sent,c=s.data(),a=c.ownPlaylists,r=a.filter((function(e){return e!==t.id})),m.collection("users").doc(n.uid).update({ownPlaylists:r});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),m.collection("playlists").doc(t.id).update({id:t.id,name:r,songs:Q,authors:I,image:b,listens:t.listens,creationDate:T,subscribers:t.subscribers,isAlbum:1===_,imageColors:pe,isPrivate:1===te}).then((function(){we(!1),Ie(!0)}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){i(t.name),h(t.image),A(t.authors)}),[t.id]),Object(s.useEffect)((function(){0===D.length&&t.songs.map(function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("songs").doc(t).get();case 2:n=e.sent.data(),ue(!1),z((function(e){return[].concat(Object(W.a)(e),[n])}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[D]),Object(v.jsxs)("div",{className:"AddSong",children:[Object(v.jsx)(Dt.a,{src:be,getColors:function(e){return ge(e)}}),Object(v.jsx)(me,{title:"Playlist name",value:r,setValue:i,placeholder:"Enter playlist name"}),Object(v.jsxs)("label",{children:[Object(v.jsx)("h3",{children:"Playlist authors"}),Object(v.jsx)(Re,{value:p,setValue:g,setResultAuthorList:C,defaultSearchMode:"authors",inputText:"Search for authors"}),Object(v.jsx)("div",{className:"chosenAuthorsList",children:I.map((function(e){return Object(v.jsxs)("div",{className:"chosenAuthorItem",children:[Object(v.jsx)("span",{children:e.displayName}),Object(v.jsx)(je.H,{onClick:function(){return e.uid===n.uid?null:Ae(e)}})]})}))}),Object(v.jsx)("div",{className:"authorsResult",children:ae?Object(v.jsx)("div",{style:{position:"relative",width:"100%",height:"50px"},children:Object(v.jsx)(M,{})}):w.map((function(e,t){return Object(v.jsx)(J,{data:e,onClick:function(){return function(e){if(!I.some((function(t){return t.uid===e.uid})))return A((function(t){return[].concat(Object(W.a)(t),[{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL}])}));Ae(e)}(e)},style:I.includes(e.uid)?{background:"var(--green)"}:{}},t)}))})]}),Object(v.jsxs)("label",{children:[Object(v.jsx)("h3",{children:"Search for songs"}),Object(v.jsx)(Re,{value:D,setValue:F,setAllFoundSongs:z,defaultSearchMode:"songs",inputText:"Search for songs"}),Object(v.jsx)("div",{className:"authorsResult",children:oe?Object(v.jsx)("div",{style:{position:"relative",width:"100%",height:"50px"},children:Object(v.jsx)(M,{})}):Object(v.jsx)(Ct,{listOfSongs:V,source:"no",listOfChosenSongs:Q,setListOfSongs:G})})]}),n.isAdmin||n.isAuthor?Object(v.jsxs)("div",{style:{display:"flex",justifyContent:"flex-start",margin:"15px 0"},children:[Object(v.jsx)(Ht,{label:"Playlist",onClick:function(){return $(0)},currentActive:_,id:0}),Object(v.jsx)(Ht,{label:"Album",onClick:function(){return $(1)},currentActive:_,id:1})]}):null,Object(v.jsxs)("div",{style:{display:"flex",justifyContent:"flex-start",margin:"15px 0"},children:[Object(v.jsx)(Ht,{label:"Not Private",onClick:function(){return ne(0)},currentActive:te,id:0}),Object(v.jsx)(Ht,{label:"Private",onClick:function(){return ne(1)},currentActive:te,id:1})]}),(n.isAdmin||n.isAuthor)&&Object(v.jsx)(me,{title:"Release Date",type:"date",value:T,setValue:R,placeholder:"Enter release date"}),Object(v.jsx)(Wt,{text:"Download playlist cover",place:"songsImages/",setItemSrc:h,setImageLocalPath:he}),Object(v.jsx)(ve,{text:"Update playlist",action:function(e){return Pe.apply(this,arguments)},isLoading:Se,completed:ke,setCompleted:Ie,bottomMessage:"Playlist was updated"})]})},zt=function(){var e=Object(d.a)(l.a.mark((function e(t,n){var s,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(n.uid).get();case 2:(s=e.sent.data().addedAuthors).push(t.uid),m.collection("users").doc(n.uid).update({addedAuthors:s}),c=t.subscribers,c++,m.collection("users").doc(t.uid).update({subscribers:c});case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();function Yt(e,t){var n=e.friends,s=t.friends;n.push({status:"requested",uid:t.uid}),s.push({status:"awaiting",uid:e.uid}),m.collection("users").doc(e.uid).update({friends:n}),m.collection("users").doc(t.uid).update({friends:s})}var qt=function(e,t){},Qt=function(e){var t=e.author,n=re().setContent,c=ue().yourFriends,a=Object(s.useState)([]),r=Object(j.a)(a,2),i=r[0],o=r[1],u=Object(s.useState)(!0),b=Object(j.a)(u,2),h=b[0],f=b[1];function O(){return(O=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f(!0),o([]),c.forEach((function(e){t.isAuthor?e.addedAuthors.includes(t.uid)&&o((function(t){return[].concat(Object(W.a)(t),[e])})):e.friends.find((function(e){return e.uid===t.uid}))&&o((function(t){return[].concat(Object(W.a)(t),[e])}))})),f(!1);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){!function(){O.apply(this,arguments)}()}),[t.uid]),Object(v.jsxs)("div",{className:"SongInfo",children:[Object(v.jsx)("div",{className:"songImage",style:{backgroundImage:"url(".concat(t.photoURL,")")}}),Object(v.jsxs)("div",{className:"songInfoContent",children:[Object(v.jsxs)("div",{style:{display:"flex",flexDirection:"column-reverse"},children:[Object(v.jsxs)("h3",{style:{color:t.imageColors[1]},children:[t.displayName,t.isVerified?Object(v.jsx)(ge.b,{style:{color:t.imageColors[0],width:"15px",height:"15px",marginLeft:"5px"}}):null]}),Object(v.jsx)("span",{style:{opacity:".5",fontWeight:500,fontSize:".7em"},children:t.isAuthor?"Author":"User"})]}),Object(v.jsxs)("div",{style:{display:"flex",opacity:"0.6",fontSize:".9em",position:"relative"},className:"listensAndDate",children:[Object(v.jsxs)("p",{className:"infoListens",style:{marginRight:"20px",position:"relative"},children:[t.numberOfListenersPerMonth,Object(v.jsx)(je.l,{})]}),Object(v.jsxs)("p",{className:"infoListens",style:{marginRight:"20px",position:"relative"},children:[t.subscribers," ",Object(v.jsx)(je.E,{})]}),Object(v.jsx)("span",{children:Q(t.regDate)})]}),Object(v.jsx)("h4",{style:{margin:"10px 0"},children:i.length>0?"Friends subscribed":"None of your friends subscribed"}),h?Object(v.jsx)("div",{style:{position:"relative",height:"50px"},children:Object(v.jsx)(M,{top:"50%"})}):Object(v.jsx)("div",{style:{display:"flex"},children:i.length>0?Object(v.jsxs)(v.Fragment,{children:[i.map((function(e,t){if(t<2)return Object(v.jsx)(Je,{person:e},e.uid)})),i.length>2?Object(v.jsx)(_e,{onClick:function(){return n(Object(v.jsx)($e,{listOfPeople:i,title:"Friends subscribed to ".concat(t.displayName)}))}}):null]}):Object(v.jsx)("button",{className:"shareBtn",style:{minHeight:"35px",background:t.imageColors[0]},onClick:function(){n(Object(v.jsx)(ct,{item:t,whatToShare:"author"}))},children:"Share"})})]})]})},Gt=function(e){var t=e.data,n=re().setContent;return Object(v.jsxs)("div",{className:"AuthorMoreWindow",style:{top:"110%",bottom:"auto"},onClick:function(e){return e.stopPropagation()},children:[Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){n(Object(v.jsx)(ct,{item:t,whatToShare:void 0!==t.authors?"playlist":"author"}))},children:[Object(v.jsx)(je.A,{}),"Share"]}),Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){n(void 0!==t.authors?Object(v.jsx)(Bt,{album:t}):Object(v.jsx)(Qt,{author:t}))},children:[Object(v.jsx)(je.o,{}),"Info"]})]})},Kt=function(e){var t=e.author,n=Object(s.useState)(t.displayName),c=Object(j.a)(n,2),a=c[0],r=c[1],i=Object(s.useState)(t.photoURL),o=Object(j.a)(i,2),u=o[0],b=o[1],h=Object(s.useState)(""),f=Object(j.a)(h,2),O=f[0],g=f[1],x=Object(s.useState)(t.imageColors),y=Object(j.a)(x,2),S=y[0],w=y[1];function C(){return(C=Object(d.a)(l.a.mark((function e(t,n,s){var c,a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=t.target.files[0],g(URL.createObjectURL(c)),a=p.ref(),r=a.child(n+c.name),e.next=6,r.put(c);case 6:return e.t0=s,e.next=9,r.getDownloadURL();case 9:e.t1=e.sent,(0,e.t0)(e.t1);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(v.jsxs)("div",{className:"AddSong",children:[Object(v.jsx)(Dt.a,{src:O,getColors:function(e){return w(e)}}),Object(v.jsxs)("form",{onSubmit:function(e){return e.preventDefault()},children:[Object(v.jsx)("div",{style:{width:"100%",display:"flex",justifyContent:"center"},children:Object(v.jsx)("div",{className:"chatInfoImage",style:{backgroundImage:"url(".concat(u,")")},children:Object(v.jsxs)("label",{className:"changePhoto",children:[Object(v.jsx)(be.b,{}),"Change photo",Object(v.jsx)("input",{type:"file",style:{display:"none"},onChange:function(e){return function(e,t,n){return C.apply(this,arguments)}(e,"chatCovers/",b)}})]})})}),Object(v.jsxs)("label",{children:[Object(v.jsx)("h3",{children:"Your name"}),Object(v.jsx)("input",{type:"text",placeholder:"Enter your name",value:a,onChange:function(e){return r(e.target.value)},required:!0})]}),Object(v.jsx)("button",{type:"button",className:"addSongBtn",onClick:function(e){e.preventDefault(),m.collection("users").doc(t.uid).update({displayName:a,photoURL:u,imageColors:S})},children:"Update author"})]})]})},Xt=function(e){var t=e.data,n=e.headerColors,c=S(),a=c.currentUser,r=c.logout,o=Ye().isMobile,u=Object(s.useState)(!1),l=Object(j.a)(u,2),d=l[0],b=l[1],h=re(),f=h.toggleModal,O=h.setContent,p=h.openConfirm,g=h.closeConfirm,x=h.openBottomMessage,y=Object(s.useRef)(null);return Te(y,b),Object(v.jsxs)("div",{className:"headerBtns",style:{background:n[2]},children:[Object(v.jsx)(Et,{}),Object(v.jsxs)("div",{style:{display:"flex"},children:[Object(v.jsx)("div",{className:"headerBackBtn",children:t.authors?a.ownPlaylists.includes(t.id)&&1===t.authors.length?Object(v.jsxs)("button",{onClick:function(){return p("Are you sure you want to DELETE this playlist forever?!","Yes, pretty sure","No, I Don't!",(function(){var e;e=t.id,m.collection("users").where("addedPlaylists","array-contains",e).get().then((function(t){t.docs.forEach((function(t){var n=t.data().addedPlaylists.filter((function(t){return t!==e}));m.collection("users").doc(t.data().uid).update({addedPlaylists:n})}))})),m.collection("users").where("ownPlaylists","array-contains",e).get().then((function(t){t.docs.forEach((function(t){var n=t.data().addedPlaylists.filter((function(t){return t!==e}));m.collection("users").doc(t.data().uid).update({ownPlaylists:n})}))})),m.collection("search").doc(e).delete().then((function(){m.collection("playlists").doc(e).delete()})),g(),x("Playlist ".concat(t.name," was deleted"))}))},children:[Object(v.jsx)(Qe,{text:"delete playlist",direction:"bottom"}),Object(v.jsx)(je.B,{})]}):a.ownPlaylists.includes(t.id)?Object(v.jsxs)("button",{onClick:function(){return p("Are you sure you want to quit this playlist?","Yes, pretty sure","No, I Don't!",(function(){!function(e,t){m.collection("users").doc(t.uid).update({ownPlaylists:t.ownPlaylists.filter((function(t){return t!==e.id}))}),m.collection("playlists").doc(e.id).update({authors:e.authors.filter((function(e){return e.uid!==t.uid}))})}(t,a),g(),x("You left ".concat(t.name))}))},children:[Object(v.jsx)(Qe,{text:"quit playlist",direction:"bottom"}),Object(v.jsx)(de.e,{})]}):a.addedPlaylists.includes(t.id)?Object(v.jsxs)("button",{onClick:function(){return p("Are you sure you want to remove this playlist from library?","Yes, pretty sure","No-no-no, go away",(function(){Rt(t,a),g(),x("Playlist was removed from library")}))},children:[Object(v.jsx)(Qe,{text:"remove playlist from library",direction:"bottom"}),Object(v.jsx)(Xe.a,{})]}):Object(v.jsxs)("button",{onClick:function(){Tt(t,a),x("Playlist ".concat(t.name," was added to library"))},children:[Object(v.jsx)(Qe,{text:"add playlist",direction:"bottom"}),Object(v.jsx)(je.x,{})]}):a.addedAuthors.includes(t.uid)?Object(v.jsxs)("button",{onClick:function(){return qt(t,a)},children:[Object(v.jsx)(Qe,{text:"delete author from library",direction:"bottom"}),Object(v.jsx)(Xe.a,{})]}):a.uid===t.uid?Object(v.jsx)(i.b,{to:"/settings",children:Object(v.jsxs)("button",{children:[Object(v.jsx)(Qe,{text:"settings",direction:"bottom"}),Object(v.jsx)(je.z,{})]})}):!t.isAuthor&&a.friends.find((function(e){return e.uid===t.uid&&"added"===e.status}))?Object(v.jsxs)("button",{onClick:function(){return p("Are you sure you want to unfriend ".concat(t.displayName,"?"),"Yes, pretty sure","No-no-no, go away",(function(){!function(e,t){var n=e.friends.filter((function(e){return e.uid!==t.uid})),s=t.friends.filter((function(t){return t.uid!==e.uid}));m.collection("users").doc(e.uid).update({friends:n}),m.collection("users").doc(t.uid).update({friends:s})}(a,t),g(),x("".concat(t.displayName," was unfriended"))}))},children:[Object(v.jsx)(Qe,{text:"remove from friend list",direction:"bottom"}),Object(v.jsx)(je.D,{})]}):!t.isAuthor&&a.friends.find((function(e){return e.uid===t.uid&&"awaiting"===e.status}))?Object(v.jsxs)("button",{onClick:Yt,children:[Object(v.jsx)(Qe,{text:"waiting for response",direction:"bottom"}),Object(v.jsx)(de.l,{style:{animation:"loading 1s infinite linear"}})]}):t.isAuthor?Object(v.jsxs)("button",{onClick:function(){zt(t,a),x("".concat(t.displayName," was added to your library"))},children:[Object(v.jsx)(Qe,{text:"subscribe",direction:"bottom"}),Object(v.jsx)(je.x,{})]}):Object(v.jsxs)("button",{onClick:function(){Yt(t,a),x("Friend request was sent to ".concat(t.displayName))},children:[Object(v.jsx)(Qe,{text:"add friend",direction:"bottom"}),Object(v.jsx)(je.E,{})]})}),Object(v.jsxs)("div",{className:"headerMoreBtn",ref:y,children:[Object(v.jsxs)("button",{onClick:o?function(){f(),O(Object(v.jsx)(Gt,{data:t}))}:function(){return b(!d)},children:[Object(v.jsx)(Qe,{text:"more",direction:"bottom"}),Object(v.jsx)(je.t,{})]}),d?Object(v.jsxs)("div",{className:"songItemMenuWindow",style:{top:"110%",bottom:"auto"},onClick:function(e){return e.stopPropagation()},children:[t.authors&&t.authors.find((function(e){return e.uid===a.uid}))||t.authors&&a.isAdmin?Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){f(),O(Object(v.jsx)(Vt,{playlist:t}))},children:[Object(v.jsx)(je.j,{}),"Edit"]}):t.uid!==a.uid||t.isAuthor?null:Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){f(),O(Object(v.jsx)(Kt,{author:t}))},children:[Object(v.jsx)(je.j,{}),"Edit"]}),Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){f(),O(Object(v.jsx)(ct,{item:t,whatToShare:void 0!==t.authors?"playlist":"author"}))},children:[Object(v.jsx)(je.A,{}),"Share"]}),Object(v.jsxs)("div",{className:"songItemMenuWindowItem",onClick:function(){f(),O(void 0!==t.authors?Object(v.jsx)(Bt,{album:t}):Object(v.jsx)(Qt,{author:t}))},children:[Object(v.jsx)(je.o,{}),"Info"]})]}):null]})]}),a.uid===t.uid?Object(v.jsxs)("button",{onClick:function(){return p("Are you sure you want to quit?","Yes, pretty sure","No, I Don't!",(function(){r(),g()}))},children:[Object(v.jsx)(Qe,{text:"quit",direction:"bottom"}),Object(v.jsx)(H.c,{})]}):null]})},Jt=function(e){var t,n,s=e.data,c=e.headerColors,a=ue().displayAuthors,r=Nt(s),i=Object(j.a)(r,2),o=i[0],u=i[1],l=S().currentUser.friends.find((function(e){return e.uid===s.uid&&"added"===e.status}));return Object(v.jsxs)("div",{className:"Header",style:c.length?{background:"linear-gradient(45deg, ".concat(c[2],", ").concat(c[0],")")}:{background:"var(--yellowAndPinkGrad)"},children:[Object(v.jsx)(Xt,{data:s,headerColors:c}),Object(v.jsx)("div",{className:"headerAuthorsImage",style:void 0===s.authors?{animation:"floatingBorderRadius 10s infinite ease-in-out",backgroundImage:"url(".concat(s.photoURL,")"),position:"relative"}:{backgroundImage:"url(".concat(s.image,")"),position:"relative",backgroundColor:"var(--red)"},children:void 0===s.authors||s.image?null:Object(v.jsx)(de.a,{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",width:"60px",height:"60px"}})}),Object(v.jsxs)("div",{className:"headerAuthorInfo",children:[Object(v.jsxs)("div",{className:"headerAuthorsName",children:[void 0!==s.authors?s.isAlbum?Object(v.jsx)("h5",{children:"Album"}):Object(v.jsx)("h5",{children:"Playlist"}):s.isAuthor?Object(v.jsx)("h5",{children:"Author"}):Object(v.jsxs)("h5",{children:["User"," ",void 0===s.authors&&l?Object(v.jsx)(K,{userUID:s.uid}):null]}),Object(v.jsxs)("div",{style:{display:"flex",alignItems:"center",margin:"2px 0 10px 0"},children:[Object(v.jsx)(v.Fragment,{children:Object(v.jsx)("h1",{children:s.displayName||s.name})}),s.isVerified?Object(v.jsx)(ge.b,{style:{color:c[0]}}):null,s.isPrivate?Object(v.jsx)(Xe.b,{}):null,!!s.displayName&&l&&Object(v.jsx)(Mt,{data:s,loading:!1})]})]}),void 0!==s.authors?Object(v.jsxs)("div",{className:"headerAuthorsImagesAndNames",children:[Object(v.jsx)(kt,{imagesList:u,borderColor:c[2]}),Object(v.jsx)("div",{className:"headerAuthors",children:a(o,", ")})]}):null,Object(v.jsxs)("div",{className:"headerListenersAndSubs",children:[Object(v.jsxs)("div",{className:"headerListenersAndSubsItem",children:[Object(v.jsx)(Qe,{text:(null!==(t=s.listens)&&void 0!==t?t:s.numberOfListenersPerMonth)+" listens",style:{fontSize:"0.8em"}}),Object(v.jsx)("span",{children:bt(null!==(n=s.listens)&&void 0!==n?n:s.numberOfListenersPerMonth)}),Object(v.jsx)(je.l,{})]}),Object(v.jsxs)("div",{className:"headerListenersAndSubsItem",children:[Object(v.jsx)(Qe,{text:s.subscribers+" subscribers",style:{fontSize:"0.8em"}}),Object(v.jsx)("span",{children:bt(s.subscribers)}),Object(v.jsx)(je.E,{})]}),void 0!==s.creationDate?Object(v.jsxs)("div",{className:"headerListenersAndSubsItem",children:[Object(v.jsx)(Qe,{text:"creation date",style:{fontSize:"0.8em"}}),Object(v.jsx)("span",{children:Q(s.creationDate)})]}):null]}),l?Object(v.jsx)(It,{data:s,color:c[3]}):null]})]})},_t=function(e){var t=e.children,n=Object(F.a)(e,["children"]);return Object(v.jsx)("div",Object(D.a)(Object(D.a)({className:"content-container"},n),{},{children:t}))},$t=function(){var e=Object(o.h)("/albums/:albumId"),t=Object(s.useState)([]),n=Object(j.a)(t,2),c=n[0],a=n[1],r=Object(s.useState)([]),i=Object(j.a)(r,2),u=i[0],b=i[1],h=e.params.albumId,f=Object(s.useState)([]),O=Object(j.a)(f,2),p=O[0],g=O[1],x=Object(s.useState)(!0),y=Object(j.a)(x,2),S=y[0],w=y[1],C=Object(o.g)();function N(){return(N=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:m.collection("playlists").doc(h).onSnapshot((function(e){e.exists?(g(e.data()),b(e.data().imageColors)):C.push("/not-found")}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){!function(){N.apply(this,arguments)}()}),[h,m]),Object(s.useEffect)((function(){!function(){var e;(null===(e=p.songs)||void 0===e?void 0:e.length)?se(p.songs,"songs",a,(function(e){return e}),(function(){return w(!1)})):w(!1)}()}),[p]),Object(v.jsx)("div",{className:"AlbumPage",style:{animation:"zoomIn .2s forwards"},children:S?Object(v.jsx)(M,{top:"50%"}):Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(Jt,{data:p,headerColors:u,setHeaderColors:b}),Object(v.jsxs)(_t,{style:{display:"flex",flexDirection:"column",minHeight:"100%",borderRadius:"25px 25px 0 0",flex:"1 1 auto",position:"relative",overflow:"hidden",boxShadow:"0px 0px 100px #060606"},children:[Object(v.jsx)("div",{className:"content-background",style:{background:"linear-gradient(360deg, black, ".concat(u[0],")")}}),Object(v.jsx)(Ct,{listOfSongs:c,source:{source:"/albums/".concat(p.id),name:p.name,image:p.image,songsList:c},showSearch:!0,defaultSearchMode:"songs"})]})]})})},Zt=function(e){var t=e.person,n=e.addFriend,s=e.rejectFriend;return Object(v.jsxs)("div",{className:"FriendRequestItem",children:[Object(v.jsx)(i.b,{to:"/authors/".concat(t.uid),children:Object(v.jsxs)("div",{className:"friendRequestImageAndName",children:[Object(v.jsx)("div",{className:"requestImage",children:Object(v.jsx)("img",{loading:"lazy",src:t.photoURL,alt:""})}),Object(v.jsx)("h3",{children:t.displayName})]})}),Object(v.jsxs)("div",{className:"requestButtons",children:[Object(v.jsxs)("button",{style:{color:"var(--green)"},onClick:function(){return n(t.uid)},children:[Object(v.jsx)(je.d,{}),Object(v.jsx)("span",{children:"Add"})]}),Object(v.jsxs)("button",{style:{color:"var( --lightRed)"},onClick:function(){return s(t.uid)},children:[Object(v.jsx)(je.G,{}),Object(v.jsx)("span",{children:"Reject"})]})]})]})},en=function(){var e=S().currentUser,t=Object(s.useState)([]),n=Object(j.a)(t,2),c=n[0],a=n[1];return Object(s.useEffect)((function(){!function(){var t=[];e.friends.forEach(function(){var n=Object(d.a)(l.a.mark((function n(s,c){var r;return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("requested"!==s.status){n.next=6;break}return n.next=3,m.collection("users").doc(s.uid).get();case 3:r=n.sent.data(),t.push(r),c===e.friends.length-1&&a(t);case 6:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())}()}),[JSON.stringify(e.friends)]),[c,function(t){var n=e.friends,s=c.find((function(e){return e.uid===t})).friends;n.find((function(e){return e.uid===t})).status="added",s.find((function(t){return t.uid===e.uid})).status="added",m.collection("users").doc(e.uid).update({friends:n}),m.collection("users").doc(t).update({friends:s}),a((function(e){return e.filter((function(e){return e.uid!==t}))}))},function(t){var n=e.friends.filter((function(e){return e.uid!==t}));m.collection("users").doc(t).get().then((function(s){var c=s.data().friends.filter((function(t){return t.uid!==e.uid}));m.collection("users").doc(e.uid).update({friends:n}),m.collection("users").doc(t).update({friends:c}),a((function(e){return e.filter((function(e){return e.uid!==t}))}))}))}]},tn=function(){var e=en(),t=Object(j.a)(e,3),n=t[0],s=t[1],c=t[2];return Object(v.jsx)(v.Fragment,{children:n.map((function(e,t){return Object(v.jsx)(Zt,{person:e,addFriend:s,rejectFriend:c},t)}))})};function nn(e){var t=new Date(e.releaseDate);return(new Date).getTime()-t.getTime()<18144e5}var sn=function(e){e.authorId;var t=e.authorsData,n=(e.headerColors,Object(s.useState)([])),c=Object(j.a)(n,2),a=c[0],r=c[1],i=Object(s.useState)([]),o=Object(j.a)(i,2),u=o[0],b=o[1];function h(){return(h=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.isAuthor?se(t.ownSongs,"songs",r,(function(e){return e.forEach((function(e){nn(e)&&!u.includes(e)&&b((function(t){return[].concat(Object(W.a)(t),[e])}))})),e.sort((function(e,t){return t.listens-e.listens}))})):se(t.addedSongs.slice(0).reverse(),"songs",r);case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){!function(){h.apply(this,arguments)}(),b([])}),[t.ownSongs]),t.isAuthor?Object(v.jsxs)("div",{className:"TopSongs",children:[Object(v.jsx)(Ct,{listOfSongs:u,source:{source:"/authors/".concat(t.uid),name:t.displayName,image:t.photoURL,songsList:u},isNewSong:!0}),Object(v.jsx)(Ct,{listOfSongs:a,source:{source:"/authors/".concat(t.uid),name:t.displayName,image:t.photoURL,songsList:a},title:"Popular Songs",showListens:!0,showCount:!0,isHorizontal:!0})]}):Object(v.jsx)(Ct,{listOfSongs:a,source:{source:"/authors/".concat(t.uid),name:t.displayName+"'s Library",image:t.photoURL,songsList:a},title:t.displayName+"'s Library",showListens:!0,showCount:!0,isHorizontal:!0})},cn=function(){var e=Object(d.a)(l.a.mark((function e(t,n,s,c){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n([]),a=[],void 0!==t.ownPlaylists&&0!==t.ownPlaylists.length&&t.ownPlaylists.forEach(function(){var e=Object(d.a)(l.a.mark((function e(r,i){var o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("playlists").doc(r).get();case 2:(o=e.sent.data())&&(!o.isPrivate||t.uid===s&&o.isPrivate)&&a.push(o),i===t.ownPlaylists.length-1&&(a.sort((function(e,t){return new Date(t.creationDate).getTime()-new Date(e.creationDate).getTime()})),c(!1),n(a));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e)})));return function(t,n,s,c){return e.apply(this,arguments)}}(),an=n(34),rn=function(){return Object(v.jsxs)("div",{style:{textDecoration:"none"},className:"playlistWrapper",children:[Object(v.jsx)("div",{className:"playlistItem",style:{background:"var(--playlistsColor)",display:"flex",justifyContent:"center",alignItems:"center"},children:Object(v.jsx)("img",{loading:"lazy",src:R,alt:"",style:{width:"70px",height:"70px",filter:"grayscale(80%)"}})}),Object(v.jsx)("h4",{style:{display:"flex",alignItems:"center",margin:"5px 0"},children:"Playlist was deleted"})]})},on=function(e,t,n){var c=ue(),a=c.currentSongPlaylistSource,r=c.playSong,i=c.setCurrentSongQueue,o=c.setCurrentSong,u=c.setPlay,j=c.songRef,b=c.setCurrentSongInQueue,h=c.setCurrentSongPlaylistSource,f=S().currentUser;return Object(s.useEffect)((function(){if(t.length){var n={source:"/albums/".concat(e.id),name:e.name,image:e.image,songsList:t},s=t.map((function(e){return e.id}));i(t),b(0),o(t[0].id),j.current.play(),u(!0),h(n),m.collection("users").doc(f.uid).update({lastSongPlayed:t[0].id,lastQueue:{image:n.image,name:n.name,songsList:s,source:n.source}})}}),[t.length]),function(t){t.preventDefault(),a.name!==e.name?(n([]),0!==e.length&&e.songs.map(function(){var e=Object(d.a)(l.a.mark((function e(t){var s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("songs").doc(t).get();case 2:s=e.sent.data(),n((function(e){return[].concat(Object(W.a)(e),[s])}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())):r()}},un=function(e){var t=e.playlist,n=void 0===t?null:t,c=e.listOfChosenAlbums,a=e.setListOfChosenAlbums,r=e.shouldSaveSearchHistory,o=new Date(null===n||void 0===n?void 0:n.creationDate),u=Ye().isMobile,l=S().currentUser,d=ue(),b=d.currentSongPlaylistSource,h=d.play,f=Object(s.useState)([]),O=Object(j.a)(f,2),p=O[0],m=O[1],g=on(n,p,m);return null!==n?Object(v.jsxs)(i.b,{to:"/albums/".concat(n.id),style:{textDecoration:"none"},className:"playlistWrapper",onClick:function(){r&&it(l.uid,n.id,"playlists")},children:[Object(v.jsx)(V,{listOfChosenItems:c,setListOfChosenItems:a,itemId:n.id}),Object(v.jsxs)("div",{className:"playlistItem",style:n.image?{backgroundImage:"url(".concat(n.image,")")}:{background:"var(--yellowAndPinkGrad)"},children:[n.image?null:Object(v.jsx)(de.a,{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",width:"60px",height:"60px"}}),u?null:Object(v.jsx)("button",{onClick:g,children:b.name===n.name&&h?Object(v.jsx)(an.b,{}):Object(v.jsx)(an.c,{})})]}),Object(v.jsxs)("h4",{style:{display:"flex",alignItems:"center",margin:"5px 0"},children:[dt(n.name,u?10:15),Object(v.jsx)("span",{style:{fontSize:".6em",opacity:.6,fontWeight:"500",marginLeft:"7px"},children:n.isAlbum?1===n.songs.length?"single":"album":"playlist"})]}),Object(v.jsx)("h5",{style:{margin:"5px 0"},children:o.getFullYear()})]}):Object(v.jsx)(rn,{})},ln=function(e){var t=e.listOfAlbums,n=e.title,c=void 0===n?"":n,a=e.loading,r=void 0===a||a,i=e.listOfChosenAlbums,o=e.setListOfChosenAlbums,u=e.saveSearchHistory,l=Object(s.useState)(0),d=Object(j.a)(l,2),b=d[0],h=d[1],f=Object(s.useRef)(null),O=Object(s.useState)(!1),p=Object(j.a)(O,2),m=p[0],g=p[1];return Object(s.useEffect)((function(){t.length>0&&!r&&(f.current.scrollWidth>f.current.offsetWidth&&g(!0))}),[t]),t.length>0?r?Object(v.jsx)(M,{}):Object(v.jsxs)("div",{className:"AuthorsList",children:[0!==c.length?Object(v.jsx)("h2",{children:c}):null,Object(v.jsx)("div",{className:"authorsWrapper",ref:f,onScroll:function(e){return h(e.target.scrollLeft)},children:t.map((function(e,t){return Object(v.jsx)(un,{playlist:e,listOfChosenAlbums:i,setListOfChosenAlbums:o,shouldSaveSearchHistory:u},t)}))}),Object(v.jsxs)("div",{className:"authorsShiftButtons",children:[Object(v.jsx)("button",{onClick:function(){var e=f.current.scrollLeft;f.current.scrollLeft=e-220,h(e-220)},style:b<=0?{visibility:"hidden",opacity:"0"}:{},children:Object(v.jsx)(je.f,{})}),Object(v.jsx)("button",{onClick:function(){var e=f.current.scrollLeft;f.current.scrollLeft=e+220,h(e+220)},style:m&&f.current&&f.current.scrollWidth-f.current.offsetWidth!==b?{}:{visibility:"hidden",opacity:"0"},children:Object(v.jsx)(je.g,{})})]})]}):null},dn=function(e){var t=e.authorsData,n=S().currentUser,c=Object(s.useState)([]),a=Object(j.a)(c,2),r=a[0],i=a[1],o=Object(s.useState)(!0),u=Object(j.a)(o,2),l=u[0],d=u[1];return Object(s.useEffect)((function(){cn(t,i,n.uid,d)}),[t.ownPlaylists]),Object(v.jsx)(ln,{listOfAlbums:r,title:n.isAuthor?"Albums":"Playlists",loading:l})};function jn(e,t,n){var s=[];e.forEach((function(e){var t=e.authors;0!==t.length&&s.push(t)})),s=s.flat();for(var c=new Set(s.map((function(e){return e.uid})).filter((function(e){return e!==t.uid}))),a=Array.from(c),r=[],i=0;i<a.length;i++)for(var o=0;o<s.length;o++)if(a[i]===s[o].uid){r.push(s[o]);break}return n(r),r}function bn(e,t){return hn.apply(this,arguments)}function hn(){return(hn=Object(d.a)(l.a.mark((function e(t,n){var s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0!==t&&void 0!==t.ownSongs&&0!==t.ownSongs.length&&(s=[],t.ownSongs.forEach(function(){var e=Object(d.a)(l.a.mark((function e(c,a){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("songs").doc(c).get();case 2:if(r=e.sent.data(),s.push(r),a!==t.ownSongs.length-1){e.next=6;break}return e.abrupt("return",jn(s,t,n));case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var fn=function(e){var t=e.data,n=e.listOfChosenAuthors,s=e.setListOfChosenAuthors,c=e.shouldSaveSearchHistory,a=void 0!==c&&c,r=S().currentUser;return Object(v.jsxs)(i.b,{to:"/authors/".concat(t.uid),className:"AuthorItemBig",onClick:function(){a&&it(r.uid,t.uid,"users")},children:[Object(v.jsx)(V,{listOfChosenItems:n,setListOfChosenItems:s,itemId:t.uid}),Object(v.jsxs)("div",{children:[Object(v.jsx)("div",{className:"AuthorItemBigImage",style:{backgroundImage:"url(".concat(t.photoURL,")")}}),Object(v.jsx)("h3",{children:t.displayName})]})]})},On=function(e){var t=e.listOfAuthors,n=e.title,c=void 0===n?"":n,a=e.listOfChosenAuthors,r=e.setListOfChosenAuthors,i=e.saveSearchHistory,o=Object(s.useState)(0),u=Object(j.a)(o,2),l=u[0],d=u[1],b=Object(s.useRef)(null),h=Object(s.useState)(!1),f=Object(j.a)(h,2),O=f[0],p=f[1];return Object(s.useEffect)((function(){t.length>0&&(b.current.scrollWidth>b.current.offsetWidth&&p(!0))}),[t]),t.length>0?Object(v.jsxs)("div",{className:"AuthorsList",children:[0!==c.length?Object(v.jsx)("h2",{children:c}):null,Object(v.jsx)("div",{className:"authorsWrapper",ref:b,onScroll:function(e){return d(e.target.scrollLeft)},children:t.map((function(e){return Object(v.jsx)(fn,{data:e,listOfChosenAuthors:a,setListOfChosenAuthors:r,shouldSaveSearchHistory:i},e.uid)}))}),Object(v.jsxs)("div",{className:"authorsShiftButtons",children:[Object(v.jsx)("button",{onClick:function(){var e=b.current.scrollLeft;b.current.scrollLeft=e-200,d(e-200)},style:l<=0?{visibility:"hidden",opacity:"0"}:{},children:Object(v.jsx)(je.f,{})}),Object(v.jsx)("button",{onClick:function(){var e=b.current.scrollLeft;b.current.scrollLeft=e+200,d(e+200)},style:O&&null!==b.current&&b.current.scrollWidth-b.current.offsetWidth!==l?{}:{visibility:"hidden",opacity:"0"},children:Object(v.jsx)(je.g,{})})]})]}):null},pn=function(e){var t=e.data,n=Object(s.useState)([]),c=Object(j.a)(n,2),a=c[0],r=c[1];return Object(s.useEffect)((function(){bn(t,r)}),[t]),Object(v.jsx)(On,{listOfAuthors:a,title:"Similar Authors"})},mn=function(e){var t=e.loading;return Object(v.jsx)("div",{className:"FullScreenLoading",style:t?{}:{opacity:"0",visibility:"hidden"},children:Object(v.jsx)("img",{loading:"lazy",src:"https://icon-library.com/images/spinner-icon-gif/spinner-icon-gif-28.jpg",alt:""})})},gn=function(){var e=S().currentUser,t=Object(s.useState)(""),n=Object(j.a)(t,2),c=n[0],a=n[1],r=Object(s.useState)(""),i=Object(j.a)(r,2),o=i[0],u=i[1],b=Object(s.useState)(""),h=Object(j.a)(b,2),f=h[0],O=h[1],p=Object(s.useState)([]),g=Object(j.a)(p,2),v=g[0],y=g[1],w=Object(s.useState)(e.isAdmin?[]:[{uid:e.uid,photoURL:e.photoURL,displayName:e.displayName}]),C=Object(j.a)(w,2),N=C[0],k=C[1],I=Object(s.useState)(e.isAdmin?"":(new Date).toString()),A=Object(j.a)(I,2),P=A[0],L=A[1],M=Object(s.useState)(""),T=Object(j.a)(M,2),R=T[0],E=T[1],B=Object(s.useState)([]),D=Object(j.a)(B,2),F=D[0],U=D[1],H=Object(s.useState)([]),V=Object(j.a)(H,2),z=V[0],Y=V[1],q=Object(s.useState)(0),Q=Object(j.a)(q,2),G=Q[0],K=Q[1],X=Object(s.useState)(0),J=Object(j.a)(X,2),_=J[0],$=J[1],Z=Object(s.useState)(""),ee=Object(j.a)(Z,2),te=ee[0],ne=ee[1],se=Object(s.useState)([]),ce=Object(j.a)(se,2),ae=ce[0],re=ce[1],ie=Object(s.useState)(""),oe=Object(j.a)(ie,2),ue=(oe[0],oe[1]),le=Object(s.useState)(!1),de=Object(j.a)(le,2),je=de[0],be=de[1],he=Object(s.useState)(!1),fe=Object(j.a)(he,2),Oe=fe[0],pe=fe[1];function me(e){var t=N.filter((function(t){return t.uid!==e.uid}));return k(t)}function ge(){return(ge=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),n=Ze(),0===c.length?ue("Playlist has to have some name"):0===N.length?ue("Playlist has to have at least 1 author"):0===P.length?ue("You have to set release date for a playlist"):(be(!0),m.collection("playlists").doc(n).set({id:n,name:c,songs:z,authors:N,image:o,listens:0,creationDate:P,subscribers:0,isAlbum:1===G,imageColors:ae,isPrivate:!0===_}).then((function(){y([]),O(""),k([]),u(""),a(""),L(""),E(""),Y([]),$(0),be(!1),pe(!0)})).catch((function(e){ue(e),be(!1)})),N.forEach(function(){var e=Object(d.a)(l.a.mark((function e(t){var s,c,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(t.uid).get();case 2:s=e.sent,c=s.data(),(a=c.ownPlaylists).push(n),m.collection("users").doc(t.uid).update({ownPlaylists:a});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),m.collection("search").doc(n).set({place:"playlists",uid:n,rank:0,variantsOfName:x(c)}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return{playlistName:c,setPlaylistName:a,imageLocalPath:te,loadingPlaylist:je,setImageColors:re,authorsInputValue:f,setAuthorsInputValue:O,setAllAuthors:y,chosenAuthors:N,removeAuthorFromList:me,allAuthors:v,addAuthor:function(e){if(!N.some((function(t){return t.uid===e.uid})))return k((function(t){return[].concat(Object(W.a)(t),[{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL}])}));me(e)},songsSearch:R,setSongsSearch:E,setAllSongs:U,setPlaylistStatus:K,removeSongFromList:function(e){var t=z.filter((function(t){return t!==e}));return Y(t)},chosenSongs:z,allSongs:F,setChosenSongs:Y,playlistStatus:G,isPlaylistPrivate:_,setIsPlaylistPrivate:$,setPlaylistCover:u,releaseDate:P,setReleaseDate:L,setImageLocalPath:ne,completed:Oe,setCompleted:pe,addPlaylistToFirebase:function(e){return ge.apply(this,arguments)},setChosenAuthors:k}},xn=function(e){var t=e.data,n=e.title,c=Object(s.useState)([]),a=Object(j.a)(c,2),r=a[0],i=a[1],o=Object(s.useState)(0),u=Object(j.a)(o,2),b=u[0],h=u[1],f=Object(s.useRef)(null),O=Object(s.useState)(!1),p=Object(j.a)(O,2),g=p[0],x=p[1];return Object(s.useEffect)((function(){r.length>0&&(f.current.scrollWidth>f.current.offsetWidth&&x(!0))}),[r]),Object(s.useEffect)((function(){i([]),i([]),t.friends.forEach(function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("added"!==t.status){e.next=5;break}return e.next=3,m.collection("users").doc(t.uid).get();case 3:n=e.sent.data(),i((function(e){return[].concat(Object(W.a)(e),[n])}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[t.uid]),r.length>0?Object(v.jsxs)("div",{className:"PersonTinyList",children:[n&&Object(v.jsx)("h2",{children:n}),Object(v.jsxs)("div",{style:{position:"relative"},children:[Object(v.jsx)("div",{className:"personTinyListWrapper",ref:f,onScroll:function(e){return h(e.target.scrollLeft)},children:r.map((function(e,t){return Object(v.jsx)(Je,{person:e},e.uid)}))}),Object(v.jsxs)("div",{className:"authorsShiftButtons",children:[Object(v.jsx)("button",{onClick:function(){var e=f.current.scrollLeft;f.current.scrollLeft=e-200,h(e-200)},style:b<=0?{visibility:"hidden",opacity:"0"}:{},children:Object(v.jsx)(je.f,{})}),Object(v.jsx)("button",{onClick:function(){var e=f.current.scrollLeft;f.current.scrollLeft=e+200,h(e+200)},style:g&&f.current&&f.current.scrollWidth-f.current.offsetWidth!==b?{}:{visibility:"hidden",opacity:"0"},children:Object(v.jsx)(je.g,{})})]})]})]}):null},vn=function(){var e=S().currentUser,t=ue().yourFriends,n=gn(),s=n.playlistName,c=n.setPlaylistName,a=n.imageLocalPath,r=n.loadingPlaylist,i=n.setImageColors,o=n.authorsInputValue,u=n.setAuthorsInputValue,l=n.setAllAuthors,d=n.chosenAuthors,j=(n.removeAuthorFromList,n.allAuthors),b=(n.addAuthor,n.songsSearch),h=n.setSongsSearch,f=n.setAllSongs,O=n.setPlaylistStatus,p=n.removeSongFromList,m=n.chosenSongs,g=n.allSongs,x=n.setChosenSongs,y=n.playlistStatus,w=n.isPlaylistPrivate,C=n.setIsPlaylistPrivate,N=n.setPlaylistCover,k=n.releaseDate,I=n.setReleaseDate,A=n.setImageLocalPath,P=n.completed,L=n.setCompleted,M=n.addPlaylistToFirebase,T=n.setChosenAuthors;return Object(v.jsxs)("div",{className:"AddSong",children:[Object(v.jsx)(mn,{loading:r}),Object(v.jsx)(Dt.a,{src:a,getColors:function(e){return i(e)}}),Object(v.jsxs)("div",{children:[Object(v.jsx)(me,{title:"Playlist name",value:s,setValue:c,placeholder:"Enter playlist name"}),Object(v.jsxs)("label",{children:[Object(v.jsx)("h3",{children:"Playlist authors"}),Object(v.jsx)(Re,{value:o,setValue:u,setResultAuthorList:l,defaultSearchMode:"authors",defaultAuthorsListValue:t,inputText:"Search for authors"}),Object(v.jsx)($e,{listOfPeople:j,restriction:3,chosenArray:d,setChosenArray:T})]}),Object(v.jsxs)("label",{children:[Object(v.jsx)("h3",{children:"Search for songs"}),Object(v.jsx)(Re,{value:b,setValue:h,setAllFoundSongs:f,defaultSearchMode:"songs",inputText:"Search for songs"}),Object(v.jsx)("div",{className:"chosenAuthorsList",children:m.map((function(e){return Object(v.jsxs)("div",{className:"chosenAuthorItem",children:[Object(v.jsx)("span",{children:e}),Object(v.jsx)(je.H,{onClick:function(){return p(e)}})]})}))}),Object(v.jsx)("div",{className:"authorsResult",children:g.map((function(e,t){return Object(v.jsx)(yt,{song:e,localIndex:t,listOfChosenSongs:m,setListOfSongs:x})}))})]}),e.isAdmin||e.isAuthor?Object(v.jsxs)("div",{style:{display:"flex",justifyContent:"flex-start",margin:"15px 0"},children:[Object(v.jsx)(Ht,{label:"Playlist",onClick:function(){return O(0)},currentActive:y,id:0}),Object(v.jsx)(Ht,{label:"Album",onClick:function(){return O(1)},currentActive:y,id:1})]}):null,Object(v.jsxs)("div",{style:{display:"flex",justifyContent:"flex-start",margin:"15px 0"},children:[Object(v.jsx)(Ht,{label:"Not Private",onClick:function(){return C(0)},currentActive:w,id:0}),Object(v.jsx)(Ht,{label:"Private",onClick:function(){return C(1)},currentActive:w,id:1})]}),(e.isAdmin||e.isAuthor)&&Object(v.jsx)(me,{title:"Release Date",type:"date",value:k,setValue:I,placeholder:"Enter release date"}),Object(v.jsx)(Wt,{text:"Download playlist cover",place:"songsImages/",setItemSrc:N,setImageLocalPath:A}),Object(v.jsx)(ve,{text:"Add playlists",action:M,isLoading:r,completed:P,setCompleted:L,bottomMessage:"Playlist was uploaded to database"})]})]})},yn=function(){var e=S().currentUser,t=Object(s.useState)(""),n=Object(j.a)(t,2),c=n[0],a=n[1],r=Object(s.useState)(""),i=Object(j.a)(r,2),o=i[0],u=i[1],b=Object(s.useState)(""),h=Object(j.a)(b,2),f=h[0],O=h[1],p=Object(s.useState)(""),g=Object(j.a)(p,2),y=g[0],w=g[1],C=Object(s.useState)([]),N=Object(j.a)(C,2),k=N[0],I=N[1],A=Object(s.useState)(e.isAdmin?[]:[{uid:e.uid,photoURL:e.photoURL,displayName:e.displayName}]),P=Object(j.a)(A,2),L=P[0],M=P[1],T=Object(s.useState)(""),R=Object(j.a)(T,2),E=R[0],B=R[1],D=Object(s.useState)(""),F=Object(j.a)(D,2),U=F[0],H=F[1],V=Object(s.useState)(""),z=Object(j.a)(V,2),Y=z[0],q=z[1],Q=Object(s.useState)([]),G=Object(j.a)(Q,2),K=G[0],X=G[1],_=Object(s.useState)(!1),$=Object(j.a)(_,2),Z=($[0],$[1],Object(s.useState)("")),ee=Object(j.a)(Z,2),te=(ee[0],ee[1]),ne=Object(s.useState)(!1),se=Object(j.a)(ne,2),ce=se[0],ae=se[1],re=Object(s.useState)(!1),ie=Object(j.a)(re,2),oe=ie[0],ue=ie[1];function le(e){var t=L.filter((function(t){return t.uid!==e.uid}));return M(t)}function de(){return(de=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),n=Ze(),te(""),0===c.length?te("Song has to have some name"):0===L.length?te("Song has to have at least 1 author"):0===o.length?te("You didn't load song cover"):0===f.length?te("You didn't load song file"):0===E.length?te("You have to set release date for a song"):(ue(!0),m.collection("songs").doc(n).set({id:n,name:c,songSrc:f,authors:L,cover:o,listens:0,releaseDate:E,lyrics:Ee(U),imageColors:K}).then((function(){I([]),w(""),M([]),H([]),u(""),a(""),O(""),B(""),H([]),ae(!0),X([]),ue(!1)})).catch((function(e){te(e),ue(!1)})),L.forEach(function(){var e=Object(d.a)(l.a.mark((function e(t){var s,c,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(t.uid).get();case 2:s=e.sent,c=s.data(),(a=c.ownSongs).push(n),m.collection("users").doc(t.uid).update({ownSongs:a});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),m.collection("search").doc(n).set({place:"songs",uid:n,rank:0,variantsOfName:x(c)}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(v.jsxs)("div",{className:"AddSong",children:[Object(v.jsx)(mn,{loading:oe}),Object(v.jsx)(Dt.a,{src:Y,getColors:function(e){return X(e)}}),Object(v.jsxs)("div",{children:[Object(v.jsx)(me,{title:"Song name",value:c,setValue:a,placeholder:"Enter song name"}),Object(v.jsxs)("label",{children:[Object(v.jsx)("h3",{children:"Song authors"}),Object(v.jsx)(Re,{value:y,setValue:w,setResultAuthorList:I,defaultSearchMode:"authors",inputText:"Search for authors"}),Object(v.jsx)("div",{className:"chosenAuthorsList",children:L.map((function(t){return Object(v.jsxs)("div",{className:"chosenAuthorItem",children:[Object(v.jsx)("span",{children:t.displayName}),Object(v.jsx)(je.H,{onClick:function(){(e.isAdmin||t.uid!==e.uid)&&le(t)}})]})}))}),Object(v.jsx)("div",{className:"authorsResult",children:k.map((function(e,t){return Object(v.jsx)(J,{data:e,onClick:function(){return function(e){if(!L.some((function(t){return t.uid===e.uid})))return M((function(t){return[].concat(Object(W.a)(t),[{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL}])}));le(e)}(e)},style:L.includes(e.uid)?{background:"var(--green)"}:{}},t)}))})]}),Object(v.jsx)(me,{title:"Release Date",type:"date",value:E,setValue:B,placeholder:"Enter release date"}),Object(v.jsx)("div",{style:{width:"100%",display:"flex"},children:K.map((function(e,t){return Object(v.jsx)("input",{type:"color",value:e,style:{width:"100%",height:"60px",padding:"0",borderRadius:"0px"},onChange:function(e){!function(e,t){K[t]=e.target.value,X(Object(W.a)(K))}(e,t)}})}))}),Object(v.jsx)(Wt,{text:"Download song cover",place:"songsImages/",setItemSrc:u,setImageLocalPath:q}),Object(v.jsx)(Wt,{text:"Download song file",place:"songs/",setItemSrc:O}),Object(v.jsx)("label",{children:Object(v.jsx)("textarea",{name:"",id:"",placeholder:"Add song lyrics",value:U,onChange:function(e){return H(e.target.value)}})}),Object(v.jsx)(ve,{text:"Add song",action:function(e){return de.apply(this,arguments)},isLoading:oe,completed:ce,setCompleted:ae,bottomMessage:"Song was uploaded to database"})]})]})},Sn=function(e){var t=e.pages,n=e.currentPage,s=e.setCurrentPage;return Object(v.jsx)("div",{className:"Slider",children:t.map((function(e,t){return Object(v.jsx)("div",{className:"sliderItem "+(t===n?"current":""),onClick:function(){return s(t)},children:e},t)}))})},wn=function(e){var t=e.data,n=S().currentUser,c=Object(s.useState)(!1),a=Object(j.a)(c,2),r=a[0],i=a[1],o=Object(s.useState)(0),u=Object(j.a)(o,2),l=u[0],d=u[1],b=[Object(v.jsx)(yn,{}),Object(v.jsx)(vn,{})];return(n.isAdmin||t.isAuthor)&&t.uid===n.uid?Object(v.jsxs)("div",{className:"AddSong",children:[Object(v.jsx)("button",{onClick:function(){return i(!r)},style:r?{background:"var(--red)"}:{},className:"openAddSongWindowBtn",children:Object(v.jsx)(je.w,{style:r?{transform:"rotate(45deg)"}:{}})}),Object(v.jsxs)("div",{className:"addSongWindow",style:r?{display:"flex"}:{},children:[Object(v.jsx)(Sn,{pages:["Song","Playlist"],currentPage:l,setCurrentPage:d}),b[l]]})]}):null},Cn=(n(267),function(){var e=Object(o.h)("/authors/:authorId"),t=S().currentUser,n=Object(s.useState)([]),c=Object(j.a)(n,2),a=c[0],r=c[1],i=e.params.authorId,u=Object(s.useState)([]),b=Object(j.a)(u,2),h=b[0],f=b[1],O=Object(s.useState)(!0),p=Object(j.a)(O,2),g=p[0],x=p[1],y=Object(o.g)(),w=re().openBottomMessage;function C(){return(C=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:m.collection("users").doc(i).get().then((function(e){e.exists?(f(e.data()),r(e.data().imageColors),x(!1)):y.push("/not-found")})).catch((function(e){w("Failed to load author's data","failure")}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){!function(){C.apply(this,arguments)}()}),[i]),Object(v.jsx)(v.Fragment,{children:Object(v.jsx)("div",{className:"AuthorPage",style:{animation:"zoomIn .2s forwards"},children:g?Object(v.jsx)(M,{}):Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(Jt,{data:h,headerColors:a,setHeaderColors:r}),Object(v.jsxs)(_t,{style:{display:"flex",flexDirection:"column",minHeight:"100%",borderRadius:"25px 25px 0 0",flex:"auto",position:"relative",overflow:"hidden",boxShadow:"0px 0px 100px #060606"},children:[Object(v.jsx)("div",{className:"content-background",style:{background:"linear-gradient(360deg, black, ".concat(a[0],")")}}),t.uid===h.uid?Object(v.jsx)(tn,{}):null,Object(v.jsx)(wn,{data:h}),Object(v.jsx)(sn,{author:i,authorsData:h,headerColors:a}),h.friends&&!h.isAuthor&&Object(v.jsx)(xn,{data:h,title:"Friends"}),Object(v.jsx)(dn,{authorsData:h,headerColors:a}),h.isAuthor?Object(v.jsx)(pn,{data:h}):null]})]})})})}),Nn=(n(268),function(e){var t=e.amountOfUnseen;return 0!==t&&Object(v.jsx)("div",{className:"AmountOfUnseenMessages",children:t})}),kn=function(e){var t=e.listOfSeen;return Object(v.jsx)("div",{className:"SeenByCircle",style:void 0!==t?t.length<=1?{opacity:"1",visibility:"visible"}:{}:null})},In=function(e){var t=e.typingPeople,n=Object(s.useState)([]),c=Object(j.a)(n,2),a=c[0],r=c[1],i=S().currentUser;return Object(s.useEffect)((function(){r([]),t.map(function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(t).get();case 2:(n=e.sent.data()).uid!==i.uid&&r((function(e){return[].concat(Object(W.a)(e),[n])}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[t]),a.length>0?Object(v.jsxs)("div",{className:"typingWrapper",children:[Object(v.jsx)(kt,{imagesList:a.map((function(e){return e.photoURL})),borderColor:"var(--navItemColor)"}),Object(v.jsxs)("div",{className:"TypingAnimation",children:[Object(v.jsx)("span",{className:"typingCircle"}),Object(v.jsx)("span",{className:"typingCircle"}),Object(v.jsx)("span",{className:"typingCircle"})]})]}):null},An=function(e){var t=e.sender,n=e.isGroup,c=e.message,a=e.showUnseenCircle,r=void 0!==a&&a,i=e.messageLen,o=void 0===i?30:i,u=(e.chatId,e.typing),b=void 0!==u&&u,h=S().currentUser,f=Object(s.useState)(""),O=Object(j.a)(f,2),p=O[0],g=O[1],x=Object(s.useState)(!1),y=Object(j.a)(x,2),w=y[0],C=y[1],N=Object(s.useState)(""),k=Object(j.a)(N,2),I=k[0],A=k[1],P=[null,Object(v.jsx)(je.u,{}),Object(v.jsx)(de.a,{}),Object(v.jsx)(je.C,{})],L=Object(s.useState)(0),M=Object(j.a)(L,2),T=M[0],R=M[1];function E(){return(E=Object(d.a)(l.a.mark((function e(){var t,n,s,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(A(""),void 0===c){e.next=23;break}if(t=c,A((function(e){return e+t.message})),C(0!==t.message.length),!t.attachedSongs.length){e.next=11;break}return e.next=8,m.collection("songs").doc(t.attachedSongs[0]).get();case 8:n=e.sent.data().name,R(1),g((function(e){return e+n}));case 11:if(!t.attachedAlbums.length){e.next=17;break}return e.next=14,m.collection("playlists").doc(t.attachedAlbums[0]).get();case 14:(s=e.sent).exists?g((function(e){return e+s.data().name})):g((function(e){return e+"Deleted Album "})),R(2);case 17:if(!t.attachedAuthors.length){e.next=23;break}return e.next=20,m.collection("users").doc(t.attachedAuthors[0]).get();case 20:a=e.sent.data().displayName,R(3),g((function(e){return e+a}));case 23:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){!function(){E.apply(this,arguments)}()}),[c.id]),b?Object(v.jsx)(In,{typingPeople:[t.uid]}):Object(v.jsxs)("div",{className:"messageShowOutside",children:[Object(v.jsxs)("span",{style:c.sender===h.uid||t&&n?{marginRight:"5px"}:{},children:[" ","".concat(c.sender===h.uid?"You: ":n&&t?t.displayName+": ":"")]}),dt(I,o),w&&p.length?Object(v.jsx)(an.a,{}):null,P[T],p,r&&Object(v.jsx)(kn,{listOfSeen:c.seenBy})]})};function Pn(e,t){return e.reduce((function(e,n){return n.sender===t.uid||void 0===n.seenBy||n.seenBy.includes(t.uid)?e:++e}),0)}var Ln=function(e){var t=Object(s.useState)(!1),n=Object(j.a)(t,2),c=n[0],a=n[1];return Object(s.useEffect)((function(){var t=m.collection("users").doc(e).onSnapshot((function(t){if(void 0!==e){var n=(new Date).getTime()-3e5,s=t.data().online>n;a(s)}}));return function(){t()}}),[e]),c},Mn=function(e){var t=e.userUID;return Ln(t)?Object(v.jsx)("div",{className:"onlineCircle"}):null},Tn=function(e){var t=e.chatData,n=S().currentUser,c=t.chatName,a=t.chatImage,r=t.participants,o=Object(s.useState)({}),u=Object(j.a)(o,2),b=u[0],h=u[1],f=Object(s.useState)(0),O=Object(j.a)(f,2),p=O[0],g=O[1],x=Object(s.useState)(t.messages),y=Object(j.a)(x,2),w=y[0],C=y[1],N=Object(s.useState)(!1),k=Object(j.a)(N,2),I=k[0],A=k[1];function P(){return(P=Object(d.a)(l.a.mark((function e(){var t,s,a,i,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c){e.next=8;break}return t=r.find((function(e){return e!==n.uid})),e.next=4,m.collection("users").doc(t).get();case 4:s=e.sent.data(),h(s),e.next=13;break;case 8:return i=null===(a=w[w.length-1])||void 0===a?void 0:a.sender,e.next=11,m.collection("users").doc(i).get();case 11:o=e.sent.data(),h(o);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){m.collection("chats").doc(t.id).onSnapshot((function(e){C(e.data().messages),A(!!e.data().typing.length)}))}),[]),Object(s.useEffect)((function(){g(Pn(w,n))}),[]),Object(s.useEffect)((function(){!function(){P.apply(this,arguments)}()}),[]),t?Object(v.jsx)(i.b,{to:"/chat/".concat(t.id),children:Object(v.jsxs)("div",{className:"ChatItem "+(p>0?"unseen":""),children:[Object(v.jsx)("div",{className:"chatItemImage",children:Object(v.jsx)("img",{loading:"lazy",src:a||b.photoURL,alt:""})}),!c&&Object(v.jsx)(Mn,{userUID:b.uid}),Object(v.jsxs)("div",{style:{width:"100%"},children:[Object(v.jsxs)("h4",{style:{display:"flex",justifyContent:"space-between",width:"100%"},children:[Object(v.jsx)("span",{children:c||b.displayName}),Object(v.jsxs)("div",{children:[w.length?Object(v.jsx)("span",{style:{opacity:".6",fontWeight:"500",fontSize:".8em"},children:Q(w[w.length-1].sentTime,t&&Date.now()-new Date(w[w.length-1].sentTime).getTime()>86e6?0:2)}):null,Object(v.jsx)(Nn,{amountOfUnseen:p})]})]}),w.length?Object(v.jsx)("p",{style:w[w.length-1].sender!==n.uid?{color:"#fff"}:{},children:Object(v.jsx)(An,{sender:b,isGroup:c.length,message:w[w.length-1],showUnseenCircle:!0,typing:I})}):null]})]})}):null},Rn=function(){var e=S().currentUser,t=re().toggleModal,n=ue().yourFriends,c=Object(s.useState)(""),a=Object(j.a)(c,2),r=a[0],i=a[1],u=Object(s.useState)(n),l=Object(j.a)(u,2),d=l[0],b=l[1],h=Object(s.useState)([]),f=Object(j.a)(h,2),O=f[0],p=f[1],m=Object(s.useState)(""),g=Object(j.a)(m,2),x=g[0],v=g[1],y=Object(s.useState)(""),w=Object(j.a)(y,2),C=w[0],N=w[1],k=Object(s.useState)(""),I=Object(j.a)(k,2),A=(I[0],I[1]),P=Ze(),L=Object(o.g)(),M=Object(s.useState)(!1),T=Object(j.a)(M,2),R=T[0],E=T[1],B=Object(s.useState)(0),D=Object(j.a)(B,2),F=D[0],U=D[1],H=Object(s.useState)(!1),V=Object(j.a)(H,2),z=V[0],Y=V[1];Object(s.useEffect)((function(){O.length>=1&&tt(O,e,E,U)}),[O]),Object(s.useEffect)((function(){0===C.length||0===O.length?Y(!1):Y(!0),A("")}),[O.length,C]);return{searchValue:r,setSearchValue:i,foundFriends:d,setFoundFriends:b,chosenFriends:O,setChosenFriends:p,chatName:C,setChatName:N,setChatCover:v,handleCreateChat:function(){R?z?et([e.uid].concat(Object(W.a)(O)),P,C,x,[e.uid]).then((function(){L.push("/chat/".concat(P)),t()})):A("Chat has to have a name"):(L.push("/chat/".concat(F)),t())},shouldCreate:R,allowedToCreate:z}},En=function(){var e=Rn(),t=e.searchValue,n=e.setSearchValue,s=e.foundFriends,c=e.setFoundFriends,a=e.chosenFriends,r=e.setChosenFriends,i=e.chatName,o=e.setChatName,u=e.setChatCover,l=e.handleCreateChat,d=e.shouldCreate,j=e.allowedToCreate;return Object(v.jsxs)("div",{className:"CreateChat",children:[Object(v.jsx)(Re,{value:t,setValue:n,setResultAuthorList:c,focus:!0,inputText:"Search for friends",defaultSearchMode:"authors"}),Object(v.jsx)($e,{listOfPeople:s,chosenArray:a,setChosenArray:r,lastSeen:!0}),a.length>1&&d&&Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(me,{title:"Chat name",value:i,setValue:o,placeholder:"Enter chat name"}),Object(v.jsx)(Wt,{title:"Chat image",text:"Download chat image",place:"chatCovers/",setItemSrc:u,setImageLocalPath:function(){return null}})]}),Object(v.jsx)(ve,{text:d?"Create Chat":"Go to chat",action:l,isActive:a.length>0&&(d&&j||!d)})]})},Bn=function(){var e=Object(s.useState)([]),t=Object(j.a)(e,2),n=t[0],c=t[1],a=re(),r=a.toggleModal,i=a.setContent,o=S().currentUser,u=Object(s.useState)(!0),l=Object(j.a)(u,2),d=l[0],b=l[1];return Object(s.useEffect)((function(){se(o.chats,"chats",c,(function(e){return e.sort((function(e,t){if(e.messages.length&&t.messages.length)return new Date(t.messages[t.messages.length-1].sentTime).getTime()-new Date(e.messages[e.messages.length-1].sentTime).getTime()}))}),(function(){return b(!1)}))}),[]),Object(v.jsx)("div",{style:{animation:"zoomIn .2s forwards",minHeight:"100%"},children:Object(v.jsxs)(_t,{children:[Object(v.jsx)("div",{style:{marginBottom:"10px",display:"flex",alignItems:"start",width:"100%"},children:Object(v.jsxs)("button",{className:"standartButton",onClick:function(){r(),i(Object(v.jsx)(En,{}))},children:[Object(v.jsx)(je.w,{}),"Create chat"]})}),d?Object(v.jsx)(M,{}):Object(v.jsx)("div",{className:"chatsWrapper",children:n.length?n.map((function(e,t){return Object(v.jsx)(Tn,{chatData:e},t)})):Object(v.jsx)("h3",{children:"No chats"})})]})})},Dn=function(e){var t=e.date;return Object(v.jsx)("div",{className:"DateOnTop",children:Q(t)})},Fn=function(e){var t=S().currentUser,n=Object(s.useState)({}),c=Object(j.a)(n,2),a=c[0],r=c[1],i=Object(s.useState)(e.chatName?[]:e.imageColors),o=Object(j.a)(i,2),u=o[0],b=o[1];function h(){return(h=Object(d.a)(l.a.mark((function n(){var s,c;return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s=e.participants.find((function(e){return e!==t.uid})),n.next=3,m.collection("users").doc(s).get();case 3:c=n.sent.data(),r(c),b(c.imageColors);case 6:case"end":return n.stop()}}),n)})))).apply(this,arguments)}return Object(s.useEffect)((function(){e.chatName.length||function(){h.apply(this,arguments)}()}),[e.id]),[a,u]},Un=n(67),Wn=function(){var e=Object(d.a)(l.a.mark((function e(t,n){var s,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("chats").doc(t).get();case 2:s=e.sent.data(),c=s.participants.filter((function(e){return e!==n.uid})),nt(t,s,"soundbubble","".concat(n.displayName," left the chat")),m.collection("chats").doc(t).update({participants:c});case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Hn=function(e){var t=e.chat,n=e.user,s=S().currentUser,c=re(),a=c.openConfirm,r=c.closeConfirm,i=c.setContent,o=s.uid===n.uid;return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(Qe,{text:o?"quit chat":"kick"}),Object(v.jsx)(fe,{onClick:function(){return a("Are you sure you want to ".concat(o?"leave":"kick ".concat(n.displayName," ")," from this chat?"),"Yes","No",(function(){Wn(t.id,n),r(),i(Object(v.jsx)(Qn,{data:t}))}))},icon:o?Object(v.jsx)(je.p,{}):Object(v.jsx)(je.G,{})})]})},Vn=function(e){var t=e.chatId,n=Object(s.useState)([]),c=Object(j.a)(n,2),a=c[0],r=c[1],i=Object(s.useState)(!0),o=Object(j.a)(i,2),u=o[0],b=o[1],h=Object(s.useState)(0),f=Object(j.a)(h,2),O=f[0],p=f[1],g=[Object(v.jsx)(Ct,{listOfSongs:a,source:{source:"/chat/".concat(t),name:"Chat with ".concat(t),image:"",songsList:a}}),Object(v.jsx)(On,{listOfAuthors:a}),Object(v.jsx)(ln,{listOfAlbums:a,loading:u})];function x(e,t){return y.apply(this,arguments)}function y(){return(y=Object(d.a)(l.a.mark((function e(n,s){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("chats").doc(t).get();case 2:e.sent.data().messages.forEach((function(e){e[n].length>0&&se(e[n],s,r,(function(e){return e}),(function(){return b(!1)}),void 0,1)}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){switch(O){case 0:x("attachedSongs","songs").then((function(){return b(!1)}));break;case 1:x("attachedAuthors","users").then((function(){return b(!1)}));break;case 2:x("attachedAlbums","playlists").then((function(){return b(!1)}))}}),[O]),Object(s.useEffect)((function(){r([])}),[t]),Object(v.jsxs)("div",{className:"AttachmentList",children:[Object(v.jsx)(Sn,{pages:["Songs","Authors","Playlists"],currentPage:O,setCurrentPage:function(e){p(e),b(!0),r([])}}),u?Object(v.jsx)(M,{}):a.length>0?g[O]:Object(v.jsx)("h2",{children:"Nothing here"})]})},zn=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"uid",s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return s?e.filter((function(e){return!t.includes(e[n])})):e.filter((function(e){return t.includes(e[n])}))},Yn=function(){var e=Object(d.a)(l.a.mark((function e(t,n,s,c){var a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(!0),c(!1),e.next=4,m.collection("chats").doc(t).get();case 4:a=e.sent.data(),r=a.participants,n.forEach((function(e){return r.push(e.uid)})),m.collection("chats").doc(t).update({participants:r}),n.forEach((function(e){var n=e.uid,s=e.chats;m.collection("users").doc(n).update({chats:[].concat(Object(W.a)(s),[t])})})),nt(t,a,"soundbubble","".concat(n.map((function(e){return e.displayName}))," entered the chat")),s(!1),c(!0);case 12:case"end":return e.stop()}}),e)})));return function(t,n,s,c){return e.apply(this,arguments)}}(),qn=function(e){var t=e.chat,n=ue().yourFriends,c=Object(s.useState)(""),a=Object(j.a)(c,2),r=a[0],i=a[1],o=Object(s.useState)([]),u=Object(j.a)(o,2),l=u[0],d=u[1],b=Object(s.useState)(!1),h=Object(j.a)(b,2),f=h[0],O=h[1],p=Object(s.useState)(!1),m=Object(j.a)(p,2),g=m[0],x=m[1],y=zn(n,t.participants),S=Object(s.useState)([]),w=Object(j.a)(S,2),C=w[0],N=w[1];return Object(v.jsxs)("div",{children:[Object(v.jsx)(Re,{value:r,setValue:i,setResultAuthorList:d,defaultSearchMode:"authors",defaultAuthorsListValue:y}),Object(v.jsx)($e,{listOfPeople:l,chosenArray:C,setChosenArray:N,lastSeen:!0}),!!C.length&&Object(v.jsx)(ve,{text:"Add ".concat(C.length," friends"),action:function(){return Yn(t.id,zn(n,C,"uid",!1),O,x)},isLoading:f,completed:g,setCompleted:x,bottomMessage:"".concat(C.length," friends have been added to ").concat(t.chatName)})]})},Qn=function(e){var t=e.data,n=S().currentUser,c=Object(s.useState)([]),a=Object(j.a)(c,2),r=a[0],i=a[1],o=Object(s.useState)(!0),u=Object(j.a)(o,2),b=u[0],h=u[1],f=Object(s.useState)(t.chatName),O=Object(j.a)(f,2),g=O[0],x=O[1],y=Object(s.useState)(t.chatImage),w=Object(j.a)(y,2),C=w[0],N=w[1],k=Object(s.useState)(""),I=Object(j.a)(k,2),A=I[0],P=I[1],L=Object(s.useState)(t.imageColors||[]),T=Object(j.a)(L,2),R=T[0],E=T[1],B=re().setContent,D=Object(s.useState)(0),F=Object(j.a)(D,2),U=F[0],W=F[1],H=Object(s.useState)(!1),V=Object(j.a)(H,2),z=V[0],Y=V[1];function q(){return(q=Object(d.a)(l.a.mark((function e(t,n,s){var c,a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=t.target.files[0],P(URL.createObjectURL(c)),a=p.ref(),r=a.child(n+c.name),e.next=6,r.put(c);case 6:return e.t0=s,e.next=9,r.getDownloadURL();case 9:e.t1=e.sent,(0,e.t0)(e.t1);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){h(!0),se(t.participants,"users",i,(function(e){return e}),(function(){return h(!1)}))}),[t.id]),Object(s.useEffect)((function(){g.trim()!==t.chatName.trim()||C!==t.chatImage?Y(!0):Y(!1)}),[g,C]),Object(s.useEffect)((function(){x(t.chatName)}),[t.id]),Object(s.useEffect)((function(){x(t.chatName),N(t.chatImage)}),[t.chatName,t.chatImage]),Object(v.jsxs)("div",{className:"ChatInfo",children:[Object(v.jsx)(Dt.a,{src:A,getColors:function(e){return E(e)}}),Object(v.jsxs)("div",{className:"chatInfoImageAndName",children:[Object(v.jsxs)("div",{className:"chatInfoImage",children:[Object(v.jsxs)("label",{className:"changePhoto",children:[Object(v.jsx)(be.b,{}),"Change photo",Object(v.jsx)("input",{type:"file",style:{display:"none"},onChange:function(e){return function(e,t,n){return q.apply(this,arguments)}(e,"chatCovers/",N)}})]}),Object(v.jsx)("img",{loading:"lazy",src:C,alt:""})]}),Object(v.jsxs)("div",{children:[Object(v.jsx)(me,{value:g,setValue:x,placeholder:"Enter chat name",required:!0}),Object(v.jsxs)("div",{className:"chatInfoButtons",children:[Object(v.jsxs)("button",{className:"chatInfoButton",children:[Object(v.jsx)(je.z,{}),"Settings"]}),Object(v.jsxs)("button",{className:"chatInfoButton",onClick:function(){return B(Object(v.jsx)(Vn,{chatId:t.id}))},children:[Object(v.jsx)(ge.a,{}),dt("Attachments",7)]}),Object(v.jsxs)("button",{className:"chatInfoButton",children:[Object(v.jsx)(Un.b,{}),"Sound"]})]})]}),z?Object(v.jsx)("button",{className:"standartButton",onClick:function(){m.collection("chats").doc(t.id).update({chatName:g,chatImage:C,imageColors:R})},children:"Update Chat"}):null]}),Object(v.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[Object(v.jsx)("h4",{children:"Chat participants"}),Object(v.jsx)(fe,{text:"Add",icon:Object(v.jsx)(je.E,{}),onClick:function(){return B(Object(v.jsx)(qn,{chat:t}))}})]}),Object(v.jsx)(Sn,{pages:["All participants","Administrators"],currentPage:U,setCurrentPage:W}),b?Object(v.jsx)(M,{}):r.map((function(e){return 1!==U?Object(v.jsx)(J,{data:e,lastSeen:!0,rightButton:e.uid===n.uid?Object(v.jsx)(Hn,{chat:t,user:n}):t.admins.includes(n.uid)?Object(v.jsx)(Hn,{chat:t,user:e}):null},e.uid):t.admins.includes(e.uid)?Object(v.jsx)(J,{data:e,lastSeen:!0},e.uid):void 0}))]})},Gn=function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection(t).get();case 2:return n=e.sent.docs.map((function(e){return e.data()})),e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Kn=function(e){var t=e.chatId,n=e.image,s=e.currentWallpaper;return Object(v.jsx)("div",{className:"WallpaperItem "+(n===s?"active":""),onClick:function(){m.collection("chats").doc(t).update({wallpaper:n})},style:"undefined"===n?{background:"var(--playlistsColor)"}:{},children:"undefined"!==n?Object(v.jsx)("img",{loading:"lazy",src:n,alt:""}):null})},Xn=function(e){var t=e.chatId,n=e.currentWallpaper,c=Object(s.useState)([]),a=Object(j.a)(c,2),r=a[0],i=a[1];return Object(s.useEffect)((function(){Gn("chatWallpapers").then((function(e){return i(e)}))}),[]),r?Object(v.jsxs)("div",{className:"Wallpapers",children:[Object(v.jsx)("h2",{children:"Wallpapers"}),Object(v.jsxs)("div",{className:"wallpapreWrapper",children:[Object(v.jsx)(Kn,{chatId:t,image:"undefined"}),r.map((function(e,s){return Object(v.jsx)(Kn,{chatId:t,image:e.image,currentWallpaper:n},e.id)}))]})]}):Object(v.jsx)(M,{})},Jn=function(e){var t=e.chatId,n=e.currentWallpaper,c=e.data,a=Object(s.useState)(),r=Object(j.a)(a,2),i=r[0],o=r[1],u=re(),l=u.toggleModal,d=u.setContent,b=Object(s.useRef)(null);return Te(b,o),Object(v.jsxs)("div",{className:"ChatMoreBtn",ref:b,children:[Object(v.jsx)("button",{onClick:function(){return o(!i)},children:Object(v.jsx)(je.s,{})}),Object(v.jsxs)("div",{className:"chatHeaderMenuWindow",style:i?{}:{display:"none"},children:[c.participants.length>2?Object(v.jsxs)("div",{className:"chatHeaderMenuWindowItem",onClick:function(){l(),d(Object(v.jsx)(Qn,{data:c}))},children:[Object(v.jsx)(je.o,{}),Object(v.jsx)("span",{children:"Info"})]}):null,Object(v.jsxs)("div",{className:"chatHeaderMenuWindowItem",onClick:function(){l(),d(Object(v.jsx)(Vn,{chatId:t}))},children:[Object(v.jsx)(je.k,{}),Object(v.jsx)("span",{children:"Attachments"})]}),Object(v.jsxs)("div",{className:"chatHeaderMenuWindowItem",onClick:function(){l(),d(Object(v.jsx)(Xn,{chatId:t,currentWallpaper:n}))},children:[Object(v.jsx)(je.n,{}),Object(v.jsx)("span",{children:"Change wallpaper"})]})]})]})},_n=function(e){var t=e.data,n=re(),s=n.toggleModal,c=n.setContent,a=Fn(t),r=Object(j.a)(a,2),o=r[0],u=r[1];return Object(v.jsxs)("div",{className:"ChatHeader",style:(null===u||void 0===u?void 0:u.length)?{background:"linear-gradient(45deg, ".concat(u[0],", ").concat(u[1],")")}:{},children:[Object(v.jsx)(Et,{}),0===t.chatName.length?Object(v.jsxs)(i.b,{className:"chatHeaderImageAndName",to:"/authors/".concat(o.uid),children:[Object(v.jsx)("div",{className:"chatHeaderImage",style:{backgroundImage:"url(".concat(o.photoURL||t.chatImage,")")}}),Object(v.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center"},children:[Object(v.jsx)("h4",{children:o.displayName||t.chatName}),Object(v.jsx)(K,{userUID:o.uid})]})]}):Object(v.jsxs)("div",{className:"chatHeaderImageAndName",onClick:function(){s(),c(Object(v.jsx)(Qn,{data:t}))},children:[Object(v.jsx)("div",{className:"chatHeaderImage",style:{backgroundImage:"url(".concat(o.photoURL||t.chatImage,")")}}),Object(v.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center"},children:[Object(v.jsx)("h4",{children:o.displayName||t.chatName}),Object(v.jsx)(K,{userUID:o.uid})]})]}),Object(v.jsx)(Jn,{chatId:t.id,data:t,currentWallpaper:t.wallpaper})]})};function $n(e){return e.attachedSongs.length?"Audio":e.attachedAlbums.length?"Album":e.attachedAuthors.length?"Author":e.inResponseToMessage&&e.inResponseToMessage.length?"Forwarded message":""}var Zn=function(e){var t=e.attachedItems,n=e.setAttachedItems,s=e.icon;return Object(v.jsx)("div",{className:"AttachedItemsInChatInput",children:t.map((function(e,c){return Object(v.jsxs)("div",{className:"attachedSongItem",children:[s,Object(v.jsx)("span",{children:e}),Object(v.jsx)("button",{className:"removeMessageFromResponse",onClick:function(){return function(e,t,n){t(e.filter((function(e){return e!==n})))}(t,n,e)},children:Object(v.jsx)(je.G,{})})]},e)}))})},es=function(e){var t=e.chatId,n=e.chatData,c=e.messageText,a=e.setMessageText,r=e.inResponseToMessage,i=e.setInResponseToMessage,o=e.otherMessages,u=S().currentUser,b=Object(s.useState)(!1),h=Object(j.a)(b,2),f=h[0],O=h[1],p=ue(),g=p.yourSongs,x=p.yourAuthors,y=p.yourPlaylists,w=Object(s.useState)(""),C=Object(j.a)(w,2),N=C[0],k=C[1],I=Object(s.useState)(g),A=Object(j.a)(I,2),P=A[0],L=A[1],M=Object(s.useState)([]),T=Object(j.a)(M,2),R=T[0],E=T[1],B=Object(s.useState)([]),D=Object(j.a)(B,2),F=D[0],U=D[1],H=Object(s.useState)([]),V=Object(j.a)(H,2),z=V[0],Y=V[1],q=Object(s.useState)(y),Q=Object(j.a)(q,2),G=Q[0],K=Q[1],X=Object(s.useState)(x),J=Object(j.a)(X,2),_=J[0],$=J[1],Z=Object(s.useState)([]),ee=Object(j.a)(Z,2),te=ee[0],ne=ee[1],se=Object(s.useState)([]),ce=Object(j.a)(se,2),ae=ce[0],re=ce[1],ie=Object(s.useRef)(null);function oe(){nt(t,n,u.uid,c,R,F,z,r),a(""),E([]),Y([]),U([]),i([]),O(!1)}return Te(ie,O),Object(s.useEffect)((function(){0===N.length&&L(g)}),[N]),Object(s.useEffect)((function(){if(0===c.length)m.collection("chats").doc(t).update({typing:n.typing.filter((function(e){return e!==u.uid}))});else if(!n.typing.includes(u.uid)){var e=n.typing;e.push(u.uid),m.collection("chats").doc(t).update({typing:e})}}),[c]),Object(s.useEffect)((function(){ne([]),r.forEach(function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(o[t].sender).get();case 2:n=e.sent.data().displayName,ne((function(e){return[].concat(Object(W.a)(e),[n])}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[r.length]),Object(s.useEffect)((function(){re([]),R.forEach(function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("songs").doc(t).get();case 2:n=e.sent.data().name,re((function(e){return[].concat(Object(W.a)(e),[n])}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[R.length]),Object(v.jsxs)("div",{className:"chatInput",style:f?{borderRadius:"0 0 var(--standartBorderRadius) var(--standartBorderRadius)",transition:".2s"}:{},ref:ie,children:[Object(v.jsx)("div",{className:"attachWindow",style:f?{height:"400px",opacity:"1"}:{},children:f?Object(v.jsxs)("div",{style:f?{maxHeight:"100%",overflow:"hidden",display:"flex",flexDirection:"column"}:{display:"none"},children:[Object(v.jsx)(Re,{value:N,setValue:k,setAllFoundSongs:L,setResultPlaylists:K,setResultAuthorList:$}),Object(v.jsxs)("div",{style:{height:"100%",overflowY:"auto"},children:[Object(v.jsx)(Ct,{listOfSongs:P,source:"no",listOfChosenSongs:R,setListOfSongs:E}),Object(v.jsx)(On,{listOfAuthors:_,listOfChosenAuthors:z,setListOfChosenAuthors:Y}),Object(v.jsx)(ln,{listOfAlbums:G,loading:!1,listOfChosenAlbums:F,setListOfChosenAlbums:U})]})]}):null}),Object(v.jsxs)("div",{className:"inResponseArea",style:r.length||ae.length||z.length||F.length?{}:{height:"0",padding:"0",opacity:"0",top:"0",visibility:"hidden"},children:[Object(v.jsx)("div",{className:"responseMessages",children:r.map((function(e,t){return Object(v.jsxs)("div",{className:"responseItem",children:[Object(v.jsx)("h5",{style:o[e].sender===u.uid?{color:"var(--lightPurple)"}:{},children:te[t]}),Object(v.jsxs)("p",{children:[dt(o[e].message,35),Object(v.jsx)("span",{style:{marginLeft:"5px",color:"var(--reallyLightBlue)"},children:$n(o[e])})]}),Object(v.jsx)("button",{onClick:function(){return t=e,void i(r.filter((function(e){return e!==t})));var t},className:"removeMessageFromResponse",children:Object(v.jsx)(je.G,{})})]},e)}))}),Object(v.jsx)(Zn,{attachedItems:R,setAttachedItems:E,icon:Object(v.jsx)(Xe.c,{})}),Object(v.jsx)(Zn,{attachedItems:z,setAttachedItems:Y,icon:Object(v.jsx)(je.C,{})}),Object(v.jsx)(Zn,{attachedItems:F,setAttachedItems:U,icon:Object(v.jsx)(de.a,{})})]}),Object(v.jsxs)("div",{className:"attachAndEmojis",children:[Object(v.jsx)("div",{className:"attachBtn",children:Object(v.jsx)("button",{onClick:function(){O(!f)},children:Object(v.jsx)(ge.a,{})})}),Object(v.jsx)("input",{type:"text",style:{background:"var(--lightGrey)",border:"none",outline:"none",minHeight:"100%"},value:c,onChange:function(e){a(e.target.value)},onKeyDown:function(e){"Enter"===e.key&&oe()}})]}),Object(v.jsx)("button",{className:"sendBtn",onClick:function(){oe()},children:Object(v.jsx)(be.d,{})})]})},ts=n(51),ns=function(){return Object(v.jsx)("div",{className:"SongItem SongItemLoading",children:Object(v.jsxs)("div",{className:"songItemImageAndName",children:[Object(v.jsx)("div",{className:"songItemImage"}),Object(v.jsxs)("div",{className:"songItemNameAndAuthor",children:[Object(v.jsx)("div",{className:"songItemName"}),Object(v.jsx)("div",{className:"songItemAuthor"})]})]})})};function ss(e){var t=Object(s.useState)(!1),n=Object(j.a)(t,2),c=n[0],a=n[1],r=new IntersectionObserver((function(e){var t=Object(j.a)(e,1)[0];return a(t.isIntersecting)}));return Object(s.useEffect)((function(){return r.observe(e.current),function(){r.disconnect()}}),[]),c}var cs,as,rs,is,os,us,ls,ds,js,bs,hs,fs=function(e,t,n){var c=Object(s.useRef)(),a=ss(c),r=S().currentUser;return Object(s.useEffect)((function(){if(void 0!==t.seenBy&&r.uid!==t.sender&&a&&!t.seenBy.includes(r.uid)){var s=n;s[t.id].seenBy.push(r.uid),m.collection("chats").doc(e).update({messages:s})}}),[a]),[c,a]},Os=function(e){var t=e.messageData,n=e.chatId,c=e.scrollToMessageRef,a=e.setScrollToMessageId,r=e.scrollToMessageId,i=e.showPhoto,o=void 0===i||i,u=e.otherMessages,b=e.inResponseToMessageArr,h=e.setInResponseToMessageArr,f=S().currentUser,O=Ye(),p=O.isMobile,g=O.screenHeight,x=t.message,y=t.attachedAlbums,w=t.attachedSongs,C=t.attachedAuthors,N=t.sender,k=t.inResponseToMessage,I=t.id,A=t.sentTime,P=Object(s.useState)({}),L=Object(j.a)(P,2),M=L[0],T=L[1],R=Q(A,2),E=Object(s.useState)([]),B=Object(j.a)(E,2),D=B[0],F=B[1],U=Object(s.useState)([]),H=Object(j.a)(U,2),V=H[0],z=H[1],Y=Object(s.useState)([]),q=Object(j.a)(Y,2),G=q[0],K=q[1],X=Object(s.useState)([]),J=Object(j.a)(X,2),_=J[0],$=J[1],Z=Object(s.useState)([]),ee=Object(j.a)(Z,2),te=ee[0],ne=ee[1],se=fs(n,t,u),ce=Object(j.a)(se,2),ae=ce[0],re=ce[1],ie=Object(s.useState)(0),oe=Object(j.a)(ie,2),ue=oe[0],le=oe[1],je=Object(s.useState)(0),be=Object(j.a)(je,2),he=be[0],fe=be[1],Oe=Object(ts.useSwipeable)({onSwiping:function(e){e.deltaX<0&&le(e.deltaX)}});function pe(){return(pe=Object(d.a)(l.a.mark((function e(){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(t.sender).get();case 2:n=e.sent.data(),T(n);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function me(e,t,n){return e.forEach(function(){var e=Object(d.a)(l.a.mark((function e(s){var c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection(t).doc(s).get();case 2:(c=e.sent).exists?n((function(e){return[].concat(Object(W.a)(e),[c.data()])})):n((function(e){return[].concat(Object(W.a)(e),[null])}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}function ge(){b.includes(I)||h((function(e){return[].concat(Object(W.a)(e),[I])}))}function xe(){var e;clearTimeout(e),fe(.2),e=setTimeout((function(){le(0),fe(0)}),200)}return Object(s.useEffect)((function(){!function(){pe.apply(this,arguments)}(),me(w,"songs",F),me(C,"users",z),me(y,"playlists",K),null!==k&&k.forEach(function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return $((function(e){return[].concat(Object(W.a)(e),[u[t]])})),e.next=3,m.collection("users").doc(u[t].sender).get();case 3:n=e.sent.data().displayName,ne((function(e){return[n].concat(Object(W.a)(e))}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]),Object(s.useEffect)((function(){ue<-160&&(xe(),ge())}),[ue]),Object(v.jsxs)("div",{className:"MessageItem "+(N===f.uid?"your":""),ref:I===r?c:function(e){Oe.ref(e),ae.current=e},style:o?{paddingBottom:"15px",transform:"translateX(".concat(ue,"px)"),transition:he}:{transform:"translateX(".concat(ue,"px)"),transition:he},onTouchEnd:xe,children:[Object(v.jsx)("div",{className:"messageItemImage",children:o?Object(v.jsx)("img",{loading:"lazy",src:M.photoURL,alt:""}):null}),Object(v.jsxs)("div",{className:"messageItemBody",style:I===r?{animation:"showResponseMessage .5s forwards"}:o?{borderRadius:"var(--standartBorderRadius2) var(--standartBorderRadius) var(--standartBorderRadius) 5px"}:{},children:[Object(v.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"5px"},children:[Object(v.jsx)("h5",{className:"messageUserName",children:M.displayName}),Object(v.jsx)("div",{style:{fontSize:".7em",opacity:".8",marginLeft:"10px"},children:R})]}),null!==k?_.map((function(e,t){return Object(v.jsxs)("div",{className:"responseItem",onClick:function(){return a(e.id)},children:[Object(v.jsxs)("span",{style:{display:"flex",alignItems:"center"},children:[Object(v.jsx)("h5",{style:e.sender===f.uid?{color:"var(--lightPurple)"}:{},children:te[t]}),Object(v.jsx)("div",{style:{fontSize:".7em",opacity:".8",marginLeft:"10px"},children:Q(e.sentTime,2)})]}),Object(v.jsxs)("p",{children:[e.message,Object(v.jsx)("span",{style:{marginLeft:"5px",color:"var(--reallyLightBlue)"},children:$n(e)})]})]})})):null,Object(v.jsxs)("div",{children:[Object(v.jsx)("p",{children:x}),D.map((function(e,t){return re?Object(v.jsx)(yt,{song:e,localIndex:t,position:g},t):Object(v.jsx)(ns,{})})),G.map((function(e,t){return Object(v.jsx)(un,{playlist:e},t)})),V.map((function(e,t){return Object(v.jsx)(fn,{data:e},t)}))]})]}),Object(v.jsx)(kn,{listOfSeen:t.seenBy}),Object(v.jsx)("button",{className:"respondToMessageBtn",onClick:ge,style:p?{opacity:-ue/80}:{},children:Object(v.jsx)(de.o,{})})]})},ps=function(e){var t=e.message,n=e.index,c=e.messageList,a=e.chatId,r=e.inResponseToMessage,i=e.setInResponseToMessage,o=e.scrollToMessageRef,u=e.scrollToMessageId,l=e.setScrollToMessageId,d=e.setDateRefsArray,b=Object(s.useState)(!1),h=Object(j.a)(b,2),f=h[0],O=h[1],p=Object(s.useState)(!1),m=Object(j.a)(p,2),g=m[0],x=m[1],y=Object(s.useRef)(null);return Object(s.useEffect)((function(){(n===c.length-1||c[n+1].sender!==c[n].sender||Q(c[n+1].sentTime)!==Q(c[n].sentTime))&&O(!0),(0===n||Q(c[n].sentTime)!==Q(c[n-1].sentTime))&&x(!0)}),[]),Object(s.useEffect)((function(){null!==y.current&&d((function(e){return[].concat(Object(W.a)(e),[y])}))}),[g]),Object(v.jsxs)(v.Fragment,{children:[g?Object(v.jsx)("div",{ref:y,style:{width:"100%",display:"flex",justifyContent:"center",alignItems:"center",padding:"10px 0"},children:Q(t.sentTime)}):null,Object(v.jsx)(Os,{messageData:t,chatId:a,scrollToMessageRef:o,scrollToMessageId:u,setScrollToMessageId:l,showPhoto:f,otherMessages:c,inResponseToMessageArr:r,setInResponseToMessageArr:i},t.id)]})},ms=z.a.div(cs||(cs=Object(U.a)(["\n  width: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  opacity: 0.5;\n"]))),gs=function(e){var t=e.chatId,n=e.message,s=e.messageList,c=fs(t,n,s),a=Object(j.a)(c,2),r=a[0];a[1];return Object(v.jsx)(ms,{ref:r,children:n.message})},xs=function(e){var t=e.chatId,n=e.messageList,c=e.inResponseToMessage,a=e.setInResponseToMessage,r=e.messagesWindowRef,i=e.setDateRefsArray,o=Object(s.useRef)(null),u=Object(s.useState)(-1),l=Object(j.a)(u,2),d=l[0],b=l[1];return Object(s.useEffect)((function(){-1!==d&&(r.current.scrollTo(0,o.current.offsetTop-65<0?0:o.current.offsetTop-65),setTimeout((function(){b(-1)}),500))}),[d]),n.length?Object(v.jsx)(v.Fragment,{children:n.map((function(e,s){return"soundbubble"!==e.sender?Object(v.jsx)(ps,{message:e,index:s,messageList:n,chatId:t,inResponseToMessage:c,setInResponseToMessage:a,scrollToMessageRef:o,scrollToMessageId:d,setScrollToMessageId:b,setDateRefsArray:i},e.id):Object(v.jsx)(gs,{chatId:t,message:e,messageList:n})}))}):null},vs=function(e){var t=e.chatId,n=e.chatData,c=e.messageList,a=e.findTopDate,r=e.inResponseToMessage,i=e.setInResponseToMessage,o=e.setDateRefsArray,u=Ye(),l=u.screenHeight,d=(u.isMobile,Object(s.useRef)(null));return Object(s.useEffect)((function(){setTimeout((function(){!function(){var e,t,n,s=(null===(e=d.current)||void 0===e?void 0:e.scrollHeight)-(null===(t=d.current)||void 0===t?void 0:t.clientHeight);null===(n=d.current)||void 0===n||n.scrollTo(0,s)}()}),200)}),[c]),Object(v.jsxs)("div",{className:"chatMessagesWindow",ref:d,onScroll:a,style:{height:l-105+"px"},children:[Object(v.jsx)(xs,{chatId:t,messageList:c,inResponseToMessage:r,setInResponseToMessage:i,messagesWindowRef:d,setDateRefsArray:o}),Object(v.jsx)(In,{typingPeople:n.typing})]})},ys=function(){var e=Object(o.h)("/chat/:chatId"),t=S().currentUser,n=e.params.chatId,c=Object(s.useState)(""),a=Object(j.a)(c,2),r=a[0],i=a[1],u=Object(s.useState)([]),l=Object(j.a)(u,2),d=l[0],b=l[1],h=Object(s.useState)([]),f=Object(j.a)(h,2),O=f[0],p=f[1],g=Object(o.g)(),x=function(e,t){var n=Object(s.useState)(null),c=Object(j.a)(n,2),a=c[0],r=c[1],i=Object(s.useState)([]),o=Object(j.a)(i,2),u=o[0],l=o[1],d=Object(s.useState)(!0),b=Object(j.a)(d,2),h=b[0],f=b[1],O=Object(s.useState)(""),p=Object(j.a)(O,2),g=p[0],x=p[1];return Object(s.useEffect)((function(){var t=m.collection("chats").doc(e).onSnapshot((function(e){var t,n;r(e.data()),l(null===(t=e.data())||void 0===t?void 0:t.messages),x((null===(n=e.data())||void 0===n?void 0:n.messages.length)?e.data().messages[0].sentTime:(new Date).toString()),f(!1)}));return function(){t()}}),[m,e]),[a,u,h,g,function(e){t.forEach((function(t){null!==t.current&&t.current.offsetTop-70<=e.target.scrollTop&&x(t.current.innerHTML)}))}]}(n,O),y=Object(j.a)(x,5),w=y[0],C=y[1],N=y[2],k=y[3],I=y[4];return Object(s.useEffect)((function(){void 0===w?g.push("/not-found"):void 0!==(null===w||void 0===w?void 0:w.participants)&&(w.participants.includes(t.uid)||g.push("/chat"))}),[w]),null!==w&&void 0!==w?Object(v.jsxs)("div",{className:"DialoguePage",style:{height:"100%"},children:[N?Object(v.jsx)(M,{top:"50%"}):Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(_n,{data:w}),Object(v.jsx)(Dn,{date:k}),Object(v.jsx)(vs,{chatId:n,chatData:w,messageList:C,findTopDate:I,setDateRefsArray:p,inResponseToMessage:d,setInResponseToMessage:b}),Object(v.jsx)(es,{chatId:n,chatData:w,messageText:r,setMessageText:i,inResponseToMessage:d,setInResponseToMessage:b,otherMessages:C})]}),"undefined"!==(null===w||void 0===w?void 0:w.wallpaper)?Object(v.jsx)("img",{loading:"lazy",src:w.wallpaper,className:"chatWallpaper",alt:""}):null]}):null},Ss=function(){var e=Object(s.useState)([]),t=Object(j.a)(e,2),n=t[0],c=t[1],a=Object(s.useState)([]),r=Object(j.a)(a,2),i=r[0],o=r[1],u=S().currentUser;return Object(s.useEffect)((function(){m.collection("history").doc(u.uid).onSnapshot((function(e){c(e.data().history)}))}),[m]),Object(s.useEffect)((function(){se(n,"songs",o)}),[n]),Object(v.jsx)("div",{className:"HistoryPage",style:{animation:"zoomIn .2s forwards"},children:Object(v.jsxs)(_t,{children:[Object(v.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[Object(v.jsx)(Et,{}),Object(v.jsx)("h2",{style:{margin:"0px",marginLeft:"8px"},children:"History"})]}),Object(v.jsx)(Ct,{listOfSongs:i,source:{source:"/history",name:"History",image:"https://www.seekpng.com/png/full/781-7815113_history-icon-white-png.png",songsList:i},showCount:!0,showSearch:!0,displayIfEmpty:"Nothing here"})]})})},ws=function(){var e=Object(s.useState)([]),t=Object(j.a)(e,2),n=t[0],c=t[1],a=Object(s.useState)(0),r=Object(j.a)(a,2),i=r[0],o=r[1],u=Object(s.useState)(!0),b=Object(j.a)(u,2),h=b[0],f=b[1],O=Object(s.useState)({}),p=Object(j.a)(O,2),g=p[0],x=p[1],y=Object(s.useState)({}),S=Object(j.a)(y,2),w=S[0],C=S[1],N=Object(s.useState)({}),k=Object(j.a)(N,2),I=k[0],A=k[1];function P(e,t,n){return L.apply(this,arguments)}function L(){return(L=Object(d.a)(l.a.mark((function e(t,n,s){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection(n).orderBy(s,"desc").limit(1).get();case 2:a=e.sent.docs[0].data(),t(a),c((function(e){return[].concat(Object(W.a)(e),[a.imageColors[0]])})),"playlists"===n&&f(!1);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){P(x,"users","subscribers"),P(C,"songs","listens"),P(A,"playlists","listens")}),[]),Object(v.jsx)("div",{className:"MainBanner",style:{background:n[i]},children:h?Object(v.jsx)(M,{}):Object(v.jsxs)(v.Fragment,{children:[Object(v.jsxs)("div",{className:"slider",children:[Object(v.jsxs)("div",{className:"sliderItem "+(0===i?"current":""),style:{transform:"translateX(-".concat(100*i,"%)")},children:[Object(v.jsx)("h3",{children:"Most popular artist on platform"}),Object(v.jsx)(fn,{data:g})]}),Object(v.jsxs)("div",{className:"sliderItem "+(1===i?"current":""),style:{transform:"translateX(-".concat(100*i,"%)")},children:[Object(v.jsx)("h3",{children:"Most popular song on platform"}),Object(v.jsx)(yt,{song:w,localIndex:0,showListens:!0})]}),Object(v.jsxs)("div",{className:"sliderItem "+(2===i?"current":""),style:{transform:"translateX(-".concat(100*i,"%)")},children:[Object(v.jsx)("h3",{children:"Most popular album on platform"}),Object(v.jsx)(un,{playlist:I})]})]}),Object(v.jsxs)("div",{className:"sliderBtns",children:[Object(v.jsx)("button",{onClick:function(){return o($(i-1,2,0))},children:Object(v.jsx)(de.c,{})}),Object(v.jsx)("button",{onClick:function(){return o($(i+1,2,0))},children:Object(v.jsx)(de.d,{})})]})]})})},Cs=function(){var e=ue().yourAuthors,t=Object(s.useState)([]),n=Object(j.a)(t,2),c=n[0],a=n[1];return Object(s.useEffect)((function(){void 0!==e&&0!==e.length&&0===c.length&&function(){var t=[];e.forEach((function(e,n){e.ownSongs.forEach(function(){var e=Object(d.a)(l.a.mark((function e(n){var s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("songs").doc(n).get();case 2:nn(s=e.sent.data())&&!t.includes(s.id)&&(a((function(e){return[].concat(Object(W.a)(e),[s])})),t.push(s.id));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}))}()}),[]),Object(v.jsx)("div",{children:Object(v.jsx)(Ct,{listOfSongs:c,source:{source:"/home",name:"New Songs",image:"",songsList:c},title:"New Songs",isNewSong:!0})})},Ns=function(){var e=ue().yourAuthors,t=Object(s.useState)([]),n=Object(j.a)(t,2),c=n[0],a=n[1],r=Object(s.useState)([]),i=Object(j.a)(r,2),o=i[0],u=i[1],l=S().currentUser;return Object(s.useEffect)((function(){void 0!==e&&e.forEach((function(e){bn(e,a)}))}),[]),Object(s.useEffect)((function(){c.forEach((function(e){var t=o.map((function(e){return e.uid}));l.addedAuthors.includes(e.uid)||t.includes(e.uid)||u((function(t){return[].concat(Object(W.a)(t),[e])}))}))}),[c]),Object(v.jsx)("div",{className:"RecommendedAuthors",children:Object(v.jsx)(On,{listOfAuthors:o,title:"Recommended Authors"})})},ks=function(e){var t=e.message,n=e.image,s=e.button;return Object(v.jsx)("div",{className:"importantMessage",children:Object(v.jsxs)("div",{children:[n?Object(v.jsx)("img",{loading:"lazy",src:n,alt:""}):null,Object(v.jsx)("h3",{children:t}),s||null]})})},Is=function(){var e=ue().yourAuthors,t=S().currentUser,n=Object(s.useState)([]),c=Object(j.a)(n,2),a=c[0],r=c[1];return Object(s.useEffect)((function(){!function(){var n=[];e.forEach((function(e,s){e.ownSongs.forEach(function(){var e=Object(d.a)(l.a.mark((function e(s,c){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("songs").doc(s).get();case 2:a=e.sent.data(),!t.addedSongs.includes(s)&&!n.includes(a.id)&&c<=3&&(r((function(e){return[].concat(Object(W.a)(e),[a])})),n.push(a.id));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}))}()}),[]),Object(v.jsx)("div",{className:"RecommendedSongs",children:Object(v.jsx)(Ct,{listOfSongs:a,source:{source:"/home",name:"Recommended Songs",image:"",songsList:a},title:"Recommended Songs",displayIfEmpty:Object(v.jsx)(ks,{message:"No songs recommended. Add favorite authors so we could know what to recommend",image:"https://i.pinimg.com/originals/b2/3d/f6/b23df649311586e74a8455c92eb3d76b.png"})})})},As=function(){var e=Object(s.useState)([]),t=Object(j.a)(e,2),n=t[0],c=t[1],a=Object(s.useState)(!0),r=Object(j.a)(a,2),i=r[0],o=r[1];return Object(s.useEffect)((function(){o(!0),m.collection("songs").orderBy("listens","desc").limit(15).get().then((function(e){e.docs.forEach((function(e){c((function(t){return[].concat(Object(W.a)(t),[e.data()])}))})),o(!1)}))}),[]),i?Object(v.jsx)(M,{}):Object(v.jsx)(Ct,{listOfSongs:n,source:{source:"/home",name:"Top 15 Songs",image:"https://media.istockphoto.com/vectors/fire-icon-illustration-for-design-stock-vector-vector-id931601050?k=6&m=931601050&s=170667a&w=0&h=fhRQfwwsW6aXK9OSDM-yj842SFFl2Q9ll6ch-xCK5es=",songsList:n},title:"Top 15 Songs",showListens:!0,showCount:!0})},Ps=(n(269),function(){return Object(v.jsxs)("div",{style:{animation:"zoomIn .2s forwards"},className:"HomePage",children:[Object(v.jsx)(ws,{}),Object(v.jsxs)(_t,{children:[Object(v.jsx)(Cs,{}),Object(v.jsx)(As,{}),Object(v.jsx)(Is,{}),Object(v.jsx)(Ns,{})]})]})}),Ls=(n(270),function(){var e=ue().yourAuthors,t=Object(s.useState)(""),n=Object(j.a)(t,2),c=n[0],a=n[1],r=Object(s.useState)(e),i=Object(j.a)(r,2),o=i[0],u=i[1];return Object(v.jsx)("div",{className:"AuthorsPage",children:Object(v.jsxs)(_t,{children:[Object(v.jsx)(Re,{value:c,setValue:a,setResultAuthorList:u,defaultSearchMode:"authors",defaultAuthorsListValue:e,inputText:"Search for authors"}),Object(v.jsx)("div",{className:"authorsContainer",children:o.map((function(e){return Object(v.jsx)(fn,{data:e},e.uid)}))})]})})}),Ms=z.a.div(as||(as=Object(U.a)(["\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  background: var(--chatsColor);\n  border-radius: var(--standartBorderRadius);\n  font-weight: 600;\n  cursor: pointer;\n  transition: 0.15s, 0.1s box-shadow;\n\n  & .text {\n    transition: 0.15s;\n    height: 25px;\n  }\n\n  &:hover .add-circle {\n    transform: scale(1.3);\n  }\n\n  &:hover .text {\n    opacity: 0;\n    height: 0;\n  }\n\n  &:hover {\n    transform: scale(0.93);\n  }\n\n  &:active {\n    transform: scale(0.9);\n    box-shadow: 0 0 0 7px #ffffff5e;\n  }\n\n  & .add-circle {\n    width: 60px;\n    height: 60px;\n    border-radius: 100%;\n    background: var(--playlistsColor);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    margin-bottom: 10px;\n    transition: 0.2s;\n\n    svg {\n      width: 30px;\n      height: 30px;\n    }\n  }\n"]))),Ts=function(){var e=re(),t=e.toggleModal,n=e.setContent;return Object(v.jsxs)(Ms,{onClick:function(){t(),n(Object(v.jsx)(vn,{}))},className:"playlistItem",children:[Object(v.jsx)("span",{className:"add-circle",children:Object(v.jsx)(je.w,{})}),Object(v.jsx)("span",{className:"text",children:"Add playlist"})]})},Rs=function(){var e=ue().yourPlaylists,t=Object(s.useState)(e),n=Object(j.a)(t,2),c=n[0],a=n[1],r=Object(s.useState)(""),i=Object(j.a)(r,2),o=i[0],u=i[1];return Object(v.jsx)("div",{className:"PlaylistsPage",children:Object(v.jsxs)(_t,{children:[Object(v.jsx)("div",{style:{display:"flex"},className:"searchAndCreatePlaylist",children:Object(v.jsx)(Re,{value:o,setValue:u,setResultPlaylists:a,defaultSearchMode:"playlists",defaultPlaylistsListValue:e,inputText:"Search for playlist name"})}),Object(v.jsxs)("div",{className:"playlistsContainer",children:[Object(v.jsx)(Ts,{}),c&&c.map((function(e,t){return Object(v.jsx)(un,{playlist:e},e.id)}))]})]})})},Es=function(e){return e<1990&&e>=1780?7:e<1780&&e>=1570?6:e<1570&&e>=1360?5:e<1360&&e>=1150?4:e<1150&&e>=1e3?3:e<1e3&&e>=892?6:e<892&&e>=754?5:e<754&&e>=614?4:e<614&&e>=464?3:2},Bs=n.p+"static/media/wave2.f62cb572.svg",Ds=function(e){var t=e.playlist,n=ue(),c=n.currentSongPlaylistSource,a=n.play,r=Ye().isMobile,o=Object(s.useState)([]),u=Object(j.a)(o,2),l=u[0],d=u[1],b=on(t,l,d);return Object(v.jsx)(i.b,{to:"/albums/".concat(t.id),className:"playlistWrapper",children:Object(v.jsxs)("div",{className:"library playlistItem",style:{backgroundImage:"url(".concat(t.image,")")},children:[Object(v.jsx)("h2",{style:{background:t.imageColors[2]},children:dt(t.name,10)}),t.image?null:Object(v.jsx)(de.a,{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",width:"60px",height:"60px"}}),r?null:Object(v.jsx)("button",{onClick:b,children:c.name===t.name&&a?Object(v.jsx)(an.b,{}):Object(v.jsx)(an.c,{})})]})})},Fs=function(){var e=ue(),t=e.yourSongs,n=e.yourPlaylists,c=S().currentUser,a=Ye().screenWidth,r=re(),i=r.toggleModal,o=r.setContent,u=Object(s.useState)(Es(a)),l=Object(j.a)(u,2),d=l[0],b=l[1];return Object(s.useEffect)((function(){b(Es(a))}),[a]),Object(v.jsxs)("div",{className:"SongsPage",children:[Object(v.jsxs)("div",{className:"playLists",children:[Object(v.jsx)("div",{className:"playlistContent",children:n.length?n.map((function(e,t){if(t<d)return Object(v.jsx)(Ds,{playlist:e},t)})):Object(v.jsxs)("div",{style:{position:"absolute",left:"50%",top:"40%",display:"flex",flexDirection:"column",alignItems:"center",transform:"translate(-50%, -50%)"},children:[Object(v.jsx)("h3",{children:"You don't have playlists"}),Object(v.jsx)(fe,{text:"Add playlist",icon:Object(v.jsx)(je.w,{}),onClick:function(){i(),o(Object(v.jsx)(vn,{}))}})]})}),Object(v.jsx)("div",{className:"playlistsBackground",children:Object(v.jsx)("img",{loading:"lazy",src:Bs,alt:"wave"})})]}),Object(v.jsx)("div",{className:"yourSongsList",children:Object(v.jsx)(Ct,{listOfSongs:t,source:{source:"/library",name:"Your Library",image:c.photoURL,songsList:t},showSearch:!0,showhistory:!0,displayIfEmpty:Object(v.jsx)("h3",{children:"Your library is empty"})})})]})},Us=function(){var e=Object(s.useState)(0),t=Object(j.a)(e,2),n=t[0],c=t[1],a=[Object(v.jsx)(Fs,{}),Object(v.jsx)(Rs,{}),Object(v.jsx)(Ls,{})];return Object(v.jsxs)("div",{className:"LibraryPage",style:{animation:"zoomIn .2s forwards"},children:[Object(v.jsx)(Sn,{pages:["Songs","Playlists","Authors"],currentPage:n,setCurrentPage:c}),a[n]]})},Ws=function(e){var t=e.title;return Object(v.jsxs)("div",{className:"titleAndLogo",children:[Object(v.jsx)("div",{className:"title",children:Object(v.jsx)("h1",{children:t})}),Object(v.jsx)("div",{className:"logo",children:Object(v.jsx)("img",{loading:"lazy",src:R,alt:""})})]})},Hs=function(e){var t=e.errorMessage,n=re().openBottomMessage;return Object(s.useEffect)((function(){t&&n(t,"failure")}),[t]),t&&Object(v.jsx)("div",{className:"Alert",children:t})},Vs=function(){return Object(v.jsxs)("div",{className:"BlurredBg",children:[Object(v.jsx)("div",{className:"circle circle1"}),Object(v.jsx)("div",{className:"circle circle2"}),Object(v.jsx)("div",{className:"circle circle3"}),Object(v.jsx)("div",{className:"circle circle4"}),Object(v.jsx)("div",{className:"circle circle5"})]})},zs=function(){var e=S().login,t=Object(s.useState)(""),n=Object(j.a)(t,2),c=n[0],a=n[1],r=Object(s.useState)(""),o=Object(j.a)(r,2),u=o[0],b=o[1],h=Object(s.useState)(""),f=Object(j.a)(h,2),O=f[0],p=f[1],m=Object(s.useState)(!1),g=Object(j.a)(m,2),x=g[0],y=g[1],w=0!==c.length&&0!==u.length;function C(){return(C=Object(d.a)(l.a.mark((function t(n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),w){t.next=3;break}return t.abrupt("return",p("One of your fields is totaly empty"));case 3:return t.next=5,e(c,u,p,y);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return Object(v.jsxs)("div",{className:"In-Up-Container",children:[Object(v.jsxs)("div",{className:"CentralPlate",children:[Object(v.jsx)(mn,{loading:x}),Object(v.jsx)(Ws,{title:"Log In"}),Object(v.jsx)(Hs,{errorMessage:O}),Object(v.jsxs)("div",{className:"inner-plate-content",children:[Object(v.jsx)(me,{type:"email",placeholder:"Enter your email",value:c,setValue:a,margin:!0}),Object(v.jsx)(me,{type:"password",placeholder:"Enter your password",value:u,setValue:b,margin:!0}),Object(v.jsxs)("div",{className:"inAndUpBtns",children:[Object(v.jsx)("button",{className:"upBtn",disabled:x,onClick:function(e){return C.apply(this,arguments)},children:"Log In"}),Object(v.jsx)(i.b,{to:N,children:Object(v.jsx)("button",{className:"inBtn",children:"Create new account"})})]})]})]}),Object(v.jsx)(Vs,{})]})},Ys=z.a.div(rs||(rs=Object(U.a)(["\n  max-height: 500px;\n  width: 1000px;\n  overflow-y: auto;\n\n  .lyricsBlock {\n    padding: 10px;\n    box-sizing: border-box;\n    font-size: 1.8em;\n    font-weight: 700;\n    margin: 10px 0;\n    user-select: none;\n    cursor: pointer;\n    border-radius: var(--standartBorderRadius2);\n\n    &:hover {\n      background: #ffffff5c;\n    }\n  }\n"]))),qs=function(e){var t=e.song;return Object(v.jsx)(Ys,{children:t.lyrics.map((function(e,t){return Object(v.jsx)("div",{className:"lyricsBlock",children:e.text})}))})},Qs=z.a.div(is||(is=Object(U.a)(["\n  width: 100%;\n  max-width: 800px;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n\n  .song-image {\n    width: 300px;\n    height: 300px;\n    background-size: cover;\n    background-position: center center;\n    border-radius: var(--standartBorderRadius);\n  }\n"]))),Gs=function(e){var t=e.song;return Object(v.jsxs)(Qs,{children:[Object(v.jsx)("div",{className:"song-image",style:{backgroundImage:"url(".concat(t.cover,")")}}),Object(v.jsx)("h3",{children:t.name})]})},Ks=Object(z.a)(_t)(os||(os=Object(U.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n  background: ",";\n\n  h2 {\n    margin: 0;\n  }\n\n  .image-and-lyrics {\n    display: flex;\n    align-items: center;\n  }\n"])),(function(e){var t=e.colors;return"linear-gradient(45deg, ".concat(t[2],", ").concat(t[3],");")})),Xs=function(){var e=Object(s.useState)("3e35c47f-2186-4dea-a415-55616c525874"),t=Object(j.a)(e,2),n=t[0],c=(t[1],Object(s.useState)(null)),a=Object(j.a)(c,2),r=a[0],i=a[1];return Object(s.useEffect)((function(){m.collection("songs").doc(n).get().then((function(e){i(e.data())}))}),[]),!!r&&Object(v.jsx)(Ks,{colors:r.imageColors,children:Object(v.jsxs)("div",{children:[Object(v.jsxs)("div",{className:"image-and-lyrics",children:[Object(v.jsx)(Gs,{song:r}),Object(v.jsx)(qs,{song:r})]}),Object(v.jsx)("div",{})]})})},Js=(n(271),function(){var e=Object(o.g)();return Object(v.jsxs)("div",{className:"PageNotFound",children:[Object(v.jsx)("img",{loading:"lazy",src:"https://i.pinimg.com/originals/b2/3d/f6/b23df649311586e74a8455c92eb3d76b.png",alt:""}),Object(v.jsx)("h2",{children:"Page not found"}),Object(v.jsx)("button",{className:"standartButton",onClick:function(){return e.push("/library")},children:"Back to library"})]})}),_s=function(){var e=Object(s.useState)([]),t=Object(j.a)(e,2),n=t[0],c=t[1],a=Object(s.useState)([]),r=Object(j.a)(a,2),i=r[0],o=r[1],u=Object(s.useState)([]),b=Object(j.a)(u,2),h=b[0],f=b[1],O=S().currentUser;return Object(s.useEffect)((function(){m.collection("searchHistory").doc(O.uid).get().then((function(e){var t;(null===(t=e.data())||void 0===t?void 0:t.history)&&e.data().history.forEach(function(){var e=Object(d.a)(l.a.mark((function e(t){var n,s,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,s=t.type,e.next=3,m.collection(s).doc(n).get();case 3:a=e.sent.data(),e.t0=s,e.next="songs"===e.t0?7:"playlists"===e.t0?9:"users"===e.t0?11:13;break;case 7:return c((function(e){return[].concat(Object(W.a)(e),[a])})),e.abrupt("break",14);case 9:return o((function(e){return[].concat(Object(W.a)(e),[a])})),e.abrupt("break",14);case 11:return f((function(e){return[].concat(Object(W.a)(e),[a])})),e.abrupt("break",14);case 13:return e.abrupt("break",14);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}))}),[]),[n,i,h]},$s=function(){var e=S().searchValue,t=_s(),n=Object(j.a)(t,3),s=n[0],c=n[1],a=n[2];return e?null:Object(v.jsxs)("div",{className:"search-history",style:{animation:"zoomIn .2s forwards"},children:[Object(v.jsx)(Ct,{listOfSongs:s,source:{source:"/search",name:"Search",image:"https://www.pngkey.com/png/full/87-872187_lupa-search-icon-white-png.png",songsList:s},title:"Search history",showListens:!0,displayIfEmpty:"",isHorizontal:!0}),Object(v.jsx)(On,{listOfAuthors:a}),Object(v.jsx)(ln,{listOfAlbums:c,loading:!1})]})},Zs=(n(272),function(){var e=S(),t=e.searchValue,n=e.setSearchValue,c=Object(s.useState)([]),a=Object(j.a)(c,2),r=a[0],i=a[1],o=Object(s.useState)([]),u=Object(j.a)(o,2),l=u[0],d=u[1],b=Object(s.useState)([]),h=Object(j.a)(b,2),f=h[0],O=h[1],p=Object(s.useState)(""),m=Object(j.a)(p,2),g=m[0],x=m[1];return Object(s.useEffect)((function(){i([]),d([]),O([])}),[t]),Object(s.useEffect)((function(){0!==r.length?x(r[0].imageColors[0]+"a6"):0!==l.length?x(l[0].imageColors[0]+"a6"):0!==f.length?x(f[0].imageColors[0]+"a6"):x("")}),[r,l,f]),Object(v.jsx)("div",{className:"SearchPage",style:{animation:"zoomIn .2s forwards"},children:Object(v.jsxs)(_t,{children:[Object(v.jsx)(Re,{value:t,setValue:n,allFoundSongs:r,setAllFoundSongs:i,setResultPlaylists:O,setResultAuthorList:d,focus:!0}),Object(v.jsx)($s,{}),Object(v.jsx)(Ct,{listOfSongs:r,source:{source:"/search",name:"Search",image:"https://www.pngkey.com/png/full/87-872187_lupa-search-icon-white-png.png",songsList:r},title:"Songs",showListens:!0,saveSearchHistory:!0,displayIfEmpty:"",isHorizontal:!0}),Object(v.jsx)(On,{listOfAuthors:l,title:"Authors",saveSearchHistory:!0}),Object(v.jsx)(ln,{listOfAlbums:f,title:"Albums and Playlists",loading:!1,saveSearchHistory:!0}),Object(v.jsx)("div",{className:"colorfullShadow",style:{background:g}})]})})}),ec=function(){return Object(v.jsx)("div",{children:"Account"})},tc=function(e){var t=e.boolValue,n=e.setBoolValue;return Object(v.jsx)("div",{className:"SwitchToggle",onClick:function(){return n(!t)},children:Object(v.jsx)("div",{className:"switchInnerCircle",style:t?{transform:"translateX(100%)",background:"var(--green)"}:{}})})},nc=z.a.div(us||(us=Object(U.a)(['\n  width: 100%;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  cursor: pointer;\n  transition: 0.2s;\n  padding: 20px 50px;\n  box-sizing: border-box;\n  position: relative;\n\n  &::after {\n    content: "";\n    position: absolute;\n    width: 100%;\n    height: 2px;\n    bottom: 0;\n    left: 0%;\n    /* transform: translateX(-50%); */\n    background: #313131;\n  }\n\n  .icon-and-text {\n    display: flex;\n    align-items: center;\n    justify-content: flex-start;\n    user-select: none;\n\n    svg {\n      margin-right: 7px;\n      width: 20px;\n      height: 20px;\n    }\n  }\n\n  &:hover {\n    background: var(--leftSideBarColor);\n  }\n']))),sc=function(e){var t=e.icon,n=e.text,c=e.action,a=Object(s.useState)(!1),r=Object(j.a)(a,2),i=r[0],o=r[1],u=function(e){o(e),e&&c&&c()};return Object(v.jsxs)(nc,{onClick:function(){return u(!i)},children:[Object(v.jsxs)("div",{className:"icon-and-text",children:[t,n]}),Object(v.jsx)(tc,{boolValue:i,setBoolValue:u})]})},cc=function(){return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(sc,{icon:Object(v.jsx)(je.c,{}),text:"\u0423\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f"}),Object(v.jsx)(sc,{icon:Object(v.jsx)(je.c,{}),text:"\u0423\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f"}),Object(v.jsx)(sc,{icon:Object(v.jsx)(je.c,{}),text:"\u0423\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f"}),Object(v.jsx)(sc,{icon:Object(v.jsx)(je.c,{}),text:"\u0423\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f"}),Object(v.jsx)(sc,{icon:Object(v.jsx)(je.c,{}),text:"\u0423\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f"})]})},ac=function(){return Object(v.jsx)("div",{children:"Music"})},rc=z.a.div(ls||(ls=Object(U.a)(["\n  width: 85%;\n  height: 100px;\n  border-radius: 5px;\n"]))),ic=function(e){var t=e.currentPage,n=[Object(v.jsx)(ec,{}),Object(v.jsx)(ac,{}),Object(v.jsx)(cc,{})];return Object(v.jsx)(rc,{children:n[t]})},oc=z.a.button(ds||(ds=Object(U.a)(["\n  width: 100%;\n  display: flex;\n  align-items: center;\n  cursor: pointer;\n  /* transition: 0.1s; */\n  padding: 10px;\n  box-sizing: border-box;\n  background: ",";\n  color: #fff;\n  font-weight: 600;\n\n  svg {\n    margin-right: 7px;\n    width: 16px;\n    height: 16px;\n  }\n  /* \n  &:hover {\n    background: var(--leftSideBarColor);\n  } */\n"])),(function(e){return e.isActive?"var(--lightBlue)":"transparent"})),uc=function(e){var t=e.icon,n=e.text,s=e.onClick,c=e.isActive;return Object(v.jsxs)(oc,{onClick:s,isActive:c,children:[t,n]})},lc=z.a.div(js||(js=Object(U.a)(["\n  width: 15%;\n  border-radius: 5px;\n  overflow: hidden;\n  background: var(--leftSideBarColor);\n"]))),dc=function(e){var t=e.currentPage,n=e.setCurrentPage;return Object(v.jsxs)(lc,{children:[Object(v.jsx)(uc,{icon:Object(v.jsx)(je.C,{}),text:"Account",onClick:function(){return n(0)},isActive:0===t}),Object(v.jsx)(uc,{icon:Object(v.jsx)(de.m,{}),text:"Music",onClick:function(){return n(1)},isActive:1===t}),Object(v.jsx)(uc,{icon:Object(v.jsx)(je.q,{}),text:"Chat",onClick:function(){return n(2)},isActive:2===t}),Object(v.jsx)(uc,{icon:Object(v.jsx)(de.m,{}),text:"Music",onClick:function(){return n(3)},isActive:3===t})]})},jc=z.a.div(bs||(bs=Object(U.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: flex-start;\n"]))),bc=function(){var e=Object(s.useState)(0),t=Object(j.a)(e,2),n=t[0],c=t[1];return Object(v.jsxs)(_t,{children:[Object(v.jsx)("h2",{children:"Settings"}),Object(v.jsxs)(jc,{children:[Object(v.jsx)(dc,{setCurrentPage:c,currentPage:n}),Object(v.jsx)(ic,{currentPage:n})]})]})},hc=(n(273),[{path:C,Component:zs},{path:N,Component:function(){var e=Object(s.useState)(1),t=Object(j.a)(e,2),n=t[0],c=t[1],a=Object(s.useState)(""),r=Object(j.a)(a,2),o=r[0],u=r[1],b=Object(s.useState)(""),h=Object(j.a)(b,2),f=h[0],O=h[1],p=Object(s.useState)(""),m=Object(j.a)(p,2),g=m[0],x=m[1],y=Object(s.useState)(""),w=Object(j.a)(y,2),N=w[0],k=w[1],I=Object(s.useState)(!1),A=Object(j.a)(I,2),P=A[0],L=A[1],M=S().signup,T=Object(s.useState)(""),R=Object(j.a)(T,2),E=R[0],B=R[1],D=0!==o.length&&0!==f.length&&0!==g.length,F=Object(s.useState)(""),U=Object(j.a)(F,2),W=U[0],H=U[1],V=Object(s.useState)([]),z=Object(j.a)(V,2),Y=z[0],q=z[1];function Q(){return(Q=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),D){e.next=3;break}return e.abrupt("return",k("One of your fields is totaly empty"));case 3:return e.next=5,M(o,g,f,n,E,Y,k,L);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(v.jsxs)("div",{className:"In-Up-Container",children:[Object(v.jsx)(Dt.a,{src:W,getColors:function(e){return q(e)}}),Object(v.jsxs)("div",{className:"CentralPlate",children:[Object(v.jsx)(mn,{loading:P}),Object(v.jsx)(Ws,{title:"Sign Up"}),N&&Object(v.jsx)("div",{className:"Alert",children:N}),Object(v.jsxs)("div",{className:"inner-plate-content",children:[Object(v.jsx)(me,{type:"email",placeholder:"Enter your email",value:o,setValue:u,margin:!0}),Object(v.jsx)(me,{type:"text",placeholder:"Enter your name",value:g,setValue:x,margin:!0}),Object(v.jsx)(me,{type:"password",placeholder:"Create password",value:f,setValue:O,margin:!0}),Object(v.jsxs)("div",{style:{display:"flex",width:"100%",justifyContent:"center",margin:"5px 0 15px 0"},children:[Object(v.jsx)(Ht,{label:"User",onClick:function(){return c(0)},currentActive:n,id:0}),Object(v.jsx)(Ht,{label:"Author",onClick:function(){return c(1)},currentActive:n,id:1})]}),Object(v.jsx)(Wt,{text:"Download photo",place:"usersImages/",setItemSrc:B,setImageLocalPath:H}),Object(v.jsxs)("div",{className:"inAndUpBtns",children:[Object(v.jsx)("button",{className:"upBtn",type:"submit",disabled:P,onClick:function(e){return Q.apply(this,arguments)},children:"Sign Up"}),Object(v.jsx)(i.b,{to:C,children:Object(v.jsx)("button",{className:"inBtn",children:"Already registered"})})]})]})]}),Object(v.jsx)(Vs,{})]})}}]),fc=[{path:k,Component:Ps},{path:I,Component:Us},{path:A,Component:Zs},{path:P,Component:Bn},{path:"/not-found",Component:Js},{path:"/chat/:chatId",Component:ys},{path:"/albums/:albumId",Component:$t},{path:"/authors/:authorId",Component:Cn},{path:L,Component:Ss},{path:"/settings",Component:bc},{path:"/lyrics-editing",Component:Xs}],Oc=function(){return Object(v.jsxs)(o.d,{children:[fc.map((function(e,t){var n=e.path,s=e.Component;return Object(v.jsx)(o.b,{path:n,component:s,exact:!0},n)})),Object(v.jsx)(o.a,{to:k})]})},pc=function(){var e=re().bottomMessage,t=function(){switch(e.type){case"success":return{light:"#69e985",dark:"#12321ce6"};case"failure":return{light:"#f4546a",dark:"#581921d8"};default:return{light:"#69e985",dark:"#12321ce6"}}};return Object(v.jsxs)("div",{className:"bottom-message ".concat(e.isOpenned?"openned":""),style:{background:t().dark,color:t().light},children:[function(){switch(e.type){case"success":return Object(v.jsx)(T.g,{});case"failure":return Object(v.jsx)(T.h,{});default:return Object(v.jsx)(T.g,{})}}(),Object(v.jsx)("span",{children:e.message})]})},mc=n.p+"static/media/notification.cdade1f4.mp3",gc=z.a.div(hs||(hs=Object(U.a)(["\n  color: #fff;\n  padding: 20px;\n  box-sizing: border-box;\n  border-radius: var(--standartBorderRadius2);\n  background: #000000b9;\n  position: absolute;\n  bottom: 20px;\n  right: 20px;\n  transition: 0.2s;\n  transform: translateY(\n    ","\n  );\n  opacity: ",";\n  width: 250px;\n  height: 90px;\n\n  a {\n    text-decoration: none;\n  }\n\n  &:hover {\n    background: #1f1f1fb3;\n  }\n\n  .image-and-name {\n    display: flex;\n    justify-content: flex-start;\n    align-items: center;\n    font-weight: bold;\n\n    img {\n      width: 25px;\n      height: 25px;\n      border-radius: 100%;\n      margin-right: 7px;\n    }\n  }\n\n  .message {\n    margin-top: 10px;\n    display: flex;\n    white-space: nowrap;\n    overflow: hidden;\n  }\n"])),(function(e){var t=e.show,n=e.index;return t?"-".concat(90*n+10*n,"px"):"90px"}),(function(e){return e.show?"1":"0"})),xc=function(e){var t=e.chatId,n=e.chatName,c=e.chatImage,a=e.message,r=e.userId,o=e.index,u=Object(s.useState)(null),l=Object(j.a)(u,2),d=l[0],b=l[1],h=Object(s.useState)(!1),f=Object(j.a)(h,2),O=f[0],p=f[1];return Object(s.useEffect)((function(){m.collection("users").doc(r).get().then((function(e){p(!0),new Audio(mc).play(),b(e.data()),setTimeout((function(){p(!1)}),6e3)}))}),[]),Object(v.jsx)(gc,{show:O,index:o,children:Object(v.jsxs)(i.b,{to:"/chat/".concat(t),children:[Object(v.jsxs)("div",{className:"image-and-name",children:[Object(v.jsx)("img",{src:(null===c||void 0===c?void 0:c.length)?c:null===d||void 0===d?void 0:d.photoURL,alt:""}),n.length?n:null===d||void 0===d?void 0:d.displayName]}),Object(v.jsx)("div",{className:"message",children:Object(v.jsx)(An,{sender:d,isGroup:n.length,message:a,messageLen:20})})]})})},vc=function(){var e=re(),t=e.isOpenConfirm,n=e.confirmContent,c=e.setIsOpenConfirm,a=Object(s.useRef)(null);return Te(a,c),Object(v.jsx)("div",{className:"modal_darkBg confirm",style:t?{}:{opacity:0,visibility:"hidden"},children:Object(v.jsxs)("div",{className:"ConfirmWindow",ref:a,style:t?{}:{transform:"translateY(40px)"},children:[Object(v.jsx)("h3",{children:n.question}),Object(v.jsxs)("div",{className:"confirmButtons",children:[Object(v.jsx)("button",{onClick:n.onConfirm,className:"standartButton",children:n.confirmText}),Object(v.jsx)("button",{onClick:n.onReject,className:"standartButton",children:n.rejectText})]})]})})},yc=n(52);function Sc(e){return e%10===e?"0"+e:e}function wc(e){return Sc(Math.floor(e/60))+":"+Sc(Math.floor(e%60))}function Cc(e){var t="";return e.forEach((function(e){t+=e.displayName})),t.length}var Nc=function(e){var t=e.inputRef,n=e.textLimit,s=void 0===n?18:n,c=e.linkToAuthors,a=void 0===c||c,r=ue(),i=r.currentSongData,o=r.currentTime,u=r.changeCurrentTime,l=r.songDuration,d=r.setRepeatMode,j=r.repeatMode,b=r.play,h=r.prevSong,f=r.playSong,O=r.nextSong,p=r.setShuffleMode,m=r.shuffleMode,g=r.displayAuthors,x=r.name,y=r.authors,S=r.cover,w=r.inputRange;return-1!==i.id?Object(v.jsxs)("div",{className:"player",children:[Object(v.jsxs)("div",{className:"playerUpperSide",children:[Object(v.jsx)("div",{className:"songCover",children:Object(v.jsx)("img",{loading:"lazy",src:S,alt:""})}),Object(v.jsxs)("div",{className:"nameAndAuthors",children:[Object(v.jsx)("h2",{title:x.length>s?x:null,style:{overflow:"hidden"},children:Object(v.jsx)("div",{style:x.length>s?{animation:"outSideText 17s infinite",whiteSpace:"nowrap"}:{},children:x})}),Object(v.jsx)("h3",{style:{overflow:"hidden"},title:y.map((function(e){return" "+e.displayName})),children:a?Object(v.jsx)("div",{style:Cc(i.authors)>s?{animation:"outSideText 17s infinite",whiteSpace:"nowrap"}:{},children:g()}):Object(v.jsx)("div",{children:jt(y," & ",33)})})]})]}),Object(v.jsxs)("div",{className:"controlPanel",children:[Object(v.jsx)("input",{type:"range",min:"0",ref:t,step:"1",value:o,onChange:function(e){u(e)},style:{background:"linear-gradient(to right, var(--themeColor2) ".concat(w,"%, #fff ").concat(w,"%)")}}),Object(v.jsxs)("div",{className:"startAndEndTime",children:[Object(v.jsx)("span",{children:wc(o)}),Object(v.jsx)("span",{children:wc(l)})]}),Object(v.jsxs)("div",{className:"btns",children:[Object(v.jsx)("button",{className:"shuffleBtn",onClick:function(){return p($(m+1,1))},style:m?{background:"var(--reallyTransparentWhite)"}:{},children:Object(v.jsx)(yc.b,{style:m?{color:"var(--themeColor)"}:{}})}),Object(v.jsx)("button",{onClick:function(e){e.stopPropagation(),h()},children:Object(v.jsx)(T.a,{})}),Object(v.jsx)("button",{onClick:function(e){e.stopPropagation(),f()},children:b?Object(v.jsx)(T.e,{}):Object(v.jsx)(T.f,{})}),Object(v.jsx)("button",{onClick:function(e){e.stopPropagation(),O()},children:Object(v.jsx)(T.c,{})}),Object(v.jsxs)("button",{className:"repeatBtn",onClick:function(){return d($(j+1,2))},style:j?{background:"var(--reallyTransparentWhite)"}:{},children:[Object(v.jsx)(yc.a,{style:j?{color:"var(--themeColor)"}:{}}),Object(v.jsx)("span",{style:2===j?{opacity:1}:{}})]}),Object(v.jsx)(lt,{play:b})]})]})]}):null},kc=function(e){var t=e.currentTime,n=e.timeSpan,s=e.id;return Object(v.jsx)("div",{className:"Loading",id:s,children:Object(v.jsx)("div",{className:"outer",style:{pointerEvents:"none"},children:Object(v.jsx)("div",{className:"inner",style:t/n<1?{width:t/n*100+"%"}:{width:"0%",opacity:"0"}})})})},Ic=function(e){var t=e.el,n=e.index,c=e.lyricsModeratorMode,a=e.karaokeModeratorTimes,r=e.setKaraokeModeratorTimes,i=e.setInputKaraokeTime,o=e.inputKaraokeTime,u=ue(),l=u.currentSongData,d=u.currentParagraph,j=(u.displayAuthors,u.changeCurrentTime),b=u.play,h=u.currentTime,f=u.currentParagraphRef,O=u.lyrics,p=Object(s.useRef)(),m=ss(d===n?f:p),g=d===n?{}:window.innerWidth>1e3?Math.abs(d-n)<2?{transform:"scale(.8) translateX(-58px)"}:{transform:"scale(.75) translateX(-78px)"}:Math.abs(d-n)<2?{transform:"scale(.8) translateX(-11.5%)"}:{transform:"scale(.75) translateX(-15.6%)"};function x(e,t){var n=a;if("down"===t)return n.splice(e+1,0,void 0),r(n),l.lyrics.splice(e+1,0,{startTime:"undefined",text:"@loading"});n.splice(e,0,void 0),r(n),l.lyrics.splice(e,0,{startTime:"undefined",text:"@loading"})}return Object(v.jsxs)("div",{className:"lyricsBlock "+(m?"":"notVisible"),id:n,onClick:function(e){return j(e,t.startTime)},style:b?d===n?{}:Math.abs(d-n)<2?{opacity:.5}:{opacity:.1}:{},ref:d===n?f:p,children:[1===c?Object(v.jsxs)("div",{className:"lyricsBlockInput",children:[Object(v.jsxs)("span",{onClick:function(e){return e.stopPropagation()},children:[void 0!==a[n]&&0!==a[n].length?Object(v.jsx)(de.b,{style:{background:"var(--themeColor3)",color:"var(--themeColor)"}}):Object(v.jsx)(je.H,{})," "]}),Object(v.jsx)("input",{type:"number",value:a[n]||o,onChange:function(e){return function(e,t){var n=a,s=e.target.value;n[t]=s,i(e.target.value),r(n)}(e,n)},onClick:function(e){return e.stopPropagation()}}),Object(v.jsxs)("div",{className:"addLyricsElementBtns",onClick:function(e){return e.stopPropagation()},children:[Object(v.jsx)("button",{onClick:function(){x(n,"up")},children:Object(v.jsx)(de.p,{})}),Object(v.jsx)("button",{onClick:function(){x(n,"down")},children:Object(v.jsx)(de.g,{})})]})]}):null,"@loading"===t.text?Object(v.jsx)(kc,{currentTime:h-O[n].startTime,timeSpan:O[n+1].startTime-O[n].startTime,id:n}):"@end"===t.text?Object(v.jsx)(v.Fragment,{}):Object(v.jsx)("p",{id:n,style:g,children:t.text},n)]},n)},Ac=[{id:0,icon:Object(v.jsx)(de.o,{}),title:"Share",component:function(){var e=ue().currentSongData,t=[Object(v.jsx)(ge.c,{}),Object(v.jsx)(T.b,{}),Object(v.jsx)(T.i,{}),Object(v.jsx)(T.j,{}),Object(v.jsx)(Ft.a,{})];return Object(v.jsxs)("div",{className:"Share",children:[Object(v.jsxs)("button",{className:"shareCopyLink",children:[Object(v.jsx)(je.i,{}),"Copy link"]}),Object(v.jsx)("div",{className:"shareOnSocial",children:t.map((function(e,t){return Object(v.jsx)("div",{className:"shareSocialIcon",children:e},t)}))}),Object(v.jsx)("div",{className:"sharePeopleShort",children:Object(v.jsx)(ct,{item:e,whatToShare:"song"})})]})}},{id:1,icon:Object(v.jsx)(de.f,{}),title:"More",component:function(){var e=ue(),t=e.currentSongData,n=e.setRightSideCurrentPage;return Object(v.jsxs)("div",{className:"Options",children:[Object(v.jsx)("div",{className:"OptionItem",children:Object(v.jsx)(He,{song:t})}),Object(v.jsxs)("div",{className:"OptionItem",onClick:function(){return n(4)},children:[Object(v.jsx)(de.q,{}),"Go to author"]}),Object(v.jsxs)("div",{className:"OptionItem",onClick:function(){return n(5)},children:[Object(v.jsx)(be.c,{}),"Add to playlist"]}),Object(v.jsxs)("div",{className:"OptionItem",onClick:function(){return n(6)},children:[Object(v.jsx)(je.o,{}),"Info"]})]})}},{id:2,icon:Object(v.jsx)(yc.c,{}),title:"Lyrics",component:function(){var e=ue(),t=e.setIsThereKaraoke,n=e.currentSongData,c=e.setCurrentSongData,a=e.isThereKaraoke,r=e.currentParagraph,i=e.displayAuthors,o=e.currentParagraphRef,u=e.lyrics,l=e.rightSideCurrentPage,d=e.openFullScreenPlayer,b=e.openMenu,h=S().currentUser,f=Object(s.useState)(0),O=Object(j.a)(f,2),p=O[0],g=O[1],x=Object(s.useState)([]),y=Object(j.a)(x,2),w=y[0],C=y[1],N=Object(s.useState)(0),k=Object(j.a)(N,2),I=k[0],A=k[1],P=Object(s.useState)(!1),L=Object(j.a)(P,2),M=L[0],T=L[1];function R(e,t){var n=w,s=e.target.value;n[t]=s,g(e.target.value),C(n)}function E(e,t){var s=w;if("down"===t)return s.splice(e+1,0,void 0),C(s),n.lyrics.splice(e+1,0,{startTime:"undefined",text:"@loading"});s.splice(e,0,void 0),C(s),n.lyrics.splice(e,0,{startTime:"undefined",text:"@loading"})}return Object(s.useEffect)((function(){a&&b&&2===l&&d&&o.current.scrollIntoView()}),[r]),Object(s.useEffect)((function(){u&&"undefined"!==u[0].startTime&&(u.forEach((function(e){w.push(e.startTime)})),T(!0))}),[]),Object(s.useEffect)((function(){var e,s=n;void 0!==s&&0!==p&&(s.lyrics.forEach((function(e,t){e.startTime=w[t]||"undefined"})),c(s),t(!0)),(null===(e=n.lyrics)||void 0===e?void 0:e.some((function(e){return"undefined"===e.startTime})))?T(!1):T(!0)}),[p]),u?Object(v.jsxs)("div",{className:"Lyrics",children:[h.isAdmin?Object(v.jsx)(Sn,{pages:["Listen mode","Edit Mode"],currentPage:I,setCurrentPage:A}):null,a?u.map((function(e,t){return Object(v.jsx)(Ic,{el:e,index:t,lyricsModeratorMode:I,karaokeModeratorTimes:w,setKaraokeModeratorTimes:C,setInputKaraokeTime:g,inputKaraokeTime:R})})):u.map((function(e,t){return Object(v.jsxs)("div",{className:"lyricsBlock",children:[1===I?Object(v.jsxs)("div",{className:"lyricsBlockInput",children:[void 0!==w[t]&&0!==w[t].length?Object(v.jsx)(de.b,{style:{background:"var(--themeColor3)",color:"var(--themeColor)"}}):Object(v.jsx)(je.H,{}),Object(v.jsx)("input",{type:"number",value:w[t]||p,onChange:function(e){return R(e,t)},onClick:function(e){return e.stopPropagation()}}),Object(v.jsxs)("div",{className:"addLyricsElementBtns",children:[Object(v.jsx)("button",{onClick:function(){return E(t,"up")},children:Object(v.jsx)(de.p,{})}),Object(v.jsx)("button",{onClick:function(){return E(t,"down")},children:Object(v.jsx)(de.g,{})})]})]}):null,Object(v.jsx)("p",{children:e.text})]},t)})),Object(v.jsxs)("h6",{className:"lyricsAuthors "+(r===u.length-1?"active":""),children:["Authors: ",i()]}),1===I?Object(v.jsx)("button",{onClick:M?function(){m.collection("songs").doc(n.id).update({lyrics:n.lyrics})}:null,className:"updateLyricsBtn",style:M?{}:{opacity:.3},children:"Update Lyrics"}):null]}):Object(v.jsx)("h3",{children:"No lyrics"})}},{id:3,icon:Object(v.jsx)(Un.a,{}),title:"Queue",component:function(){var e=ue(),t=e.currentSongQueue,n=e.currentSongPlaylistSource,s=e.setOpenFullScreenPlayer;return Object(v.jsxs)("div",{className:"Queue",children:[Object(v.jsx)("div",{className:"queueNowIsPlaying",children:Object(v.jsxs)("h5",{style:{marginTop:2},children:["Now is playing:",Object(v.jsxs)(i.b,{onClick:function(){return s(!1)},to:n.source,className:"queueAlbumName",children:[Object(v.jsx)("div",{className:"queueImage",style:n.image?{}:{display:"none"},children:Object(v.jsx)("img",{loading:"lazy",src:n.image,alt:""})}),Object(v.jsx)("span",{children:dt(n.name,25)})]})]})}),t.map((function(e,t){return Object(v.jsx)(yt,{song:e,localIndex:t},t)}))]})}},{id:4,icon:null,title:"Go To Authors",component:On},{id:5,icon:null,title:"Add to playlist",component:Ke},{id:6,icon:null,title:"Info",component:at}];function Pc(){var e=ue(),t=e.imgColors,n=e.inputRef,a=e.rightSideCurrentPage,r=e.setRightSideCurrentPage,i=e.openFullScreenPlayer,o=e.setOpenFullScreenPlayer,u=e.lyrics,l=e.openMenu,d=e.setOpenMenu,b=Ye(),h=b.isMobile,f=(b.screenHeight,b.screenWidth,Object(s.useRef)(null)),O=Object(s.useState)(.05),p=Object(j.a)(O,2),m=p[0],g=p[1],x=Object(s.useState)(0),y=Object(j.a)(x,2),S=y[0],w=y[1],C=Object(s.useState)(0),N=Object(j.a)(C,2),k=N[0],I=N[1],A=Object(s.useState)(0),P=Object(j.a)(A,2),L=P[0],M=P[1],T=Object(s.useRef)(),R=c.a.useRef();Te(R,d);var E=Object(ts.useSwipeable)({onSwiping:function(e){e.deltaY>0&&I(e.deltaY)}}),B=c.a.useRef(),F=Object(ts.useSwipeable)({onSwiping:function(e){e.event.stopPropagation(),(l&&0===T.current.scrollTop&&e.deltaY>0||!l&&e.deltaY<0)&&M(e.deltaY)},onSwipedLeft:function(){r($(a+1,3))},onSwipedRight:function(){r($(a-1,3))}});Object(s.useEffect)((function(){k>150&&o(!1)}),[k]),Object(s.useEffect)((function(){!l&&L<-100?(d(!0),M(0),w(.2)):l&&L>150?(d(!1),M(0),w(.2)):function(){var e;clearTimeout(e),w(0),e=setTimeout((function(){w(.2),M(0)}),300)}()}),[L]);function U(e){var t=Ac[e].component;return Object(v.jsx)(t,{})}function W(){return u&&0===u.length}function H(e){if(2===e.id&&W())return null;w(.2),r(e.id),d(!0)}return Object(s.useEffect)((function(){0!==t.length&&(document.documentElement.style.setProperty("--themeColor",t[1]),document.documentElement.style.setProperty("--themeColor2",t[0]),document.documentElement.style.setProperty("--themeColor3",t[2]),document.documentElement.style.setProperty("--themeColor4",t[5]),document.documentElement.style.setProperty("--themeColorTransparent",t[0]+"6e"))}),[t]),Object(v.jsxs)("div",Object(D.a)(Object(D.a)({className:"bg",style:i?{top:0,opacity:1,visibility:"visible",zIndex:10,transform:"translateY(".concat(k,"px)"),borderRadius:"".concat(k<20?k:20,"px ").concat(k<20?k:20,"px 0 0"),transition:".4s opacity, ".concat(m,"s transform, .4s top, .4s visibility")}:{transform:"translateY(".concat(k,"px)"),transition:".4s opacity, ".concat(m,"s transform, .4s top, .4s visibility")},ref:function(e){E.ref(e),B.current=e}},E),{},{onTouchEnd:function(){var e;clearTimeout(e),g(.2),e=setTimeout((function(){I(0),g(0)}),100)},children:[Object(v.jsx)("div",{className:"closeFullScreen",onClick:function(){o(!1)},children:window.innerWidth>1e3?Object(v.jsx)(ut.a,{}):Object(v.jsx)(je.r,{style:{opacity:.6}})}),Object(v.jsxs)("div",{className:"FullScreenPlayer",children:[Object(v.jsx)("div",{className:"leftSide",style:l?h?{opacity:.6,visibility:"visible",transform:"translateY(20px)",borderRadius:"10px",transition:".4s"}:null:{width:"100%"},children:Object(v.jsx)(Nc,{inputRef:n})}),window.innerWidth>1e3?Object(v.jsxs)("div",{className:"rightSideWrapper",style:l?{}:{transform:"translateX(calc(100% - 90px))",width:0},children:[Object(v.jsx)("button",{className:"menuBtn",style:l?{transform:"rotate(180deg)"}:{opacity:0,visibility:"hidden"},onClick:function(){return d(!l)},children:Object(v.jsx)(de.c,{})}),Object(v.jsx)("div",{className:"rightSideControl",children:Ac.map((function(e,t){return Object(v.jsx)("div",{className:"controlIcon",style:e.id===a&&l?{background:"var(--themeColor)"}:2===e.id&&W()?{opacity:.4}:{},onClick:function(){return H(e)},children:e.icon},e.id)}))}),Object(v.jsx)("div",{className:"rightSide",ref:f,style:l?{}:{display:"none"},children:U(a)})]}):Object(v.jsxs)("div",Object(D.a)(Object(D.a)({className:"mobilePlayerMenu"},F),{},{ref:function(e){F.ref(e),R.current=e},style:l?{top:"calc(100% - calc(70vh + 55px) + ".concat(L,"px)"),transition:"".concat(S,"s")}:{top:"calc(100% - 55px + ".concat(L,"px)"),transition:"".concat(S,"s")},children:[Object(v.jsx)("div",{className:"mobilePlayerMenuClose",children:Object(v.jsx)(je.r,{style:{opacity:.6,width:"50px"},onClick:function(){return d(!l)}})}),Object(v.jsx)("div",{className:"controlIconsWrapper",children:Ac.map((function(e,t){if(t<=3)return Object(v.jsx)("div",{className:"controlIcon",style:e.id===a&&l?{background:"var(--transparentWhite)"}:2===e.id&&W()?{opacity:.4}:{},onClick:function(t){return H(e)},children:e.title},e.id)}))}),Object(v.jsx)("div",{className:"mobilePlayerMenuContent",ref:T,style:l?{}:{opacity:0},children:U(a)})]}))]})]}))}n(274);var Lc,Mc,Tc=[{id:0,icon:Object(v.jsx)(je.m,{}),title:"Home",link:k},{id:1,icon:Object(v.jsx)(de.m,{}),title:"Library",link:I},{id:2,icon:Object(v.jsx)(de.n,{}),title:"Search",link:A},{id:3,icon:Object(v.jsx)(je.q,{}),title:"Chat",link:P}],Rc=z.a.div(Lc||(Lc=Object(U.a)(["\n  border-radius: 100%;\n  width: 20px;\n  height: 20px;\n  font-size: 0.7em;\n  background: var(--red);\n  color: #fff;\n  font-weight: bold;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  position: absolute;\n  top: 50%;\n  right: 10px;\n  transform: translateY(-50%);\n"]))),Ec=function(e){var t=e.value;return!!t&&Object(v.jsx)(Rc,{className:"notification-circle",children:t})},Bc=(n(275),z.a.div(Mc||(Mc=Object(U.a)(["\n  width: 100%;\n  border-radius: var(--standartBorderRadius);\n  background: var(--navItemColor);\n  color: #fff;\n  font-weight: bold;\n  min-height: 40px;\n  padding: 0.4px 5px;\n  box-sizing: border-box;\n  scroll-snap-type: y mandatory;\n  transition: 0.2s height;\n  position: relative;\n\n  &:hover {\n    a {\n      text-decoration: none;\n    }\n  }\n\n  .personName {\n    white-space: nowrap;\n    text-overflow: ellipsis;\n  }\n"])))),Dc=function(){var e=S().currentUser,t=Object(s.useState)(0),n=Object(j.a)(t,2),c=n[0],a=n[1];return Object(s.useEffect)((function(){var t=m.collection("chats").where("participants","array-contains",e.uid).onSnapshot((function(t){a(0),t.docs.map((function(t){var n=t.data();a((function(t){return t+Pn(n.messages,e)}))}))}));return function(){t()}}),[]),c};function Fc(e){var t=e.id,n=e.title,s=e.icon,c=e.link,a=e.currentPage,r=e.setCurrentPage,o=e.notificationValue;return Object(v.jsx)(i.b,{to:c,children:Object(v.jsxs)("div",{className:"NavigationItem "+(t===a?"active":""),onClick:function(){return r(t)},children:[Object(v.jsx)("div",{className:"icon",children:s}),Object(v.jsx)("b",{children:n}),Object(v.jsx)(Ec,{value:o})]})})}var Uc,Wc=function(e){var t=e.currentPage,n=e.setCurrentPage,s=Object(j.a)(Tc,4),c=s[0],a=s[1],r=s[2],i=s[3],o=Dc();return Object(v.jsxs)("div",{className:"NavigationPanel",children:[Object(v.jsx)(Fc,{id:c.id,title:c.title,icon:c.icon,link:c.link,currentPage:t,setCurrentPage:n},0),Object(v.jsx)(Fc,{id:a.id,title:a.title,icon:a.icon,link:a.link,currentPage:t,setCurrentPage:n},1),Object(v.jsx)(Fc,{id:r.id,title:r.title,icon:r.icon,link:r.link,currentPage:t,setCurrentPage:n},2),Object(v.jsx)(Fc,{id:i.id,title:i.title,icon:i.icon,link:i.link,currentPage:t,setCurrentPage:n,notificationValue:o},3)]})},Hc=z.a.div(Uc||(Uc=Object(U.a)(['\n  width: 10px;\n  height: 10px;\n  background: var(--red);\n  box-shadow: 0 0 10px var(--red);\n  border-radius: 100%;\n  position: relative;\n\n  @keyframes waveAnimation {\n    0% {\n      opacity: 0;\n      transform: scale(0.95);\n    }\n    60% {\n      opacity: 0.5;\n      transform: scale(2);\n    }\n    100% {\n      opacity: 0;\n      transform: scale(0.95);\n    }\n  }\n\n  &::after {\n    content: "";\n    width: 10px;\n    height: 10px;\n    background: var(--red);\n    filter: brightness(0.3);\n    border-radius: 100%;\n    animation: waveAnimation 1.5s infinite;\n    position: absolute;\n    top: 0;\n    left: 0;\n    z-index: -1;\n  }\n']))),Vc=function(){return Object(v.jsx)(Hc,{})},zc=function(e){var t=e.index,n=e.friend,c=S().currentUser,a=re().openBottomMessage,r=Object(s.useState)(0),o=Object(j.a)(r,2),u=o[0],l=o[1],d=Object(s.useState)(!1),b=Object(j.a)(d,2),h=b[0],f=b[1],O=Object(s.useState)(""),p=Object(j.a)(O,2),m=p[0],g=p[1],x=ue(),y=x.currentSong,w=x.currentSongData,C=Object(s.useState)(!1),N=Object(j.a)(C,2),k=N[0],I=N[1],A=Ln(n.uid),P=Lt(n),L=Object(j.a)(P,2),M=L[0],T=L[1];return Object(s.useEffect)((function(){tt([n.uid],c,f,l)}),[]),Object(s.useEffect)((function(){(null===m||void 0===m?void 0:m.length)>0&&(I(!0),setTimeout((function(){g(""),I(!1)}),600))}),[m]),Object(v.jsxs)("div",{className:"person",id:n.uid,children:[Object(v.jsx)("img",{loading:"lazy",src:w.cover,alt:"",className:"sendSongImage "+m}),Object(v.jsxs)("div",{className:"personBtns",children:[Object(v.jsx)(i.b,{to:"/chat/".concat(u),children:Object(v.jsxs)("button",{onClick:function(){h&&et([c.uid,n.uid],u)},children:[Object(v.jsx)(Qe,{text:"chat"}),Object(v.jsx)(je.q,{})]})}),Object(v.jsxs)("button",{onClick:T,children:[Object(v.jsx)(Qe,{text:A?dt("".concat(null===M||void 0===M?void 0:M.name," | ").concat(null===M||void 0===M?void 0:M.authors[0].displayName)||"No song data",20):"last listened song"}),A?Object(v.jsx)(Vc,{}):Object(v.jsx)(je.u,{})]}),Object(v.jsxs)("button",{onClick:function(){k||(st({shareList:[n.uid],currentUser:c,itemId:y,whatToShare:"song",setShouldCreate:f,setFriendChatId:l}),g("sendAnimation"),a("".concat(w.name," was sent to ").concat(n.displayName)))},children:[Object(v.jsx)(Qe,{text:"share"}),Object(v.jsx)(de.o,{})]})]}),Object(v.jsx)(i.b,{className:"personImg",to:"/authors/".concat(n.uid),children:Object(v.jsx)("img",{loading:"lazy",src:n.photoURL,alt:""})}),Object(v.jsx)(Mn,{userUID:n.uid}),Object(v.jsx)("div",{className:"personName",style:{pointerEvents:"none"},children:dt(n.displayName,12)})]},t)},Yc=function(e){var t=e.playlist,n=re(),c=n.toggleModal,a=n.setContent,r=Object(s.useState)([]),u=Object(j.a)(r,2),l=u[0],d=u[1],b=on(t,l,d),h=Ve(t.id),f=Object(j.a)(h,2),O=f[0],p=f[1],m=S().currentUser,g=Object(o.g)();return Object(v.jsxs)("div",{className:"TinyPlaylist",children:[Object(v.jsxs)("div",{className:"TinyPlaylistBtns",children:[t.authors.find((function(e){return e.uid===m.uid}))?Object(v.jsx)("button",{onClick:O,children:p?Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(Qe,{text:"remove song"}),Object(v.jsx)(je.d,{})]}):Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(Qe,{text:"add song"}),Object(v.jsx)(je.x,{})]})}):Object(v.jsxs)("button",{onClick:function(){c(),a(Object(v.jsx)(ct,{item:t,whatToShare:"playlist"}))},children:[Object(v.jsx)(Qe,{text:"share"}),Object(v.jsx)(je.A,{})]}),Object(v.jsx)(i.b,{to:"/albums/".concat(t.id),children:Object(v.jsxs)("button",{children:[Object(v.jsx)(Qe,{text:"album"}),Object(v.jsx)(de.a,{})]})}),Object(v.jsxs)("button",{onClick:b,children:[Object(v.jsx)(Qe,{text:"play"}),Object(v.jsx)(je.v,{})]})]}),Object(v.jsx)("div",{className:"TinyPlaylistImg",style:{backgroundImage:"url(".concat(t.image,")"),display:"inline-block",backgroundPosition:"center center",backgroundSize:"cover",position:"relative"},onClick:function(){return g.push("/albums/".concat(t.id))},children:t.image?null:Object(v.jsx)(de.a,{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",width:"20px",height:"20px"}})}),Object(v.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[Object(v.jsx)("span",{children:dt(t.name,13)}),Object(v.jsx)("span",{style:{fontSize:"0.8em",color:"grey",fontWeight:"500"},children:t.isAlbum?"album":"playlist"})]})]})},qc=function(){var e=S().currentUser,t=Object(s.useState)(0),n=Object(j.a)(t,2),c=n[0],a=n[1],r=ue(),o=r.leftSideBarInputRef,u=r.setOpenFullScreenPlayer,l=r.currentSongData,d=r.yourFriends,b=r.yourPlaylists,h=re(),f=h.toggleModal,O=h.setContent,p=Object(s.useState)(0),m=Object(j.a)(p,2),x=m[0],y=m[1],w=Object(s.useState)((function(){var e=Tc.find((function(e,t){return!!window.location.hash.includes(g(e.title))}));return void 0===e?-1:e.id})),C=Object(j.a)(w,2),N=C[0],k=C[1];return Object(s.useEffect)((function(){a(e.friends.reduce((function(e,t){return"requested"===t.status?e+1:e}),0))}),[JSON.stringify(e.friends)]),Object(v.jsxs)("div",{className:"LeftsideBar",children:[Object(v.jsxs)("div",{className:"logo",children:[Object(v.jsx)("img",{loading:"lazy",src:R,alt:""}),Object(v.jsx)("h3",{children:"Soundbubble"})]}),Object(v.jsx)(Bc,{onClick:function(){return k(-1)},children:Object(v.jsx)(i.b,{to:"/authors/".concat(e.uid),children:Object(v.jsxs)("div",{className:"person",style:-1===N?{background:"var(--blue)"}:{},children:[Object(v.jsx)(Ec,{value:c}),Object(v.jsx)("div",{className:"personImg",style:{backgroundImage:"url(".concat(e.photoURL,")")}}),Object(v.jsx)("div",{className:"personName",children:dt(e.displayName,11)})]})})}),Object(v.jsx)(Wc,{currentPage:N,setCurrentPage:k}),Object(v.jsxs)(Bc,{className:"leftSideBarContainer friendsAndPlaylists",children:[Object(v.jsx)("span",{style:{display:x?"none":"block",animation:"scrollFromBottom .2s forwards"},children:d.length>0?Object(v.jsxs)(v.Fragment,{children:[d.map((function(e,t){return t<=2?Object(v.jsx)(zc,{index:e.uid,friend:e}):null})),Object(v.jsx)("h4",{className:"seeMoreBtn",onClick:function(){f(),O(Object(v.jsx)(ct,{item:l,whatToShare:"song"}))},children:"See more"})]}):Object(v.jsx)("h4",{style:{alignSelf:"center",width:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:"No friends added"})}),Object(v.jsxs)("span",{style:{display:x?"block":"none",animation:"scrollFromTop .2s forwards"},children:[b.map((function(e,t){if(t<=2)return Object(v.jsx)(Yc,{playlist:e},e.id)})),Object(v.jsxs)("button",{className:"createPlaylistBtn",onClick:function(){f(),O(Object(v.jsx)(vn,{}))},style:{margin:"5px 0"},children:[Object(v.jsx)(de.i,{}),"Create Playlist"]})]}),Object(v.jsxs)("div",{className:"upAndDownBtns",children:[Object(v.jsx)("button",{onClick:function(){return y(0)},style:x?{}:{opacity:"0.3"},children:Object(v.jsx)(je.h,{})}),Object(v.jsx)("button",{onClick:function(){return y(1)},style:x?{opacity:"0.3"}:{},children:Object(v.jsx)(je.e,{})})]})]}),Object(v.jsx)("div",{className:"leftSideBarContainer",children:-1===l.id?null:Object(v.jsxs)("div",{className:"littlePlayer",children:[Object(v.jsx)(Nc,{textLimit:15,inputRef:o}),Object(v.jsx)("div",{className:"fullScreenBtn",onClick:function(){return u(!0)},children:Object(v.jsx)(de.j,{})})]})})]})},Qc=(n(276),function(e){var t=e.element,n=e.currentPage,s=e.setCurrentPage;return Object(v.jsx)(i.b,{to:t.link,className:"MobileControlBarItem",onClick:function(){return s(t.id)},style:t.id===n?{}:{opacity:.4},children:t.icon})}),Gc=function(){var e=S().currentUser,t={icon:Object(v.jsx)(de.q,{}),link:"/authors/".concat(e.uid)},n=Object(s.useState)((function(){var e=Tc.find((function(e,t){return!!window.location.hash.includes(g(e.title))}));return void 0===e?0:e.id})),c=Object(j.a)(n,2),a=c[0],r=c[1];return Object(v.jsxs)("div",{className:"BottomControlBar",children:[Tc.map((function(e,t){return Object(v.jsx)(Qc,{element:e,currentPage:a,setCurrentPage:r},t)})),Object(v.jsx)(Qc,{element:t,currentPage:a,setCurrentPage:r})]})},Kc=function(){var e=ue(),t=e.setOpenFullScreenPlayer,n=e.inputRange;return Object(v.jsxs)("div",{className:"FullBottomSide",children:[Object(v.jsxs)("span",{onClick:function(){return t(!0)},style:{display:"block",position:"relative"},children:[Object(v.jsx)(Nc,{textLimit:25,linkToAuthors:!1}),Object(v.jsx)("span",{className:"mobileSongRange",style:{width:n+"%"}})]}),Object(v.jsx)(Gc,{})]})},Xc=function(e){var t=Object.assign({},e),n=re(),c=n.openModal,a=n.setOpenModal,r=n.content,i=Object(s.useRef)(null),o=Ye().screenHeight;return Te(i,a),Object(v.jsx)("div",{className:"modal_darkBg",style:c?{height:o}:{opacity:0,visibility:"hidden"},children:Object(v.jsx)("div",Object(D.a)(Object(D.a)({className:"ModalWindow"},t),{},{ref:i,style:c?{}:{opacity:0,visibility:"hidden",transform:"translateY(40px)"},children:r}))})},Jc=function(){var e,t=Object(s.useState)([]),n=Object(j.a)(t,2),c=n[0],a=n[1],r=S().currentUser,i=Object(o.h)("/chat/:chatId"),u=null===i||void 0===i||null===(e=i.params)||void 0===e?void 0:e.chatId;return Object(s.useEffect)((function(){var e={},t=m.collection("chats").where("participants","array-contains",r.uid).onSnapshot((function(t){a((function(n){var s=Object(W.a)(n);return t.docChanges().map(function(){var t=Object(d.a)(l.a.mark((function t(n){var c,a,i,o,d,j;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:c=n.doc.data(),u!==c.id&&("added"===n.type?e[c.id]=c.messages.length:"modified"===n.type&&c.messages.length&&e[c.id]&&c.messages.length!==e[c.id]&&(a=c.id,i=c.chatName,o=c.chatImage,d=c.messages,j=d[d.length-1],j.sender!==r.uid&&!j.seenBy.includes(r.uid)&&(s.push({chatId:a,chatName:i,chatImage:o,message:d[d.length-1],userId:d[d.length-1].sender}),e[a]+=1)));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),s}))}));return function(){t()}}),[u]),Object(s.useEffect)((function(){var e;if(c.length)return e=setTimeout((function(){a((function(e){return e.slice(1,e.length)}))}),6200),function(){return clearTimeout(e)}}),[c.length]),[c,a]},_c=function(){var e=ue(),t=e.currentSongData,n=e.currentSongPlaylistSource,c=e.nextSong,a=e.prevSong,r=e.songRef,i=e.setPlay,o=function(){navigator.mediaSession.setPositionState({duration:r.current.duration,playbackRate:r.current.playbackRate,position:r.current.currentTime})};function u(){r.current.pause(),i(!1)}Object(s.useEffect)((function(){"mediaSession"in navigator&&-1!==t.id&&(navigator.mediaSession.metadata=new window.MediaMetadata({title:t.name,artist:jt(t.authors),album:n.name,artwork:[{src:t.cover,sizes:"512x512",type:"image/png"}]}),navigator.mediaSession.setActionHandler("play",(function(){r.current.play(),i(!0)})),navigator.mediaSession.setActionHandler("pause",u),navigator.mediaSession.setActionHandler("stop",u),navigator.mediaSession.setActionHandler("nexttrack",(function(){c(),o()})),navigator.mediaSession.setActionHandler("previoustrack",(function(){a(),o()})))}),[t.id])},$c=function(){var e=ue(),t=e.songRef,n=e.loadSongData,c=e.playing,a=e.songSrc,r=e.openFullScreenPlayer,i=e.repeatMode,o=e.setPlay,u=e.prevSong,b=e.currentSongQueue,h=e.nextSong,f=Ye(),O=f.isMobile,p=f.screenHeight,g=S().currentUser,x=Jc(),y=Object(j.a)(x,2),w=y[0],C=y[1];_c();var N=function(){var e=Object(s.useRef)(),t=ue(),n=t.currentSongData,c=t.currentSongPlaylistSource,a=t.songDuration,r=t.play;function i(){-1!==n.id&&(e.current=setTimeout(Object(d.a)(l.a.mark((function e(){var t,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("songs").doc(n.id).get();case 2:t=e.sent.data().listens,++t,m.collection("songs").doc(n.id).update({listens:t}),"albums"===c.source.substr(1,6)&&(s=c.source.substr(8,c.source.length-8),m.collection("playlists").doc(s).get().then((function(e){var t=e.data().listens;t++,m.collection("playlists").doc(s).update({listens:t})}))),n.authors.forEach(function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("users").doc(t.uid).get();case 2:n=e.sent.data().numberOfListenersPerMonth,++n,m.collection("users").doc(t.uid).update({numberOfListenersPerMonth:n});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 7:case"end":return e.stop()}}),e)}))),1e3*a*.5))}return Object(s.useEffect)((function(){clearTimeout(e.current),r&&i()}),[r,n.id]),i}();return Object(s.useEffect)((function(){var e=setInterval((function(){m.collection("users").doc(g.uid).update({online:(new Date).getTime()})}),3e5);return function(){return clearInterval(e)}}),[]),Object(s.useEffect)((function(){m.collection("users").doc(g.uid).update({online:(new Date).getTime()})}),[]),Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)("audio",{src:a,ref:t,onLoadedData:n,onTimeUpdate:c,onEnded:function(){return 0===i?(t.current.pause(),o(!1),u()):1===i?1===b.length?(u(),N(),t.current.play()):h():(u(),N(),void t.current.play())}}),Object(v.jsxs)("div",{className:"Wrapper "+(r?"turnedOff":""),style:O?{height:p}:{height:"100vh"},children:[O?"chat"===window.location.hash.substr(2,4)&&window.location.hash.length>6?null:Object(v.jsx)(Kc,{}):Object(v.jsx)(qc,{}),Object(v.jsx)("div",{className:"Content",children:Object(v.jsx)(Oc,{})}),Object(v.jsx)(pc,{}),Object(v.jsx)(Xc,{}),Object(v.jsx)(vc,{}),w.map((function(e,t){return Object(v.jsx)(xc,Object(D.a)(Object(D.a)({},e),{},{index:t,notifsLen:w.length,setNotifications:C}))}))]}),Object(v.jsx)(Pc,{})]})},Zc=function(){return S().currentUser.uid?Object(v.jsx)(o.d,{children:Object(v.jsx)(o.b,{path:"/",component:$c})}):Object(v.jsxs)(o.d,{children:[hc.map((function(e,t){var n=e.path,s=e.Component;return Object(v.jsx)(o.b,{path:n,component:s,exact:!0},t)})),Object(v.jsx)(o.a,{to:C})]})};function ea(){return Object(v.jsx)(i.a,{basename:"/",children:Object(v.jsx)(Zc,{})})}r.a.render(Object(v.jsx)(c.a.StrictMode,{children:Object(v.jsx)(qe,{children:Object(v.jsx)(w,{children:Object(v.jsx)(ie,{children:Object(v.jsx)(le,{children:Object(v.jsx)(ea,{})})})})})}),document.getElementById("root"))},91:function(e,t,n){}},[[277,1,2]]]);
//# sourceMappingURL=main.eb3a1483.chunk.js.map